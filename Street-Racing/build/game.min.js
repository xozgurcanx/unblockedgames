"use strict";var __extends=this&&this.t||function(){var h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])};return function(t,i){function n(){this.constructor=t}h(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();!function(t){var i=function(){function t(t){this.i=t,this.muted=!1}return t.prototype.play0=function(t,i){if(this.muted)return i&&i(),0;var n=this.i.play(t);return null!=i&&this.i.once("end",function(){i()},n),n},t.prototype.pause=function(t){this.i.pause(t)},t.prototype.stop=function(t){this.i.stop(t)},t.prototype.mute=function(t){this.muted=!0,this.i.mute(!0,t)},t.prototype.unmute=function(t){this.muted=!1,this.i.mute(!1,t)},t.prototype.fade=function(t,i,n,h,s){this.muted?s&&s():(this.i.fade(t,i,n,h),s&&this.i.once("fade",function(t){s()},h))},t.prototype.loop=function(t,i){this.i.loop(t,i)},t.prototype.seek=function(t,i){this.i.seek(t,i)},t.prototype.rate=function(t,i){this.i.rate(t,i)},t.prototype.setVolume=function(t,i){this.i.volume(t,i)},t.prototype.getVolume=function(){return this.i.volume()},t}();t.AbstractSound=i}(h5ge||(h5ge={})),function(s){var t=function(){function i(t){this.s=t,this.u={},this.o={},this.l=!0,this.v=!0,this.p=!0,this.m=!0,this.musicStateChangeHandlers=new s.HandlerCollection,(i._=this).s.addVisibilityChangeHandler(this.onVisibilityChange.bind(this))}return i.prototype.loadSounds=function(t,i){new s.Loader(t).load(function(t){i(t)})},i.prototype.registerSoundsheet=function(t,i){var n=s.JSONS.safeJson(i);if(null!=n){n.src=n.urls;var h=new Howl(n);this.getSpriteCount(n.sprite)<=1?(s.logger.debug("Registering music: "+t),this.addMusic(t,new s.Music(h,n.sprite))):(s.logger.debug("Registering sound: "+t),this.addSoundSprite(t,new s.Sound(h)))}},i.prototype.getSpriteCount=function(t){if(null==t)return 0;var i=0;for(var n in t)i++;return i},i.prototype.mute=function(){Howler.mute(!0)},i.prototype.unmute=function(){Howler.mute(!1)},i.prototype.volume=function(t){Howler.volume(t)},i.prototype.addMusic=function(t,i){this.l||i.mute(),this.o[t]=i},i.prototype.getMusic=function(t){var i=this.o[t];return i||(s.logger.error("Can't find music with name: "+t),null)},i.prototype.muteMusics=function(){for(var t in s.logger.debug("muting musics "),this.o)this.o[t].mute();this.l=!1,this.musicStateChangeHandlers.fire(!1)},i.prototype.unmuteMusics=function(){for(var t in s.logger.debug("unmuting musics "),this.o)this.o[t].unmute();this.l=!0,this.musicStateChangeHandlers.fire(!0)},i.prototype.volumeMusics=function(t){for(var i in this.o)this.o[i].setVolume(t)},Object.defineProperty(i.prototype,"enableMusics",{get:function(){return this.l},set:function(t){t?this.unmuteMusics():this.muteMusics()},enumerable:!0,configurable:!0}),i.prototype.addSoundSprite=function(t,i){this.u[t]=i,this.v||i.mute()},i.prototype.getSoundSprite=function(t){var i=this.u[t];return i||(s.logger.error("Can't find sound sprite with name: "+t+". Sprite may not be loaded yet or load failed."),null)},i.prototype.muteSoundSprites=function(t,i){var n=this.u[t];null!=n&&(i?n.mute():n.unmute())},i.prototype.muteSoundsSprites=function(){for(var t in this.u)this.u[t].mute();this.v=!1},i.prototype.unmuteSoundsSprites=function(){for(var t in this.u)this.u[t].unmute();this.v=!0},i.prototype.volumeSoundsSprites=function(t){for(var i in this.u)this.u[i].setVolume(t)},Object.defineProperty(i.prototype,"enableSoundsSprites",{get:function(){return this.v},set:function(t){t?this.unmuteSoundsSprites():this.muteSoundsSprites()},enumerable:!0,configurable:!0}),i.prototype.onVisibilityChange=function(t){t?(this.enableMusics=this.p,this.enableSoundsSprites=this.m):(this.p=this.l,this.m=this.v,this.muteMusics(),this.muteSoundsSprites())},i.get=function(){return i._},i}();s.AudioManager=t}(h5ge||(h5ge={})),function(t){var i=function(s){function t(t,i){var n=s.call(this,t)||this;if((n.O=null)!=i)for(var h in i){n.O=h;break}return n}return __extends(t,s),t.prototype.play=function(t){return s.prototype.play0.call(this,this.O,t)},t}(t.AbstractSound);t.Music=i}(h5ge||(h5ge={})),function(t){var i=function(n){function t(t){return n.call(this,t)||this}return __extends(t,n),t.prototype.play=function(t,i){return n.prototype.play0.call(this,t,i)},t}(t.AbstractSound);t.Sound=i}(h5ge||(h5ge={})),h5ge||(h5ge={}),function(t){if(Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),!t.performance||!t.performance.now){var i=Date.now();t.performance||(t.performance={}),t.performance.now=function(){return Date.now()-i}}for(var h=Date.now(),n=["ms","moz","webkit","o"],s=0;s<n.length&&!t.requestAnimationFrame;++s)t.requestAnimationFrame=t[n[s]+"RequestAnimationFrame"],t.cancelAnimationFrame=t[n[s]+"CancelAnimationFrame"]||t[n[s]+"CancelRequestAnimationFrame"];t.requestAnimationFrame||(t.requestAnimationFrame=function(t){if("function"!=typeof t)throw new TypeError(t+"is not a function");var i=Date.now(),n=16+h-i;return n<0&&(n=0),h=i,setTimeout(function(){h=Date.now(),t(performance.now())},n)}),t.cancelAnimationFrame||(t.cancelAnimationFrame=function(t){clearTimeout(t)})}(window),function(s){var e=function(){function t(t,i,n){void 0===n&&(n=60),this.callback=t,this.forceSetTimeOut=i,this.A=!1,this.j=1e3/n,this.G=this.onSetTimeoutCb.bind(this),this.k=this.onRafCb.bind(this)}return t.prototype.start=function(){this.A||(this.A=!0,this.D=performance.now(),this.T=this.forceSetTimeOut?window.setTimeout(this.G,0):window.requestAnimationFrame(this.k))},t.prototype.stop=function(){this.A&&(this.A=!1,this.forceSetTimeOut?clearTimeout(this.T):window.cancelAnimationFrame(this.T))},t.prototype.onSetTimeoutCb=function(){this.D=performance.now(),this.callback(this.D);var t=Math.min(this.j,performance.now()-this.D);this.T=window.setTimeout(this.G,t)},t.prototype.onRafCb=function(t){this.D=t,this.callback(t),this.T=window.requestAnimationFrame(this.k)},t}();s.RequestAnimationFrame=e;var t=function(){function t(t,i){this.updateCb=t,this.renderCb=i,this.started=!1,this.lastTime=0,this.S=0,this.C=10,this.I=[],this.H=0}return t.prototype.start=function(){if(!this.started){var t=s.Game.get().options.gameLoop,i=null!=t&&null!=t.desiredFps?t.desiredFps:60,n=null!=t&&null!=t.forceSetTimeout&&t.forceSetTimeout;if(this.started=!0,this.P=1e3/i,this.L=1e3/i,this.lastTime=performance.now(),t.smoothDelta){this.raf=new e(this.ticksmooth.bind(this),n,i);for(var h=0;h<this.C;h++)this.I[h]=this.P}else this.raf=new e(this.tick.bind(this),n,i);this.raf.start()}},t.prototype.tick=function(t){var i=(t=performance.now())-this.lastTime;i=Math.min(i,100);var n=s.Maths.clamp(this.P/i,0,1);this.lastTime=t,this.updateCb(t,i),this.renderCb(t,n)},t.prototype.ticksmooth=function(t){var i=(t=performance.now())-this.lastTime;100<i&&(i=this.I[this.S]),this.I[this.S]=i,this.S++,this.S>=this.C&&(this.S=0);for(var n=0,h=0;h<this.C;h++)n+=this.I[h];var s=(n/=this.C)/i;this.lastTime=t,this.updateCb(t,n),this.renderCb(t,s)},t.prototype.stop=function(){this.started&&(this.started=!1,this.raf.stop())},t}();s.MainLoop=t}(h5ge||(h5ge={})),function(s){var t=function(){function i(){this.R=!1,this.showCursor=!0,this.U=!0,this.Y=!1,this.X=!1,this.B=0,this.F=0,this.q=0,this.J=0,this.Z=0,this.V=1,this.W=1,this.K=1,this.$=0,this.tt=0,this.it=!1,this.nt=!1,this.ht=16777215,this.st=!1,this.et=1,this.rt=!1,this.B=0,this.F=0,this.W=1,this.K=1,this.ut=i.ot++,this.ft="DisplayObject-"+this.ut,this.at=new s.Matrix,this.ct=new s.Matrix,this.lt=new s.Matrix}return i.prototype.addDebugBorder=function(t){void 0===t&&(t="#00FFBB"),this.debug=!0},Object.defineProperty(i.prototype,"tint",{get:function(){return this.ht},set:function(t){this.ht=null==t?16777215:t},enumerable:!0,configurable:!0}),i.prototype.draw=function(t){if(this.visible){this.computeWorldTransform();var i=this.getParentAlpha();this.et=this.V*i,t.globalAlpha=this.et,t.save(),this.ct.applyToContext(t),null!=this.vt&&this.vt.gt(t),this.cachedAsBitmap?(null==this.xt&&this.createCachedTexture(),this.drawCachedTexture(t)):this.draw0(t),t.restore()}},i.prototype.computeWorldTransform=function(){this.st&&(this.st=!1,this.at.reset(),0==this.B&&0==this.F||this.at.translate(this.B,this.F),(0!=this.Z||1!=this.W||1!=this.K||this.it||this.nt)&&(0==this.$&&0==this.tt||this.at.translate(this.$,this.tt),0!=this.Z&&this.at.rotate(this.Z),1==this.W&&1==this.K||this.at.scale(this.W,this.K),0==this.$&&0==this.tt||this.at.translate(-this.$,-this.tt),(this.it||this.nt)&&(this.at.translate(this.q*(this.it?1:0),this.J*(this.nt?1:0)),this.at.scale(this.it?-1:1,this.nt?-1:1))));var t=this.getParentWorldTransform(),i=new s.Matrix;i.setTransform(t.a,t.b,t.c,t.d,t.e,t.f),i.transform(this.at.a,this.at.b,this.at.c,this.at.d,this.at.e,this.at.f);var n=this.getParentHitTransform(),h=new s.Matrix;(h.setTransform(n.a,n.b,n.c,n.d,n.e,n.f),this.R||h.transform(this.at.a,this.at.b,this.at.c,this.at.d,this.at.e,this.at.f),this.Y)&&((!h.isEqual(this.lt)||null==this.wt)&&this.updateWorldHitArea(h));this.ct=i,this.lt=h},i.prototype.getParentWorldTransform=function(){return null==this.yt?new s.Matrix:this.yt.ct},i.prototype.getParentAlpha=function(){return null==this.yt?1:this.yt.et},i.prototype.getParentHitTransform=function(){return this.R?this.lt:this.yt.lt},i.prototype.updateWorldHitArea=function(t){var i;if(null!=this.bt)i=t.applyToArray([this.bt.x,this.bt.y,this.bt.x+this.bt.width,this.bt.y,this.bt.x+this.bt.width,this.bt.y+this.bt.height,this.bt.x,this.bt.y+this.bt.height]);else{if(this.q<=0||this.height<=0)return void s.logger.warn("Cannot compute hit area on no-size object. Check bounds of #"+this.getDebugId()+". Size:"+this.q+"x"+this.J);i=t.applyToArray([0,0,this.q,0,this.q,this.J,0,this.J])}i.push(i[0]),i.push(i[1]),this.wt=i},i.prototype.draw0=function(t){},i.prototype.createCachedTexture=function(){},i.prototype.drawCachedTexture=function(t){t.drawImage(this.xt.getImpl(),this.xt.x,this.xt.y,this.xt.width,this.xt.height,0,0,this.xt.width,this.xt.height)},i.prototype.onDetach=function(){null!=this.pt&&this.pt.fire()},i.prototype.removeSelf=function(){return null!=this.yt&&null!=this.yt.removeChild(this)},i.prototype.getDebugId=function(){return this.ft},i.prototype.setDebugId=function(t,i){void 0===i&&(i=!1),this.ft=t,i&&(this.ft+=this.ut)},i.prototype.hitPoint=function(t){return null!=this.wt&&0<this.wt.length?s.Collisions.pointInPolygon2(this.wt,t.x,t.y):!this.st&&(s.logger.error("Using containsPoint without worldHitArea. Check object bounds of #"+this.getDebugId()+". Size:"+this.q+"x"+this.J+", Hit area: "+this.bt),this.containsPoint(t))},i.prototype.containsPoint=function(t){return!1},Object.defineProperty(i.prototype,"interactive",{get:function(){return this.Y},set:function(t){i.interactiveDirty=!0,this.wt=null,this.Y=t,this.st=!0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"hitArea",{get:function(){return this.bt},set:function(t){this.bt=t,this.wt=null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"hasInteractiveChild",{get:function(){return this.X},set:function(t){this.X=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"mask",{get:function(){return this.vt},set:function(t){this.vt=t},enumerable:!0,configurable:!0}),Object.defineProperty(i,"interactiveDirty",{get:function(){return this._t},set:function(t){this._t=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"visible",{get:function(){return this.U},set:function(t){this.U=t},enumerable:!0,configurable:!0}),i.prototype.onClick=function(t,i,n){this.interactive=!0,null!=n&&1==n?this.clickHandler.once(t,i):this.clickHandler.add(t,i)},i.prototype.hasDownHandler=function(){return null!=this.Et&&0<this.Et.length},i.prototype.hasUpHandler=function(){return null!=this.Ot&&0<this.Ot.length},i.prototype.hasOverHandler=function(){return null!=this.At&&0<this.At.length},i.prototype.hasOutHandler=function(){return null!=this.jt&&0<this.jt.length},i.prototype.hasClickHandler=function(){return null!=this.Gt&&0<this.Gt.length},Object.defineProperty(i.prototype,"downHandler",{get:function(){return null==this.Et&&(this.Et=new s.HandlerCollection),this.Et},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"upHandler",{get:function(){return null==this.Ot&&(this.Ot=new s.HandlerCollection),this.Ot},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"overHandler",{get:function(){return null==this.At&&(this.At=new s.HandlerCollection),this.At},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"outHandler",{get:function(){return null==this.jt&&(this.jt=new s.HandlerCollection),this.jt},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"clickHandler",{get:function(){return null==this.Gt&&(this.Gt=new s.HandlerCollection),this.Gt},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"detachListener",{get:function(){return null==this.pt&&(this.pt=new s.HandlerCollection),this.pt},enumerable:!0,configurable:!0}),i.prototype.setPivot=function(t,i){this.$=t,this.tt=i,this.st=!0},i.prototype.setPivotToCenter=function(){if(this.q<=0||this.J<=0)throw new Error("Cannot set pivot to center on display object without size");this.$=this.q/2,this.tt=this.J/2,this.st=!0},Object.defineProperty(i.prototype,"x",{get:function(){return this.B},set:function(t){this.B=t,this.st=!0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"y",{get:function(){return this.F},set:function(t){this.F=t,this.st=!0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"alpha",{get:function(){return this.V},set:function(t){this.V=t,1<this.V?this.V=1:this.V<0&&(this.alpha=0)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scaleX",{get:function(){return this.W},set:function(t){this.W=t,this.st=!0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scaleY",{get:function(){return this.K},set:function(t){this.K=t,this.st=!0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scaleXY",{get:function(){return this.W},set:function(t){this.W=t,this.K=t,this.st=!0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"debug",{get:function(){return this.kt},set:function(t){this.kt=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"pivotX",{get:function(){return this.$},set:function(t){this.$=t,this.st=!0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"pivotY",{get:function(){return this.tt},set:function(t){this.tt=t,this.st=!0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"flipX",{get:function(){return this.it},set:function(t){this.it=t,this.st=!0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"flipY",{get:function(){return this.nt},set:function(t){this.nt=t,this.st=!0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"angle",{get:function(){return this.Z*s.Maths.RADIAN_TO_DEG},set:function(t){this.rotation=t*s.Maths.DEG_TO_RADIAN},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"width",{get:function(){return this.q*this.W},set:function(t){0!=this.q&&(this.scaleX=t/this.q)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"height",{get:function(){return this.J*this.K},set:function(t){0!=this.J&&(this.scaleY=t/this.J)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"parent",{get:function(){return this.yt},set:function(t){throw new Error("parent is readonly")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"rotation",{get:function(){return this.Z},set:function(t){this.Z=t,this.st=!0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"cachedAsBitmap",{get:function(){return this.rt},set:function(t){this.rt=t},enumerable:!0,configurable:!0}),i._t=!1,i.ot=0,i}();s.DisplayObject=t}(h5ge||(h5ge={})),function(n){var t=function(h){function e(t,i){void 0===t&&(t=0),void 0===i&&(i=0);var n=h.call(this)||this;return n.Dt=[],n.ft="Container-"+n.ut,n.q=t,n.J=i,n}return __extends(e,h),e.prototype.addChild=function(t){return this.addChildAt(t,this.Dt.length)},e.prototype.addChildAt=function(t,i){if(t.yt){if(t.yt==this)return console.error("Child already in H5Container. Use setChildIndex."),t;t.yt.removeChild(t)}return this.Dt.splice(i,0,t),t.yt=this,t},e.prototype.removeChild=function(t){var i=this.Dt.indexOf(t);return-1===i?null:this.removeChildAt(i)},e.prototype.removeChildAt=function(t){var i=this.getChildAt(t);return i.yt=null,i.onDetach(),this.Dt.splice(t,1),i},e.prototype.removeChildren=function(t,i){var n=null==t?0:t,h=(null==i?this.Dt.length:i)-n;if(h<=0)return[];for(var s=this.Dt.splice(n,h),e=0;e<s.length;e++){var r=s[e];r.yt=null,r.onDetach()}return s},e.prototype.getChildIndex=function(t){return this.Dt.indexOf(t)},e.prototype.getChildById=function(t){for(var i=0;i<this.Dt.length;i++){var n=this.Dt[i];if(n.getDebugId()==t)return n}return null},e.prototype.setChildIndex=function(t,i){var n=this.getChildIndex(t);n!=i?(this.Dt.splice(n,1),this.Dt.splice(i,0,t)):console.error("Child "+t.getDebugId()+"already @ that index : "+i)},e.prototype.onDetach=function(){h.prototype.onDetach.call(this);for(var t=this.Dt.length,i=0;i<t;i++)this.Dt[i].onDetach()},e.prototype.getChildAt=function(t){return this.Dt[t]},e.prototype.getChildrenCount=function(){return this.Dt.length},e.prototype.Tt=function(t,i){void 0===i&&(i=[]);for(var n="",h=0;h<t;h++)n+="  ";for(h=0;h<this.Dt.length;h++){var s=this.Dt[h];console.log(n+this.getDebugPropertyString(s,i)),s instanceof e&&s.Tt(t++,i)}},e.prototype.St=function(t){if(void 0===t&&(t=!1),t&&!this.visible)return 0;for(var i=1,n=0;n<this.Dt.length;n++){var h=this.Dt[n];i+=h instanceof e?h.St():1}return i},e.prototype.getDebugPropertyString=function(i,t){var n=i.getDebugId()+" ";return t.forEach(function(t){n+=t+"="+i[t]+" "}),n},e.prototype.draw0=function(t){h.prototype.draw0.call(this,t);for(var i=0;i<this.Dt.length;i++){this.Dt[i].draw(t)}},e.prototype.setSize=function(t,i){this.q=t,this.J=i},e.prototype.setSizeFromChildren=function(t){void 0===t&&(t=!1);var i=n.layout.computeBounds(this,t);this.setSize(i.width,i.height)},e}(n.DisplayObject);n.Container=t}(h5ge||(h5ge={})),function(i){var t=function(){function t(){this.Ct=new i.HashMap,this.Nt=!1,this.R=new i.Container,this.R.R=!0,this.R.setDebugId("root")}return t.prototype.destroy=function(){this.Ct.clear()},t.prototype.update=function(){this.Nt&&(this.sortLayers(),this.Nt=!1)},t.prototype.getChild=function(t){return this.ensureLayer(t).container},t.prototype.addChild=function(t,i){void 0===i&&(i=1);var n=this.ensureLayer(t);return n.zindex=i,n.container},t.prototype.removeChild=function(t){var i=this.Ct.remove(t);return null!=i&&this.R.removeChild(i.container),i.container},t.prototype.setChildIndex=function(t,i){this.ensureLayer(t).zindex=i,this.Nt=!0},t.prototype.sortLayers=function(){for(var t=this.Ct.values().sort(function(t,i){return t.zindex-i.zindex}),i=0;i<t.length;i++){var n=t[i];this.R.getChildIndex(n.container)!=i&&this.R.setChildIndex(n.container,i)}},t.prototype.ensureLayer=function(t){var i=this.Ct.get(t);return null==i&&(i=new n(t),this.R.addChild(i.container),this.Ct.put(t,i),this.Nt=!0),i},Object.defineProperty(t.prototype,"root",{get:function(){return this.R},set:function(t){throw new Error("root is read-only")},enumerable:!0,configurable:!0}),t}();i.ContainerGroup=t;var n=function(t){this.container=new i.Container,this.container.setDebugId(t),this.zindex=1,this.name=t}}(h5ge||(h5ge={})),function(t){var i=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"background",{get:function(){return null==this.It&&(this.It=this.addChild("background",1)),this.It},set:function(t){throw new Error("background is read-only")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scene",{get:function(){return null==this.Ht&&(this.Ht=this.addChild("scene",100)),this.Ht},set:function(t){throw new Error("scene is read-only")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"gameplayHUD",{get:function(){return null==this.Pt&&(this.Pt=this.addChild("gameplayHUD",150)),this.Pt},set:function(t){throw new Error("gameplayHUD is read-only")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"sceneHUD",{get:function(){return null==this.Pt&&(this.Pt=this.addChild("sceneHUD",180)),this.Pt},set:function(t){throw new Error("sceneHUD is read-only")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"popup",{get:function(){return null==this.Lt&&(this.Lt=this.addChild("popup",200)),this.Lt},set:function(t){throw new Error("popup is read-only")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"top",{get:function(){return null==this.Rt&&(this.Rt=this.addChild("top",300)),this.Rt},set:function(t){throw new Error("top is read-only")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"technical",{get:function(){return null==this.Ut&&(this.Ut=this.addChild("technical",400)),this.Ut},set:function(t){throw new Error("technical is read-only")},enumerable:!0,configurable:!0}),i}(t.ContainerGroup);t.GameContainerGroup=i}(h5ge||(h5ge={})),function(e){var t=function(){function h(t,i,n){void 0===n&&(n={}),this.Yt=[],this.zt=[],this.Xt=!1,this.Bt=[],this.Ft=0,this.qt=performance.now(),this.Jt=0,this.Zt=[],this.Vt=[],this.Wt=[],h.GAME_INSTANCE=this,n.gameLoop=n.gameLoop||{},n.gameLoop.desiredFps=n.gameLoop.desiredFps||60,n.gameLoop.forceSetTimeout=n.gameLoop.forceSetTimeout||!1,n.gameLoop.smoothDelta=n.gameLoop.smoothDelta||!1,n.input=n.input||{},n.input.maxTouchPointer=n.input.maxTouchPointer||1,n.rendering=n.rendering||{},n.rendering.backgroundColor=null==n.rendering.backgroundColor?-1:n.rendering.backgroundColor,n.rendering.canvasFullscreen=null==n.rendering.canvasFullscreen||n.rendering.canvasFullscreen,this.updt_LastTime=Date.now(),this.options=n,this.Kt=new e.Rectangle(0,0,t,i),this.timeManager=e.TimeManager.get(),this.deviceManager=new e.DeviceManager,this.audioManager=new e.AudioManager(this.deviceManager.visibilityManager),this.layers=new e.GameContainerGroup,this.renderer=new e.GameCanvas(t,i)}return h.prototype.start=function(){var t=this;this.deviceManager.whenReady(function(){try{t.start0()}catch(t){e.logger.error("Error occured while starting game",t)}})},h.get=function(){return h.GAME_INSTANCE},h.options=function(){return h.GAME_INSTANCE.options},h.prototype.start0=function(){var t=this;this.scaleManager=new e.ScaleManager(this),this.inputManager=new e.InputManager(this),this.mainLoop=new e.MainLoop(this.update.bind(this),this.render.bind(this)),this.mainLoop.start(),this.onCreate(),window.addEventListener("load",function(){t.scaleManager.resize()}),window.parent&&document.addEventListener("click",function(){document.hasFocus()||window.focus()},!1)},h.prototype.onCreate=function(){},h.prototype.update=function(t,i){e.Time.Qt(t);var n=performance.now();this.Xt=!0;try{this.inputManager.update(i),this.timeManager.update(i),this.layers.update(),this.scene&&this.scene.update(i);for(var h=0;h<this.Yt.length;h++)this.Yt[h].update(i);if(this.Xt=!1,0<this.Bt.length){for(h=0;h<this.Bt.length;h++)this.Bt[h]();this.Bt=[]}}catch(t){e.logger.error("Error occured in game update:"+t.message,t),this.Xt=!1}var s=performance.now();this.Jt++,this.Zt[this.Ft]=s-n,this.Wt[this.Ft]=i,this.Ft++,120<this.Ft&&(this.Ft=0)},h.prototype.render=function(t,i){performance.now();try{this.scene&&this.scene.render(i);for(var n=0;n<this.zt.length;n++)this.zt[n].render(i);this.renderer.beginDraw(),this.layers.root.draw(this.renderer.context),this.renderer.endDraw()}catch(t){e.logger.error("Error occured in game render: ",t)}performance.now()},h.prototype.getStats=function(){for(var t=performance.now(),i=99,n=0,h=0,s=0;s<this.Zt.length;s++)h+=this.Zt[s],i=Math.min(i,this.Zt[s]),n=Math.max(n,this.Zt[s]);h/=this.Zt.length;var e=0,r=99,u=0;for(s=0;s<this.Vt.length;s++)e+=this.Vt[s],r=Math.min(r,this.Vt[s]),u=Math.max(u,this.Vt[s]);e/=this.Vt.length;var o=0,f=99,a=0;for(s=0;s<this.Wt.length;s++)o+=this.Wt[s],f=Math.min(f,this.Wt[s]),a=Math.max(a,this.Wt[s]);o/=this.Wt.length;var c=(t-this.qt)/1e3,l=this.Jt/c;return this.Jt=0,this.qt=t,{update:{min:this.roundStat(i),max:this.roundStat(n),avg:this.roundStat(h)},render:{min:this.roundStat(r),max:this.roundStat(u),avg:this.roundStat(e)},delta:{min:this.roundStat(f),max:this.roundStat(a),avg:this.roundStat(o)},fps:this.roundStat(l)}},h.prototype.roundStat=function(t){return Math.round(100*t)/100},h.prototype.switchScene=function(t,i,n){var h=this;void 0===i&&(i=!0),void 0===n&&(n=!0),this.scene?(this.$t=t,this.scene.hide(function(){h.layers.scene.removeChild(h.scene.container),h.pushScene(t,n)},i)):(this.$t=t,this.pushScene(t,n))},h.prototype.pushScene=function(t,i){e.logger.debug("Change scene"),this.scene=t,this.scene&&(this.layers.scene.addChild(this.scene.container),this.scene.show(i))},h.prototype.addRenderable=function(t){this.zt.push(t)},h.prototype.removeRenderable=function(t){var i=this.zt.indexOf(t);this.zt.splice(i,1)},h.prototype.addUpdatable=function(t){if(this.Xt){var i=this;this.Bt.push(function(){i.Yt.push(t)})}else this.Yt.push(t)},h.prototype.removeUpdatable=function(t){if(this.Xt){var i=this;this.Bt.push(function(){i.removeUpdatable(t)})}else{var n=this.Yt.indexOf(t);this.Yt.splice(n,1)}},h.prototype.getCurrentOrPendingScene=function(){return this.$t},Object.defineProperty(h.prototype,"width",{get:function(){return this.Kt.width},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"height",{get:function(){return this.Kt.height},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"bounds",{get:function(){return this.Kt},enumerable:!0,configurable:!0}),h.prototype.getOrCreateBackground=function(t,i){return null!=this.It||(this.It=new e.Background(t,i)),this.It},h.prototype.ti=function(t,i){void 0===t&&(t=65467),void 0===i&&(i=!1);var n=new e.Graphics;n.beginStroke(1,t),n.drawRect(0,0,this.width,this.height),i&&(n.moveTo(0,this.height/2),n.lineTo(this.width,this.height/2),n.moveTo(this.width/2,0),n.lineTo(this.width/2,this.height)),n.endStroke(),this.layers.root.addChild(n)},h}();e.Game=t}(h5ge||(h5ge={})),function(n){var t=function(){function t(t){var i=this;this.ii=!1,this.enable=!0,this.ni=!0,this.hi=t,this.ni=this.hi.options.rendering.canvasFullscreen,this.si=new h,window.addEventListener("resize",function(){i.ii||(i.ii=!0,window.setTimeout(function(){i.resize()},250))}),window.addEventListener("deviceOrientation",function(){i.ii||(i.ii=!0,window.setTimeout(function(){i.resize()},250))}),this.resizeHandler=new n.HandlerCollection,this.resize()}return t.prototype.resize=function(){if(this.ii=!1,this.enable){var t=window.innerWidth,i=window.innerHeight;if(null!=this.ei){var n=this.ei();t=n.width,i=n.height}var h=this.hi.bounds;this.ri=this.si.getScaling(h.width,h.height,t,i);var s=window.devicePixelRatio||1;if(this.ni){var e=this.hi.renderer,r=this.hi.layers.root;e.canvas.width=t*s,e.canvas.height=i*s,e.canvas.style.width=t+"px",e.canvas.style.height=i+"px",r.scaleXY=this.ri.scale*s,r.x=this.ri.x*s,r.y=this.ri.y*s}else{s=1,(e=this.hi.renderer).canvas.width=h.width*s,e.canvas.height=h.height*s,e.canvas.style.width=h.width*s*this.ri.scale+"px",e.canvas.style.height=h.height*s*this.ri.scale+"px",e.canvas.style.left=this.ri.x+"px",e.canvas.style.top=this.ri.y+"px"}window.scrollTo&&window.scrollTo(0,0),this.resizeHandler.fire()}},t.prototype.setWindowSizeProvider=function(t){this.ei=t},t.prototype.setScalingStategy=function(t){this.si=t},t.prototype.getAbsoluteGameSize=function(){var t=n.Game.get();return{width:t.width*this.ri.scale,height:t.height*this.ri.scale,marginX:this.ri.x,marginY:this.ri.y}},t.prototype.getWindowSize=function(){var t=window.innerWidth,i=window.innerHeight;if(null!=this.ei){var n=this.ei();t=n.width,i=n.height}return{width:t,height:i}},t.prototype.getCurrentScaling=function(){return this.ri},Object.defineProperty(t.prototype,"offsetX",{get:function(){return this.ri.x},set:function(t){this.ri.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"offsetY",{get:function(){return this.ri.y},set:function(t){this.ri.y=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scale",{get:function(){return this.ri.scale},set:function(t){this.ri.scale=t},enumerable:!0,configurable:!0}),t}();n.ScaleManager=t;var h=function(){function t(){}return t.prototype.getScaling=function(t,i,n,h){var s=i/t<h/n?n/t:h/i;return{x:(n-t*s)/2,y:(h-i*s)/2,scale:s}},t}();n.FitScalingStrategy=h;var i=function(){function t(){}return t.prototype.getScaling=function(t,i,n,h){var s=h/n<i/t?n/t:h/i;return{x:(n-t*s)/2,y:(h-i*s)/2,scale:s}},t}();n.FillScalingStrategy=i}(h5ge||(h5ge={})),function(e){var h,t;(t=h=e.DeadZone||(e.DeadZone={}))[t.Lock=0]="Lock",t[t.TopDown=1]="TopDown",t[t.TopDownTight=2]="TopDownTight";var i=function(){function t(t,i,n,h,s){this.targetOffsetX=0,this.targetOffsetY=0,this.ui=t,this.oi=new e.Rectangle(i,n,h,s)}return t.prototype.moveBy=function(t,i){this.oi.left+=t,this.oi.top+=i},t.prototype.update=function(t){this.followTarget(),this.checkBounds(),this.ui.x=-this.x,this.ui.y=-this.y},t.prototype.setLimits=function(t,i,n,h){},t.prototype.follow=function(t){this.fi=t},t.prototype.setDeadZone=function(t){this.ai=t},t.prototype.setDeadZonePreset=function(t){switch(t){case h.Lock:this.ai=null;break;case h.TopDown:var i=Math.max(this.oi.width,this.oi.height)/4;this.ai=new e.Rectangle((this.oi.width-i)/2,(this.oi.height-i)/2,i,i);break;case h.TopDownTight:var n=Math.max(this.oi.width,this.oi.height)/8;this.ai=new e.Rectangle((this.oi.width-n)/2,(this.oi.height-n)/2,n,n)}},t.prototype.followTarget=function(){if(null!=this.fi){var t=this.oi.width/2,i=this.oi.height/2,n=this.fi.x,h=this.fi.y;if(null!=this.targetOffsetX&&(n-=this.targetOffsetX),null!=this.targetOffsetY&&(h-=this.targetOffsetY),null!=this.ai){var s=n-this.oi.x,e=h-this.oi.y;s<this.ai.left?this.oi.x=n-this.ai.left:s>this.ai.right&&(this.oi.x=n-this.ai.right),e<this.ai.top?this.oi.y=h-this.ai.top:e>this.ai.bottom&&(this.oi.y=h-this.ai.bottom)}else this.oi.x=n-t,this.oi.y=h-i}},t.prototype.checkBounds=function(){null!=this.limitLeft&&this.oi.left<=this.limitLeft&&(this.oi.left=this.limitLeft),null!=this.limitRight&&this.oi.right>=this.limitRight&&(this.oi.right=this.limitRight),null!=this.limitTop&&this.oi.top<=this.limitTop&&(this.oi.top=this.limitTop),null!=this.limitBottom&&this.oi.bottom>=this.limitBottom&&(this.oi.bottom=this.limitBottom)},Object.defineProperty(t.prototype,"x",{get:function(){return this.oi.x},set:function(t){this.oi.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.oi.y},set:function(t){this.oi.y=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"zoom",{get:function(){return this.ui.scaleX},set:function(t){this.ui.scaleX=this.ui.scaleY=t},enumerable:!0,configurable:!0}),t}();e.Camera=i}(h5ge||(h5ge={})),function(s){var t=function(h){function i(t){var i=h.call(this)||this;if(i.ci=t,i.ft="Sprite-"+i.ut,i.setSizeFromTexture(),!i.texture.isLoaded()){var n=i;i.texture.addLoadedHandler(function(){n.setSizeFromTexture()})}return i}return __extends(i,h),i.prototype.setSizeFromTexture=function(){if(this.texture.trimmed){var t=this.texture.getTrim();this.q=t.width,this.J=t.height}else this.q=this.texture.width,this.J=this.texture.height},i.fromFrame=function(t){return new i(s.Texture.getTexture(t))},i.fromImage=function(t){return new i(s.Texture.fromImage(t))},i.fromTexture=function(t){return new i(t)},i.prototype.setTexture=function(t){this.ci=t},i.prototype.setFrame=function(t){this.ci=s.Texture.getTexture(t)},i.prototype.addLoadedHandler=function(t){this.texture.addLoadedHandler(t)},Object.defineProperty(i.prototype,"texture",{get:function(){return this.ci},enumerable:!0,configurable:!0}),i.prototype.draw0=function(t){var i=16777215==this.ht?this.ci:s.Tinter.tint(this.ci,this.ht),n=0,h=0;this.texture.trimmed&&(n=this.texture.getTrim().x,h=this.texture.getTrim().y),t.drawImage(i.getImpl(),i.x,i.y,i.width,i.height,n,h,i.width,i.height)},i}(s.DisplayObject);s.Sprite=t}(h5ge||(h5ge={})),function(e){var t=function(s){function n(t,i){var n=s.call(this,t[0])||this;n.fps=1e3/60,n.li=0,n.vi=[],n.di=!1,n.gi=0,n.xi=0,n.wi=-1,n.yi=0,n.Mi=0,n.bi=1,n.forward=!0,n.animationSpeed=1;var h=n;return t.forEach(function(t){h.vi.push(t)}),e.Game.get().addUpdatable(n),n.detachListener.once(n.destroy,n),null!=i&&n.setDebugId(i),n}return __extends(n,s),n.fromFrames=function(t,i){return new n(e.Texture.fromFrames(t),i)},n.prototype.destroy=function(){this.stop(),e.Game.get().removeUpdatable(this)},n.prototype.setTextures=function(t){var i=this.isPlaying();1==i&&this.stop(),this.vi=e.Texture.fromFrames(t),this.gotoAndStop(0),1==i&&this.play()},n.prototype.setFrameIndex=function(t){var i=this.vi[t];this.setTexture(i),0==this.di&&(this.di=!0)},n.prototype.setActiveFrame=function(t){var i;if(null!=t&&(i=t<0?(t%this.pi+this.pi)%this.pi:t%this.pi)!=this.li){this.li=i;var n=this.yi+this.li%this.pi;this.setFrameIndex(n),0<this.wi&&(t=Math.abs(t))>=this.wi&&(this.setFrameIndex(this.Mi),this.onAnimationEnded())}},n.prototype.onAnimationEnded=function(){this.di=!1,this.onEnd&&this.onEnd()},n.prototype.gotoAndStop=function(t){this.setFrameIndex(t),this.di=!1},n.prototype.gotoAndPlay=function(t){this.setFrameIndex(t)},n.prototype.update=function(t){if(this.di){var i=Math.floor((e.Time.now()-this.gi)/this.fps);i=Math.floor(i*this.animationSpeed);var n=this.xi;this.forward?n+=i:n-=i,this.setActiveFrame(n)}},n.prototype.getTotalFrames=function(){return this.pi},n.prototype.getCurrentFrame=function(){return this.li},n.prototype.play0=function(){this.di=!0,this.gi=e.Time.now(),this.xi=this.li},n.prototype.play=function(t,i){void 0===t&&(t=0),void 0===i&&(i=0),this.yi=t,this.Mi=0<i?i:this.vi.length-1,this.pi=this.Mi-this.yi+1,this.li=t,this.setFrameIndex(t),this.bi<0?this.wi=-1:this.wi=this.li+this.pi*this.bi,this.play0()},n.prototype.repeat=function(t){void 0===t&&(t=0),this.bi=t},n.prototype.isPlaying=function(){return this.di},n.prototype.stop=function(){this.di=!1},n}(e.Sprite);e.Animation=t}(h5ge||(h5ge={})),function(t){var i=function(i){function t(){var t=i.call(this)||this;return t.mi=!0,t.disableAlpha=.5,t.interactive=!0,t.downHandler.add(t.onStateDown,t),t.upHandler.add(t.onStateUp,t),t.overHandler.add(t.onStateOver,t),t.outHandler.add(t.onStateOut,t),t.enable(),t}return __extends(t,i),t.prototype.enable=function(){this.mi=!0,this.interactive=!0,this.alpha=1},t.prototype.disable=function(){this.mi=!1,this.interactive=!1,this.alpha=this.disableAlpha},t.prototype.onStateDown=function(){this._i=!0},t.prototype.onStateUp=function(){this.Ei=!1,this._i=!1},t.prototype.onStateOver=function(){this.Ei=!0},t.prototype.onStateOut=function(){this.Ei=!1,this._i=!1},t}(t.Container);t.Button=i}(h5ge||(h5ge={})),function(u){var h=function(){function r(t,i,n){this.Oi=t,this.Ai=i,this.ji=n}return r.fromFrames=function(t,i,n){var h=u.Sprite.fromFrame(t),s=null,e=null;return null!=i&&(s=u.Sprite.fromFrame(i)),null!=n&&(e=u.Sprite.fromFrame(n)),new r(h,s,e)},r.fromTextures=function(t,i,n){var h=u.Sprite.fromTexture(t),s=null,e=null;return null!=i&&(s=u.Sprite.fromTexture(i)),null!=n&&(e=u.Sprite.fromTexture(n)),new r(h,s,e)},r}();u.ImageButtonStyle=h;var t=function(n){function e(t){var i=n.call(this)||this;return i.Gi=null,i.ki=null,i.Di=t,i.addChild(i.Di.Ai),i.addChild(i.Di.ji),i.addChild(i.Di.Oi),i.setSize(i.Di.Oi.width,i.Di.Oi.height),i}return __extends(e,n),e.fromFramesArray=function(t){var i=t.length;if(i<1||3<i)throw new Error("Invalid states array size");var n=t[0],h=null,s=null;return 1<i&&(h=t[1]),2<i&&(s=t[2]),e.fromFrames(n,h,s)},e.fromFrames=function(t,i,n){return new e(h.fromFrames(t,i,n))},e.fromTextures=function(t,i,n){return new e(h.fromTextures(t,i,n))},e.prototype.setFrames=function(t,i,n){this.Di.Ai&&this.Di.Ai.removeSelf(),this.Di.ji&&this.Di.ji.removeSelf(),this.Di.Oi&&this.Di.Oi.removeSelf(),this.Di=h.fromFrames(t,i,n),this.addChildAt(this.Di.Oi,0),this.Di.Ai&&this.addChildAt(this.Di.Ai,0),this.Di.ji&&this.addChildAt(this.Di.ji,0)},e.prototype.setContent=function(t){this.addChild(t),u.layout.centerOnX(t,this,!1),u.layout.centerOnY(t,this,!1)},e.prototype.setText=function(t){null!=this.Gi&&this.Gi.removeSelf(),this.Gi=t,this.addChild(t),u.layout.centerOnX(t,this,!1),u.layout.centerOnY(t,this,!1)},e.prototype.setIcon=function(t,i){null!=this.ki&&this.ki.removeSelf(),this.ki=u.Sprite.fromFrame(t),null!=i&&(this.ki.scaleXY=i),u.layout.centerOnX(this.ki,this,!1),u.layout.centerOnY(this.ki,this,!1),this.addChild(this.ki)},e.prototype.setStateTexture=function(){this.Di.Ai&&(this.Di.Ai.visible=!1),this.Di.ji&&(this.Di.Ai.visible=!1),this.Di.Oi.visible=!1,this._i?this.Di.Ai&&(this.Di.Ai.visible=!0):this.Ei?this.Di.ji&&(this.Di.ji.visible=!0):this.Di.Oi&&(this.Di.Oi.visible=!0)},e.prototype.onStateDown=function(){n.prototype.onStateDown.call(this),this.setStateTexture()},e.prototype.onStateUp=function(){n.prototype.onStateUp.call(this),this.setStateTexture()},e.prototype.onStateOver=function(){n.prototype.onStateOver.call(this),this.setStateTexture()},e.prototype.onStateOut=function(){n.prototype.onStateOut.call(this),this.setStateTexture()},Object.defineProperty(e.prototype,"style",{get:function(){return this.Di},enumerable:!0,configurable:!0}),e}(u.Button);u.ImageButton=t}(h5ge||(h5ge={})),function(t){var i=function(){function t(t,i){this.Ti=t,this.Si=i,this.Ci={},this.apply(0)}return t.prototype.apply=function(t){for(var i=0;i<this.Si.length;i++){var n=this.Si[i],h=this.Ci[n],s=this.Ti[n];null!=h&&(s=h+(s-h)*t,this.Ti[n]=s),this.Ci[n]=s}},t.prototype.get=function(t){return this.Ci[t]},t}();t.SpriteInterpolator=i}(h5ge||(h5ge={})),function(a){!function(t){function i(t,i,n){void 0===n&&(n=!0);var h=Math.round((i.width-t.width)/2);t.x=n?i.x+h:h}function n(t,i,n){void 0===n&&(n=!0);var h=Math.round((i.height-t.height)/2);t.y=n?i.y+h:h}function f(t,i){void 0===i&&(i=!1);for(var n=Number.POSITIVE_INFINITY,h=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY,e=Number.NEGATIVE_INFINITY,r=0;r<t.getChildrenCount();r++){var u,o=t.getChildAt(r);u=i&&o instanceof a.Container?f(o,!0):o,n=Math.min(n,u.x),h=Math.min(h,u.y),0<u.width&&(e=Math.max(e,u.x+u.width)),0<u.height&&(s=Math.max(s,u.y+u.height))}return{x:n,y:h,width:e-n,height:s-h}}t.centerOnX=i,t.centerOnY=n,t.centerOnXInParent=function(t){i(t,t.parent,!1)},t.centerOnYInParent=function(t){n(t,t.parent,!1)},t.centerOnXYInParent=function(t){i(t,t.parent,!1),n(t,t.parent,!1)},t.computeBounds=f,t.setContainerSize=function(t,i){void 0===i&&(i=!1);var n=f(t,i);t.setSize(n.width,n.height)}}(a.layout||(a.layout={}))}(h5ge||(h5ge={})),function(o){var t=function(u){function t(t,i,n,h){var s=u.call(this)||this;s.Ni=t,s.Ii=i,s.Hi=n,s.Pi=h,s.Li=[],s.optShowItemOverlay=!0;s.Ri=new o.ScrollableContainer,s.addChild(s.Ri);var e=t,r=i;return h?(r=(s.Ui=i)*n,s.Ri.scrollEnableOnX=!1):(e=(s.Ui=t)*n,s.Ri.scrollEnableOnY=!1),s.Ri.setContainerSize(e,r),s.Ri.addScrollHandler(s.onScroll,s),s.Ri.wheelOnY=s.Pi,s.Yi=new o.Rectangle(0,0,e,r),s.setSize(e,r),s.updateVisibleItems(0),s}return __extends(t,u),t.prototype.getContentBounds=function(){return this.Yi},t.prototype.addItem=function(t){var i=this.Li.length;this.Pi?(t.x=0,t.y=i*this.Ii):(t.x=i*this.Ni,t.y=0),this.Ri.addDisplayObject(t),this.Li.push(t),this.updateVisibleItems()},t.prototype.clear=function(){this.Ri.clear(),this.Li=[],this.updateVisibleItems(0)},t.prototype.setControlButton=function(t,i){var n=this;this.zi=t,this.Xi=i,this.zi.onClick(function(){n.moveUpOrLeft()}),this.Xi.onClick(function(){n.moveDownOrRight()})},t.prototype.moveUpOrLeft=function(){this.Pi?this.moveUp():this.moveLeft()},t.prototype.moveDownOrRight=function(){this.Pi?this.moveDown():this.moveRight()},t.prototype.moveUp=function(){this.Pi&&this.moveUp0()},t.prototype.moveDown=function(){this.Pi&&this.moveDown0()},t.prototype.moveLeft=function(){this.Pi||this.moveUp0()},t.prototype.moveRight=function(){this.Pi||this.moveDown0()},t.prototype.scrollToItem=function(t){t>this.Li.length-this.Hi&&(t=this.Li.length-this.Hi),0<=t&&this.moveTo(t)},t.prototype.getItems=function(){return this.Li},t.prototype.onScroll=function(t,i,n,h){this.updateVisibleItems()},t.prototype.moveUp0=function(){var t=this.getMoveByCount();this.moveBy(-t)},t.prototype.moveDown0=function(){var t=this.getMoveByCount();this.moveBy(t)},t.prototype.getMoveByCount=function(){return 3<this.Hi?this.Hi-2:1},t.prototype.moveBy=function(t){var i=t*this.Ui;this.Pi?this.Ri.moveByAbout(null,i):this.Ri.moveByAbout(i,null),this.updateVisibleItems()},t.prototype.moveTo=function(t){var i=t*this.Ui;this.Pi?this.Ri.moveTo(null,i):this.Ri.moveTo(i,null),this.updateVisibleItems()},t.prototype.updateVisibleItems=function(t){if(void 0===t&&(t=null),null==t){var i=this.Ri.getContentBound();t=this.Pi?i.y:i.x}null!=this.Bi&&(this.Bi.visible=!1),null!=this.Fi&&(this.Fi.visible=!1);for(var n=t+this.Hi*this.Ui,h=0;h<this.Li.length;h++){var s=this.Li[h],e=this.Pi?s.y:s.x,r=this.Pi?s.y+this.Ui:s.x+this.Ui;t<=e&&r<=n?s.visible=!0:n<=e||r<=t?s.visible=!1:(s.visible=!0,e+this.Ui/2<t?this.addTopItemOverlay(s):r-this.Ui/2>n&&this.addBottomItemOverlay(s))}},t.prototype.addTopItemOverlay=function(t){this.optShowItemOverlay&&(null==this.Bi&&(this.Bi=this.buildItemOverlay(t),this.Ri.addDisplayObject(this.Bi)),this.Bi.visible=!0,this.Bi.x=t.x,this.Bi.y=t.y)},t.prototype.addBottomItemOverlay=function(t){this.optShowItemOverlay&&(null==this.Fi&&(this.Fi=this.buildItemOverlay(t),this.Ri.addDisplayObject(this.Fi)),this.Fi.visible=!0,this.Fi.x=t.x,this.Fi.y=t.y)},t.prototype.buildItemOverlay=function(t){var i=this.Ni,n=this.Ni;t instanceof o.Container&&(i=Math.min(this.Ni,t.width),n=Math.min(this.Ii,t.height));var h=new o.Graphics;return h.beginFill(0,.2),h.drawRect(0,0,i,n),h.endFill(),h.showCursor=!1,h},t}(o.Container);o.ScrollableList=t}(h5ge||(h5ge={})),function(t){var i=function(){function t(){this.qi=[]}return t.prototype.moveTo=function(t,i){this.qi.push(-1),this.qi.push(t),this.qi.push(i)},t.prototype.lineTo=function(t,i){this.qi.push(-2),this.qi.push(t),this.qi.push(i)},t.prototype.rectangle=function(t,i,n,h){this.qi.push(-3),this.qi.push(t),this.qi.push(i),this.qi.push(n),this.qi.push(h)},t.prototype.arc=function(t,i,n,h,s){void 0===h&&(h=0),void 0===s&&(s=2*Math.PI),this.qi.push(-4),this.qi.push(t),this.qi.push(i),this.qi.push(n),this.qi.push(h),this.qi.push(s)},t.prototype.gt=function(t){t.beginPath();for(var i=0;i<this.qi.length;i++){var n=this.qi[i];-1==n?(t.moveTo(this.qi[i+1],this.qi[i+2]),i+=2):-2==n?(t.lineTo(this.qi[i+1],this.qi[i+2]),i+=2):-3==n?(t.rect(this.qi[i+1],this.qi[i+2],this.qi[i+3],this.qi[i+4]),i+=4):-4==n&&(t.arc(this.qi[i+1],this.qi[i+2],this.qi[i+3],this.qi[i+4],this.qi[i+5]),i+=5)}t.clip()},t}();t.Mask=i}(h5ge||(h5ge={})),function(e){var t=function(h){function t(){var t=h.call(this)||this;t.applyVelocity=!0,t.velocityTheshold=.2,t.dragDurationVelocityTheshold=400,t.wheelOnY=!0,t.scrollEnableOnX=!0,t.scrollEnableOnY=!0,t.Ji=new e.Vector,t.Zi=new e.Point,t.Vi=0,t.Wi=new e.Point,t.Ki=new e.HandlerCollection;var i=t,n=e.Game.get().bounds;return t.interactive=!0,t.showCursor=!1,t.hi=e.Game.get(),t.hi.addUpdatable(t),t.Qi=new e.Container,t.addChild(t.Qi),t.$i=new e.DragManager(t),t.$i.setStartDragController(function(t){return i.canStartDrag(t)}),t.hi.inputManager.mouse.mouseWheelHandlers.add(t.onMouseWheel,t),t.detachListener.once(function(){i.destroy()}),t.setContainerSize(n.width,n.height),t}return __extends(t,h),t.prototype.setContainerSize=function(t,i){this.setSize(t,i),this.Yi=new e.Rectangle(0,0,t,i),this.tn=new e.Mask,this.tn.rectangle(0,0,t,i),this.mask=this.tn},t.prototype.onDragBegin=function(t){this.Zi=t.copy(),this.Vi=Date.now(),this.Ji.x=0,this.Ji.y=0},t.prototype.onDragMove=function(t,i,n){this.scrollEnableOnX&&(this.Qi.x+=t),this.scrollEnableOnY&&(this.Qi.y+=i),this.checkBoundLimit()},t.prototype.onDragEnd=function(t){var i=t.x-this.Zi.x,n=t.y-this.Zi.y,h=Date.now()-this.Vi;this.scrollEnableOnX||(i=0),this.scrollEnableOnY||(n=0),this.applyVelocity&&h<this.dragDurationVelocityTheshold&&(this.Ji.x=i/h,this.Ji.y=n/h)},t.prototype.onMouseWheel=function(t){var i=e.Game.get().inputManager.mouse.position;if(this.canStartDrag(i)){var n=0,h=0,s=50*-t;this.wheelOnY?h=s:n=s,this.doFakeDrag(n,h,1e3)}},t.prototype.addDisplayObject=function(t,i){var n;return n=null!=i?this.Qi.addChildAt(t,i):this.Qi.addChild(t),this.computeInnerMinMax(),n},t.prototype.clear=function(){this.Qi.removeChildren(),this.computeInnerMinMax()},t.prototype.moveTo=function(t,i){void 0===t&&(t=null),void 0===i&&(i=null),null!=t&&(this.Qi.x=-t),null!=i&&(this.Qi.y=-i),this.checkBoundLimit()},t.prototype.moveBy=function(t,i){void 0===t&&(t=null),void 0===i&&(i=null),null!=t&&(this.Qi.x-=t),null!=i&&(this.Qi.y-=i),this.checkBoundLimit()},t.prototype.moveByAbout=function(t,i){void 0===t&&(t=null),void 0===i&&(i=null),this.canMove()&&(null==t&&(t=0),null==i&&(i=0),this.Qi.x+=t,this.Qi.y+=i,this.doFakeDrag(-t,-i,300))},t.prototype.update=function(t){0==this.Ji.x&&0==this.Ji.y||(this.Ji.x*=.95,this.Ji.y*=.95,Math.abs(this.Ji.x)<this.velocityTheshold&&(this.Ji.x=0),Math.abs(this.Ji.y)<this.velocityTheshold&&(this.Ji.y=0),this.Qi.x=this.Qi.x+t*this.Ji.x,this.Qi.y=this.Qi.y+t*this.Ji.y,this.checkBoundLimit())},t.prototype.getContentBound=function(){return this.Yi.x=-this.Qi.x,this.Yi.y=-this.Qi.y,this.Yi},t.prototype.doFakeDrag=function(t,i,n){var h=new e.Point(this.Qi.x,this.Qi.y),s=h.copy();s.x=s.x+t,s.y=s.y+i,this.onDragBegin(h),this.Vi=Date.now()-n,this.onDragMove(t,i,s),this.onDragEnd(s)},t.prototype.computeInnerMinMax=function(){var t=e.layout.computeBounds(this.Qi,!1);this.Qi.setSize(t.width,t.height);var i=this.Qi.width,n=this.Qi.height;this.in=new e.Point(-i+this.Yi.width,-n+this.Yi.height),this.nn=new e.Point(0,0)},t.prototype.canMove=function(){return!(this.Qi.width<=this.Yi.width&&this.Qi.height<=this.Yi.height)},t.prototype.canStartDrag=function(t){return!!this.canMove()&&this.hitPoint(t)},t.prototype.checkBoundLimit=function(){this.scrollEnableOnX&&(this.Qi.x<this.in.x?this.Qi.x=this.in.x:this.Qi.x>this.nn.x&&(this.Qi.x=this.nn.x)),this.scrollEnableOnY&&(this.Qi.y<this.in.y?this.Qi.y=this.in.y:this.Qi.y>this.nn.y&&(this.Qi.y=this.nn.y));var t=this.Wi.x-this.Qi.x,i=this.Wi.y-this.Qi.y;this.Wi.x=this.Qi.x,this.Wi.y=this.Qi.y,0==t&&0==i||this.Ki.fire(t,i,-this.Wi.x,-this.Wi.y)},t.prototype.destroy=function(){this.$i.destroy(),this.hi.inputManager.mouse.mouseWheelHandlers.remove(this.onMouseWheel),this.hi.removeUpdatable(this)},t.prototype.addScrollHandler=function(t,i){this.Ki.add(t,i)},t.prototype.removeScrollHandler=function(t){this.Ki.remove(t)},t}(e.Container);e.ScrollableContainer=t}(h5ge||(h5ge={})),function(c){var t=function(s){function h(t,i,n){var h=s.call(this,t,i)||this;return h.objectFactory=n,h.hn=0,h.sn=0,h.Nt=!0,h.rn=0,h.un=0,h.on=0,h.fn=0,h.mask=new c.Mask,h.mask.rectangle(0,0,t,i),h}return __extends(h,s),h.fromFrame=function(t,i,n){return new h(t,i,function(){return c.Sprite.fromFrame(n)})},h.prototype.draw0=function(t){this.Nt&&(this.create(),this.Nt=!1),s.prototype.draw0.call(this,t)},h.prototype.create=function(){if(0==this.on){var t=this.objectFactory(),i=t.width,n=t.height;this.on=Math.ceil(this.width/i+1),this.fn=Math.ceil(this.height/n+1),this.addChild(t);for(var h=this.on*this.fn,s=1;s<h;s++)this.addChild(this.objectFactory());this.rn=i,this.un=n}for(var e=c.Maths.mod(this.hn,this.rn)-this.rn,r=c.Maths.mod(this.sn,this.un)-this.un,u=0;u<this.on;u++)for(var o=0;o<this.fn;o++){var f=u*this.fn+o,a=this.getChildAt(f);a.x=e+u*this.rn,a.y=r+o*this.un}},Object.defineProperty(h.prototype,"tilePositionX",{get:function(){return this.hn},set:function(t){this.hn=t,this.Nt=!0},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"tilePositionY",{get:function(){return this.sn},set:function(t){this.sn=t,this.Nt=!0},enumerable:!0,configurable:!0}),h}(c.Container);c.TilingSprite=t}(h5ge||(h5ge={})),function(g){var t=function(){function d(){}return d.isMultiplySupported=function(){if(null===this.multiplyDetected){var t=document.createElement("canvas"),i=t.getContext("2d");t.width=1,t.height=1,i.clearRect(0,0,1,1),i.globalCompositeOperation="source-over",i.fillStyle="#000",i.fillRect(0,0,1,1),i.globalCompositeOperation="multiply",i.fillStyle="#fff",i.fillRect(0,0,1,1),this.multiplyDetected=0===i.getImageData(0,0,1,1).data[0],this.multiplyDetected||g.logger.warn("Tinter : globalCompositeOperation multiply not supported, fallback to manual multiply")}return this.multiplyDetected},d.tint=function(t,i,n){void 0===n&&(n=!0);var h=i>>16&255,s=i>>8&255,e=255&i;h=Math.min(255,Math.round(h/d.rounding)*d.rounding),s=Math.min(255,Math.round(s/d.rounding)*d.rounding),e=Math.min(255,Math.round(e/d.rounding)*d.rounding);var r=t.name+"-tint-"+h+","+s+","+e;if(n){var u=g.Texture.containsTexture(r);if(null!=u)return u}var o=document.createElement("canvas"),f=o.getContext("2d");if(o.width=t.width,o.height=t.height,f.fillStyle="rgba("+h+","+s+","+e+",1)",f.fillRect(0,0,t.width,t.height),this.isMultiplySupported())f.globalCompositeOperation="multiply",f.drawImage(t.getImpl(),t.x,t.y,t.width,t.height,0,0,t.width,t.height);else{f.drawImage(t.getImpl(),t.x,t.y,t.width,t.height,0,0,t.width,t.height);for(var a=f.getImageData(0,0,o.width,o.height),c=a.data,l=0;l<c.length;l+=4)c[l]=h*c[l]/255,c[l+1]=s*c[l+1]/255,c[l+2]=e*c[l+2]/255;f.putImageData(a,0,0)}f.globalCompositeOperation="destination-atop",f.drawImage(t.getImpl(),t.x,t.y,t.width,t.height,0,0,t.width,t.height);var v=new g.Texture(r,0,0,t.width,t.height);return v.setImpl(o),n&&g.Texture.addTexture(v),v},d.rounding=8,d.multiplyDetected=null,d}();g.Tinter=t}(h5ge||(h5ge={})),function(n){var t=function(){function e(){}return e.merge=function(t,i){for(var n in t){var h=t[n],s=typeof h;"constructor"!==s&&"function"!=s&&(n in i&&"object"==typeof h?e.merge(h,i[n]):i[n]=h)}},e.safeJson=function(i,t){if(void 0===t&&(t=null),null==i||0==i.length)return t;try{return JSON.parse(i)}catch(t){n.logger.error("Failed to parse json data="+i,t)}return t},e}();n.JSONS=t}(h5ge||(h5ge={})),function(e){var t=function(){function s(){}return s.setAvailableLocales=function(t){s.availableLocales=t},s.registerTranslation=function(t,i){null==s.translations[t]&&(s.translations[t]={}),e.JSONS.merge(i,s.translations[t])},s.setDefaultLocale=function(t){s.defaultLocale=t},s.setLocale=function(t){s.locale=0<=s.availableLocales.indexOf(t)?t:s.defaultLocale},s.isAvailableLocale=function(t){return 0<=s.availableLocales.indexOf(t)},s.get=function(t,i){var n=s.translations[s.locale][t];if(n)return null!=i?e.Strings.interpolate(n,i):n;var h=s.translations[s.defaultLocale][t];return h?null!=i?e.Strings.interpolate(h,i):h:t},s.getPluralForm=function(t,i){null==i&&(i=s.locale);return"fr"==i?1<t?1:0:"lv"==i?0==t?0:t%10==1&&t%100!=11?1:2:"pl"==i?1==t?0:2<=t%10&&t%10<=4&&(t%100<10||20<=t%100)?1:2:"ru"==i?t%10==1&&t%100!=11?0:2<=t%10&&t%10<=4&&(t%100<10||20<=t%100)?1:2:1==t?0:1},s.getPlural=function(t,i,n){null==n&&(n={n:t});var h=s.getPluralForm(t);return s.get(i+"_F"+h,n)},s.availableLocales=[],s.defaultLocale="en",s.locale="en",s.translations=[],s}();e.I18N=t}(h5ge||(h5ge={})),function(i){var t=function(){function t(){this.isDown=!1,this.isUp=!0,this.isJustDown=!1,this.isJustUp=!1,this.timeDown=0,this.timeUp=0,this.downDuration=0,this.justUpdated=!1,this.an=0}return t.prototype.update=function(){this.isDown&&(this.downDuration=i.Time.now()-this.timeDown),this.justUpdated?(this.isJustDown=this.isDown,this.isJustUp=this.isUp):(this.isJustDown=!1,this.isJustUp=!1),this.justUpdated=!1},t.prototype.ondown=function(){this.isDown||(this.justUpdated=!0,this.isDown=!0,this.isUp=!1,this.timeDown=i.Time.now(),this.downDuration=0)},t.prototype.onup=function(){this.isUp||(this.justUpdated=!0,this.isDown=!1,this.isUp=!0,this.timeUp=i.Time.now())},t}();i.AbstractInput=t}(h5ge||(h5ge={})),function(s){var t=function(){function t(t){this.cn=!1,this.ln=1,this.vn=0,this.dn=!1,this.noCursor=!1,this.ln=null==t.options.input?1:null==t.options.input.maxTouchPointer?1:t.options.input.maxTouchPointer,this.rootContainer=t.layers.root,this.desktop=t.deviceManager.os.desktop,this.keyboard=new s.KeyboardHandler(t,this),this.mouse=new s.MouseHandler(t,this)}return t.prototype.update=function(t){this.dn||(this.keyboard.update(),this.mouse.update(),this.triggerMouseHit())},t.prototype.triggerImmediateClick=function(){if(!(this.vn<=0))for(var t=0;t<this.mouse.pointers.length;t++){var i=this.mouse.pointers[t];i.isActive()&&i.gn()}},t.prototype.triggerMouseHit=function(){var t=this.cn;if(this.cn=!1,s.DisplayObject.interactiveDirty&&(this.vn=0,this.invalidateInteractive(this.rootContainer),t=!(s.DisplayObject.interactiveDirty=!1)),t)for(var i=0;i<this.mouse.pointers.length;i++){this.mouse.pointers[i].xn()}},t.prototype.invalidateInteractive=function(t){t.hasInteractiveChild=!1;for(var i=t.getChildrenCount(),n=0;n<i;n++){var h=t.getChildAt(n);h instanceof s.Container?(this.invalidateInteractive(h),(h.hasInteractiveChild||h.interactive)&&(t.hasInteractiveChild=!0)):h.interactive&&(t.hasInteractiveChild=!0),h.hasClickHandler()&&this.vn++}},Object.defineProperty(t.prototype,"maxTouchPointer",{get:function(){return this.ln},enumerable:!0,configurable:!0}),t.prototype.enable=function(){this.dn=!1},t.prototype.disable=function(){this.dn=!0,this.mouse.update()},t.prototype.hideCursor=function(){this.noCursor=!0,s.Game.get().renderer.canvas.style.cursor="none"},t}();s.InputManager=t}(h5ge||(h5ge={})),function(t){var i=function(){function t(){}return t.fromChar=function(t){return t.charCodeAt(0)-32},t.SHIFT=17,t.CTRL=17,t.ALT=18,t.SPACEBAR=32,t.LEFT=37,t.PAGEUP=33,t.PAGEDOWN=34,t.END=35,t.HOME=36,t.UP=38,t.RIGHT=39,t.DOWN=40,t.INSERT=45,t.DELETE=46,t.F1=112,t.F2=113,t.F3=114,t.F4=115,t.F5=116,t.F6=117,t.F7=118,t.F8=119,t.F9=120,t.F10=121,t.F11=122,t.F12=123,t}();t.KeyCode=i}(h5ge||(h5ge={})),function(t){var i=function(n){function t(t){var i=n.call(this)||this;return i.keycode=t,i}return __extends(t,n),t.prototype.keydown=function(t){this.isDown||n.prototype.ondown.call(this)},t.prototype.keyup=function(t){this.isUp||n.prototype.onup.call(this)},t}(t.AbstractInput);t.KeyInput=i}(h5ge||(h5ge={})),function(h){var t=function(){function t(t,i){var n=this;this.wn=!1,this.keys=[],this.propagatedKeys=new h.HashSet,this.propagateAllKeys=!1,this.keydown=function(t){var i=n.ensureKey(t.which);i.keydown(t),n.keyDownHandlers.fire(i,t),n.stopEvent(t)},this.keyup=function(t){var i=n.ensureKey(t.which);i.keyup(t),n.keyUpHandlers.fire(i,t),n.stopEvent(t)},this.enable(),this.propagatedKeys.add(h.KeyCode.F5),this.propagatedKeys.add(h.KeyCode.F12),this.keyUpHandlers=new h.HandlerCollection,this.keyDownHandlers=new h.HandlerCollection}return t.prototype.update=function(){if(this.enable)for(var t=0;t<this.keys.length;t++){var i=this.keys[t];null!=i&&i.update()}},t.prototype.enable=function(){this.wn||(this.wn=!0,window.addEventListener("keydown",this.keydown,!1),window.addEventListener("keyup",this.keyup,!1))},t.prototype.disable=function(){this.wn&&(this.wn=!1,window.removeEventListener("keydown",this.keydown),window.removeEventListener("keyup",this.keyup))},t.prototype.key=function(t){return this.ensureKey(t)},t.prototype.isDown=function(t){var i=this.keys[t];return null!=i&&i.isDown},t.prototype.isUp=function(t){var i=this.keys[t];return null==i||i.isUp},t.prototype.isJustDown=function(t){var i=this.keys[t];return null!=i&&i.isJustDown},t.prototype.isJustUp=function(t){var i=this.keys[t];return null!=i&&i.isJustUp},t.prototype.downDuration=function(t){var i=this.keys[t];return null==i?0:i.downDuration},t.prototype.stopEvent=function(t){if(!this.propagateAllKeys){var i=t.which;i&&this.propagatedKeys.contains(i)||(t.preventDefault(),t.stopPropagation())}},t.prototype.ensureKey=function(t){var i=this.keys[t];return null==i&&(i=new h.KeyInput(t),this.keys[t]=i),i},t}();h.KeyboardHandler=t}(h5ge||(h5ge={})),function(h){var t=function(){function t(t,i){var s=this;this.wn=!1,this.propagateAllEvents=!1,this.touchEndFired=!1,this.mousedown=function(t){s.pointer.mousedown(t),s.inputManager.cn=!0,s.stopEvent(t)},this.mousemove=function(t){s.pointer.mousemove(t),s.inputManager.cn=!0,s.stopEvent(t)},this.mouseup=function(t){s.pointer.mouseup(t),s.inputManager.cn=!0,s.stopEvent(t)},this.mouseout=function(t){},this.mousewheel=function(t){if(t.deltaY){var i=t.deltaY;i<-1?i=-1:1<i&&(i=1),0!=i&&s.mouseWheelHandlers.fire(i,t)}s.stopEvent(t)},this.touchstart=function(t){for(var i=0;i<t.changedTouches.length;i++){var n=t.changedTouches[i],h=s.getPointerOrFirstFree(n);null!=h&&h.touchdown(n)}s.inputManager.cn=!0,s.stopEvent(t)},this.touchmove=function(t){for(var i=0;i<t.changedTouches.length;i++){var n=t.changedTouches[i],h=s.getPointerOrFirstFree(n);null!=h&&h.touchmove(n)}s.inputManager.cn=!0,s.stopEvent(t)},this.touchend=function(t){for(var i=0;i<t.changedTouches.length;i++){var n=t.changedTouches[i],h=s.getPointerOrFirstFree(n);null!=h&&h.touchup(n)}s.inputManager.cn=!0,s.touchEndFired?s.stopEvent(t):s.touchEndFired=!0},this.touchcancel=function(t){s.touchend(t)},this.touchleave=function(t){s.touchend(t)},this.game=t,this.inputManager=i,this.pointer=new h.PointerInput(t,i),this.pointers=new Array(i.maxTouchPointer),this.pointers[0]=this.pointer;for(var n=1;n<i.maxTouchPointer;n++)this.pointers[n]=new h.PointerInput(t,i);this.mouseWheelHandlers=new h.HandlerCollection,this.enable()}return t.prototype.update=function(){for(var t=0;t<this.pointers.length;t++)this.pointers[t].update()},t.prototype.enable=function(){if(!this.wn){this.wn=!0;var t=h.Game.get().renderer.canvas;t.addEventListener("mousedown",this.mousedown),t.addEventListener("mousemove",this.mousemove),t.addEventListener("mouseup",this.mouseup),t.addEventListener("mouseout",this.mouseout),t.addEventListener("wheel",this.mousewheel),t.addEventListener("touchstart",this.touchstart),t.addEventListener("touchmove",this.touchmove),t.addEventListener("touchend",this.touchend),t.addEventListener("touchcancel",this.touchcancel),t.addEventListener("touchleave",this.touchleave)}},t.prototype.disable=function(){if(this.wn){this.wn=!1;var t=document.body;t.removeEventListener("mousedown",this.mousedown),t.removeEventListener("mousemove",this.mousemove),t.removeEventListener("mouseup",this.mouseup),t.removeEventListener("mouseout",this.mouseout),t.removeEventListener("touchstart",this.touchstart),t.removeEventListener("touchmove",this.touchmove),t.removeEventListener("touchend",this.touchend),t.removeEventListener("touchcancel",this.touchcancel),t.removeEventListener("touchleave",this.touchleave)}},Object.defineProperty(t.prototype,"isDown",{get:function(){return this.pointer.isDown},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isUp",{get:function(){return this.pointer.isUp},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isJustDown",{get:function(){return this.pointer.isJustDown},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isJustUp",{get:function(){return this.pointer.isJustUp},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"downDuration",{get:function(){return this.pointer.downDuration},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"downPosition",{get:function(){return this.pointer.downPosition},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this.pointer.position},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"upPosition",{get:function(){return this.pointer.upPosition},enumerable:!0,configurable:!0}),t.prototype.getPointerOrFirstFree=function(t){for(var i=t.identifier,n=null,h=null,s=0;s<this.pointers.length;s++){var e=this.pointers[s];if(null==e.identifier&&null==n)n=e;else if(e.identifier==i){h=e;break}}return null!=h?h:n},t.prototype.stopEvent=function(t){this.propagateAllEvents||(t.preventDefault(),t.stopPropagation())},t.prototype.debugTouch=function(t,i){for(var n="",h=0;h<i.changedTouches.length;h++)n+=""+i.changedTouches[h].identifier,h<i.changedTouches.length-1&&(n+=",");console.log("#### MouseHandler: "+t+", changes: "+n)},t}();h.MouseHandler=t}(h5ge||(h5ge={})),function(r){var t=function(h){function n(t,i){var n=h.call(this)||this;return n.downPosition=new r.Point,n.position=new r.Point,n.upPosition=new r.Point,n.mouseActive=!1,n.yn=!1,n.Mn=0,n.bn=4e3,n.pn=new r.Point(-1,-1),n.mn=-1,n._n=null,n.En=null,n.On=!0,n.An=1,n.inputManager=i,n.scaleManager=t.scaleManager,n.On=t.options.rendering.canvasFullscreen,n.An=window.devicePixelRatio||1,n.jn=t.layers.root,n.Gn=t.renderer.canvas,n.kn=t.deviceManager.os.desktop,n}return __extends(n,h),n.prototype.update=function(){h.prototype.update.call(this),null!=this.Mn&&this.Mn<r.Time.now()&&(this.Mn=null,this.yn=!1),this.isUp&&null!=this.identifier&&this.releasePointer()},n.prototype.isActive=function(){return this.mouseActive||null!=this.identifier},n.prototype.mousedown=function(t){this.yn||this.isDown||(h.prototype.ondown.call(this),this.downPosition.x=this.getXValue(t.pageX),this.downPosition.y=this.getYValue(t.pageY),this.position.x=this.downPosition.x,this.position.y=this.downPosition.y,this.Dn=t)},n.prototype.mousemove=function(t){this.position.x=this.getXValue(t.pageX),this.position.y=this.getYValue(t.pageY),this.Dn=t,this.mouseActive=!0},n.prototype.mouseup=function(t){this.yn||this.isUp||(h.prototype.onup.call(this),this.upPosition.x=this.getXValue(t.pageX),this.upPosition.y=this.getYValue(t.pageY),this.Dn=t,this.inputManager.triggerImmediateClick())},n.prototype.touchdown=function(t){this.isDown||null==this.identifier&&(h.prototype.ondown.call(this),this.yn=!0,this.Mn=null,this.identifier=t.identifier,this.downPosition.x=this.getXValue(t.pageX),this.downPosition.y=this.getYValue(t.pageY),this.position.x=this.downPosition.x,this.position.y=this.downPosition.y,this.acquirePointer())},n.prototype.touchmove=function(t){this.isDown&&this.identifier==t.identifier&&(this.yn=!0,this.position.x=this.getXValue(t.pageX),this.position.y=this.getYValue(t.pageY))},n.prototype.touchup=function(t){this.isUp||this.identifier==t.identifier&&(h.prototype.onup.call(this),this.yn=!0,this.Mn=r.Time.now()+this.bn,this.upPosition.x=this.getXValue(t.pageX),this.upPosition.y=this.getYValue(t.pageY),this.inputManager.triggerImmediateClick())},n.prototype.getXValue=function(t){return Math.round((t-this.scaleManager.offsetX)/this.scaleManager.scale)},n.prototype.getYValue=function(t){return Math.round((t-this.scaleManager.offsetY)/this.scaleManager.scale)},n.pageXToGameX=function(t){var i=r.Game.get().scaleManager;return Math.round((t-i.offsetX)/i.scale)},n.pageYToGameY=function(t){var i=r.Game.get().scaleManager;return Math.round((t-i.offsetY)/i.scale)},n.prototype.acquirePointer=function(){this._n=null,this.En=null,this.pn.x=-1,this.pn.y=-1,this.mn=-1},n.prototype.releasePointer=function(){this.identifier=null},n.prototype.mouseChanged=function(){var t=!1,i=this.isDown?0:1,n=this.position.x,h=this.position.y;return i!=this.mn&&(t=!0),t||this.pn.x==n&&this.pn.y==h||(t=!0),this.mn=i,this.pn.x=n,this.pn.y=h,t},n.prototype.xn=function(){if(this.mouseChanged()){var t=new Array;if(n.Tn(this.position,this.jn,t),0<t.length){var i=t[t.length-1];this.interactiveElement=i,this.isJustDown?(this.En=i).hasDownHandler()&&i.downHandler.fire():this.isJustUp&&i.hasUpHandler()&&i.upHandler.fire(),i!=this._n&&(i.hasOverHandler()&&i.overHandler.fire(),null!=this._n&&this._n.hasOutHandler()&&this._n.outHandler.fire()),this._n=i}else(this.interactiveElement=null)!=this._n&&this._n.hasOutHandler()&&this._n.outHandler.fire(),this._n=null;this.kn&&!this.inputManager.noCursor&&(null!=this._n&&this._n.showCursor?this.Gn.style.cursor="pointer":this.Gn.style.cursor="default")}},n.prototype.gn=function(){var t=new Array;if(n.Tn(this.position,this.jn,t),0<t.length){var i=t[t.length-1];i.hasClickHandler()&&(this.wasSwipe()||i.clickHandler.fire())}},n.Tn=function(t,i,n){if(i.visible){if(i.interactive)i.hitPoint(t)&&n.push(i);if(i.hasInteractiveChild)for(var h=i.getChildrenCount(),s=0;s<h;s++){var e=i.getChildAt(s);e instanceof r.Container?this.Tn(t,e,n):e.visible&&e.interactive&&e.hitPoint(t)&&n.push(e)}}},n.prototype.wasSwipe=function(){return 60<=r.Point.distance(this.upPosition,this.downPosition)},n.prototype.getLastMouseEvent=function(){return this.Dn},n}(r.AbstractInput);r.PointerInput=t}(h5ge||(h5ge={})),function(n){var t=function(){function t(t){this.mi=!0;var i=n.Game.get();i.addUpdatable(this),this.Sn=t,this.Cn=i.inputManager.mouse.pointer}return t.prototype.enable=function(){this.mi=!0},t.prototype.disable=function(){this.mi=!1},t.prototype.onStateDown=function(t){if(null!=this.Nn&&!this.Nn(t))return;this._i||(this.In=new n.Point(t.x,t.y),this._i=!0,this.Sn.onDragBegin(t))},t.prototype.hasMoved=function(t){if(this._i){var i=1<=Math.abs(t.x-this.In.x),n=1<=Math.abs(t.y-this.In.y);if(i||n)return!0}return!1},t.prototype.onStateMove=function(t){this._i&&this.Sn.onDragMove(t.x-this.In.x,t.y-this.In.y,t),this.In=new n.Point(t.x,t.y)},t.prototype.onStateUp=function(t){this._i&&(this._i=!1,this.Sn.onDragEnd(t))},t.prototype.update=function(t){this.mi&&(this.Cn.isJustDown?this.onStateDown(this.Cn.downPosition):this.Cn.isJustUp?this.onStateUp(this.Cn.upPosition):this.Cn.isDown&&this.hasMoved(this.Cn.position)&&this.onStateMove(this.Cn.position))},t.prototype.destroy=function(){n.Game.get().removeUpdatable(this)},t.prototype.setStartDragController=function(t){this.Nn=t},t}();n.DragManager=t}(h5ge||(h5ge={})),function(i){var t=function(){function t(t,i,n){this.B=t,this.F=i,this.Hn=n}return t.prototype.containsPoint=function(t){var i=this.x-t.x,n=this.y-t.y;return i*i+n*n<=this.Hn*this.Hn},t.prototype.overlap=function(t){return i.Collisions.overlapCircles(this,t)},t.prototype.toString=function(){return this.x+","+this.y+" | "+this.radius},Object.defineProperty(t.prototype,"x",{get:function(){return this.B},set:function(t){this.B=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.F},set:function(t){this.F=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"radius",{get:function(){return this.Hn},set:function(t){this.Hn=t},enumerable:!0,configurable:!0}),t}();i.Circle=t}(h5ge||(h5ge={})),function(d){var t=function(){function r(){}return r.rotateFromOrigin=function(t,i,n){return{x:t*Math.cos(n)-i*Math.sin(n),y:t*Math.sin(n)+i*Math.cos(n)}},r.rotate=function(t,i,n,h,s){var e=r.rotateFromOrigin(t-h,i-s,n);return e.x+=h,e.y+=s,e},r.clamp=function(t,i,n){return Math.max(i,Math.min(n,t))},r.clamp01=function(t){return this.clamp(t,0,1)},r.mod=function(t,i){return(t%i+i)%i},r.lerp=function(t,i,n){return n<=0?t:1<=n?i:(1-n)*t+n*i},r.inverseLerp=function(t,i,n){return t==i?0:(n-t)/(i-t)},r.sign=function(t){return 0<=t?1:-1},r.repeat=function(t,i){return this.mod(t,i)},r.pingPong=function(t,i){t<0&&(t=-t);var n=t%i;return Math.ceil(t/i)%2==0?0===n?0:i-n:0===n?i:n},r.map=function(t,i,n,h,s){return t<i?t=i:n<t&&(t=n),(t-i)*(s-h)/(n-i)+h},r.smoothDamp=function(t,i,n,h,s,e){var r=2/(h=Math.max(1e-4,h)),u=r*(e/=1e3),o=1/(1+u+.48*u*u+.235*u*u*u),f=t-i,a=i;if(null!=s){var c=s*h;f=d.Maths.clamp(f,-c,c)}var l=(n+r*f)*e;n=(n-r*l)*o;var v=(i=t-f)+(f+l)*o;return 0<a-t==a<v&&(n=((v=a)-a)/e),{smoothValue:v,newVelocity:n}},r.smoothDampAngle=function(t,i,n,h,s,e){return i=t+this.deltaAngle(t,i),this.smoothDamp(t,i,n,h,s,e)},r.deltaAngle=function(t,i){var n=d.Maths.repeat(i-t,360);return 180<n&&(n-=360),n},r.DEG_TO_RADIAN=Math.PI/180,r.RADIAN_TO_DEG=180/Math.PI,r}();d.Maths=t}(h5ge||(h5ge={})),function(i){var t=function(){function t(t,i){void 0===t&&(t=0),void 0===i&&(i=0),this.B=t,this.F=i}return t.prototype.copy=function(){return new t(this.B,this.F)},t.prototype.asVector=function(){return new i.Vector(this.B,this.F)},t.prototype.equals=function(t){return null!=t&&(this.x==t.x&&this.y==t.y)},Object.defineProperty(t.prototype,"x",{get:function(){return this.B},set:function(t){this.B=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.F},set:function(t){this.F=t},enumerable:!0,configurable:!0}),t.prototype.toString=function(){return this.B+","+this.F},t.distance=function(t,i){var n=0,h=0;return n=i.x-t.x,n*=n,h=i.y-t.y,h*=h,Math.sqrt(n+h)},t}();i.Point=t}(h5ge||(h5ge={})),function(o){var t=function(){function e(){this.Pn=[],this.Z=0,this.Nt=!0,this.Ln=!0,this.Rn=[],this.Un=new o.Point(0,0),this.Yn=new o.Point(0,0)}return e.prototype.addVertice=function(t){this.Pn.push(t),this.Rn.push(t.copy()),this.Nt=!0},e.fromValues=function(t){for(var i=new e,n=0;n<t.length;n+=2){var h=t[n],s=t[n+1];i.addVertice2(h,s)}return i},e.fromRectangle=function(t){var i=new e;return i.addVertice2(0,0),i.addVertice2(t.width,0),i.addVertice2(t.width,t.height),i.addVertice2(0,t.height),i.setPosition(t.x,t.y),i},e.prototype.addVertice2=function(t,i){this.addVertice(new o.Point(t,i))},e.prototype.getVertices=function(){return this.Pn},e.prototype.getTransformedVertices=function(){if(!this.Nt)return this.Rn;this.Nt=!1,this.Ln=!0;for(var t=Math.cos(this.Z*o.Maths.DEG_TO_RADIAN),i=Math.sin(this.Z*o.Maths.DEG_TO_RADIAN),n=0;n<this.Pn.length;n++){var h=this.Pn[n],s=h.x-this.Un.x,e=h.y-this.Un.y;if(0!=this.Z){var r=s;s=t*s-i*e,e=i*r+t*e}var u=this.Rn[n];u.x=this.Yn.x+this.Un.x+s,u.y=this.Yn.y+this.Un.y+e}return this.Rn},e.prototype.getAABB=function(){if(!this.Nt&&!this.Ln)return this.zn;var t=this.getTransformedVertices();null==this.zn&&(this.zn=new o.Rectangle(0,0,0,0));for(var i=t[0].x,n=t[0].y,h=t[0].x,s=t[0].y,e=1;e<t.length;e++){var r=t[e];i=Math.min(i,r.x),n=Math.min(n,r.y),h=Math.max(h,r.x),s=Math.max(s,r.y)}return this.zn.x=i,this.zn.y=n,this.zn.width=h-i,this.zn.height=s-n,this.Ln=!1,this.zn},e.prototype.overlap=function(t){return o.Collisions.overlapPolygons(this,t)},e.prototype.setPivot=function(t,i){this.pivotX=t,this.pivotY=i,this.Nt=!0},e.prototype.setPosition=function(t,i){this.positionX=t,this.positionY=i,this.Nt=!0},e.prototype.getProjection=function(t){for(var i=this.getTransformedVertices(),n=t.dot2(i[0].x,i[0].y),h=n,s=1;s<i.length;s++){var e=i[s],r=t.dot2(e.x,e.y);r<n?n=r:h<r&&(h=r)}return new o.Range(n,h)},Object.defineProperty(e.prototype,"pivotX",{get:function(){return this.Un.x},set:function(t){this.Un.x=t,this.Nt=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pivotY",{get:function(){return this.Un.y},set:function(t){this.Un.y=t,this.Nt=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"positionX",{get:function(){return this.Yn.x},set:function(t){this.Yn.x=t,this.Nt=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"positionY",{get:function(){return this.Yn.y},set:function(t){this.Yn.y=t,this.Nt=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return this.Z},set:function(t){this.Z=t,this.Nt=!0},enumerable:!0,configurable:!0}),e}();o.Polygon=t}(h5ge||(h5ge={})),function(t){var i=function(){function n(t,i){void 0===t&&(t=0),void 0===i&&(i=0),this.min=t,this.max=i}return n.prototype.overlap=function(t){return t.min<=this.max&&this.min<=t.max},n.prototype.sort=function(){if(this.min>this.max){var t=this.min;this.min=this.max,this.max=t}},n.prototype.copy=function(t){this.min=t.min,this.max=t.max},n.prototype.clone=function(){return new n(this.min,this.max)},n.prototype.combine=function(t){var i=new n;return i.min=this.min,i.max=this.max,t.min<this.min&&(i.min=t.min),t.max>this.max&&(i.max=t.max),i},n.prototype.extend=function(t){t>this.max?this.max=t:t<this.min&&(this.min=t)},n.prototype.clamp=function(t){return t<this.min?this.min:t>this.max?this.max:t},n}();t.Range=i}(h5ge||(h5ge={})),function(i){var t=function(){function t(t,i,n,h){this.Xn=t,this.Rt=i,this.q=n,this.J=h}return t.prototype.getCenter=function(){return new i.Point(this.Xn+Math.round(this.q/2),this.Rt+Math.round(this.J/2))},t.prototype.containsPoint=function(t){return this.containsPoint2(t.x,t.y)},t.prototype.containsPoint2=function(t,i){return t>=this.left&&t<=this.right&&(i>=this.top&&i<=this.bottom)},t.prototype.overlap=function(t){return i.Collisions.overlapRectangles(this,t)},t.prototype.toString=function(){return this.x+","+this.y+" | "+this.q+","+this.J},t.prototype.copy=function(){return new t(this.Xn,this.Rt,this.q,this.J)},Object.defineProperty(t.prototype,"x",{get:function(){return this.Xn},set:function(t){this.Xn=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){return this.Xn},set:function(t){this.Xn=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.Xn+this.q},set:function(t){this.Xn=t-this.q},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.Rt},set:function(t){this.Rt=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.Rt},set:function(t){this.Rt=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.Rt+this.J},set:function(t){this.Rt=t-this.J},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.q},set:function(t){this.q=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.J},set:function(t){this.J=t},enumerable:!0,configurable:!0}),t}();i.Rectangle=t}(h5ge||(h5ge={})),function(r){var t=function(){function n(t,i){void 0===t&&(t=0),void 0===i&&(i=0),this.B=t,this.F=i}return n.prototype.copy=function(){return new n(this.B,this.F)},n.prototype.copy2=function(t){this.B=t.x,this.F=t.y},n.prototype.clone=function(){return new n(this.B,this.F)},n.prototype.length=function(){return Math.sqrt(this.B*this.B+this.F*this.F)},n.prototype.mag=function(){return this.length()},n.prototype.magSq=function(){return this.lengthApprox()},n.prototype.lengthApprox=function(){return this.B*this.B+this.F*this.F},n.prototype.sub=function(t){this.B-=t.x,this.F-=t.y},n.sub=function(t,i){return new n(t.x-i.x,t.y-i.y)},n.prototype.sub2=function(t,i){this.B-=t,this.F-=i},n.prototype.add=function(t){this.B+=t.x,this.F+=t.y},n.prototype.minus=function(t){this.B-=t.x,this.F-=t.y},n.prototype.add2=function(t,i){this.B+=t,this.F+=i},n.prototype.dot=function(t){return this.B*t.x+this.F*t.y},n.prototype.dot2=function(t,i){return this.B*t+this.F*i},n.prototype.angle=function(t){var i=this.cross(t),n=this.dot(t);return Math.atan2(i,n)},n.prototype.project=function(t){var i=this.dot(t),n=t.clone();return n.scale1(i),n},n.prototype.scale=function(t){this.x*=t.x,this.y*=t.y},n.prototype.scale1=function(t){this.x*=t,this.y*=t},n.prototype.scale2=function(t,i){this.x*=t,this.y*=i},n.prototype.cross=function(t){return this.x*t.y-this.y*t.x},n.prototype.cross2=function(t,i){return this.x*i-this.y*t},n.prototype.perp=function(){var t=this.F;this.y=-this.B,this.x=t},n.prototype.normalize=function(){var t=this.length();this.x/=t,this.y/=t},n.prototype.rotate=function(t){var i=r.Maths.DEG_TO_RADIAN*t,n=Math.cos(i),h=Math.sin(i),s=this.x*n-this.y*h,e=this.x*h+this.y*n;this.x=s,this.y=e},n.prototype.rotate2=function(t){var i=Math.cos(t),n=Math.sin(t),h=i*this.x+n*this.y,s=i*this.y-n*this.x;this.x=h,this.y=s},n.prototype.rotate90=function(){var t=-this.y,i=this.x;this.x=t,this.y=i},n.prototype.unit=function(){var t=this.length();0!=t?(this.x=this.x/t,this.y=this.y/t):(this.x=0,this.y=0)},Object.defineProperty(n.prototype,"x",{get:function(){return this.B},set:function(t){this.B=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this.F},set:function(t){this.F=t},enumerable:!0,configurable:!0}),n.prototype.toString=function(){return"("+this.B+","+this.F+")"},n}();r.Vector=t}(h5ge||(h5ge={})),function(t){var i=function(){function o(t){this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0,this.context=t||null,t&&t.setTransform(1,0,0,1,0,0)}return o.prototype.toString=function(){return"["+this.a+","+this.b+","+this.c+","+this.d+","+this.e+","+this.f+"]"},o.prototype.flipX=function(){return this.transform(-1,0,0,1,0,0),this},o.prototype.flipY=function(){return this.transform(1,0,0,-1,0,0),this},o.prototype.reset=function(){return this.a=this.d=1,this.b=this.c=this.e=this.f=0,this.Bn(),this},o.prototype.rotate=function(t){var i=Math.cos(t),n=Math.sin(t);return this.transform(i,n,-n,i,0,0),this},o.prototype.rotateDeg=function(t){return this.rotate(.017453292519943295*t),this},o.prototype.scale=function(t,i){return this.transform(t,0,0,i,0,0),this},o.prototype.scaleX=function(t){return this.transform(t,0,0,1,0,0),this},o.prototype.scaleY=function(t){return this.transform(1,0,0,t,0,0),this},o.prototype.skew=function(t,i){return this.transform(1,i,t,1,0,0),this},o.prototype.skewX=function(t){return this.transform(1,0,t,1,0,0),this},o.prototype.skewY=function(t){return this.transform(1,t,0,1,0,0),this},o.prototype.setTransform=function(t,i,n,h,s,e){return this.a=t,this.b=i,this.c=n,this.d=h,this.e=s,this.f=e,this.Bn(),this},o.prototype.translate=function(t,i){return this.transform(1,0,0,1,t,i),this},o.prototype.translateX=function(t){return this.transform(1,0,0,1,t,0),this},o.prototype.translateY=function(t){return this.transform(1,0,0,1,0,t),this},o.prototype.transform=function(t,i,n,h,s,e){var r=this.a,u=this.b,o=this.c,f=this.d,a=this.e,c=this.f;return this.a=r*t+o*i,this.b=u*t+f*i,this.c=r*n+o*h,this.d=u*n+f*h,this.e=r*s+o*e+a,this.f=u*s+f*e+c,this.Bn(),this},o.prototype.getInverse=function(){var t=this.a,i=this.b,n=this.c,h=this.d,s=this.e,e=this.f,r=new o,u=t*h-i*n;return r.a=h/u,r.b=-i/u,r.c=-n/u,r.d=t/u,r.e=(n*e-h*s)/u,r.f=-(t*e-i*s)/u,r},o.prototype.interpolate=function(t,i){var n=new o;return n.a=this.a+(t.a-this.a)*i,n.b=this.b+(t.b-this.b)*i,n.c=this.c+(t.c-this.c)*i,n.d=this.d+(t.d-this.d)*i,n.e=this.e+(t.e-this.e)*i,n.f=this.f+(t.f-this.f)*i,n},o.prototype.applyToPoint=function(t,i){return{x:t*this.a+i*this.c+this.e,y:t*this.b+i*this.d+this.f}},o.prototype.applyToArray=function(t){for(var i,n=0,h=t.length,s=new Array(h);n<h;)i=this.applyToPoint(t[n],t[n+1]),s[n++]=i.x,s[n++]=i.y;return s},o.prototype.applyToContext=function(t){return t.setTransform(this.a,this.b,this.c,this.d,this.e,this.f),this},o.prototype.isIdentity=function(){return this.Fn(this.a,1)&&this.Fn(this.b,0)&&this.Fn(this.c,0)&&this.Fn(this.d,1)&&this.Fn(this.e,0)&&this.Fn(this.f,0)},o.prototype.isEqual=function(t){return this.Fn(this.a,t.a)&&this.Fn(this.b,t.b)&&this.Fn(this.c,t.c)&&this.Fn(this.d,t.d)&&this.Fn(this.e,t.e)&&this.Fn(this.f,t.f)},o.prototype.Fn=function(t,i){return Math.abs(t-i)<1e-14},o.prototype.Bn=function(){this.context&&this.context.setTransform(this.a,this.b,this.c,this.d,this.e,this.f)},o}();t.Matrix=i}(h5ge||(h5ge={})),function(t){var i=function(){function e(){}return e.overlapCircles=function(t,i){return this.overlapCircles2(t,i.x,i.y,i.radius)},e.overlapCircles2=function(t,i,n,h){var s=t.x-i,e=t.y-n;return Math.sqrt(s*s+e*e)<t.radius+h},e.overlapRectangles=function(t,i){return t.left<i.right&&t.right>i.left&&t.top<i.bottom&&t.bottom>i.top},e.overlapPolygonRectangle=function(t,i){t.getTransformedVertices();return!0},e.overlapPolygons=function(t,i){var n=t.getAABB(),h=i.getAABB(),s=e.overlapRectangles(n,h);return!!s&&(!!(s=this.overlapPolygons0(t,i))&&(s=this.overlapPolygons0(i,t)))},e.overlapPolygons0=function(t,i){for(var n=t.getTransformedVertices(),h=0;h<n.length;h++){var s=n[h].asVector(),e=n[h+1==n.length?0:h+1];s.sub2(e.x,e.y),s.perp(),s.normalize();var r=t.getProjection(s),u=i.getProjection(s);if(!r.overlap(u))return!1}return!0},e.pointInPolygon=function(t,i,n){var h=t.getVertices().length,s=t.getVertices(),e=0,r=h-1,u=!1;for(e=0;e<h;e++)(s[e].y<n&&s[r].y>=n||s[r].y<n&&s[e].y>=n)&&s[e].x+(n-s[e].y)/(s[r].y-s[e].y)*(s[r].x-s[e].x)<i&&(u=!u),r=e;return u},e.pointInPolygon2=function(t,i,n){var h=t.length,s=0,e=t.length-2,r=!1;for(s=0;s<h;s+=2)(t[s+1]<n&&t[e+1]>=n||t[e+1]<n&&t[s+1]>=n)&&t[s]+(n-t[s+1])/(t[e+1]-t[s+1])*(t[e]-t[s])<i&&(r=!r),e=s;return r},e}();t.Collisions=i}(h5ge||(h5ge={})),function(t){var i=function(){function t(){}return t.prototype.get=function(t,i,n){var h=this;this.initHTTPRequest(n),this.qn&&(h.qn.open("GET",t,!0),h.qn.onreadystatechange=function(){4==h.qn.readyState&&(200==h.qn.status?i(h.qn.responseText):n("invalid status: "+h.qn.status+" text="+h.qn.responseText+" statusText: "+h.qn.statusText),h.qn.onreadystatechange=null),h.qn.readyState<=0&&(n("invalid ready state: "+h.qn.readyState),h.qn.onreadystatechange=null)},this.qn.onerror=function(t){n("XHR onerror statusText: "+h.qn.statusText)},this.qn.send(null))},t.prototype.initHTTPRequest=function(t){if(window.XMLHttpRequest)this.qn=new XMLHttpRequest;else{if(!window.ActiveXObject)return void t("Not Supported");this.qn=new ActiveXObject("Microsoft.XMLHTTP")}},t.prototype.post=function(t,i,n,h){var s=this;this.initHTTPRequest(h),this.qn&&(s.qn.open("POST",t,!0),s.qn.onreadystatechange=function(){4==s.qn.readyState&&(200==s.qn.status?(n(s.qn.responseText),s.qn.onreadystatechange=null):h("invalid status: "+s.qn.status)),s.qn.readyState<=0&&(h("invalid ready state: "+s.qn.readyState),s.qn.onreadystatechange=null)},this.qn.setRequestHeader("Content-type","application/x-www-form-urlencoded"),this.qn.send(i))},t}();t.HttpRequest=i}(h5ge||(h5ge={})),function(p){var t=function(e){function t(t,i,n){var h=e.call(this)||this;h.Jn=!1,h.Zn=1,h.Vn="left",h.Wn=1e4,h.Nt=!0;var s=p.Resources.fonts[i];if(null==s)throw new Error("Font not loaded: "+i);return h.Kn=i,h.Qn=s,h.Gi=t,h.$n=null==n?s.size:n,h.Zn=h.$n/s.size,h.ft="Text-"+h.ut,h}return __extends(t,e),Object.defineProperty(t.prototype,"text",{get:function(){return this.Gi},set:function(t){t!=this.Gi&&(this.Gi=t,this.Nt=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"align",{get:function(){return this.Vn},set:function(t){this.Vn=t,this.Nt=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxWidth",{get:function(){return this.Wn},set:function(t){this.Wn=t,this.Nt=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.Nt&&this.create(),this.q*this.W},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.Nt&&this.create(),this.J*this.K},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tint",{set:function(t){this.ht=null==t?16777215:t,this.Nt=!0},enumerable:!0,configurable:!0}),t.prototype.hasMissingChar=function(){return this.Nt&&this.create(),this.Jn},t.prototype.draw0=function(t){this.Nt&&(this.create(),this.Nt=!1),e.prototype.draw0.call(this,t)},t.prototype.create=function(){this.removeChildren(),null!=this.text&&""!=this.text||this.setSize(0,0),this.Jn=!1;var t=[],i=0,n={width:0,letters:[],xposition:[]};t.push(n);for(var h=-1,s=0,e=0;e<this.Gi.length;e++){if(10!=(x=this.Gi.charCodeAt(e)))if(null!=(w=this.Qn.lettersByCode[x])){32==x&&(h=0,i),-1<h&&h++,n.letters.push(w),n.xposition.push(i),i+=this.getLetterWidthToDraw(w),n.width=i;var r=w.yoffset+w.height;if(s<r&&(s=r),0<this.Wn&&i>this.Wn&&0<h){var u=n.letters.length-h;n.letters.splice(u,h),n.xposition.splice(u,h);var o=n.xposition[u-1]+this.getLetterWidthToDraw(n.letters[u-1]);n.width=o,e=e-h+1,n={width:0,letters:[],xposition:[]},t.push(n),i=0,h=-1}}else this.Jn=!0;else n={width:0,letters:[],xposition:[]},t.push(n),i=0,h=-1}var f=0;for(e=0;e<t.length;e++){var a=t[e];f=Math.max(a.width,f)}var c=Math.ceil(f),l=t.length<=1?this.normalizeSize(s):this.normalizeSize(this.Qn.lineHeight),v=Math.ceil(t.length*l);this.setSize(c,v);var d=0;for(e=0;e<t.length;e++){a=t[e];var g=0;"center"==this.Vn?g=(f-a.width)/2:"right"==this.Vn&&(g=f-a.width);for(var x=0;x<a.letters.length;x++){var w=a.letters[x],y=a.xposition[x];if(y+=g,0<w.width&&0<w.height){var M=this.Qn.textureByCode[w.id];if(16777215!=this.ht)M=p.Tinter.tint(M,this.ht,!0);var b=new p.Sprite(M);b.scaleXY=this.Zn,b.x=y+w.xoffset*this.Zn,b.y=d+w.yoffset*this.Zn,this.addChild(b)}}d+=l}},t.prototype.normalizeSize=function(t){return t*this.Zn},t.prototype.getLetterWidthToDraw=function(t){return 32==t.id?t.xadvance*this.Zn:(t.xoffset+t.width)*this.Zn},t}(p.Container);p.BitmapText=t}(h5ge||(h5ge={})),function(s){var t=function(){function h(t,i){if(this.hi=s.Game.get(),null!=this.hi.options.rendering&&null!=this.hi.options.rendering.canvasId){var n=this.hi.options.rendering.canvasId;if(this.canvas=document.getElementById(n),null==this.canvas)throw new Error("Unable to find canvas: "+n)}else this.canvas=document.createElement("canvas"),this.canvas.style.position="absolute",document.body.appendChild(this.canvas);this.canvas.width=t,this.canvas.height=i,this.th=this.canvas.getContext("2d"),null!=this.hi.options.rendering&&null!=this.hi.options.rendering.backgroundColor&&0<=this.hi.options.rendering.backgroundColor&&(this.ih=s.Colors.toString(this.hi.options.rendering.backgroundColor)),h.nh(this.canvas)}return h.prototype.beginDraw=function(){null!=this.ih?(this.th.fillStyle=this.ih,this.th.fillRect(0,0,this.canvas.width,this.canvas.height)):this.th.clearRect(0,0,this.canvas.width,this.canvas.height)},h.prototype.endDraw=function(){},Object.defineProperty(h.prototype,"context",{get:function(){return this.th},enumerable:!0,configurable:!0}),h.nh=function(i){["-webkit-","-khtml-","-moz-","-ms-",""].forEach(function(t){i.style[t+"user-select"]="none"}),i.style["-webkit-touch-callout"]="none",i.style["-webkit-tap-highlight-color"]="rgba(0, 0, 0, 0)"},h}();s.GameCanvas=t}(h5ge||(h5ge={})),function(s){var t=function(h){function t(t,i){void 0===t&&(t=0),void 0===i&&(i=0);var n=h.call(this)||this;return n.hh=new Array,n.ft="Graphics-"+n.ut,n.q=t,n.J=i,n}return __extends(t,h),t.prototype.customDraw=function(t){return this.hh.push(t),this},t.prototype.beginFill=function(i,n){return void 0===n&&(n=1),this.hh.push(function(t){t.fillStyle=s.Colors.toString(i,n),t.beginPath()}),this},t.prototype.beginStroke=function(i,n,h){void 0===h&&(h=1);return this.hh.push(function(t){t.lineWidth=i,t.strokeStyle=s.Colors.toString(n,h),t.beginPath()}),this},t.prototype.endStroke=function(){return this.hh.push(function(t){t.stroke()}),this},t.prototype.endFill=function(){return this.hh.push(function(t){t.fill()}),this},t.prototype.moveTo=function(i,n){return this.hh.push(function(t){t.moveTo(i,n)}),this},t.prototype.lineTo=function(i,n){return this.hh.push(function(t){t.lineTo(i,n)}),this},t.prototype.quadraticCurveTo=function(i,n,h,s){return this.hh.push(function(t){t.quadraticCurveTo(i,n,h,s)}),this},t.prototype.bezierCurveTo=function(i,n,h,s,e,r){return this.hh.push(function(t){t.bezierCurveTo(i,n,h,s,e,r)}),this},t.prototype.arcTo=function(i,n,h,s,e){return this.hh.push(function(t){t.arcTo(i,n,h,s,e)}),this},t.prototype.arc=function(i,n,h,s,e,r){return void 0===s&&(s=0),void 0===e&&(e=2*Math.PI),this.hh.push(function(t){t.arc(i,n,h,s,e,r)}),this},t.prototype.drawRect=function(i,n,h,s){return this.hh.push(function(t){t.rect(i,n,h,s)}),this},t.prototype.drawRoundedRect=function(i,n,h,s,e){return this.hh.push(function(t){t.moveTo(i+e,n),t.lineTo(i+h-e,n),t.quadraticCurveTo(i+h,n,i+h,n+e),t.lineTo(i+h,n+s-e),t.quadraticCurveTo(i+h,n+s,i+h-e,n+s),t.lineTo(i+e,n+s),t.quadraticCurveTo(i,n+s,i,n+s-e),t.lineTo(i,n+e),t.quadraticCurveTo(i,n,i+e,n)}),this},t.prototype.drawCircle=function(i,n,h){return this.hh.push(function(t){t.arc(i,n,h,0,2*Math.PI)}),this},t.prototype.clear=function(){return this.hh.length=0,this},t.prototype.createCachedTexture=function(){var t=document.createElement("canvas");t.width=this.q,t.height=this.J,0!=this.q&&0!=this.J||s.logger.warn("Caching graphics without size.");var i=t.getContext("2d");this.draw0(i),this.xt=new s.Texture("graphics",0,0,this.q,this.J),this.xt.setImpl(t)},t.prototype.draw0=function(i){this.hh.forEach(function(t){t(i)})},t.prototype.setSize=function(t,i){this.q=t,this.J=i},t}(s.DisplayObject);s.Graphics=t}(h5ge||(h5ge={})),function(t){var i=function(){function t(){}return t.prototype.render=function(t){var i=document.createElement("canvas"),n=i.getContext("2d");i.width=t.x+t.width,i.height=t.y+t.height;var h=t.yt;return t.yt=null,t.draw(n),t.yt=h,i.toDataURL("image/png")},t}();t.RenderTexture=i}(h5ge||(h5ge={})),function(r){var u,t=function(e){function t(t,i,n,h){void 0===h&&(h=16777215);var s=e.call(this)||this;return s.Gi=t,s.Kn=i,s.sh=n,s.eh=h,s.Vn="left",s.Nt=!0,s.rh=1.4,s.Qn=n+"px "+i,s.ft="Text-"+s.ut,s.uh=r.Colors.toHexString(h),s}return __extends(t,e),Object.defineProperty(t.prototype,"text",{get:function(){return this.Gi},set:function(t){t!=this.Gi&&(this.Gi=t,this.Nt=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.Nt&&this.create(),this.q*this.W},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.Nt&&this.create(),this.J*this.K},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"align",{get:function(){return this.Vn},set:function(t){this.Vn=t,this.Nt=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"color",{set:function(t){this.color=null==t?16777215:t,this.uh=r.Colors.toHexString(t),this.Nt=!0},enumerable:!0,configurable:!0}),t.prototype.draw0=function(t){this.Nt&&(this.create(),this.Nt=!1),null!=this.Gn&&(e.prototype.draw0.call(this,t),t.drawImage(this.Gn,0,0))},t.prototype.setFontStyle=function(t){t.textBaseline="alphabetic",t.font=this.Qn,t.fillStyle=this.uh},t.prototype.create=function(){if(null==this.text||""==this.text)return this.q=0,this.J=0,void(this.Gn=null);if(null!=this.Gn&&(this.Gn=null),this.Gn=document.createElement("canvas"),0<this.Gi.indexOf("\n"))this.createMultiline();else{var t=this.Gn.getContext("2d");this.setFontStyle(t);var i=t.measureText(this.Gi).width,n=l(this.Kn,this.sh);this.Gn.width=i,this.Gn.height=n*this.rh,this.q=this.Gn.width,this.J=this.Gn.height,this.setFontStyle(t),t.fillText(this.Gi,0,n)}},t.prototype.createMultiline=function(){var t=this.Gn.getContext("2d"),i=this.Gi.split("\n"),n=l(this.Kn,this.sh),h=n*this.rh,s=0,e=[];this.setFontStyle(t);for(var r=0;r<i.length;r++){var u=i[r],o=t.measureText(u).width;e.push({x:0,y:r*h,width:o}),s=Math.max(s,o)}this.Gn.width=s,this.Gn.height=h*e.length,this.q=this.Gn.width,this.J=this.Gn.height;for(r=0;r<e.length;r++){u=e[r];var f=i[r],a=r*h,c=(o=u.width,0);"center"==this.Vn?c=(s-o)/2:"right"==this.align&&(c=s-o),this.setFontStyle(t),t.fillText(f,c,a+n)}},t}(r.DisplayObject);function l(t,i){null==u&&(u=new r.HashMap);var n=t+i,h=u.get(n);if(null!=h)return h;var s=document.createElement("div");s.innerHTML="(|MÃ‰qgy",s.style.position="absolute",s.style.top="-9999px",s.style.left="-9999px",s.style.fontFamily=t,s.style.fontWeight="normal",s.style.fontSize=i+"px",document.body.appendChild(s);var e=s.offsetHeight;return u.put(n,e),document.body.removeChild(s),e}r.Text=t}(h5ge||(h5ge={})),function(t){var i=function(){function t(){this.oh={},this.$n=0}return t.prototype.isEmpty=function(){return 0==this.$n},t.prototype.size=function(){return this.$n},t.prototype.clear=function(){this.oh={},this.$n=0},t.prototype.containsKey=function(t){return null!=this.oh[t]},t.prototype.get=function(t){return this.oh[t]},t.prototype.put=function(t,i){var n=this.oh[t];return this.oh[t]=i,null==n&&this.$n++,n},t.prototype.remove=function(t){var i=this.oh[t];return null!=i&&(delete this.oh[t],this.$n--),i},t.prototype.removeValues=function(t){var i=[];for(var n in this.oh){var h=this.oh[n];null!=h&&h==t&&i.push(n)}for(var s=0;s<i.length;s++)this.remove(i[s])},t.prototype.keys=function(){var t=[];for(var i in this.oh)t.push(i);return t},t.prototype.values=function(){var t=[];for(var i in this.oh){var n=this.oh[i];null!=n&&t.push(n)}return t},t.prototype.forEach=function(t,i){for(var n in this.oh){var h=this.oh[n];if(null!=h)if(!1===t.call(i,n,h))break}},t.prototype.computeIfAbsent=function(t,i){var n=this.get(t);if(null!=n)return n;var h=i(t);return this.put(t,h),h},t}();t.HashMap=i}(h5ge||(h5ge={})),function(s){var e,t;(t=e=s.TextureType||(s.TextureType={}))[t.IMG=0]="IMG",t[t.CANVAS=1]="CANVAS";var i=function(){function n(t,i,n,h,s){this.name=t,this.x=i,this.y=n,this.width=h,this.height=s,this.fh=e.IMG,this.ah=!1}return n.prototype.setTrim=function(t,i,n,h){this.lh=new s.Rectangle(t,i,n,h)},n.prototype.getTrim=function(){return this.lh},Object.defineProperty(n.prototype,"trimmed",{get:function(){return null!=this.lh},set:function(t){throw new Error("trimmed is read-only")},enumerable:!0,configurable:!0}),n.addTexture=function(t){n.textures.put(t.name,t)},n.getTexture=function(t){var i=n.textures.get(t);if(null==i)throw new Error("Texture "+t+" not loaded.");return i},n.containsTexture=function(t){return n.textures.get(t)},n.fromFrame=function(t){return n.getTexture(t)},n.fromImage=function(t){var i=n.containsTexture(t);return null!=i?i:i=new s.HImage(t,t).getTexture()},n.fromFrames=function(t){var i=[];return t.forEach(function(t){i.push(n.fromFrame(t))}),i},n.prototype.setLoaded=function(t){(this.ah=t)&&null!=this.vh&&this.vh.fire()},n.prototype.isLoaded=function(){return this.ah},n.prototype.setImpl=function(t){this.dh=t},n.prototype.getImpl=function(){return this.dh},n.prototype.addLoadedHandler=function(t){this.ah?t():(null==this.vh&&(this.vh=new s.HandlerCollection),this.vh.once(t))},n.textures=new s.HashMap,n}();s.Texture=i}(h5ge||(h5ge={})),function(t){var i=function(){function t(){this.gh=!1,this.xh=!1}return t.prototype.onSuccess0=function(){this.gh=!0,null!=this.wh&&this.wh()},t.prototype.onFailed0=function(){this.xh=!0,null!=this.yh&&this.yh()},t.prototype.onSuccess=function(t){this.wh=t,this.gh&&t()},t.prototype.onFailed=function(t){this.yh=t,this.xh&&t()},t.prototype.isSuccess=function(){return this.gh},t.prototype.isFailed=function(){return this.xh},t.prototype.isTerminated=function(){return 1==this.gh||1==this.xh},t}();t.AbstractLoadingResource=i}(h5ge||(h5ge={})),function(s){var t=function(h){function t(t){var i=h.call(this)||this;i.file=t,i.Mh=new s.HttpRequest;var n=i;return i.Mh.get(i.file,function(t){n.data=t,n.onSuccess0()},function(t){s.logger.error("Can't load "+n.file+", reason: "+t),n.onFailed0()}),i}return __extends(t,h),t.prototype.getAssetDef=function(){return{type:"file",name:this.file,file:this.file}},t}(s.AbstractLoadingResource);s.FileResource=t}(h5ge||(h5ge={})),function(f){var t=function(r){function t(t,i,n){var h=r.call(this)||this;h.bh=t,h.ph=i,h.mh=n;var s=h,e=new f.WaitQueue(2);return e.onComplete=function(){s.onAllLoaded()},h.chars=[],h.lettersByCode=new Array(65e3),h.textureByCode=new Array(65e3),h._h=new f.FileResource(n),h.Eh=f.Resources.addImage(t,i),h.resource=h.Eh.resource,h._h.onSuccess(function(){e.resolve(0,null)}),h._h.onFailed(function(){e.resolve(0,null)}),h.Eh.onSuccess(function(){e.resolve(1,null)}),h.Eh.onFailed(function(){e.resolve(1,null)}),h}return __extends(t,r),t.prototype.onAllLoaded=function(){this.Eh.isTerminated()&&this._h.isTerminated()?this.Eh.isSuccess()&&this._h.isSuccess()?(this.createFont(),this.onSuccess0()):this.onFailed0():f.logger.error("Bad font loading. Image and atlas should be success/failed here")},t.prototype.createFont=function(){var t;window.DOMParser?t=(new DOMParser).parseFromString(this._h.data,"text/xml"):((t=new ActiveXObject("Microsoft.XMLDOM")).async=!1,t.loadXML(this._h.data));var i=t.getElementsByTagName("font")[0],n=i.getElementsByTagName("info")[0],h=i.getElementsByTagName("common")[0];this.size=parseInt(n.getAttribute("size")),this.lineHeight=parseInt(h.getAttribute("lineHeight"));for(var s=i.getElementsByTagName("char"),e=0;e<s.length;e++){var r=s[e],u={id:parseInt(r.getAttribute("id")),x:parseInt(r.getAttribute("x")),y:parseInt(r.getAttribute("y")),xoffset:parseInt(r.getAttribute("xoffset")),yoffset:parseInt(r.getAttribute("yoffset")),width:parseInt(r.getAttribute("width")),height:parseInt(r.getAttribute("height")),xadvance:parseInt(r.getAttribute("xadvance"))};this.lettersByCode[u.id]=u;var o=new f.Texture(this.bh+"/"+u.id,u.x,u.y,u.width,u.height);o.setImpl(this.resource),this.textureByCode[u.id]=o,this.chars.push(u.id)}},t.prototype.getAssetDef=function(){return{type:"font",name:this.bh,file:this.ph,atlas:this.mh}},t}(f.AbstractLoadingResource);f.HFont=t}(h5ge||(h5ge={})),function(l){var t=function(){function n(){}return n.loadAll=function(t){for(var i=0;i<t.length;i++)n.load(t[i])},n.load=function(t){var i=l.Sprite.fromFrame(t.face+".png"),n=new Array,h=new Array(65e3),s=new Array(65e3),e={size:t.size,lettersByCode:h,lineHeight:t.lineHeight,textureByCode:s,chars:n,resource:i.texture.getImpl()},r=i.texture.x,u=i.texture.y;i.texture.trimmed&&(r-=i.texture.getTrim().x,u-=i.texture.getTrim().y);for(var o=0;o<t.chars.length;o++){var f=t.chars[o],a={id:f.id,x:f.x+r,y:f.y+u,xoffset:f.xoffset,yoffset:f.yoffset,width:f.width,height:f.height,xadvance:f.xadvance},c=new l.Texture(t.face+"/"+a.id,a.x,a.y,a.width,a.height);c.setImpl(i.texture.getImpl()),h[f.id]=a,s[f.id]=c,n.push(f.id)}l.Resources.addLoadedFont(t.face,e)},n}();l.FontLoader=t}(h5ge||(h5ge={})),function(e){var t=function(s){function t(t,i){var n=s.call(this)||this;n.bh=t,n.Oh=i,n.created=!1;var h=n;return n.resource=new Image,n.ci=new e.Texture(n.bh,0,0,0,0),n.ci.setImpl(n.resource),e.Texture.addTexture(n.ci),n.resource.src=i,n.resource.onload=function(){h.onSuccess0()},n.resource.onerror=function(){h.onFailed0()},n.resource.complete&&h.onSuccess0(),n}return __extends(t,s),t.prototype.onSuccess0=function(){this.createTexture(),s.prototype.onSuccess0.call(this)},t.prototype.createTexture=function(){this.created||(this.ci.x=0,this.ci.y=0,this.ci.width=this.resource.width,this.ci.height=this.resource.height,this.ci.setLoaded(!0),this.created=!0)},t.prototype.getTexture=function(){return this.ci},t.prototype.getAssetDef=function(){return{type:"img",name:this.bh,file:this.Oh}},t}(e.AbstractLoadingResource);e.HImage=t}(h5ge||(h5ge={})),function(r){var t=function(){function i(t,i){void 0===i&&(i=3),this.Ah=t,this.jh=i,this.Gh=0,this.kh=[],this.Dh=[],this.Th=0,this.Sh=new r.HandlerCollection}return i.prototype.load=function(t){this.Ch=t,this.Nh=r.TimeManager.get().createTimer(100,this.checkLoaded,this),this.Nh.setRepeat(-1),this.Nh.start(),this.load0()},i.prototype.getResourcesLoaded=function(){return this.Dh},i.prototype.checkLoaded=function(){if(1==this.Gh){for(var t=this,i=!1,n=this.Ih.length-1;0<=n;n--){var h=this.Ih[n];h.isTerminated()&&(this.Ih.splice(n,1),h.isSuccess()?(i=!0,this.Dh.push(h)):(r.logger.error("Failed to load "+h.getAssetDef().file),this.kh.push(h.getAssetDef())))}if(i){var s=this.Ih.length+this.Dh.length+this.kh.length,e=this.Dh.length/s;this.Sh.fire(e)}this.Ih.length<=0&&(0<this.kh.length?(this.Gh=0,setTimeout(function(){t.retry()},250)):(this.Gh=2,this.terminate()))}},i.prototype.load0=function(){var e=this;this.Th++,this.Ih=[],this.kh=[],this.Ah.forEach(function(t){if("img"==t.type){var i=r.Resources.addImage(t.name,t.file);e.Ih.push(i)}else if("font"==t.type){var n=r.Resources.addFont(t.name,t.file,t.atlas);e.Ih.push(n)}else if("spritesheet"==t.type){var h=r.Resources.addSpriteSheet(t.name,t.file,t.atlas);e.Ih.push(h)}else if("soundsheet"==t.type){var s=r.Resources.addSoundsheet(t.name,t.file);e.Ih.push(s)}else if("file"==t.type){s=r.Resources.addFile(t.name,t.file);e.Ih.push(s)}}),this.Gh=1},i.prototype.retry=function(){var i=this;this.Th>=this.jh?this.terminate():(this.Ah=[],this.kh.forEach(function(t){i.Ah.push(t)}),this.load0())},i.prototype.terminate=function(){this.Nh.cancel(),0<this.kh.length?this.Ch(!1):this.Ch(!0)},i.prototype.getStatus=function(){return{loading:this.Ih.length,loaded:this.Dh.length,failed:this.kh.length}},i.prototype.getProgress=function(){var t=this.Ih.length+this.Dh.length+this.kh.length;return this.Dh.length/t},i.loadFile=function(t,n){var h=new i([{type:"file",name:t,file:t}],5);h.load(function(t){if(t){var i=h.getResourcesLoaded()[0];n(i.data)}else n(null)})},i}();r.Loader=t}(h5ge||(h5ge={})),function(s){var t=function(){function t(){}return t.Destroy=function(){return delete t.images,delete t.spritesheets,delete t.fonts,this},t.addImage=function(t,i){var n=new s.HImage(t,i);return this.images[t]=n},t.addFont=function(t,i,n){var h=new s.HFont(t,i,n);return this.fonts[t]=h},t.addLoadedFont=function(t,i){return this.fonts[t]=i},t.addSpriteSheet=function(t,i,n){var h=new s.Spritesheet(t,i,n);return this.spritesheets[t]=h},t.addSoundsheet=function(t,i){return new s.Soundsheet(t,i)},t.addFile=function(t,i){return new s.FileResource(i)},t.images={},t.spritesheets={},t.fonts={},t}();s.Resources=t}(h5ge||(h5ge={})),function(i){var t=function(h){function t(t,i){var n=h.call(this,i)||this;return n.bh=t,n}return __extends(t,h),t.prototype.onSuccess0=function(){h.prototype.onSuccess0.call(this),i.AudioManager.get().registerSoundsheet(this.bh,this.data)},t.prototype.getAssetDef=function(){return{type:"soundsheet",name:this.bh,file:this.file}},t}(i.FileResource);i.Soundsheet=t}(h5ge||(h5ge={})),function(u){var t=function(r){function t(t,i,n){var h=r.call(this)||this;h.bh=t,h.ph=i,h.mh=n;var s=h,e=new u.WaitQueue(2);return e.onComplete=function(){s.onAllLoaded()},h._h=new u.FileResource(n),h.Eh=u.Resources.addImage(t,i),h._h.onSuccess(function(){e.resolve(0,null)}),h._h.onFailed(function(){e.resolve(0,null)}),h.Eh.onSuccess(function(){e.resolve(1,null)}),h.Eh.onFailed(function(){e.resolve(1,null)}),h}return __extends(t,r),t.prototype.onAllLoaded=function(){this.Eh.isTerminated()&&this._h.isTerminated()?this.Eh.isSuccess()&&this._h.isSuccess()?(this.createSpritesheet(),this.onSuccess0()):this.onFailed0():u.logger.error("Bad spritesheet loading. Image and atlas should be success/failed here")},t.prototype.createSpritesheet=function(){var t=JSON.parse(this._h.data);for(var i in t.frames){var n=t.frames[i].frame,h=new u.Texture(i,n.x,n.y,n.w,n.h);if(t.frames[i].trimmed){var s=t.frames[i].sourceSize,e=t.frames[i].spriteSourceSize;h.setTrim(e.x,e.y,s.w,s.h)}h.setImpl(this.Eh.resource),h.setLoaded(!0),u.Texture.addTexture(h)}},t.prototype.getAssetDef=function(){return{type:"spritesheet",name:this.bh,file:this.ph,atlas:this.mh}},t}(u.AbstractLoadingResource);u.Spritesheet=t}(h5ge||(h5ge={})),function(s){var t=function(){function t(t,i){if(this.width=t,this.height=i,this.hi=s.Game.get(),this.container=new s.Container(this.hi.width,this.hi.height),this.container.debugName="Background",t<=this.hi.bounds.width&&i<=this.hi.bounds.height)s.logger.warn("Background won't be visible. Ignoring.");else{var n=this,h=this.hi.renderer.canvas;this.Gn=document.createElement("canvas"),this.Gn.style.position="absolute",document.body.insertBefore(this.Gn,h),this.Gn.width=t,this.Gn.height=i,this.Hh=this.Gn.getContext("2d"),this.si=new s.FillScalingStrategy,this.hi.scaleManager.resizeHandler.add(function(){n.Ph()}),n.Ph()}}return t.prototype.Ph=function(){var t=window.innerWidth,i=window.innerHeight,n=this.si.getScaling(this.width,this.height,t,i);this.Gn.width=1*this.width,this.Gn.height=1*this.height,this.Gn.style.width=1*this.width*n.scale+"px",this.Gn.style.height=1*this.height*n.scale+"px",this.Gn.style.left=n.x+"px",this.Gn.style.top=n.y+"px",this.redraw()},t.prototype.redraw=function(){this.Hh.clearRect(0,0,this.Gn.width,this.Gn.height),this.container.draw(this.Hh)},t}();s.Background=t}(h5ge||(h5ge={})),function(h){var t=function(){function t(){this.game=h.Game.get(),this.container=new h.Container(this.game.width,this.game.height),this.container.debugName="Scene"}return t.prototype.addChild=function(t){this.container.addChild(t)},t.prototype.removeChild=function(t){this.container.removeChild(t)},t.prototype.update=function(t){},t.prototype.render=function(t){},t.prototype.show=function(t){var i=this;void 0===t&&(t=!0);var n=this;1==t?this.animateIn(function(){i.game.inputManager.enable(),h.DisplayObject.interactiveDirty=!0,n.onShow()}):(this.game.inputManager.enable(),h.DisplayObject.interactiveDirty=!0,this.onShow())},t.prototype.animateIn=function(t){t()},t.prototype.onShow=function(){},t.prototype.hide=function(t,i){void 0===i&&(i=!0),h.Game.get().inputManager.disable(),this.container.interactive=!1,this.container.hasInteractiveChild=!1,null!=this.Lh&&(this.Lh.fire(),this.Lh.clear());var n=this;1==i?this.animateOut(function(){n.onHide(),t()}):(this.onHide(),t())},t.prototype.animateOut=function(t){t()},t.prototype.onHide=function(){},Object.defineProperty(t.prototype,"hideHandler",{get:function(){return null==this.Lh&&(this.Lh=new h.HandlerCollection),this.Lh},enumerable:!0,configurable:!0}),t}();h.Scene=t}(h5ge||(h5ge={})),function(e){var t=function(h){function t(t,i){var n=h.call(this)||this;return n.progressListener=new e.HandlerCollection,n.timeCounted=0,n.startLoadTime=0,n.optDelayBeforeCompleteFire=0,n.optProgressAlgo=1,n.optEstimateLoadingTime=2e3,n.estimatedProgress=-1,n.lastEstimatedProgress=-1,n.assetList=t,n.callback=i,n}return __extends(t,h),t.prototype.onLoadComplete=function(){var t=this,i=performance.now()-this.startLoadTime;e.logger.debug("Loading time: "+i);for(var n=0;n<this.assetList.length;n++){var h=this.assetList[n];if("spritesheet"==h.type){var s=h.atlas.split("/");if(-1!=s[s.length-1].indexOf(".json"))h.name}}0<this.optDelayBeforeCompleteFire?e.TimeManager.get().createAndStartTimer(this.optDelayBeforeCompleteFire,function(){t.progressListener.fire(100),t.callback()}):(t.progressListener.fire(100),t.callback())},t.prototype.addProgressListener=function(t,i){this.progressListener.add(t,i)},t.prototype.onShow=function(){var i=this;this.startLoadTime=performance.now(),this.loader=new e.Loader(this.assetList,t.retryMax),this.loader.load(function(t){t?i.onLoadComplete():e.logger.error("Failed to load all assets :/")}),this.loadingStatus=this.loader.getStatus()},t.prototype.update=function(t){if(h.prototype.update.call(this,t),!(this.startLoadTime<=0)){if(this.lastEstimatedProgress=this.estimatedProgress,this.updateProgress(t),null!=this.optOnProgress&&this.optOnProgress(this.estimatedProgress),null!=this.loadingStatus){var i=this.loader.getStatus();i.loaded!=this.loadingStatus.loaded&&(this.loadingStatus=i)}this.lastEstimatedProgress!=this.estimatedProgress&&this.progressListener.fire(100*this.estimatedProgress)}},t.prototype.render=function(t){},t.prototype.updateProgress=function(t){2==this.optProgressAlgo?this.Rh(t):3==this.optProgressAlgo?this.Uh(t):this.Yh(t)},t.prototype.Rh=function(t){var i=this.loadingStatus.loading+this.loadingStatus.loaded+this.loadingStatus.failed,n=(this.loadingStatus.loaded+1)/i;n=Math.min(n,1);var h=this.timeCounted/this.optEstimateLoadingTime;h<n&&(this.timeCounted+=t),this.estimatedProgress=Math.min(h,1)},t.prototype.Uh=function(t){var i=(performance.now()-this.startLoadTime)/this.optEstimateLoadingTime;this.estimatedProgress=Math.min(i,1)},t.prototype.Yh=function(t){var i=this.loadingStatus.loading+this.loadingStatus.loaded+this.loadingStatus.failed,n=this.loadingStatus.loaded/i;this.estimatedProgress=Math.min(n,1)},t.retryMax=5,t}(e.Scene);e.H5PreLoadingScene=t}(h5ge||(h5ge={})),function(i){var t=function(){function t(){var t=this;this.os=new i.OS,this.fullscreenManager=new i.FullScreenManager,this.visibilityManager=new i.VisibilityManager,this.checkReady=function(){document.body?(t.os.init(),document.removeEventListener("DOMContentLoaded",t.checkReady),window.removeEventListener("load",t.checkReady),t.readyCallback()):window.setTimeout(t.checkReady,20)}}return t.prototype.whenReady=function(t){var i="complete"==document.readyState;this.readyCallback=t,i?(this.os.init(),this.readyCallback()):(document.addEventListener("DOMContentLoaded",this.checkReady),window.addEventListener("load",this.checkReady))},t}();i.DeviceManager=t}(h5ge||(h5ge={})),function(i){var t=function(){function t(){var t=this;this.onFullscreenChange=function(){t.zh=t.hasFullscreenElement(),null!=t.Xh&&t.Xh.fire()},this.fullscreenEnabled=document.fullscreenEnabled||document.msFullscreenEnabled||document.mozFullScreenEnabled||document.webkitFullscreenEnabled,this.Bh=document.documentElement,this.zh=this.hasFullscreenElement(),document.addEventListener("fullscreenchange",this.onFullscreenChange),document.addEventListener("msfullscreenchange",this.onFullscreenChange),document.addEventListener("mozfullscreenchange",this.onFullscreenChange),document.addEventListener("webkitfullscreenchange",this.onFullscreenChange)}return Object.defineProperty(t.prototype,"isInFullScreen",{get:function(){return this.zh},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"changeHandler",{get:function(){return null==this.Xh&&(this.Xh=new i.HandlerCollection),this.Xh},enumerable:!0,configurable:!0}),t.prototype.requestFullScreen=function(){if(this.fullscreenEnabled)if(document.documentElement.requestFullscreen)document.documentElement.requestFullscreen();else if(document.documentElement.msRequestFullscreen)document.documentElement.msRequestFullscreen();else if(document.documentElement.mozRequestFullScreen)document.documentElement.mozRequestFullScreen();else if(document.documentElement.webkitRequestFullscreen){Element.ALLOW_KEYBOARD_INPUT;document.documentElement.webkitRequestFullscreen()}},t.prototype.exitFullscreen=function(){this.fullscreenEnabled&&(document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen())},t.prototype.hasFullscreenElement=function(){return null!=(document.fullscreenElement||document.msFullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement)},t.prototype.toggleFullScreen=function(){this.fullscreenEnabled?this.isInFullScreen?this.exitFullscreen():this.requestFullScreen():i.logger.info("FullScreen is not enabled")},t}();i.FullScreenManager=t}(h5ge||(h5ge={})),function(i){var t=function(){function t(){this.level=0}return t.prototype.setLevel=function(t){this.level=t},t.prototype.debug=function(t){0<this.level||(console.debug(t),null!=this.listeners&&this.listeners.fire("debug",t))},t.prototype.info=function(t){1<this.level||(console.info(t),null!=this.listeners&&this.listeners.fire("info",t))},t.prototype.warn=function(t){2<this.level||(console.warn(t),null!=this.listeners&&this.listeners.fire("warn",t))},t.prototype.error=function(t,i){3<this.level||(console.error(t,i),null!=this.listeners&&this.listeners.fire("error",t,i))},t.prototype.addListener=function(t){null==this.listeners&&(this.listeners=new i.HandlerCollection),this.listeners.add(t)},t}();i.Logger=t,i.logger=new t}(h5ge||(h5ge={})),function(t){var i=function(){function t(){this.vita=!1,this.kindle=!1,this.android=!1,this.chromeOS=!1,this.iOS=!1,this.iPhone=!1,this.iPad=!1,this.linux=!1,this.macOS=!1,this.windows=!1,this.windowsPhone=!1,this.desktop=!1,this.iOSVersion=0,this.pixelRatio=1}return t.prototype.init=function(){var t=navigator.userAgent;/Playstation Vita/.test(t)?this.vita=!0:/Kindle/.test(t)||/\bKF[A-Z][A-Z]+/.test(t)||/Silk.*Mobile Safari/.test(t)?this.kindle=!0:/Android/.test(t)?this.android=!0:/CrOS/.test(t)?this.chromeOS=!0:/iP[ao]d|iPhone/i.test(t)?(this.iOS=!0,navigator.appVersion.match(/OS (\d+)/),this.iOSVersion=parseInt(RegExp.$1,10)):/Linux/.test(t)?this.linux=!0:/Mac OS/.test(t)?this.macOS=!0:/Windows/.test(t)&&(this.windows=!0),(/Windows Phone/i.test(t)||/IEMobile/i.test(t))&&(this.android=!1,this.iOS=!1,this.macOS=!1,this.windows=!0,this.windowsPhone=!0);var i=/Silk/.test(t);(this.windows||this.macOS||this.linux&&!i||this.chromeOS)&&(this.desktop=!0),(this.windowsPhone||/Windows NT/i.test(t)&&/Touch/i.test(t))&&(this.desktop=!1),this.iPhone=-1!==t.toLowerCase().indexOf("iphone"),this.iPad=-1!==t.toLowerCase().indexOf("ipad"),this.pixelRatio=window.devicePixelRatio||1},t}();t.OS=i}(h5ge||(h5ge={})),function(n){var t=function(){function t(){this.Fh=!1,this.qh=!0,this.Jh=!0,this.visibilityChangeHandler=new n.HandlerCollection,this.extendedVisibilityChangeHandler=new n.HandlerCollection,this.beforeUnloadHandler=new n.HandlerCollection,this.browserPrefixes=["moz","ms","o","webkit"];var t=this,i=this.getBrowserPrefix();this.hiddenPropertyName=this.getHiddenPropertyName(i),this.visibilityEventName=this.getVisibilityEvent(i),document.addEventListener(this.visibilityEventName,this.handleVisibilityChange.bind(this),!1),document.addEventListener("focus",function(){t.handleExtendedVisibilityChange(!0,"document-focus")},!1),document.addEventListener("blur",function(){t.handleExtendedVisibilityChange(!1,"document-blur")},!1),window.addEventListener("focus",function(){t.handleExtendedVisibilityChange(!0,"window-focus")},!1),window.addEventListener("blur",function(){t.handleExtendedVisibilityChange(!1,"window-blur")},!1),window.addEventListener("beforeunload",this.handleOnBeforeUnload.bind(this),!1)}return t.prototype.getHiddenPropertyName=function(t){return t?t+"Hidden":"hidden"},t.prototype.getVisibilityEvent=function(t){return(t||"")+"visibilitychange"},t.prototype.getBrowserPrefix=function(){for(var t=0;t<this.browserPrefixes.length;t++)if(this.getHiddenPropertyName(this.browserPrefixes[t])in document)return this.browserPrefixes[t];return null},t.prototype.handleVisibilityChange=function(){if(document[this.hiddenPropertyName])return this.qh=!1,this.visibilityChangeHandler.fire(!1),void this.onExtendedHidden(this.hiddenPropertyName);this.qh=!0,this.visibilityChangeHandler.fire(!0),this.onExtendedVisible(this.hiddenPropertyName)},t.prototype.handleExtendedVisibilityChange=function(t,i){return t?this.onExtendedVisible(i):this.onExtendedHidden(i)},t.prototype.onExtendedVisible=function(t){this.Jh||(this.Jh=!0,this.extendedVisibilityChangeHandler.fire(this.Jh,t))},t.prototype.onExtendedHidden=function(t){this.Jh&&(this.Jh=!1,this.extendedVisibilityChangeHandler.fire(this.Jh,t))},t.prototype.handleOnBeforeUnload=function(t){this.Fh=!0,this.beforeUnloadHandler.fire(t)},t.prototype.addVisibilityChangeHandler=function(t){this.visibilityChangeHandler.add(t)},t.prototype.removeVisibilityChangeHandler=function(t){this.visibilityChangeHandler.remove(t)},t.prototype.addExtendedVisibilityChangeHandler=function(t){this.extendedVisibilityChangeHandler.add(t)},t.prototype.removeExtendedVisibilityChangeHandler=function(t){this.extendedVisibilityChangeHandler.remove(t)},t.prototype.addBeforeUnloadHandler=function(t){this.beforeUnloadHandler.add(t)},t.prototype.removeBeforeUnloadHandler=function(t){this.beforeUnloadHandler.remove(t)},t.prototype.isVisible=function(){return this.qh},t.prototype.isUnloading=function(){return this.Fh},Object.defineProperty(t.prototype,"hidden",{get:function(){return!this.qh},set:function(t){throw"Read only"},enumerable:!0,configurable:!0}),t}();n.VisibilityManager=t}(h5ge||(h5ge={})),function(t){var i;(i=t.UTCDate||(t.UTCDate={})).oneday=864e5,i.serverTimeDiff=0,i.now=function(){return Date.now()-i.serverTimeDiff}}(h5ge||(h5ge={})),function(t){var i,n,h;i=t.Time||(t.Time={}),n=performance.now(),h=performance.now(),i.Qt=function(t){t=performance.now(),h=t-n,n=t},i.now=function(){return n},i.ellapsed=function(){return h}}(h5ge||(h5ge={})),function(e){var t=function(){function s(){this.Zh=[],this.Vh=!1,this.Wh=[],this.Kh=[],s.Qh=this}return s.get=function(){return null==s.Qh&&(s.Qh=new s),s.Qh},s.prototype.update=function(t){this.Vh=!0,this.$h=e.Time.now();for(var i=this,n=this.Zh.length-1;0<=n;n--){var h=this.Zh[n];h.update(this.$h)&&h.hasExpired()&&this.Kh.push(h)}this.Vh=!1,0<this.Kh.length&&(this.Kh.forEach(function(t){i.remove(t)}),this.Kh.length=0),0<this.Wh.length&&(this.Wh.forEach(function(t){i.pushTimer(t)}),this.Wh.length=0)},s.prototype.pushTimer=function(t){this.Zh.push(t)},s.prototype.remove=function(t){if(this.Vh)this.Kh.push(t);else{var i=this.Zh.indexOf(t);0<=i&&this.Zh.splice(i,1)}},s.prototype.removeAll=function(){for(var t=0;t<this.Zh.length;t++)this.Zh[t].ts=!0;this.Zh=[]},s.prototype.cancelAll=function(){for(var t=this.Zh.length-1;0<=t;t--)this.Zh[t].cancel()},s.prototype.createTimer=function(t,i,n,h){var s=new e.Timer(this,t,i,n,h);return this.Vh?this.Wh.push(s):this.pushTimer(s),s},s.prototype.createAndStartTimer=function(t,i,n,h){var s=this.createTimer(t,i,n,h);return s.start(),s},s.createAndStartTimer=function(t,i,n,h){return s.get().createAndStartTimer(t,i,n,h)},Object.defineProperty(s.prototype,"activeTimersCount",{get:function(){return this.Zh.length},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"activeTimers",{get:function(){return this.Zh.map(function(t){return t.id}).join()},enumerable:!0,configurable:!0}),s}();e.TimeManager=t}(h5ge||(h5ge={})),function(i){var t=function(){function t(t,i,n,h,s){this.id="DefaultId",this.ns=1,this.A=!1,this.ts=!1,this.hs=t,this.ss=i,this.es=n,this.rs=h,this.us=s}return t.prototype.setRepeat=function(t){this.ns=t},t.prototype.update=function(t){return!this.A||this.D-t<=0&&(null!=this.es&&this.es.call(this.rs,this.us),this.ns--,0==this.ns?(this.A=!1,this.ts=!0):(this.ns<-1&&(this.ns=-1),this.D=t+this.ss,this.gi=t,!1))},t.prototype.start=function(){this.A||(this.A=!0,this.D=i.Time.now()+this.ss,this.gi=i.Time.now())},t.prototype.cancel=function(){this.A=!1,this.hs.remove(this)},t.prototype.hasExpired=function(){return this.ts},t.prototype.getProgress=function(){return this.ts?1:this.A?(i.Time.now()-this.gi)/this.ss:0},t.prototype.getDuration=function(){return this.ss},t}();i.Timer=t}(h5ge||(h5ge={})),function(o){var t=function(){function t(){}return t.getRgb=function(t){return[t>>16&255,t>>8&255,255&t]},t.fromRgb=function(t,i,n){return t<<16|i<<8|n},t.fromHSV=function(t,i,n){var h,s,e,r=Math.floor(6*t),u=6*t-r,o=n*(1-i),f=n*(1-u*i),a=n*(1-(1-u)*i);switch(r%6){case 0:h=n,s=a,e=o;break;case 1:h=f,s=n,e=o;break;case 2:h=o,s=n,e=a;break;case 3:h=o,s=f,e=n;break;case 4:h=a,s=o,e=n;break;case 5:h=n,s=o,e=f}return h=Math.round(255*h),s=Math.round(255*s),e=Math.round(255*e),this.fromRgb(h,s,e)},t.toString=function(t,i){return void 0===i&&(i=1),"rgba("+((16711680&t)>>>16)+","+((65280&t)>>>8)+","+(255&t)+","+i+")"},t.toHexString=function(t){return"#"+o.Strings.pads(t.toString(16),6)},t.fromString=function(t){return 7!=t.length?0:parseInt(t.replace("#",""),16)},t.lerp=function(t,i,n){var h=this.getRgb(t),s=this.getRgb(i),e=o.Maths.lerp(h[0],s[0],n),r=o.Maths.lerp(h[1],s[1],n),u=o.Maths.lerp(h[2],s[2],n);return this.fromRgb(e,r,u)},t}();o.Colors=t}(h5ge||(h5ge={})),function(t){var i=function(){function t(){}return t.init=function(t){this.fs=t,this.fs<=0&&(this.fs+=2147483646)},t.currentSeed=function(){return this.fs},t.get=function(t){return void 0===t&&(t=!1),t?this.random0():Math.random()},t.inRange=function(t,i,n){return void 0===n&&(n=!1),this.get(n)*(i-t+1)+t},t.sign=function(t){return void 0===t&&(t=!1),this.get(t)<.5?1:-1},t.intInRange=function(t,i,n){return void 0===n&&(n=!1),Math.floor(this.get(n)*(i-t+1))+t},t.getSeededInt=function(){return this.fs=16807*this.fs%2147483647},t.random0=function(){return(this.getSeededInt()-1)/2147483646},t.fs=Date.now(),t}();t.Random=i}(h5ge||(h5ge={})),function(e){var t=function(){function n(){this.params=n.urlParametersToHashMap(document.location.href)}return n.getInstance=function(){return null==n._&&(n._=new n),n._},n.add=function(t,i){n.getInstance().params.put(t,i)},n.remove=function(t){n.getInstance().params.remove(t)},n.get=function(t){return n.getInstance().params.get(t)},n.has=function(t){return n.getInstance().params.containsKey(t)},n.urlParametersToHashMap=function(t){for(var i=new e.HashMap,n=t.substring(t.indexOf("?")+1).split("&"),h=0;h<n.length;h++)if(n[h]){var s=n[h].split("=");i.put(decodeURIComponent(s[0]),decodeURIComponent(s[1]))}return i},n}();e.StartupParams=t}(h5ge||(h5ge={})),function(t){var i=function(){function i(){}return i.ellipsis=function(t,i,n){if(null==t)return t;if(t.length<=i)return t;var h=t.substring(0,i);return null!=n&&(h+=n),h},i.capitalize=function(t){return null==t?null:t.length<=1?t.toUpperCase():t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()},i.interpolate=function(t,n){return t.replace(/{([^{}]*)}/g,function(t,i){return n[i]})},i.pad=function(t,i){for(var n=t+"";n.length<i;)n="0"+n;return n},i.pads=function(t,i){for(;t.length<i;)t="0"+t;return t},i.pad2=function(t){return i.pad(t,2)},i.randomUUID=function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},i}();t.Strings=i}(h5ge||(h5ge={})),function(e){var t=function(){function s(){}return s.shuffle=function(t,i){void 0===i&&(i=!1);var n=0,h=0,s=null;for(n=t.length-1;0<n;n-=1)h=Math.floor(e.Random.get(i)*(n+1)),s=t[n],t[n]=t[h],t[h]=s},s.rotate=function(t,i){for(;i--;){var n=t.shift();t.push(n)}},s.concat=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];for(var n=[],h=0;h<t.length;h++)for(var s=t[h],e=0;e<s.length;e++)n.push(s[e]);return n},s.addAll=function(t,i){if(null!=i)for(var n=0;n<i.length;n++)t.push(i[n])},s.copy=function(t){return null==t?null:t.slice()},s.one=function(t,i){return void 0===i&&(i=!1),null==t||t.length<1?null:1==t.length?t[0]:t[e.Random.intInRange(0,t.length-1,i)]},s.some=function(t,i,n){if(void 0===n&&(n=!1),null==t||t.length<1)return null;var h=s.copy(t);return s.shuffle(h,n),h.length<=i?h:h.slice(0,i)},s.remove=function(t,i){var n=t.indexOf(i);if(0<=n){var h=t.splice(n,1);if(null!=h&&0<h.length)return!0}return!1},s}();e.Collections=t}(h5ge||(h5ge={})),function(t){var i=function(){function t(){this.oh=[],this.$n=0}return t.prototype.isEmpty=function(){return 0==this.oh.length},t.prototype.size=function(){return this.oh.length},t.prototype.clear=function(){this.oh=[],this.oh.length=0},t.prototype.add=function(t){return 0<=this.oh.indexOf(t)||this.oh.push(t),!1},t.prototype.remove=function(t){var i=this.oh.indexOf(t);return!(i<0)&&(this.oh.splice(i,1),!0)},t.prototype.contains=function(t){return 0<=this.oh.indexOf(t)},t.prototype.values=function(){return this.oh},t.prototype.forEach=function(t,i){for(var n in this.oh){var h=this.oh[n];if(null!=h)if(!1===t.call(i,n,h))break}},t}();t.HashSet=i}(h5ge||(h5ge={})),function(n){var h=function(){function t(){var t=document.createElement("div");t.style.backgroundColor="white",t.style.fontFamily="Consolas, monaco, monospace",t.style.fontSize="10px",t.style.display="inline-block",t.style.padding="5px",t.style.position="absolute",t.style.zIndex="11",document.body.appendChild(t),this.div=t}return t.prototype.update=function(t){var i=t.join("<br>");this.div.innerHTML=i},t}(),t=function(){function t(t,i){void 0===t&&(t=!0),void 0===i&&(i=!1),this.outputConsole=t,this.outputUI=i,this.debugGameData=!0,this.as=0,this.cs=0,this.ls=0,this.vs=0,this.ds=0,this.gs=0,this.xs=240,this.ws=0,this.ys=-1,this.Ms={},this.hi=n.Game.get(),this.hi.addRenderable(this),this.cs=performance.now(),this.ds=performance.now(),i&&(this.bs=new h)}return t.prototype.render=function(t){var i=performance.now(),n=i-this.cs;1e3<n&&(this.ls=Math.round(1e3*this.as/n),this.as=0,this.cs=i,this.ys--,this.ys<0&&(this.ys=30,this.xs=240,this.ws=0),this.xs=Math.min(this.xs,this.ls),this.ws=Math.max(this.ws,this.ls),this.outputUI&&this.logToUi());var h=i-this.ds;5e3<h&&(this.gs=Math.round(1e3*this.vs/h),this.vs=0,this.ds=i,this.outputConsole&&this.logToConsole()),this.as++,this.vs++},t.prototype.addCounter=function(t,i){this.Ms[t]=i},t.prototype.start=function(){this.cs=performance.now(),this.ds=performance.now()},t.prototype.logToConsole=function(){console&&(console.log("FPS: 1s: %d, 5s: %d, min: %s, max: %s",this.ls,this.gs,this.xs,this.ws),this.outputDebugGameData())},t.prototype.logToUi=function(){var t=["fps (1):&nbsp;&nbsp; "+this.ls,"fps (min): "+this.xs,"fps (max): "+this.ws];this.bs.update(t)},t.prototype.outputDebugGameData=function(){if(this.debugGameData)for(var t in console.log("Graph contains "+this.hi.layers.root.St()+" ui elements"),console.log("Active timers: "+this.hi.timeManager.activeTimersCount+" :  ["+this.hi.timeManager.activeTimers+"]"),console.log("Active updatables: "+this.hi.Yt.length),console.log("Active renderables: "+this.hi.zt.length),this.Ms){var i=this.Ms[t];console.log(t+": "+i())}},t}();n.FPSLogger=t}(h5ge||(h5ge={})),function(e){var t=function(){function t(){}return t.clearYOffset=function(t){var i=e.Resources.fonts[t];if(null==i)throw new Error("Font not loaded: "+t);for(var n=Number.POSITIVE_INFINITY,h=0;h<i.chars.length;h++){(s=i.lettersByCode[i.chars[h]]).height<=0||s.yoffset<n&&(n=s.yoffset)}for(h=0;h<i.chars.length;h++){var s;(s=i.lettersByCode[i.chars[h]]).height<=0||(s.yoffset=s.yoffset-n)}},t}();e.Fonts=t}(h5ge||(h5ge={})),function(t){var i=function(){function t(t,i){this.callback=t,this.context=i}return t.prototype.execute=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];this.callback.apply(this.context,t)},t}();t.ContextualCallback=i}(h5ge||(h5ge={})),function(h){var t=function(){function t(){this.ps=[],this.ms=[]}return Object.defineProperty(t.prototype,"length",{get:function(){return this.ps.length+this.ms.length},enumerable:!0,configurable:!0}),t.prototype.once=function(t,i){var n=new h.ContextualCallback(t,i);this.ms.push(n)},t.prototype.add=function(t,i){var n=new h.ContextualCallback(t,i);return this.ps.push(n),n},t.prototype.remove=function(t){for(var i=-1,n=0;n<this.ps.length;n++)if(this.ps[n].callback==t){i=n;break}-1<i&&this.ps.splice(i,1)},t.prototype.removeCtx=function(t){var i=this.ps.indexOf(t);-1<i&&this.ps.splice(i,1)},t.prototype.removeIdx=function(t){return this.ps.splice(t,1)[0]},t.prototype.clear=function(){0<this.ps.length&&this.ps.splice(0,this.ps.length),0<this.ms.length&&this.ms.splice(0,this.ms.length)},t.prototype.fire=function(){for(var i=[],t=0;t<arguments.length;t++)i[t]=arguments[t];this.ps.forEach(function(t){t.callback.apply(t.context,i)}),0<this.ms.length&&(this.ms.forEach(function(t){t.callback.apply(t.context,i)}),this.ms.splice(0,this.ms.length))},t}();h.HandlerCollection=t}(h5ge||(h5ge={})),function(t){var i=function(){function t(t){this.size=t,this.oh=[],this._s=[];for(var i=0;i<t;i++)this._s[i]=!1}return t.prototype.resolve=function(t,i){this.oh[t]=i,this._s[t]=!0,this.allDone()&&this.onComplete(this.oh)},t.prototype.allDone=function(){for(var t=0;t<this._s.length;t++)if(!this._s[t])return!1;return!0},t}();t.WaitQueue=i}(h5ge||(h5ge={})),function(n){var t=function(){function t(t){if(this.ut=t,this.available=!1,this.available=this.isAvailable(),this.available){var i=localStorage.getItem(this.ut);this.cacheData=n.JSONS.safeJson(i,{})}else this.cacheData={}}return t.prototype.isAvailable=function(){try{return localStorage.setItem("test123456789","test123456789"),localStorage.removeItem("test123456789"),!0}catch(t){return!1}},t.prototype.put=function(t,i){this.cacheData[t]=i,this.available&&localStorage.setItem(this.ut,JSON.stringify(this.cacheData))},t.prototype.get=function(t,i){if(this.available){var n=this.cacheData[t];return null==n?i:n}return i},t.prototype.remove=function(t){this.available&&(delete this.cacheData[t],0==Object.keys(this.cacheData).length?(localStorage.setItem(this.ut,""),localStorage.removeItem(this.ut)):localStorage.setItem(this.ut,JSON.stringify(this.cacheData)))},t}();n.LocalStorage=t}(h5ge||(h5ge={}));var h5ge;__extends=this&&this.t||function(){var h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])};return function(t,i){function n(){this.constructor=t}h(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();!function(t){!function(t){function i(t){return t*t}function n(t){return t*t*t}function h(t){return t*t*t*t}t.linear=function(t){return t},t.easeInQuad=i,t.easeInCubic=n,t.easeInQuint=h,t.easeOutQuad=function(t){return 1-i(1-t)},t.easeOutCubic=function(t){return 1-n(1-t)},t.easeOutQuint=function(t){return 1-h(1-t)},t.easeInOutQuad=function(t){return t<.5?i(2*t)/2:1-i(2*(1-t))/2},t.easeInOutCubic=function(t){return t<.5?n(2*t)/2:1-n(2*(1-t))/2},t.easeInOutQuint=function(t){return t<.5?h(2*t)/2:1-h(2*(1-t))/2},t.easeOutElastic=function(t){return Math.pow(2,-10*t)*Math.sin((t-.075)*(2*Math.PI)/.3)+1}}(t.easing||(t.easing={}))}(h5ge||(h5ge={})),function(i){var t=function(){function t(t){this.Es=!0,this.Os=[],this.As=!1,this.loop=0,null!=t?(this.js=t,this.Es=!1):(this.js=new i.Container,this.Es=!0)}return Object.defineProperty(t.prototype,"container",{get:function(){return this.js},enumerable:!0,configurable:!0}),t.prototype.start=function(){this.startTime=performance.now(),i.Game.get().addUpdatable(this)},t.prototype.update=function(t){this.deltaTime=t,this.ellapsedTime=performance.now()-this.startTime;var i=this.emit();if(null==i)this.Gs(t),this.Os.length<=0&&this.destroy();else{this.Gs(t);for(var n=0;n<i.length;n++){var h=i[n];h.start(),this.Os.push(h),this.js.addChild(h.object)}}this.loop++},t.prototype.Gs=function(t){for(var i=this.Os.length-1;0<=i;i--){var n=this.Os[i];n.terminated?this.Os.splice(i,1):n.update(t)}},t.prototype.destroy=function(){i.Game.get().removeUpdatable(this),this.Es&&this.js.removeSelf()},t}();i.Emitter=t}(h5ge||(h5ge={})),function(f){var t=function(){function t(t,i){this.object=t,this.ks=i,this.terminated=!1,this.angle=0,this.startScale=1,this.endScale=1,this.startSpeed=0,this.endSpeed=0,this.lifetime=1e3}return t.prototype.start=function(){this.object.scaleXY=this.startScale,this.gi=f.Time.now(),0<this.lifetime&&(this.Ds=f.Time.now()+this.lifetime);var t=this.angle*f.Maths.DEG_TO_RADIAN;this.Ts=Math.cos(t),this.Ss=Math.sin(t)},t.prototype.update=function(t){if(!this.terminated){var i=f.Time.now(),n=1;if(0<this.lifetime){if(i>this.Ds)return this.terminated=!0,void(this.object.visible=!1);var h=i-this.gi,s=Math.min(h,this.lifetime)/this.lifetime;n=this.ks(s)}var e=this.startScale+(this.endScale-this.startScale)*n;this.object.scaleXY=e;var r=this.startSpeed+(this.endSpeed-this.startSpeed)*n,u=t*(r*this.Ts),o=t*(r*this.Ss);this.object.x+=u,this.object.y+=o}},t.prototype.reset=function(){this.terminated=!1,this.object.visible=!0},t.prototype.destroy=function(){this.object.visible=!1},t}();f.SimpleParticle=t}(h5ge||(h5ge={})),function(s){var t=function(){function t(t,i){this.id="DefaultId",this.ns=1,this.Cs=-1,this.Ns=[],this.Gh=0,this.Ci={},this.Is=t,this.Hs=i}return t.prototype.getObject=function(){return this.Is},t.prototype.delay=function(t){var i=new s.DelayTweenStep(t);return this.Ns.push(i),this},t.prototype.repeat=function(t){this.ns=t},t.prototype.to=function(t,i,n){void 0===i&&(i=1e3),void 0===n&&(n=s.easing.linear);var h=new s.PropertiesTweenStep(this.Is,t,i,n,!1);return this.Ns.push(h),this},t.prototype.from=function(t,i,n){void 0===i&&(i=1e3),void 0===n&&(n=s.easing.linear);var h=new s.PropertiesTweenStep(this.Is,t,i,n,!0);return this.Ns.push(h),this},t.prototype.start=function(){1!=this.Gh?0!=this.Ns.length?(this.Gh=1,this.nextStep(),this.onStart&&this.onStart()):s.logger.warn("No step defined in Tween"):s.logger.warn("Tween already started")},t.prototype.stop=function(){2!=this.Gh&&(this.Gh=2,this.onComplete&&this.onComplete(this),this.Hs.remove(this))},t.prototype.update=function(t){1==this.Gh&&(null!=this.Ps?(this.Ps.update(t),this.Ps.isComplete()&&(this.render(1),this.nextStep())):this.stop())},t.prototype.render=function(t){1==this.Gh&&null!=this.Ps&&this.Ps.render(t)},t.prototype.nextStep=function(){this.Cs++,this.Cs<this.Ns.length?(this.Ps=this.Ns[this.Cs],this.Ps.start()):(this.ns-=1,0==this.ns?this.Ps=null:(this.Cs=-1,this.nextStep()))},t}();s.Tween=t}(h5ge||(h5ge={})),function(h){var t=function(){function t(){this.Ls=[],(t.Rs=this).hi=h.Game.get(),this.hi.addUpdatable(this),this.hi.addRenderable(this)}return t.get=function(){return null==t.Rs&&(t.Rs=new t),t.Rs},t.prototype.create=function(t,i){var n=new h.Tween(t,this);return null!=i&&(n.id=i),this.Ls.push(n),n},t.prototype.remove=function(t){var i=this.Ls.indexOf(t);-1<i&&(this.Ls.splice(i,1),t.stop())},t.prototype.removeAll=function(){this.cancelAll(),this.Ls=[]},t.prototype.cancelAll=function(){for(var t=0;t<this.Ls.length;t++)this.Ls[t].stop()},t.prototype.update=function(t){for(var i=0;i<this.Ls.length;i++)this.Ls[i].update(t)},t.prototype.render=function(t){for(var i=0;i<this.Ls.length;i++)this.Ls[i].render(t)},Object.defineProperty(t.prototype,"activeTweensCount",{get:function(){return this.Ls.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activeTweens",{get:function(){return this.Ls.map(function(t){return t.id}).join()},enumerable:!0,configurable:!0}),t}();h.TweenManager=t}(h5ge||(h5ge={})),function(n){var t=function(){function t(t){this.complete=!1,this.elapsedTime=null,this.startTime=null,this.duration=t}return t.prototype.start=function(){this.startTime=n.Time.now(),this.elapsedTime=0,this.complete=!1},t.prototype.update=function(t){var i=n.Time.now();this.elapsedTime=i-this.startTime,this.elapsedTime>=this.duration&&(this.complete=!0)},t.prototype.render=function(t){},t.prototype.isComplete=function(){return this.complete},t}(),i=function(i){function t(t){return i.call(this,t)||this}return __extends(t,i),t}(n.TweenStep=t);n.DelayTweenStep=i;var h=function(r){function t(t,i,n,h,s){var e=r.call(this,n)||this;return e.Us={},e.Ys={},e.zs={},e.Xs={},e.Si=i,e.ks=h,e.yi=s,e.Is=t,e}return __extends(t,r),t.prototype.start=function(){for(var t in r.prototype.start.call(this),this.Si)this.yi?(this.Us[t]=this.Si[t],this.Ys[t]=this.Is[t]):(this.Us[t]=this.Is[t],this.Ys[t]=this.Si[t]),this.zs[t]=this.Us[t],this.Xs[t]=this.Us[t]},t.prototype.update=function(t){r.prototype.update.call(this,t);var i=Math.min(this.elapsedTime,this.duration)/this.duration,n=this.ks(i);for(var h in this.Si){this.zs[h]=this.Xs[h];var s=this.Us[h],e=s+(this.Ys[h]-s)*n;this.Xs[h]=e}},t.prototype.render=function(t){for(var i in r.prototype.render.call(this,t),this.Xs){var n=this.zs[i],h=this.Xs[i];this.Is[i]=n+(h-n)*t}},t}(t);n.PropertiesTweenStep=h}(h5ge||(h5ge={})),function(t){var i=function(){function t(t,i){void 0===i&&(i=!0),this.roundValue=i,this.Bs=i?Math.round(t):t}return t.prototype.notify=function(t){var i=this.Bs;i!=t&&(i<t?(null!=this.onValueUp&&this.onValueUp(t),null!=this.onValueChange&&this.onValueChange(t)):t<i&&(null!=this.onValueDown&&this.onValueDown(t),null!=this.onValueChange&&this.onValueChange(t)))},Object.defineProperty(t.prototype,"value",{get:function(){return this.Bs},set:function(t){this.roundValue&&(t=Math.round(t)),this.notify(t),this.Bs=t},enumerable:!0,configurable:!0}),t}();t.TweenValueListener=i}(h5ge||(h5ge={})),function(n){var t=function(){function t(t,i){void 0===i&&(i=0),this.It=t,this.Fs=i,this.qs=-1,this.gi=0,this.an=0,this.ts=!1,this.Js=!1,this.Zs()}return t.prototype.startTimeLimited=function(t,i){void 0===i&&(i=0),this.Fs=i/t,this.an=t,this.gi=performance.now()-i,this.Js=!0},t.prototype.setProgress=function(t){t<0?t=0:1<t&&(t=1),this.Fs=t},t.prototype.update=function(t){if(!this.ts&&this.Js&&0!=this.gi){var i=performance.now();this.Fs=(i-this.gi)/this.an,this.Fs=Math.min(this.Fs,1),1==this.Fs&&this.Vs()}},t.prototype.render=function(t){},t.prototype.getProgress=function(){return this.Fs},t.prototype.Vs=function(){this.ts=!0,this.Js=!1,null!=this.onProgressExpired&&this.onProgressExpired()},t.prototype.Zs=function(){var t=this,i=n.Game.get();i.addRenderable(this),i.addUpdatable(this),this.It.detachListener.once(function(){i.removeRenderable(t),i.removeUpdatable(t)})},t}();n.AbstractProgressBar=t}(h5ge||(h5ge={})),function(o){var t=function(u){function t(t,i,n){void 0===i&&(i=0),void 0===n&&(n=0);var h=u.call(this,t,n)||this;return h.Ws=i,h.bgwidth=0,h.bgheight=0,h.Ks=!1,h.bgwidth=t.width,h.bgheight=t.height,h}return __extends(t,u),t.prototype.updateProgress=function(t){t<0?t=0:1<t&&(t=1),this.Fs=t},t.prototype.update=function(t){u.prototype.update.call(this,t)},t.prototype.render=function(t){if(u.prototype.render.call(this,t),this.Fs!=this.qs){var i,n,h,s;if(this.It.mask=new o.Mask,0==this.Ws)n=i=0,h=this.bgwidth*this.Fs,s=this.bgheight,this.Ks&&(i=h,h=this.bgwidth-h);else if(1==this.Ws){var e=this.It.width*this.Fs;i=this.bgwidth-e,n=0,h=e,s=this.bgheight,this.Ks&&(h=i,i=0)}else if(2==this.Ws)n=i=0,h=this.bgwidth,s=this.bgheight*this.Fs,this.Ks&&(n=s,s=this.bgheight-s);else if(3==this.Ws){var r=this.bgheight*this.Fs;i=0,n=this.bgheight-r,h=this.bgwidth,s=r,this.Ks&&(s=n,n=0)}this.It.mask.rectangle(i,n,h,s),this.qs=this.Fs}},t.prototype.setInverted=function(t){this.Ks=!0},t}(o.AbstractProgressBar);o.ProgressBar=t}(h5ge||(h5ge={})),function(n){var t=function(h){function t(t,i){void 0===i&&(i=0);var n=h.call(this,t,i)||this;return n.start=-Math.PI/2,n.Ks=!1,n.radius=t.width/2,n.centerX=n.radius,n.centerY=n.radius,n}return __extends(t,h),t.prototype.setInverted=function(t){this.Ks=t},t.prototype.updateProgress=function(t){t<0?t=0:1<t&&(t=1),this.Fs=t},t.prototype.update=function(t){h.prototype.update.call(this,t)},t.prototype.render=function(t){if(h.prototype.render.call(this,t),this.Fs!=this.qs){if(this.It.mask=new n.Mask,0<this.Fs)if(this.It.visible=!0,this.Ks){i=2*this.Fs*Math.PI;this.It.mask.moveTo(this.centerX,this.centerY),this.It.mask.lineTo(this.radius+this.radius*Math.cos(this.start+i),this.radius+this.radius*Math.sin(this.start+i)),this.It.mask.arc(this.centerX,this.centerY,this.radius,this.start+i,3*Math.PI/2),this.It.mask.lineTo(this.centerX,this.centerY)}else{var i=2*this.Fs*Math.PI;this.It.mask.moveTo(this.centerX,this.centerY),this.It.mask.lineTo(this.radius,0),this.It.mask.arc(this.centerX,this.centerY,this.radius,this.start,this.start+i),this.It.mask.lineTo(this.centerX,this.centerY)}else this.It.visible=!1;this.qs=this.Fs}},t}(n.AbstractProgressBar);n.RoundProgressBar=t}(h5ge||(h5ge={}));__extends=this&&this.t||function(){var h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])};return function(t,i){function n(){this.constructor=t}h(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();!function(t){var i=function(){function t(){}return t.prototype.canShowInterstitial=function(){return!1},t.prototype.showInterstitial=function(t){t(!1)},t.prototype.canShowRewardedVideo=function(){return!1},t.prototype.showRewardedVideo=function(t){t(!1)},t}();t.VDefaultAdsManager=i}(vsauce||(vsauce={})),function(t){var i=function(){};(vsauce||(vsauce={})).VDefaultBoostrap=i}(),function(t){var i=function(){};(vsauce||(vsauce={})).VDefaultDataManager=i}(),function(n){n.logger=h5ge.logger;var t=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.initialize=function(t){var i;this.config=t,n.logger.debug("Starting "+t.gameId+" "+t.gameVersion),n.logger.debug("✰ MATELMAS✰"),"dummy"==t.publisher?i=new n.VDummyFactory:"fbmessenger"==t.publisher&&(i=new n.VFBMessengerFactory),this.bootstrap=i.newVBootstrap(),this.dataManager=i.newVDataManager(),this.scoreManager=i.newVScoreManager(),this.adsManager=i.newVAdsManager(),this.socialManager=i.newVSocialManager(),this.scaleManager.resizeHandler.add(this.onResize,this),this.onResize()},i.prototype.loadAssets=function(t,i){var n=this;this.loadingConfig=i,null==this.loadingConfig.optDelayBeforeCompleteFire&&(this.loadingConfig.optDelayBeforeCompleteFire=50),null==this.loadingConfig.optEstimateLoadingTime&&(this.loadingConfig.optEstimateLoadingTime=5e3),null==this.loadingConfig.optProgressAlgo&&(this.loadingConfig.optProgressAlgo=1),this.bootstrap.onReady(t,function(){n.onAssetsLoaded(),n.goToGame()})},i.prototype.goToGame=function(){},i.prototype.onAssetsLoaded=function(){},i.prototype.onResize=function(){},i}(h5ge.Game);n.VGame=t}(vsauce||(vsauce={})),function(t){var i=function(){function t(){}return t.prototype.setScore=function(t,i,n,h,s){console.log("Saving score "+t+" to leaderboard "+n+", contextual? "+h),s(!0)},t.prototype.postScoreUpdate=function(t,i,n,h){console.log("Post score update"),h(!0)},t.prototype.getScores=function(t,i,n,h){void 0===h&&(h=10),n([])},t.prototype.getPlayerScore=function(t,i,n){n(null)},t}();t.VDefaultScoreManager=i}(vsauce||(vsauce={})),function(t){var i=function(){function t(){}return t.prototype.chooseContext=function(t){t(!1)},t.prototype.getContextID=function(){return null},t}();t.VDefaultSocialManager=i}(vsauce||(vsauce={})),(vsauce||(vsauce={})).getGame=function(){return h5ge.Game.get()},function(h){var t;(t=h.util||(h.util={})).loadJs=function(i,t){var n=document.createElement("script");n.type="text/javascript",n.readyState?n.onreadystatechange=function(){"loaded"!==n.readyState&&"complete"!==n.readyState||(n.onreadystatechange=null,t())}:n.onload=function(){t()},n.onerror=function(t){h.logger.error("Failed to load script "+i+"! "+t)},n.src=i,document.getElementsByTagName("head")[0].appendChild(n)},t.enableDomConsole=function(){var e=[],r=document.createElement("div");r.style.background="white",r.style.fontSize="10px",r.style.fontFamily="Consolas, monaco, monospace",r.style.position="absolute",r.style.zIndex="11",document.body.appendChild(r);var u=document.createElement("div");r.appendChild(u),e.push(u),h.logger.addListener(function(t,i,n){var h=document.createElement("div");if(h.innerHTML="<b>"+t+"</b>: "+i+(null==n?"":", "+n),r.insertBefore(h,u),e.splice(0,0,h),u=h,8<e.length){var s=e[e.length-1];e.splice(e.length-1,1),r.removeChild(s)}})}}(vsauce||(vsauce={}));var vsauce;__extends=this&&this.t||function(){var h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])};return function(t,i){function n(){this.constructor=t}h(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();!function(n){var t=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.canShowInterstitial=function(){return!0},i.prototype.showInterstitial=function(t){n.logger.debug(""),setTimeout(function(){n.logger.debug(""),t(!0)},250)},i.prototype.canShowRewardedVideo=function(){return!0},i.prototype.showRewardedVideo=function(t){n.logger.debug(""),setTimeout(function(){n.logger.debug("ads display complete"),t(!0)},250)},i}(n.VDefaultAdsManager);n.VDummyAdsManager=t}(vsauce||(vsauce={})),function(s){var t=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.onReady=function(t,i){var n=this,h=(s.getGame().loadingConfig,new h5ge.H5PreLoadingScene(t,function(){i()}));h.progressListener.add(function(t){t=h5ge.Maths.clamp01(t),t*=100,n.setLoadingProgress(t)}),h5ge.Game.get().switchScene(h)},i.prototype.setLoadingProgress=function(t){s.logger.debug("Loading "+t+"%")},i}(s.VDefaultBoostrap);s.VDummyBoostrap=t}(vsauce||(vsauce={})),function(h){var t=function(n){function t(){var t=n.call(this)||this,i=h.getGame();return t.Qs=new h5ge.LocalStorage(i.config.gameId),t}return __extends(t,n),t.prototype.getDataAsync=function(t,i){for(var n={},h=0;h<t.length;h++){var s=t[h],e=this.Qs.get(s);n[s]=e}setTimeout(function(){i(n)},100)},t.prototype.setDataAsync=function(t){for(var i in t){var n=t[i];this.Qs.put(i,n)}},t.prototype.logEvent=function(t,i,n){h.logger.debug("event:"+t+", v="+i+" ,params="+(null==n?"null":JSON.stringify(n)))},t}(h.VDefaultDataManager);h.VDummyDataManager=t}(vsauce||(vsauce={})),function(i){var t=function(){function t(){}return t.prototype.newVBootstrap=function(){return new i.VDummyBoostrap},t.prototype.newVDataManager=function(){return new i.VDummyDataManager},t.prototype.newVScoreManager=function(){return new i.VDummyScoreManager},t.prototype.newVAdsManager=function(){return new i.VDummyAdsManager},t.prototype.newVSocialManager=function(){return new i.VDummySocialManager},t}();i.VDummyFactory=t}(vsauce||(vsauce={})),function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i}(t.VDefaultScoreManager);t.VDummyScoreManager=i}(vsauce||(vsauce={})),function(t){var i=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return __extends(i,t),i}(t.VDefaultSocialManager);t.VDummySocialManager=i}(vsauce||(vsauce={}));var GAME;__extends=this&&this.t||function(){var h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])};return function(t,i){function n(){this.constructor=t}h(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();!function(e){var n={rendering:{backgroundColor:0},gameLoop:{smoothDelta:!0}};e.logger=h5ge.logger;var t=function(i){function s(){var t=i.call(this,624,1040,n)||this;return s._=t}return __extends(s,i),s.get=function(){return s._},s.prototype.onCreate=function(){i.prototype.onCreate.call(this),this.initialize(e.GAMECONFIG);var t=[{type:"spritesheet",name:"game-0",file:"game/assets/images/game-0.png",atlas:"game/assets/images/game-0.json"},{type:"img",name:"bg",file:e.MenuScene.BACKGROUND_URL},{type:"img",name:"city",file:e.MovingBack.URL_CITY},{type:"img",name:"canyon",file:e.MovingBack.URL_CANYON},{type:"img",name:"racing",file:e.MovingBack.URL_RACING},{type:"img",name:"moonfrog_splash",file:e.SplashScene.URL_SPLASH}];this.loadAssets(t,{optEstimateLoadingTime:1e3,optProgressAlgo:2})},s.prototype.onAssetsLoaded=function(){h5ge.FontLoader.loadAll(e.fonts.fonts)},s.prototype.goToGame=function(){e.System.start();var h=this;s.get().audioManager.unmute(),this.soundManager=new e.SoundManager,e.Storage.init(function(){var t=e.Storage.dataGet(e.DataKey.LANGUE);t&&(e.SPEAK.langue=t),h.layers.root.mask=new h5ge.Mask,h.layers.root.mask.rectangle(.5*(s.get().width-934),0,934,s.get().height);var i=new e.SplashScene;h.switchScene(i);var n=Date.now();h.dataManager.logEvent("session-start",1),h.deviceManager.visibilityManager.addBeforeUnloadHandler(function(){var t=Date.now(),i=Math.round((t-n)/1e3);h.dataManager.logEvent("session-end",1,{duration:i})})})},s}(vsauce.VGame);(new(e.Game=t)).start()}(GAME||(GAME={})),function(a){var t=function(f){function t(){var t=f.call(this,a.Game.get().width,a.Game.get().height)||this;t.$s=null,t.actionText=null;var i=h5ge.Sprite.fromFrame(a.ASSETS.CAR_STATS_CURSOR_RIGHT);i.setPivotToCenter(),i.x=a.Game.get().width-i.width,i.y=.5*-i.height,t.addChild(i);var n=new h5ge.Container(350,250);n.x=a.Game.get().width-n.width+200,n.y=.5*-n.height,n.onClick(t.cursorRight,t),t.addChild(n),n.overHandler.add(function(){i.scaleXY=1.2}),n.outHandler.add(function(){i.scaleXY=1});var h=h5ge.Sprite.fromFrame(a.ASSETS.CAR_STATS_CURSOR_LEFT);h.setPivotToCenter(),h.y=.5*-h.height,t.addChild(h);var s=new h5ge.Container(350,250);s.x=-200,s.y=.5*-s.height,s.onClick(t.cursorLeft,t),t.addChild(s),s.overHandler.add(function(){h.scaleXY=1.2}),s.outHandler.add(function(){h.scaleXY=1});var e=h5ge.Sprite.fromFrame(a.ASSETS.BUTTONS_BUTTONBIG1),r=h5ge.Sprite.fromFrame(a.ASSETS.BUTTONS_BUTTONBIG1_PRESSED),u=h5ge.Sprite.fromFrame(a.ASSETS.BUTTONS_BUTTONBIG1_HOVER),o=new h5ge.ImageButtonStyle(e,r,u);t.action=new h5ge.ImageButton(o),t.action.x=.5*(a.Game.get().width-t.action.width),t.action.y=180,t.addChild(t.action),t.action.onClick(t.doAction,t);e=h5ge.Sprite.fromFrame(a.ASSETS.BUTTONS_BUTTONBIG2),r=h5ge.Sprite.fromFrame(a.ASSETS.BUTTONS_BUTTONBIG2_PRESSED),u=h5ge.Sprite.fromFrame(a.ASSETS.BUTTONS_BUTTONBIG2_HOVER),o=new h5ge.ImageButtonStyle(e,r,u);return t.actionBlue=new h5ge.ImageButton(o),t.actionBlue.x=.5*(a.Game.get().width-t.action.width),t.actionBlue.y=180,t.addChild(t.actionBlue),t.actionBlue.onClick(t.doAction,t),t.actionBlue.visible=!1,t.setCar(a.Car.getMyCar()),t}return __extends(t,f),t.prototype.doAction=function(){this.actionPlay?this.$s():this.selectedCar.unlockCar()&&this.setAction(!0)},t.prototype.setAction=function(t){this.actionPlay=t,null==this.actionText&&(this.actionText=a.factory.newText("INIT",42),this.actionText.y=this.action.y+.5*(this.action.height-this.actionText.height),this.addChild(this.actionText)),t?(this.actionText.text=a.SPEAK.PLAY.get(),this.action.visible=!0,this.actionBlue.visible=!1):(this.actionText.text=a.SPEAK.UNLOCK.get(),this.action.visible=!1,this.actionBlue.visible=!0),this.actionText.x=this.action.x+.5*(this.action.width-this.actionText.width)},t.prototype.setCar=function(t,i){t=a.Car.getTrueCarNb(t),this.selectedCar=new a.CarSprite(t,i),this.selectedCar.y=.5*-this.selectedCar.height,this.addChildAt(this.selectedCar,0),this.carStat&&this.carStat.removeSelf(),this.carStat=new a.CarStatPopup(a.Car.getCarStat(t)),this.carStat.x=.5*(a.Game.get().width-this.carStat.width),this.carStat.y=-this.carStat.height-200,this.addChild(this.carStat);var n=this.selectedCar.isOwned();this.setAction(n),n&&a.Car.setMyCar(t)},t.prototype.buildNotEnouthEffect=function(){var t=new a.DropH5,i=a.factory.newText(a.SPEAK.NOT_ENOUTH_MONEY.get(),32);i.tint=16731392,i.x=.5*-i.width,i.y=.5*-i.height;var n=a.factory.newText(a.SPEAK.NOT_ENOUTH_MONEY.get(),32);n.tint=0,n.x=i.x,n.y=i.y+3,t.addChild(n),t.addChild(i),t.x=.5*this.width,t.y=this.action.y+.5*this.action.height,this.addChild(t)},t.prototype.onGo=function(t){this.$s=t},t.prototype.setPause=function(t){this.pause=t},t.prototype.cursorLeft=function(){this.selectedCar.goOut(!1),this.setCar(this.selectedCar.getCarNb()-1,!0),a.SoundManager.play("swipe_car")},t.prototype.cursorRight=function(){this.selectedCar.goOut(!0),this.setCar(this.selectedCar.getCarNb()+1,!1),a.SoundManager.play("swipe_car")},t}(h5ge.Container);a.CarSelector=t}(GAME||(GAME={})),function(e){var t=function(h){function t(t,i){var n=h.call(this)||this;return n.updater=new e.UpdaterH5(n),n.carNb=t,n.buildCar(),n.destX=.5*e.Game.get().width,n.x=.5*e.Game.get().width+(i?-1e3:1e3),n.updater.addUpdatable(),1!=e.Car.isOwned(n.carNb)?(n.owned=!1,n.buildLock()):n.owned=!0,n}return __extends(t,h),t.prototype.isOwned=function(){return this.owned},t.prototype.goOut=function(t){this.destX=.5*e.Game.get().width+(t?-1e3:1e3),this.destroy=!0,this.updater.addUpdatable()},t.prototype.getCarNb=function(){return this.carNb},t.prototype.buildLock=function(){this.car.tint=2236962,this.price=new h5ge.Container,this.cost=e.Car.getCarPrice(this.carNb);var t=h5ge.Sprite.fromFrame(e.ASSETS.MONEY),i=e.factory.newText(e.System.getNumberString(this.cost),42);i.y=.5*(t.height-i.height)-6,i.x=t.width+32,this.price.addChild(t),this.price.addChild(i),this.price.setSizeFromChildren(),this.price.x=.5*-this.price.width,this.price.y=100,this.addChild(this.price)},t.prototype.buildCar=function(){var t=h5ge.Sprite.fromFrame(e.Car.getIllustrationFrame(this.carNb));t.x=.5*-t.width,t.y=.5*-t.height,this.addChild(t),this.car=t},t.prototype.buildPaidEffect=function(){e.SoundManager.play("paid"),e.SoundManager.play("buy_car");var t=new e.DropH5,i=new h5ge.Container,n=e.factory.newText("-"+e.System.getNumberString(this.cost),42);n.y=.5*-n.height-10,n.tint=16711680,i.addChild(n);var h=h5ge.Sprite.fromFrame(e.ASSETS.MONEY);h.x=n.width+5,h.y=.5*-h.height,i.addChild(h),i.setSizeFromChildren(),i.x=.5*-i.width,t.addChild(i),t.x=0,t.y=this.price.y+.5*this.price.height,this.addChild(t);var s=e.ParticuleH5.newExplode(4,e.ASSETS.ORBE,11608341,1.5,.01,.2);s.x=t.x,s.y=t.y,this.addChild(s)},t.prototype.unlockCar=function(){var i=this,t=e.Storage.dataGet(e.DataKey.GOLD);if(this.cost<=t){var n={update:function(t){i.car.tint+=197379,16777215<=i.car.tint&&(i.car.tint=16777215,e.Game.get().removeUpdatable(n))}};return e.Game.get().addUpdatable(n),this.buildPaidEffect(),this.price.removeSelf(),this.price=null,this.owned=!0,e.Car.unlockCar(this.carNb),e.Storage.dataSave([e.DataKey.GOLD],[t-this.cost]),e.Car.setMyCar(this.carNb),e.MenuScene.get().moneyCounter.refreshCount(),!0}return e.MenuScene.get().carSelector.buildNotEnouthEffect(),!1},t.prototype.fireEnd=function(){this.updater.stopUpdatable(),this.x=this.destX,this.destroy&&this.removeSelf()},t.prototype.update=function(t){this.x=e.System.move(this.destX,this.x),Math.abs(this.x-this.destX)<5&&this.fireEnd()},t}(h5ge.Container);e.CarSprite=t}(GAME||(GAME={})),function(r){var t=function(e){function t(t){var i=e.call(this)||this,n=i.getStat(r.ASSETS.CAR_STATS_SPEED,5+t.speed),h=i.getStat(r.ASSETS.CAR_STATS_DRIVING,t.driving);h.x=n.x+n.width+32;var s=i.getStat(r.ASSETS.CAR_STATS_LIFE,t.life-4);return s.x=h.x+h.width+32,i.addChild(n),i.addChild(h),i.addChild(s),i.setSizeFromChildren(),i}return __extends(t,e),t.prototype.getStat=function(t,i){var n=new h5ge.Container,h=h5ge.Sprite.fromFrame(t);n.addChild(h);for(var s=0;s<10;s++){var e=h5ge.Sprite.fromFrame(r.ASSETS.CAR_STATS_BAR);e.y=.5*(h.height-e.height),e.x=8+h.width+s*e.width,e.tint=s<i?11206400:11184810,n.addChild(e)}return n.setSizeFromChildren(),n.setSize(n.width+8,n.height),n},t}(h5ge.Container);r.CarStatPopup=t}(GAME||(GAME={})),function(t){var i=function(){function t(){}return t.BAR_EMPTY="bar/empty.png",t.BAR_FULL="bar/full.png",t.BAR_LIFE_ICONE="bar/life_icone.png",t.BARREL_PARTICULE="barrel_particule.png",t.BARRIL="barril.png",t.BESTSCORE="bestscore.png",t.BEST_ICONE="best_icone.png",t.BUTTONS_BUTTONBIG1="buttons/buttonbig1.png",t.BUTTONS_BUTTONBIG1_HOVER="buttons/buttonbig1_hover.png",t.BUTTONS_BUTTONBIG1_PRESSED="buttons/buttonbig1_pressed.png",t.BUTTONS_BUTTONBIG2="buttons/buttonbig2.png",t.BUTTONS_BUTTONBIG2_HOVER="buttons/buttonbig2_hover.png",t.BUTTONS_BUTTONBIG2_PRESSED="buttons/buttonbig2_pressed.png",t.CACTUS="cactus.png",t.CACTUS_PARTICULE="cactus_particule.png",t.CAR_STATS_BAR="car_stats/bar.png",t.CAR_STATS_CURSOR_LEFT="car_stats/cursor_left.png",t.CAR_STATS_CURSOR_RIGHT="car_stats/cursor_right.png",t.CAR_STATS_DRIVING="car_stats/driving.png",t.CAR_STATS_LIFE="car_stats/life.png",t.CAR_STATS_SPEED="car_stats/speed.png",t.CHOC_CHOC_0="choc/choc_0.png",t.CHOC_CHOC_1="choc/choc_1.png",t.CHOC_CHOC_2="choc/choc_2.png",t.CHOC_CHOC_3="choc/choc_3.png",t.CHOC_CHOC_4="choc/choc_4.png",t.CHOC_CHOC_5="choc/choc_5.png",t.CHOC_CHOC_6="choc/choc_6.png",t.CHOC_CHOC_7="choc/choc_7.png",t.CHOC_CHOC_8="choc/choc_8.png",t.CHOC_CHOC_9="choc/choc_9.png",t.CHOC2_CHOC2_0="choc2/choc2_0.png",t.CHOC2_CHOC2_1="choc2/choc2_1.png",t.CHOC2_CHOC2_2="choc2/choc2_2.png",t.CHOC2_CHOC2_3="choc2/choc2_3.png",t.CHOC2_CHOC2_4="choc2/choc2_4.png",t.CONE_PARTICULE="cone_particule.png",t.CONVERT_ARROW="convert_arrow.png",t.DIGIT="digit.png",t.EXPLOSION_EXPLODE0001="explosion/Explode0001.png",t.EXPLOSION_EXPLODE0002="explosion/Explode0002.png",t.EXPLOSION_EXPLODE0003="explosion/Explode0003.png",t.EXPLOSION_EXPLODE0004="explosion/Explode0004.png",t.EXPLOSION_EXPLODE0005="explosion/Explode0005.png",t.EXPLOSION_EXPLODE0006="explosion/Explode0006.png",t.EXPLOSION_EXPLODE0007="explosion/Explode0007.png",t.EXPLOSION_EXPLODE0008="explosion/Explode0008.png",t.EXPLOSION_EXPLODE0009="explosion/Explode0009.png",t.EXPLOSION_EXPLODE0010="explosion/Explode0010.png",t.EXPLOSION_EXPLODE0011="explosion/Explode0011.png",t.EXPLOSION_EXPLODE0012="explosion/Explode0012.png",t.EXPLOSION_EXPLODE0013="explosion/Explode0013.png",t.EXPLOSION_EXPLODE0014="explosion/Explode0014.png",t.GAMENAME="gameName.png",t.ITEM_CONE="item/cone.png",t.ITEM_GOLD="item/gold.png",t.ITEM_LIFE="item/life.png",t.LANG_EN="lang/en.png",t.LANG_FR="lang/fr.png",t.LANG_POPUP="lang/popup.png",t.LANG_RU="lang/ru.png",t.LEADERBOARD_DUEL_ICONE="leaderboard/duel_icone.png",t.LEADERBOARD_GLOBAL_ICONE="leaderboard/global_icone.png",t.LEADERBOARD_LEADERBOARD="leaderboard/leaderboard.png",t.LEADERBOARD_LEADERBOARD_SLOT="leaderboard/leaderboard_slot.png",t.LEADERBOARD_PHOTO_PLACEHOLDER="leaderboard/photo_placeholder.png",t.LEADERBOARD_PROCESSING="leaderboard/processing.png",t.LEADERBOARD_RETURN="leaderboard/return.png",t.LIGHT="light.png",t.MAP_CANYON_ANGLE_BASE="map/canyon/angle_base.png",t.MAP_CANYON_ANGLE_BL="map/canyon/angle_bl.png",t.MAP_CANYON_ANGLE_BR="map/canyon/angle_br.png",t.MAP_CANYON_ANGLE_TL="map/canyon/angle_tl.png",t.MAP_CANYON_ANGLE_TR="map/canyon/angle_tr.png",t.MAP_CANYON_DEGRADE="map/canyon/degrade.png",t.MAP_CANYON_GROUND="map/canyon/ground.png",t.MAP_CANYON_ROCK_ARCHE="map/canyon/rock/arche.png",t.MAP_CANYON_ROCK_ROCK1="map/canyon/rock/rock1.png",t.MAP_CANYON_ROCK_ROCK2="map/canyon/rock/rock2.png",t.MAP_CANYON_ROCK_ROCK3="map/canyon/rock/rock3.png",t.MAP_CANYON_ROCK_ROCK4="map/canyon/rock/rock4.png",t.MAP_CANYON_TREE_1="map/canyon/tree/1.png",t.MAP_CANYON_TREE_2="map/canyon/tree/2.png",t.MAP_CANYON_TREE_3="map/canyon/tree/3.png",t.MAP_CITY_ANGLE_BASE="map/city/angle_base.png",t.MAP_CITY_ANGLE_LEFT="map/city/angle_left.png",t.MAP_CITY_ANGLE_RIGHT="map/city/angle_right.png",t.MAP_CITY_SIGN_CENTER="map/city/sign_center.png",t.MAP_CITY_SIGN_LEFT="map/city/sign_left.png",t.MAP_CITY_SIGN_RIGHT="map/city/sign_right.png",t.MAP_RACING_ELEMENT_1="map/racing/element_1.png",t.MAP_RACING_ELEMENT_2="map/racing/element_2.png",t.MONEY="money.png",t.ORBE="orbe.png",t.ORBE_LIFE="orbe_life.png",t.SCORE_0="score/0.png",t.SCORE_1="score/1.png",t.SCORE_2="score/2.png",t.SCORE_3="score/3.png",t.SCORE_4="score/4.png",t.SCORE_5="score/5.png",t.SCORE_6="score/6.png",t.SCORE_7="score/7.png",t.SCORE_8="score/8.png",t.SCORE_9="score/9.png",t.SCORE_BOX="score_box.png",t.SHINE="shine.png",t.TAMPON="tampon.png",t.TEXT="text.png",t.VEHICULES_CAR1_CAR1="vehicules/car1/car1.png",t.VEHICULES_CAR1_CAR1_DESTROYED="vehicules/car1/car1_destroyed.png",t.VEHICULES_CAR1_CAR1_LEFT="vehicules/car1/car1_left.png",t.VEHICULES_CAR1_CAR1_RIGHT="vehicules/car1/car1_right.png",t.VEHICULES_CAR1_SELECTION_1="vehicules/car1/selection_1.png",t.VEHICULES_CAR1_TRACE="vehicules/car1/trace.png",t.VEHICULES_CAR1_WHEEL1="vehicules/car1/wheel1.png",t.VEHICULES_CAR1_WHEEL2="vehicules/car1/wheel2.png",t.VEHICULES_CAR1_WHEEL3="vehicules/car1/wheel3.png",t.VEHICULES_CAR2_CAR2="vehicules/car2/car2.png",t.VEHICULES_CAR2_CAR2_DESTROYED="vehicules/car2/car2_destroyed.png",t.VEHICULES_CAR2_CAR2_LEFT="vehicules/car2/car2_left.png",t.VEHICULES_CAR2_CAR2_RIGHT="vehicules/car2/car2_right.png",t.VEHICULES_CAR2_SELECTION_2="vehicules/car2/selection_2.png",t.VEHICULES_CAR2_TRACE="vehicules/car2/trace.png",t.VEHICULES_CAR2_WHEEL1="vehicules/car2/wheel1.png",t.VEHICULES_CAR2_WHEEL2="vehicules/car2/wheel2.png",t.VEHICULES_CAR2_WHEEL3="vehicules/car2/wheel3.png",t.VEHICULES_CAR3_CAR3="vehicules/car3/car3.png",t.VEHICULES_CAR3_CAR3_DESTROYED="vehicules/car3/car3_destroyed.png",t.VEHICULES_CAR3_CAR3_LEFT="vehicules/car3/car3_left.png",t.VEHICULES_CAR3_CAR3_RIGHT="vehicules/car3/car3_right.png",t.VEHICULES_CAR3_SELECTION_3="vehicules/car3/selection_3.png",t.VEHICULES_CAR3_TRACE="vehicules/car3/trace.png",t.VEHICULES_CAR3_WHEEL1="vehicules/car3/wheel1.png",t.VEHICULES_CAR3_WHEEL2="vehicules/car3/wheel2.png",t.VEHICULES_CAR3_WHEEL3="vehicules/car3/wheel3.png",t.VEHICULES_CAR4_CAR4="vehicules/car4/car4.png",t.VEHICULES_CAR4_CAR4_DESTROYED="vehicules/car4/car4_destroyed.png",t.VEHICULES_CAR4_CAR4_LEFT="vehicules/car4/car4_left.png",t.VEHICULES_CAR4_CAR4_RIGHT="vehicules/car4/car4_right.png",t.VEHICULES_CAR4_SELECTION_4="vehicules/car4/selection_4.png",t.VEHICULES_CAR4_TRACE="vehicules/car4/trace.png",t.VEHICULES_CAR4_WHEEL1="vehicules/car4/wheel1.png",t.VEHICULES_CAR4_WHEEL2="vehicules/car4/wheel2.png",t.VEHICULES_CAR4_WHEEL3="vehicules/car4/wheel3.png",t.VEHICULES_CAR5_CAR5="vehicules/car5/car5.png",t.VEHICULES_CAR5_CAR5_DESTROYED="vehicules/car5/car5_destroyed.png",t.VEHICULES_CAR5_CAR5_LEFT="vehicules/car5/car5_left.png",t.VEHICULES_CAR5_CAR5_RIGHT="vehicules/car5/car5_right.png",t.VEHICULES_CAR5_SELECTION_5="vehicules/car5/selection_5.png",t.VEHICULES_CAR5_TRACE="vehicules/car5/trace.png",t.VEHICULES_CAR5_WHEEL1="vehicules/car5/wheel1.png",t.VEHICULES_CAR5_WHEEL2="vehicules/car5/wheel2.png",t.VEHICULES_CAR5_WHEEL3="vehicules/car5/wheel3.png",t.VEHICULES_CAR6_CAR6="vehicules/car6/car6.png",t.VEHICULES_CAR6_CAR6_DESTROYED="vehicules/car6/car6_destroyed.png",t.VEHICULES_CAR6_CAR6_LEFT="vehicules/car6/car6_left.png",t.VEHICULES_CAR6_CAR6_RIGHT="vehicules/car6/car6_right.png",t.VEHICULES_CAR6_SELECTION_6="vehicules/car6/selection_6.png",t.VEHICULES_CAR6_TRACE="vehicules/car6/trace.png",t.VEHICULES_CAR6_WHEEL1="vehicules/car6/wheel1.png",t.VEHICULES_CAR6_WHEEL2="vehicules/car6/wheel2.png",t.VEHICULES_CAR6_WHEEL3="vehicules/car6/wheel3.png",t.VEHICULES_DEBRIS="vehicules/debris.png",t.VERSUS="versus.png",t.WARNING="warning.png",t}();t.ASSETS=i}(GAME||(GAME={})),function(i){var t=function(){function t(){}return t.wheelCar1=[i.ASSETS.VEHICULES_CAR1_WHEEL1,i.ASSETS.VEHICULES_CAR1_WHEEL2,i.ASSETS.VEHICULES_CAR1_WHEEL3],t.wheelCar2=[i.ASSETS.VEHICULES_CAR2_WHEEL1,i.ASSETS.VEHICULES_CAR2_WHEEL2,i.ASSETS.VEHICULES_CAR2_WHEEL3],t.wheelCar3=[i.ASSETS.VEHICULES_CAR3_WHEEL1,i.ASSETS.VEHICULES_CAR3_WHEEL2,i.ASSETS.VEHICULES_CAR3_WHEEL3],t.wheelCar4=[i.ASSETS.VEHICULES_CAR4_WHEEL1,i.ASSETS.VEHICULES_CAR4_WHEEL2,i.ASSETS.VEHICULES_CAR4_WHEEL3],t.wheelCar5=[i.ASSETS.VEHICULES_CAR5_WHEEL1,i.ASSETS.VEHICULES_CAR5_WHEEL2,i.ASSETS.VEHICULES_CAR5_WHEEL3],t.wheelCar6=[i.ASSETS.VEHICULES_CAR6_WHEEL1,i.ASSETS.VEHICULES_CAR6_WHEEL2,i.ASSETS.VEHICULES_CAR6_WHEEL3],t.choc=[i.ASSETS.CHOC_CHOC_0,i.ASSETS.CHOC_CHOC_1,i.ASSETS.CHOC_CHOC_2,i.ASSETS.CHOC_CHOC_3,i.ASSETS.CHOC_CHOC_4,i.ASSETS.CHOC_CHOC_5,i.ASSETS.CHOC_CHOC_6,i.ASSETS.CHOC_CHOC_7,i.ASSETS.CHOC_CHOC_8,i.ASSETS.CHOC_CHOC_9],t.choc2=[i.ASSETS.CHOC2_CHOC2_0,i.ASSETS.CHOC2_CHOC2_1,i.ASSETS.CHOC2_CHOC2_2,i.ASSETS.CHOC2_CHOC2_3,i.ASSETS.CHOC2_CHOC2_4],t.explode=[i.ASSETS.EXPLOSION_EXPLODE0001,i.ASSETS.EXPLOSION_EXPLODE0002,i.ASSETS.EXPLOSION_EXPLODE0003,i.ASSETS.EXPLOSION_EXPLODE0004,i.ASSETS.EXPLOSION_EXPLODE0005,i.ASSETS.EXPLOSION_EXPLODE0006,i.ASSETS.EXPLOSION_EXPLODE0007,i.ASSETS.EXPLOSION_EXPLODE0008,i.ASSETS.EXPLOSION_EXPLODE0009,i.ASSETS.EXPLOSION_EXPLODE0010,i.ASSETS.EXPLOSION_EXPLODE0011,i.ASSETS.EXPLOSION_EXPLODE0012,i.ASSETS.EXPLOSION_EXPLODE0013,i.ASSETS.EXPLOSION_EXPLODE0014],t}();i.Anims=t}(GAME||(GAME={})),function(t){var i=function(){function t(){}return t.SESSION_COUNT="SESSION_COUNT",t.BEST_SCORE="BEST_SCORE",t.SEND_TO_LEADERBOARD="SEND_TO_LEADERBOARD",t.LANGUE="LANGUE",t.CAR_SELECTED="CAR_SELECTED",t.CAR_OWNED="CAR_OWNED",t.GOLD="GOLD",t}();t.DataKey=i}(GAME||(GAME={})),function(r){var t=function(e){function t(){var t=e.call(this)||this,i=h5ge.Sprite.fromFrame(r.ASSETS.MONEY);t.addChild(i),t.icone=i;var n=r.Storage.dataGet(r.DataKey.GOLD);n=n||0;var h=r.factory.newText(""+n,32);h.x=.5*(i.width-h.width),h.y=i.height+8;var s=r.factory.newText(""+n,32);return s.x=h.x,s.y=h.y+5,s.tint=0,t.addChild(s),t.addChild(h),t.count=h,t.shadow=s,t.setSizeFromChildren(),t}return __extends(t,e),t.prototype.refreshCount=function(){var t=r.Storage.dataGet(r.DataKey.GOLD);t=t||0,this.count.text=""+t,this.shadow.text=""+t,this.count.x=.5*(this.icone.width-this.count.width),this.shadow.x=this.count.x},t}(h5ge.Container);r.MoneyCount=t}(GAME||(GAME={})),function(t){var i=function(){function t(){}return t.FPS_LOG=!0,t}();t.Parameter=i}(GAME||(GAME={})),function(n){var t=function(){function t(t){this.conf=t}return t.prototype.get=function(){var t=this.conf[i.langue];return t||"TODO_"+i.langue},t}();n.SPEAK_KEY=t;var i=function(){function i(){}return i.getIcone=function(t){switch(t||(t=i.langue),t){case"en":return n.ASSETS.LANG_EN;case"fr":return n.ASSETS.LANG_FR;case"ru":return n.ASSETS.LANG_RU}return null},i.langueEnable=["en","fr","ru"],i.langue="en",i.LEADERBOARD_TOP=new t({en:"TOP",fr:"TOP",ru:"TOP"}),i.LEADERBOARD_DUEL=new t({en:"DUEL",fr:"DUEL",ru:"поединок"}),i.LEADERBOARD_GLOBALE=new t({en:"GLOBALE",fr:"MONDIAL",ru:"общий"}),i.READY=new t({en:"READY?",fr:"PRETS ?",ru:"ГОТОВЫ?"}),i.UNLOCK=new t({en:"UNLOCK",fr:"ACHETER",ru:"КУПИТЬ"}),i.GO=new t({en:"GO !",fr:"PARTEZ !",ru:"ПОЕХАЛИ!"}),i.NEW_BEST_SCORE=new t({en:"NEW RECORD",fr:"NOUVEAU RECORD",ru:"НОВЫЙ РЕКОРД"}),i.NOT_ENOUTH_MONEY=new t({en:"Not enough money",fr:"Pas assez d'argent",ru:"Недостаточно денег"}),i.PLAY=new t({en:"PLAY",fr:"JOUER",ru:"ИГРАТЬ"}),i.BUY=new t({en:"BUY",fr:"ACHETER",ru:"КУПИТЬ"}),i.LEADERBOARD_ENTER_NAME_1=new t({en:"Enter a name ",fr:"Entrez un nom pour accèder",ru:"Введите имя"}),i.LEADERBOARD_ENTER_NAME_2=new t({en:"to access the leaderboard",fr:"au tableau des scores",ru:"в таблицу"}),i.BEST=new t({en:"BEST",fr:"RECORD",ru:"РЕКОРД"}),i.TOUCH_TO_PLAY=new t({en:"Tap to play",fr:"Cliquer pour jouer",ru:"Нажмите, чтобы играть"}),i.BEST_SCORE=new t({en:"Best score",fr:"Meilleur score",ru:"Рекорд"}),i.SCORE=new t({en:"Score",fr:"Score",ru:"Ваши очки"}),i.GAME_OVER=new t({en:"Game over",fr:"Partie terminée",ru:"Игра окончена"}),i.LEVEL=new t({en:"Level",fr:"Niveau",ru:"Уровень"}),i.LEADERBOARD=new t({en:"Leaderboard",fr:"Tableau des scores",ru:"Таблица лидеров"}),i.LEADERBOARD_MY_RANK=new t({en:"My rank",fr:"Mon rang",ru:"Ваш ранг"}),i.LEADERBOARD_ME=new t({en:"Me",fr:"Moi",ru:"Вы"}),i.LEADERBOARD_MY_SCORE=new t({en:"My score",fr:"Mon score",ru:"Ваш счет"}),i.LEADERBOARD_3_LETTER_MIN=new t({en:"3 letters minimum!",fr:"3 lettres minimum !",ru:"Не менее 3 символов!"}),i.LEADERBOARD_9_LETTER_MAX=new t({en:"9 letters maximum!",fr:"9 lettres maximum !",ru:"Не более 9 символов!"}),i}();n.SPEAK=i}(GAME||(GAME={})),function(u){var t=function(){function r(){}return r.init=function(n){var t=[u.DataKey.GOLD,u.DataKey.LANGUE,u.DataKey.BEST_SCORE,u.DataKey.CAR_OWNED,u.DataKey.CAR_SELECTED];u.Game.get().dataManager.getDataAsync(t,function(t){for(var i in t)r.data[i]=t[i];r.data[u.DataKey.GOLD]||(r.data[u.DataKey.GOLD]=0),r.data[u.DataKey.BEST_SCORE]||(r.data[u.DataKey.BEST_SCORE]=0),n()})},r.dataGet=function(t){var i=r.data[t];return void 0===i?null:i},r.dataSave=function(t,i){for(var n={},h=0;h<t.length;h++){var s=t[h],e=i[h];n[s]=e,r.data[s]=e}u.Game.get().dataManager.setDataAsync(n)},r.submitScoreIfBetter=function(t){var i=u.Game.get().socialManager.getContextID();r.submitScoreIfBetter0(t,"score",!1,function(){}),null!=i&&r.submitScoreIfBetter0(t,"score",!0,function(t){t&&u.Game.get().scoreManager.postScoreUpdate("score",!0,null,function(){})})},r.submitScoreIfBetter0=function(n,h,s,e){var r=u.Game.get().scoreManager;r.getPlayerScore(h,s,function(t){var i=!1;null==t?i=!0:t.score<n&&(i=!0),i?(u.logger.debug("Submit "+n+" in "+h+", ctx? "+s),r.setScore(n,null,h,s,function(){e(!0)})):e(!1)})},r.data={},r}();u.Storage=t}(GAME||(GAME={})),function(t){var i=function(e){function t(t,i){var n=e.call(this)||this,h=new h5ge.Container,s=h5ge.Sprite.fromFrame(t);return n.icone=s,null!=i&&(s.scaleXY=i),s.x=.5*-s.width,s.y=.5*-s.height,h.addChild(s),h.x=.5*s.width,h.y=.5*s.height,n.addChild(h),s.overHandler.add(function(){h.scaleXY=1.1}),s.outHandler.add(function(){h.scaleXY=1}),n.setSize(s.width,s.height),n}return __extends(t,e),t.prototype.onClick=function(t,i){this.icone.onClick(t,i)},t}(h5ge.Container);t.Button=i}(GAME||(GAME={})),function(e){var t=function(){function s(){}return s.getTrueCarNb=function(t){return 6<t?1:t<1?6:t},s.getCarStat=function(t){switch(t){case 1:return{speed:-1,driving:4,life:5};case 2:return{speed:0,driving:5,life:7};case 3:return{speed:1,driving:5,life:9};case 4:return{speed:2,driving:6,life:11};case 5:return{speed:3,driving:6,life:13};case 6:return{speed:3,driving:7,life:15}}return null},s.getMyCar=function(){var t=e.Storage.dataGet(e.DataKey.CAR_SELECTED);return t||1},s.setMyCar=function(t){e.Storage.dataSave([e.DataKey.CAR_SELECTED],[s.getTrueCarNb(t)])},s.isOwned=function(t){if(null==s.car_owned){s.car_owned=[];var i=e.Storage.dataGet(e.DataKey.CAR_OWNED);if(i)for(var n=i.split(","),h=0;h<n.length;h++)s.car_owned.push(parseInt(n[h]))}if(1==t)return!0;for(h=0;h<s.car_owned.length;h++)if(t==s.car_owned[h])return!0;return!1},s.unlockCar=function(t){s.car_owned.push(t);for(var i="",n=s.car_owned.length,h=0;h<n;h++)i+=s.car_owned[h]+(h==n-1?"":",");e.Storage.dataSave([e.DataKey.CAR_OWNED],[i])},s.getCarPrice=function(t){switch(t){case 2:return 2e3;case 3:return 7500;case 4:return 2e4;case 5:return 4e4;case 6:return 1e5}return 0},s.getWheelAnim=function(t){switch(t){case 1:return e.Anims.wheelCar1;case 2:return e.Anims.wheelCar2;case 3:return e.Anims.wheelCar3;case 4:return e.Anims.wheelCar4;case 5:return e.Anims.wheelCar5;case 6:return e.Anims.wheelCar6}return null},s.getIdleFrame=function(t){return"vehicules/car"+t+"/car"+t+".png"},s.getLeftFrame=function(t){return"vehicules/car"+t+"/car"+t+"_left.png"},s.getRightFrame=function(t){return"vehicules/car"+t+"/car"+t+"_right.png"},s.getIllustrationFrame=function(t){return"vehicules/car"+t+"/selection_"+t+".png"},s.getTraceFrame=function(t){return"vehicules/car"+t+"/trace.png"},s.getDestroyedFrame=function(t){return"vehicules/car"+t+"/car"+t+"_destroyed.png"},s.CAR_1=1,s.CAR_2=2,s.CAR_3=3,s.CAR_4=4,s.CAR_5=5,s.CAR_6=6,s.car_owned=null,s}();e.Car=t}(GAME||(GAME={})),function(o){var t=function(u){function t(t){var i=u.call(this)||this;i.goldProgress=0,i.goldQty=t,i.step=t<=0?1:Math.max(1,Math.floor(25/t)),i.nextDelay=t<=0?0:Math.ceil(1e3/(t/i.step));var n=h5ge.Sprite.fromFrame(o.ASSETS.CONVERT_ARROW);n.x=.5*-n.width,n.y=.5*-n.height;var h=o.factory.newText("x"+t,30);h.x=n.x-h.width-32,h.y=.5*-h.height,h.tint=15452948;var s=h5ge.Sprite.fromFrame(o.ASSETS.ITEM_GOLD);s.x=h.x-s.width-8,s.y=.5*-s.height;var e=h5ge.Sprite.fromFrame(o.ASSETS.MONEY);e.scaleXY=.8,e.y=.5*-e.height,e.x=n.x+n.width+16;var r=o.factory.newText("+"+10*t,30);return r.y=.5*-r.height,r.x=e.x+e.width+8,r.tint=15452948,i.addChild(e),i.addChild(r),i.addChild(n),i.addChild(s),i.addChild(h),i.goldText=h,i.moneyText=r,i.goldText.text="",i.moneyText.text="",i}return __extends(t,u),t.prototype.buildEffect=function(){for(var t=0;t<1;t++){var i=this.newExplodeParticule();i.x=this.moneyText.x+.5*this.moneyText.width,this.addChild(i)}},t.prototype.newExplodeParticule=function(){var i=new o.ParticuleH5,n=h5ge.Sprite.fromFrame(o.ASSETS.ORBE);n.tint=15452948,n.setPivotToCenter(),n.x=.5*-n.width,n.y=.5*-n.height,n.rotation=Math.random()*Math.PI*2;var h=.1+.6*Math.random();n.scaleXY=h,i.addChild(n);var t=.8*Math.PI+1.4*Math.PI*Math.random();return i.setData("vecX",100*Math.cos(t)),i.setData("vecY",100*Math.sin(t)),i.setData("z",-1),i.setData("y",0),i.setData("vecZ",-300*Math.random()-400),i.setBehavior(function(){var t=o.System.dt;i.data.z<0?(n.scaleXY=h+.005*-i.data.z,n.x+=i.data.vecX*t,n.y=i.data.y+.5*i.data.z,i.data.z+=i.data.vecZ*t,i.data.y+=i.data.vecY*t,i.data.vecZ+=1600*t):(i.stopUpdatable(),i.removeSelf())}),i},t.prototype.getMoney=function(){return 10*this.goldQty},t.prototype.refresh=function(){if(0<this.goldQty&&(this.goldProgress=Math.min(this.goldQty,this.goldProgress+this.step)),this.goldText.text="x"+this.goldProgress,this.moneyText.text="+"+10*this.goldProgress,this.buildEffect(),this.goldProgress<this.goldQty){var t=this;h5ge.TimeManager.createAndStartTimer(this.nextDelay,function(){t.refresh.apply(t)})}},t}(h5ge.Container);o.GoldToMoney=t}(GAME||(GAME={})),function(o){var t=function(h){function e(t){var i=h.call(this)||this;i.update=null,i.type=t;var n=h5ge.Sprite.fromFrame(i.getIconeFrame());return n.x=.5*-n.width,n.y=.5*-n.height,i.addChild(n),i.update=i.getUpdate(t),i.setSize(n.width,n.height),i}return __extends(e,h),e.prototype.getUpdate=function(t){switch(t){case e.TYPE_LIFE:case e.TYPE_GOLD:return this.updateClassic;case e.TYPE_CACTUS:case e.TYPE_BARREL:case e.TYPE_CONE:return this.updateCactus}return null},e.prototype.updateClassic=function(t){this.scaleXY=1+.05*Math.sin(.1*o.System.tickcount)},e.prototype.updateCactus=function(t){},e.prototype.buildEffect=function(t,i,n,h){if(!(t<=0)){var s=new o.ParticuleH5,e=h5ge.Sprite.fromFrame(n);e.setPivotToCenter(),e.x=.5*-e.width,e.y=.5*-e.height,e.rotation=Math.random()*Math.PI*2;var r=.1*h+.6*Math.random()*h;e.scaleXY=r,e.tint=i,s.addChild(e);var u=.8*Math.PI+1.4*Math.PI*Math.random();s.setData("vecX",300*Math.cos(u)),s.setData("vecY",300*Math.sin(u)),s.setData("z",-3),s.setData("y",0),s.setData("vecZ",-600*Math.random()-800),s.setBehavior(function(){var t=o.System.dt;e.scaleXY=r+.002*-s.data.z,e.x+=s.data.vecX*t,e.y=s.data.y+.5*s.data.z,s.data.z+=s.data.vecZ*t,s.data.y+=s.data.vecY*t,s.data.vecZ+=6e3*t,e.scaleXY<=0&&s.removeSelf()}),s.x=this.x,s.y=o.Game.get().height-200,o.SceneGame.get().layRoad.addChild(s),this.buildEffect(t-1,i,n,h)}},e.prototype.fireDroped=function(){if(this.type==e.TYPE_GOLD){var t=o.ASSETS.ORBE,i=15778841;o.SceneGame.get().addGold.apply(o.SceneGame.get());var n=3;this.buildEffect(n,i,t,1);var h=o.SoundManager.play("coins_collected");o.SoundManager.get().sound.setVolume(.4+.4*Math.random(),h)}else if(this.type==e.TYPE_LIFE){t=o.ASSETS.ORBE_LIFE,i=16711680,o.SceneGame.get().lifeBar;o.SceneGame.get().addLife.apply(o.SceneGame.get());n=6;this.buildEffect(n,i,t,1.5);var s=o.SoundManager.play("life")}else if(this.type==e.TYPE_BARREL){s=o.SoundManager.play("barrel");o.SoundManager.get().sound.setVolume(4,s),this.explodeBarrel()}else if(this.type==e.TYPE_CACTUS){this.explodeCactus();s=o.SoundManager.play("rock");o.SoundManager.get().sound.setVolume(.6,s)}else if(this.type==e.TYPE_CONE){s=o.SoundManager.play("cone_"+Math.ceil(2*Math.random()));o.SoundManager.get().sound.rate(.9+.2*Math.random(),s),o.SoundManager.get().sound.setVolume(.8+.4*Math.random(),s),this.explodeCone()}this.removeSelf()},e.prototype.explodeCone=function(){var t=o.ParticuleH5.newExplode(3,o.ASSETS.CONE_PARTICULE,void 0,1.5,.5,1);t.x=this.x,t.y=this.y,this.parent.addChild(t),o.SceneGame.get().speedCar.speed-=50,o.SceneGame.get().shake(.3),o.SceneGame.get().lifeBar.addLife(-.2)},e.prototype.explodeBarrel=function(){var t;(t=o.ParticuleH5.newExplode(6,o.ASSETS.BARREL_PARTICULE,void 0,1.5,.5,1)).x=this.x,t.y=this.y,this.parent.addChild(t),(t=o.ParticuleH5.newExplode(8,o.ASSETS.BARREL_PARTICULE,void 0,3,.3,.3)).x=this.x,t.y=this.y,this.parent.addChild(t),o.SceneGame.get().speedCar.speed-=300,o.SceneGame.get().shake(.5),o.SceneGame.get().lifeBar.addLife(-1)},e.prototype.explodeCactus=function(){var t;(t=o.ParticuleH5.newExplode(3,o.ASSETS.CACTUS_PARTICULE,void 0,1.5,.5,1)).x=this.x,t.y=this.y,this.parent.addChild(t),(t=o.ParticuleH5.newExplode(4,o.ASSETS.CACTUS_PARTICULE,void 0,3,.3,.3)).x=this.x,t.y=this.y,this.parent.addChild(t),o.SceneGame.get().speedCar.speed-=300,o.SceneGame.get().shake(.5),o.SceneGame.get().lifeBar.addLife(-1)},e.prototype.getIconeFrame=function(){switch(this.type){case e.TYPE_GOLD:return o.ASSETS.ITEM_GOLD;case e.TYPE_LIFE:return o.ASSETS.ITEM_LIFE;case e.TYPE_CACTUS:return o.ASSETS.CACTUS;case e.TYPE_BARREL:return o.ASSETS.BARRIL;case e.TYPE_CONE:return o.ASSETS.ITEM_CONE}return null},e.TYPE_GOLD="TYPE_GOLD",e.TYPE_LIFE="TYPE_LIFE",e.TYPE_CACTUS="TYPE_CACTUS",e.TYPE_BARREL="TYPE_BARREL",e.TYPE_CONE="TYPE_CONE",e}(h5ge.Container);o.Item=t}(GAME||(GAME={})),function(a){var t=function(f){function t(){var t=f.call(this)||this,i=h5ge.Sprite.fromFrame(a.ASSETS.LIGHT);i.width=934,i.height=a.Game.get().height,i.alpha=0,i.x=.5*(a.Game.get().width-934),t.addChild(i),i.onClick(t.removeSelf,t);var n=new h5ge.Container,h=h5ge.Sprite.fromFrame(a.ASSETS.LANG_POPUP);h.x=.5*-h.width,h.y=.5*-h.height,n.addChild(h);for(var s=new h5ge.Container,e=a.SPEAK.langueEnable,r=0;r<e.length;r++){var u=e[r],o=t.getButton(u);o.x=(o.width+16)*r,s.addChild(o)}return s.setSizeFromChildren(),s.x=.5*-s.width,s.y=.5*-s.height,n.addChild(s),n.x=.5*a.Game.get().width,n.y=.5*a.Game.get().height,t.addChild(n),t}return __extends(t,f),t.prototype.getButton=function(t){var i=new a.Button(a.SPEAK.getIcone(t)),n=this;return i.onClick(function(){n.fireChange(t)},n),i},t.prototype.fireChange=function(t){a.SPEAK.langue!=t&&(a.SPEAK.langue=t,a.Storage.dataSave([a.DataKey.LANGUE],[t]),this.te&&this.te()),this.removeSelf()},t.prototype.onChange=function(t){this.te=t},t}(h5ge.Container);a.LanguePopup=t}(GAME||(GAME={})),function(e){var t=function(s){function t(t){var i=s.call(this)||this,n=h5ge.Sprite.fromFrame(e.ASSETS.BAR_EMPTY);n.width=.65*e.Game.get().width,i.addChild(n),i.progressBar=h5ge.Sprite.fromFrame(e.ASSETS.BAR_FULL),i.progressBar.width=n.width,i.ie=i.progressBar.width,i.addChild(i.progressBar),i.value=t,i.lifeMax=t;var h=h5ge.Sprite.fromFrame(e.ASSETS.BAR_LIFE_ICONE);return h.x=n.width,h.y=n.height-h.height+10,i.addChild(h),i.setSizeFromChildren(),i}return __extends(t,s),t.prototype.onDie=function(t){this.ne=t},t.prototype.fireDie=function(){this.ne&&this.ne()},t.prototype.getLifeRatio=function(){return this.value/this.lifeMax},t.prototype.addLife=function(t){this.value=this.value+t,this.value<0&&(this.value=0),this.value>this.lifeMax&&(this.value=this.lifeMax),this.refreshBar(),0==this.value&&1!=this.die&&this.fireDie()},t.prototype.refreshBar=function(){var t=this.value/this.lifeMax;this.progressBar.width=this.ie*t},t}(h5ge.Container);e.LifeBar=t}(GAME||(GAME={})),function(h){var t=function(n){function t(t){var i=n.call(this)||this;return i.score=0,i.txt=h.factory.newTextDigit("0",90),i.txt.x=.5*-i.txt.width,i.txt.y=.5*-i.txt.height,null!=t&&(i.txt.tint=t),i.txtShadow=h.factory.newTextDigit("0",90),i.txtShadow.x=i.txt.x,i.txtShadow.y=i.txt.y+6,i.txtShadow.tint=0,i.addChild(i.txtShadow),i.addChild(i.txt),i}return __extends(t,n),t.prototype.getScore=function(){return this.score},t.prototype.refreshScore=function(t){t!=this.score&&(this.score=t,this.txt.text=""+this.score,this.txt.x=.5*-this.txt.width,this.txt.y=.5*-this.txt.height,this.txtShadow.text=this.txt.text,this.txtShadow.x=this.txt.x,this.txtShadow.y=this.txt.y+6)},t.prototype.addScore=function(t){this.score+=t,this.txt.text=""+this.score,this.txt.x=.5*-this.txt.width,this.txt.y=.5*-this.txt.height,this.txtShadow.text=this.txt.text,this.txtShadow.x=this.txt.x,this.txtShadow.y=this.txt.y+6},t}(h5ge.Container);h.Score=t}(GAME||(GAME={})),function(o){var t=function(c){function t(t,i){var n=c.call(this)||this;n.he=null;for(var h=1;h<t;)h*=10;var s=0,e=new h5ge.Container,r=0;for(t<h&&(h/=10);1<=h;){var u=Math.floor(t/h);t%=h,h/=10;var o=h5ge.Sprite.fromFrame(n.getFrame(u));null!=i&&(o.tint=i);var f=o.width,a=n.getParticule(o,.2*r++,h<1);a.x=s+.5*f,s=a.x+.5*f+10,e.addChild(a)}return e.x=.5*-s,n.addChild(e),n}return __extends(t,c),t.prototype.onEnd=function(t){this.he=t},t.prototype.getParticule=function(i,n,h){var s=new o.ParticuleH5;i.setPivotToCenter();var e=.5*-i.height;i.x=.5*-i.width,i.y=.5*-i.height,i.scaleXY=5,i.y+=-1e3;var r=900;s.addChild(i);var u=this;return s.setBehavior(function(){var t=o.System.dt;if((n-=1*t)<0&&(r+=80,i.y=Math.min(e,i.y+r*t),i.scaleXY=1+i.y/-1e3*4,i.y==e)){o.SoundManager.play("score_choc");s.stopUpdatable(),h&&u.he&&u.he(),o.SceneGame.get().shake(1)}}),s},t.prototype.getFrame=function(t){return"score/"+t+".png"},t}(h5ge.Container);o.ScoreSplash=t}(GAME||(GAME={})),function(t){var i=function(){function t(t,i){this.frequence=t/i,this.lastCheckTime=Date.now(),this.startTime=null,this.qtySpawn=0}return t.prototype.setFrequence=function(t,i){this.frequence=t/i,this.startTime=Date.now(),this.qtySpawn=0},t.prototype.haveToSpawn=function(){var t=Date.now();null==this.startTime&&(this.startTime=t);var i=.001*(t-this.lastCheckTime),n=this.frequence*(t-this.startTime)*.001,h=this.qtySpawn<n?5:this.qtySpawn>n?.1:1,s=Math.random()<this.frequence*i*h;return this.lastCheckTime=t,s&&(this.qtySpawn+=1),s},t}();t.Spawner=i}(GAME||(GAME={})),function(r){var t=function(n){function t(){var t=n.call(this)||this;t.lastTickCount=0,t.speedMin=800,t.speedMax=1400,t.speedAcc=10,t.turnAcc=3,t.turnMax=.35*Math.PI,t.outCarLoopId=null,t.soundSpeed=1,t.traceAlpha=.3,t.delayLoseLife=0,t.blockingCollision=!0,t.lastTickCount=r.System.tickcount,t.speedChoc=0,t.lastTraceBack=null,t.lastTraceFront=null,t.turning=!1,t.speed=t.speedMin,t.car=r.Car.getMyCar();var i=r.Car.getCarStat(t.car);return t.speedMin=800+100*i.speed,t.speedMax=t.speedMin+600,t.turnAcc=.5*i.driving,t.idleTexture=h5ge.Texture.fromFrame(r.Car.getIdleFrame(t.car)),t.leftTexture=h5ge.Texture.fromFrame(r.Car.getLeftFrame(t.car)),t.rightTexture=h5ge.Texture.fromFrame(r.Car.getRightFrame(t.car)),t.idle=new h5ge.Sprite(t.idleTexture),t.idle.setPivotToCenter(),t.idleWidth=t.idle.width,t.idleHeight=t.idle.height,t.idle.y=.5*-t.idle.height,t.idle.x=.5*-t.idleWidth,t.idle.scaleXY=.6,t.widthCollision=.9*t.idle.width,t.wheel=new r.AnimationH5,t.wheel.addAnimationFromTable("main",r.Car.getWheelAnim(t.car)),t.wheel.setPivotToCenter(),t.wheel.x=.5*-t.wheel.width,t.wheel.y=.5*-t.wheel.height,t.wheel.scaleXY=.6,t.wheel.speed=25,t.wheel.stopUdatable(),t.wheel.setLooping(),t.addChild(t.wheel),t.addChild(t.idle),t.setSizeFromChildren(),t.soundBrakeId=r.SoundManager.play("wheel_brake"),r.SoundManager.get().sound.loop(!0,t.soundBrakeId),r.SoundManager.get().sound.setVolume(0,t.soundBrakeId),t.brakeVolume=0,t.carSoundId=r.SoundManager.play("car_loop_1"),r.SoundManager.get().sound.loop(!0,t.carSoundId),r.SoundManager.get().sound.setVolume(2,t.carSoundId),t}return __extends(t,n),t.prototype.noBlockingCollision=function(){this.outCarLoopId=r.SoundManager.play("out_racing_loop"),r.SoundManager.get().sound.loop(!0,this.outCarLoopId),r.SoundManager.get().sound.setVolume(0,this.outCarLoopId),this.blockingCollision=!1},t.prototype.buildTrace=function(){var t=r.Car.getTraceFrame(this.car),i=new r.ParticuleH5,n=h5ge.Sprite.fromFrame(t);n.setPivot(.5*n.width,0),n.x=.5*-n.width,n.scaleXY=this.idle.scaleXY,n.alpha=this.traceAlpha,i.addChild(n),i.setBehavior(function(){i.alpha-=1*r.System.dt,i.alpha<=0&&i.removeSelf()}),i.x=this.x,i.y=this.y+10,this.lastTraceBack&&(n.height=r.System.distance(this.lastTraceBack.x,this.lastTraceBack.y,i.x,i.y),i.rotation=r.System.angle(i.x,i.y,this.lastTraceBack.x,this.lastTraceBack.y)-.5*Math.PI,this.lastTraceBack=i),this.lastTraceBack=i,this.parent.addChildAt(i,0);var h=new r.ParticuleH5;(n=h5ge.Sprite.fromFrame(t)).setPivot(.5*n.width,0),n.x=.5*-n.width,n.scaleXY=this.idle.scaleXY,n.alpha=this.traceAlpha,h.addChild(n),h.setBehavior(function(){h.alpha-=1*r.System.dt,0==h.alpha&&h.removeSelf()}),h.x=this.x+50*Math.cos(this.rotation-.5*Math.PI),h.y=this.y+50*Math.sin(this.rotation-.5*Math.PI),this.lastTraceFront&&(n.height=r.System.distance(this.lastTraceFront.x,this.lastTraceFront.y,h.x,h.y),h.rotation=r.System.angle(h.x,h.y,this.lastTraceFront.x,this.lastTraceFront.y)-.5*Math.PI,this.lastTraceFront=h),this.lastTraceFront=h,this.parent.addChildAt(h,0)},t.prototype.getCurrentSpeed=function(){return this.speed},t.prototype.setTraceAlpha=function(t){this.traceAlpha=t},t.prototype.collid=function(t){if(!this.dead)if(this.delayLoseLife<=0&&(r.SceneGame.get().lifeBar.addLife(-1),1!=this.blockingCollision&&(this.delayLoseLife=15)),this.blockingCollision){this.rotation=0;var i=r.SoundManager.play("car_choc");r.SoundManager.get().sound.setVolume(.7+.3*Math.random(),i),t.min?(this.x=Math.max(t.min+.5*this.widthCollision,this.x),this.collidLeft()):(this.x=Math.min(t.max-.5*this.widthCollision,this.x),this.collidRight())}else r.SoundManager.get().sound.setVolume(1,this.outCarLoopId)},t.prototype.die=function(){this.dead||(r.SoundManager.get().sound.stop(this.soundBrakeId),r.SoundManager.get().sound.stop(this.carSoundId),this.outCarLoopId&&r.SoundManager.get().sound.stop(this.outCarLoopId),this.dead=!0,this.dead=!0,this.idle.setTexture(h5ge.Texture.fromFrame(r.Car.getDestroyedFrame(this.car))),this.wheel.visible=!1,this.buildExplode())},t.prototype.buildExplode=function(){var t=r.SoundManager.play("car_explode");r.SoundManager.get().sound.setVolume(.3,t);var i=new r.AnimationH5;i.addAnimationFromTable("main",r.Anims.explode),i.speed=25,i.setPivotToCenter(),i.x=.5*-i.width+this.x,i.y=.5*-i.height+this.y,i.scaleXY=1.5,i.onEnd(function(){i.stopUdatable(),i.removeSelf()}),r.SceneGame.get().map.addChild(i);for(var n=0;n<5;n++){var h=this.newExplodeParticule();h.x=i.x,h.y=i.y,r.SceneGame.get().map.addChild(h)}},t.prototype.isDead=function(){return this.dead},t.prototype.newExplodeParticule=function(){var i=new r.ParticuleH5,n=h5ge.Sprite.fromFrame(r.ASSETS.VEHICULES_DEBRIS);n.setPivotToCenter(),n.x=.5*-n.width,n.y=.5*-n.height,n.rotation=Math.random()*Math.PI*2;var h=.1+.6*Math.random();n.scaleXY=h,i.addChild(n);var t=.8*Math.PI+1.4*Math.PI*Math.random();return i.setData("vecX",300*Math.cos(t)),i.setData("vecY",300*Math.sin(t)),i.setData("z",-1),i.setData("y",0),i.setData("vecZ",-300*Math.random()-400),i.setBehavior(function(){var t=r.System.dt;i.data.z<0?(n.scaleXY=h+.005*-i.data.z,n.x+=i.data.vecX*t,n.y=i.data.y+.5*i.data.z,i.data.z+=i.data.vecZ*t,i.data.y+=i.data.vecY*t,i.data.vecZ+=1600*t):i.stopUpdatable()}),i},t.prototype.collidLeft=function(){var t=new r.AnimationH5;t.addAnimationFromTable("main",r.Anims.choc),t.speed=30,t.onEnd(function(){t.destroy.apply(t)}),t.rotation=this.rotation+.5*Math.PI,t.setPivotToCenter(),t.x=this.x-.5*t.width,t.y=this.y-.5*t.height-40,this.parent.addChild(t)},t.prototype.collidRight=function(){var t=new r.AnimationH5;t.addAnimationFromTable("main",r.Anims.choc),t.speed=30,t.onEnd(function(){t.destroy.apply(t)}),t.rotation=this.rotation-.5*Math.PI,t.setPivotToCenter(),t.x=this.x-.5*t.width,t.y=this.y-.5*t.height-40,t.width=-t.width,this.parent.addChild(t)},t.prototype.turnLeft=function(){if(!this.dead){this.turning=!0,this.idle.setTexture(this.leftTexture),this.widthCollision=.5*this.idle.width;r.Game.get().width;0<this.rotation&&(this.rotation=Math.max(-this.turnMax,this.rotation-this.turnAcc*r.System.dt)),this.rotation=Math.max(-this.turnMax,this.rotation-this.turnAcc*r.System.dt)}},t.prototype.noTurn=function(){this.dead||(this.idle.setTexture(this.idleTexture),this.widthCollision=.9*this.idle.width)},t.prototype.boost=function(){},t.prototype.turnRight=function(){this.dead||(this.idle.setTexture(this.rightTexture),this.turning=!0,this.widthCollision=.5*this.idle.width,this.rotation<0&&(this.rotation=Math.min(this.turnMax,this.rotation+this.turnAcc*r.System.dt)),this.rotation=Math.min(this.turnMax,this.rotation+this.turnAcc*r.System.dt))},t.prototype.choc=function(){this.speedChoc=500},t.prototype.update=function(t){var i=.001*t;if(!this.dead){this.delayLoseLife-=1,1!=this.turning&&(this.rotation=r.System.move(0,this.rotation,Math.PI*(.5+this.turnAcc/3)*i)),this.speedMin+=this.speedAcc*i,this.speed=Math.min(this.speedMax,r.System.move(this.speedMin,this.speed)),this.turning=!1,this.wheel.update(t);var n=this.speed/600;this.wheel.speed=20*n,this.soundSpeed=r.System.move(.5+this.speed*Math.pow(Math.sin(this.rotation+.5*Math.PI),2)/600*2+.3*Math.random(),this.soundSpeed),r.SoundManager.get().sound.rate(this.soundSpeed,this.carSoundId);var h=.5*Math.max(0,-.2+Math.abs(Math.sin(this.rotation)));this.brakeVolume=r.System.move(h,this.brakeVolume),r.SoundManager.get().sound.setVolume(this.brakeVolume,this.soundBrakeId);var s=this.speed*Math.cos(this.rotation-.5*Math.PI),e=this.speed*Math.sin(this.rotation-.5*Math.PI);this.x+=s*i,this.y+=e*i,r.System.everyXTick(4)&&this.buildTrace(),null!==this.outCarLoopId&&r.SoundManager.get().sound.setVolume(0,this.outCarLoopId)}},t}(h5ge.Container);r.SpeedCar=t}(GAME||(GAME={})),function(n){var t=function(i){function t(){var t=i.call(this,h5ge.Texture.fromFrame(n.ASSETS.WARNING))||this;return t.setPivotToCenter(),t.detachListener.add(t.stopUpdatable,t),t.addUpdatable(),t}return __extends(t,i),t.prototype.addUpdatable=function(){1!=this.updatable&&(this.updatable=!0,n.Game.get().addUpdatable(this))},t.prototype.stopUpdatable=function(){1==this.updatable&&(this.updatable=!1,n.Game.get().removeUpdatable(this))},t.prototype.update=function(t){this.alpha=Math.sin(.5*n.System.tickcount)<0?.5:1},t}(h5ge.Sprite);n.Warning=t}(GAME||(GAME={})),function(u){var t=function(n){function r(t){var i=n.call(this)||this;return i.falaiseL=null,i.lineL=null,i.falaiseR=null,i.lineR=null,i.road=null,i.triangleL=null,i.triangleR=null,i.visuLeft=!1,i.visuRight=!1,i.contLine=new h5ge.Container,i.build(t),i.buildLeft(t.a,t.b),i.buildRight(t.d,t.c),i}return __extends(r,n),r.prototype.init=function(){},r.prototype.build=function(t){null==this.road&&(this.road=h5ge.Sprite.fromFrame(u.ASSETS.MAP_CANYON_GROUND),this.road.height+=2),this.road.mask=new h5ge.Mask;var i=t.a.y-t.b.y;this.road.mask.moveTo(t.a.x,i),this.road.mask.lineTo(t.b.x,0),this.road.mask.lineTo(t.c.x,0),this.road.mask.lineTo(t.d.x,i),null==this.bodyL&&(this.bodyL=h5ge.Sprite.fromFrame(u.ASSETS.LIGHT),this.bodyL.tint=r.GROUND_TINT,this.addChild(this.bodyL));var n=u.System.distance(t.a.x,t.a.y,t.b.x,t.b.y);this.bodyL.width=n,this.bodyL.height=r.LARGE_BANDE_WIDTH;var h=u.System.angle(t.a.x,t.a.y,t.b.x,t.b.y);this.bodyL.rotation=h,this.bodyL.x=t.a.x-Math.cos(this.bodyL.rotation+.5*Math.PI)*r.LARGE_BANDE_WIDTH,this.bodyL.y=-Math.sin(this.bodyL.rotation+.5*Math.PI)*r.LARGE_BANDE_WIDTH,null==this.triangleL&&(this.triangleL=h5ge.Sprite.fromFrame(u.ASSETS.MAP_CANYON_ANGLE_TL),this.triangleL.tint=r.GROUND_TINT,this.addChild(this.triangleL)),this.triangleL.width=Math.cos(this.bodyL.rotation+.5*Math.PI)*r.LARGE_BANDE_WIDTH,0<=Math.cos(h)?(this.triangleL.setTexture(h5ge.Texture.fromFrame(u.ASSETS.MAP_CANYON_ANGLE_BL)),this.triangleL.height=Math.sin(this.bodyL.rotation+.5*Math.PI)*r.LARGE_BANDE_WIDTH+5,this.triangleL.y=-this.triangleL.height,this.triangleL.x=t.a.x-this.triangleL.width):(this.triangleL.setTexture(h5ge.Texture.fromFrame(u.ASSETS.MAP_CANYON_ANGLE_TL)),this.triangleL.height=-Math.sin(this.bodyL.rotation+.5*Math.PI)*r.LARGE_BANDE_WIDTH+5,this.triangleL.y=t.b.y-t.a.y,this.triangleL.x=t.b.x-this.triangleL.width),null==this.bodyR&&(this.bodyR=h5ge.Sprite.fromFrame(u.ASSETS.LIGHT),this.bodyR.tint=r.GROUND_TINT,this.addChild(this.bodyR));var s=u.System.distance(t.d.x,t.d.y,t.c.x,t.c.y);this.bodyR.width=s,t.d.x<=t.c.x&&(this.bodyR.width+=20),this.bodyR.height=r.LARGE_BANDE_WIDTH;var e=u.System.angle(t.d.x,t.d.y,t.c.x,t.c.y);this.bodyR.rotation=e,this.bodyR.x=t.d.x,null==this.triangleR&&(this.triangleR=h5ge.Sprite.fromFrame(u.ASSETS.MAP_CANYON_ANGLE_TR),this.triangleR.tint=r.GROUND_TINT,this.addChild(this.triangleR)),this.triangleR.width=Math.cos(this.bodyR.rotation+.5*Math.PI)*r.LARGE_BANDE_WIDTH,Math.cos(e)<=0?(this.triangleR.setTexture(h5ge.Texture.fromFrame(u.ASSETS.MAP_CANYON_ANGLE_BR)),this.triangleR.height=-Math.sin(this.bodyR.rotation+.5*Math.PI)*r.LARGE_BANDE_WIDTH+5,this.triangleR.y=-this.triangleR.height,this.triangleR.x=t.d.x):(this.triangleR.setTexture(h5ge.Texture.fromFrame(u.ASSETS.MAP_CANYON_ANGLE_TR)),this.triangleR.height=Math.sin(this.bodyR.rotation+.5*Math.PI)*r.LARGE_BANDE_WIDTH+5,this.triangleR.y=t.c.y-t.d.y,this.triangleR.x=t.c.x)},r.prototype.rebuild=function(t){this.visuLeft=!1,this.visuRight=!1,this.build(t),this.buildLeft(t.a,t.b),this.buildRight(t.d,t.c)},r.prototype.kill=function(){this.road.removeSelf(),this.contLine.removeSelf(),null==r.recycleList&&(r.recycleList=new u.ListH5),r.recycleList.addToList(new u.ListElemH5(this)),this.removeSelf()},r.getNewGround=function(t){if(r.recycleList&&null!=r.recycleList.start){var i=r.recycleList.start.content;return r.recycleList.removeFromList(r.recycleList.start),i.rebuild(t),i}return i=new r(t)},r.prototype.buildLeft=function(t,i){var n=i.y-t.y,h=u.SceneGame.get().color,s=Math.abs(i.x-t.x)/40;if(i.x>t.x){this.visuLeft=!0;var e=this.falaiseL;null==e&&(e=h5ge.Sprite.fromFrame(u.ASSETS.MAP_CANYON_ANGLE_BASE),this.addChildAt(e,0),this.falaiseL=e),e.x=t.x,e.y=n,e.width=i.x-t.x,e.tint=u.System.rgbVar(h.falaise_rgb1.r,h.falaise_rgb1.g,h.falaise_rgb1.b,h.falaise_rgb2.r,h.falaise_rgb2.g,h.falaise_rgb2.b,s),e.visible=!0}else this.falaiseL&&(this.falaiseL.visible=!1);Math.min(t.x,i.x);var r=this.lineL;null==r?(r=new h5ge.Graphics,this.contLine.addChild(r),this.lineL=r):r.clear(),r.beginStroke(6,0,.6),r.moveTo(0,0),r.lineTo(i.x-t.x,i.y-t.y),r.x=t.x,r.endStroke()},r.prototype.buildRight=function(t,i){var n=i.y-t.y,h=Math.abs(i.x-t.x)/40,s=u.SceneGame.get().color;if(i.x<t.x){this.visuRight=!0;var e=this.falaiseR;null==e&&(e=h5ge.Sprite.fromFrame(u.ASSETS.MAP_CANYON_ANGLE_BASE),this.addChildAt(e,0),this.falaiseR=e),e.x=t.x,e.y=n,e.width=i.x-t.x,e.tint=u.System.rgbVar(s.falaise_rgb1.r,s.falaise_rgb1.g,s.falaise_rgb1.b,s.falaise_rgb2.r,s.falaise_rgb2.g,s.falaise_rgb2.b,h),e.visible=!0}else this.falaiseR&&(this.falaiseR.visible=!1);var r=this.lineR;null==r?(r=new h5ge.Graphics,this.contLine.addChild(r),this.lineR=r):r.clear(),r.beginStroke(6,0,.6),r.moveTo(0,0),r.lineTo(i.x-t.x,i.y-t.y),r.x=t.x,r.endStroke()},r.recycleList=null,r.LARGE_BANDE_WIDTH=80,r.GROUND_TINT=5200213,r}(h5ge.Container);u.CanyonGround=t}(GAME||(GAME={})),function(x){var t=function(i){function g(){var t=i.call(this)||this;for(t.progressTimeSpawner=0,t.reduceRoad=0,t.delayNextSign=0,t.immobileRoad=0,t.switchDest=!1,t.cleaningStep=0,t.tickcount=0,t.buildLayout(),t.cameraY=0,t.sequence=new x.ListH5,t.cellHeight=g.RoadStep,t.currentX=.5*x.Game.get().width,t.wayMax=400,t.wayWidth=400,t.wayMinWidth=300,t.speed=1,x.CityGround.roadCount=0,t.screenHeight=Math.ceil((x.Game.get().height+200)/t.cellHeight)+Math.ceil(g.RoadHeight/t.cellHeight),t.limitY=-t.screenHeight,t.currentY=0,t.listGround=new x.ListH5,t.listItem=new x.ListH5,t.spawnerCoin=new x.Spawner(4,3),t.spawnerObstacle=new x.Spawner(1,3);t.newGround(!0),t.currentY>t.limitY;);return t}return __extends(g,i),g.prototype.buildLayout=function(){this.layGround=new h5ge.Container,this.layElement=new h5ge.Container,this.layElementTop=new h5ge.Container,this.layBridge=new h5ge.Container,this.layBridge2=new h5ge.Container,this.layBridgeTop=new h5ge.Container,this.addChild(this.layGround),this.addChild(this.layElement),this.addChild(this.layElementTop),this.addChild(this.layBridge),this.addChild(this.layBridge2),this.addChild(this.layBridgeTop)},g.prototype.newGround=function(t){var i={x:this.currentX-.5*this.wayWidth,y:this.currentY*this.cellHeight},n=(this.currentX,this.wayWidth);this.nextCur();var h={x:this.currentX-.5*this.wayWidth,y:this.currentY*this.cellHeight},s={a:{x:i.x,y:i.y+g.RoadHeight},b:{x:h.x,y:h.y+g.RoadHeight},c:{x:h.x+this.wayWidth,y:h.y+g.RoadHeight},d:{x:i.x+n,y:i.y+g.RoadHeight}},e=x.CityGround.getNewGround(s);e.y=i.y,this.layBridge.addChildAt(e,0),e.road.y=e.y+g.RoadHeight,this.layGround.addChildAt(e.road,0),e.lineCont.y=e.y,this.layBridge2.addChild(e.lineCont),i.x+=n,h.x+=this.wayWidth;var r={bridge:e,visu:{left:e.visuLeft,right:e.visuRight},elem:[],y:i.y,polygone:s};this.listGround.addToList(new x.ListElemH5(r));var u=.5*(x.Game.get().width-934),o=u+934,f=(Math.max(s.a.x,s.b.x)+Math.min(s.c.x,s.d.x))/2,a=(Math.min(s.a.x,s.b.x),Math.max(s.c.x,s.d.x),n<this.wayWidth?n:this.wayWidth);if(this.currentY<-20&&300<a&&this.spawnerObstacle.haveToSpawn()){var c=a-(v=new x.Item(x.Item.TYPE_BARREL)).width-32;v.x=f+.5*-c+c*Math.random(),v.y=r.y-.5*x.MapCanyon.RoadStep,this.layElement.addChild(v),this.listItem.addToList(new x.ListElemH5(v));var l=new x.Warning;l.x=v.x-.5*l.width,l.y=v.y-.5*v.height-.5*l.height-32,this.addChild(l),r.elem.push(l)}if(1!=t&&this.spawnerCoin.haveToSpawn()){var v,d=x.Item.TYPE_GOLD;x.SceneGame.get().lifeBar.getLifeRatio()<.7&&Math.random()<.03&&(d=x.Item.TYPE_LIFE),(v=new x.Item(d)).x=f,v.y=r.y-.5*g.RoadStep,this.layElement.addChild(v),this.listItem.addToList(new x.ListElemH5(v))}},g.prototype.updateSpawner=function(t){var i=this.progressTimeSpawner+.001*t;this.progressTimeSpawner<10&&10<=i&&(this.spawnerCoin.setFrequence(4,3),this.spawnerObstacle.setFrequence(2,3)),this.progressTimeSpawner<20&&20<=i&&(this.spawnerCoin.setFrequence(5,3),this.spawnerObstacle.setFrequence(2,3)),this.progressTimeSpawner<30&&30<=i&&(this.spawnerCoin.setFrequence(6,3),this.spawnerObstacle.setFrequence(3,3)),this.progressTimeSpawner<40&&40<=i&&(this.spawnerCoin.setFrequence(7,3),this.spawnerObstacle.setFrequence(4,3)),this.progressTimeSpawner<50&&50<=i&&(this.spawnerCoin.setFrequence(8,3),this.spawnerObstacle.setFrequence(5,3)),this.progressTimeSpawner<60&&60<=i&&(this.spawnerCoin.setFrequence(8,3),this.spawnerObstacle.setFrequence(5,3)),this.progressTimeSpawner=i},g.prototype.addElement=function(t){this.layElement.addChild(t)},g.prototype.nextCur=function(){this.currentY-=1,0<this.reduceRoad?(this.wayWidth-=5,this.reduceRoad-=1):this.wayWidth+=10,this.wayMinWidth=Math.max(130,this.wayMinWidth-.1),this.wayWidth=x.System.range(this.wayMinWidth,this.wayWidth,this.wayMinWidth+200),this.wayWidth==this.wayMinWidth&&0<this.reduceRoad&&Math.random()<.01-5e-7*this.tickcount&&(this.reduceRoad=0);var t=.5*this.wayWidth+16,i=x.Game.get().width-.5*this.wayWidth-16;0==this.immobileRoad&&(this.currentX+=20*x.System.signOf(Math.sin(.02*this.tickcount))*(this.switchDest?-1:1)),this.currentX<t&&(this.currentX=t),this.currentX>i&&(this.currentX=i);var n=.01+1e-7*this.tickcount;Math.random()<n&&(this.reduceRoad=20+Math.floor(40*Math.random())),Math.random()<.01&&(this.switchDest=!this.switchDest),0==this.immobileRoad?Math.random()<.02&&(this.immobileRoad=Math.floor(20*Math.random())):this.immobileRoad-=1},g.prototype.getSign=function(t){var i=new h5ge.Container,n=h5ge.Sprite.fromFrame(x.ASSETS.MAP_CITY_SIGN_LEFT),h=h5ge.Sprite.fromFrame(x.ASSETS.MAP_CITY_SIGN_CENTER);h.x=n.width-2,h.width=t+4;var s=h5ge.Sprite.fromFrame(x.ASSETS.MAP_CITY_SIGN_RIGHT);s.x=h.x+h.width-2,i.addChild(n),i.addChild(h),i.addChild(s);var e=h5ge.Sprite.fromFrame(x.ASSETS.MAP_CITY_SIGN_LEFT);e.tint=0,e.alpha=.2,e.x=n.x,e.y=2*e.height,e.height*=-1;var r=h5ge.Sprite.fromFrame(x.ASSETS.MAP_CITY_SIGN_CENTER);r.tint=0,r.width=h.width,r.alpha=.2,r.x=h.x,r.y=2*r.height,r.height*=-1;var u=h5ge.Sprite.fromFrame(x.ASSETS.MAP_CITY_SIGN_RIGHT);return u.x=s.x,u.tint=0,u.alpha=.2,u.y=2*u.height,u.height*=-1,i.addChild(e),i.addChild(r),i.addChild(u),i.setSize(n.width+h.width+s.width-4,2*n.height),i},g.prototype.setCameraY=function(t){this.cameraY=t;var i=Math.ceil(this.cameraY/this.cellHeight)-this.screenHeight-1;i<this.limitY&&(this.limitY=i,this.refreshBuild()),this.y=x.Game.get().height-this.cameraY},g.prototype.getCameraY=function(){return this.cameraY},g.prototype.refreshBuild=function(){for(;this.newGround(),this.currentY>this.limitY;);},g.prototype.cleanBuilding=function(){var t=this.cameraY+g.RoadHeight+300;if(x.System.everyXTick(50))for(var i=this.listGround.start;null!=i;){var n=i.content;if(n.y>t){if(0<n.elem.length)for(var h=0;h<n.elem.length;h++)n.elem[h].removeSelf();n.bridge.kill(),this.listGround.removeFromList(i)}i=i.next}i=this.listItem.start;for(var s=x.SceneGame.get().speedCar;null!=i;){var e=i.content;e.update(),x.System.distance(s.x,s.y,e.x,e.y)<64?(e.fireDroped(),this.listItem.removeFromList(i),i=i.next):(e.y>t&&(e.removeSelf(),this.listItem.removeFromList(i)),i=i.next)}},g.prototype.isCollide=function(t){for(var i=t.rotation-.5*Math.PI,n=.6*t.idleHeight*.5,h=t.x+n*Math.cos(i),s=t.y+n*Math.sin(i),e=.35*t.widthCollision,r=this.listGround.start;null!=r;){var u=r.content;if(!(u.y>s)){var o=u.polygone,f=this.getXFromDandY(o.a,o.b,s),a=this.getXFromDandY(o.c,o.d,s);return h-e<f?(u.visu.left&&this.buildImpact(f,s),{min:f,max:null}):a<h+e?(u.visu.right&&this.buildImpact(a,s),{min:null,max:a}):null}r=r.next}return null},g.prototype.buildImpact=function(t,i){var n=new x.AnimationH5;n.addAnimationFromTable("main",x.Anims.choc2),n.setPivotToCenter(),n.speed=30,n.x=t-.5*n.width,n.y=i-.5*n.height,n.scaleXY=.5,n.onEnd(function(){n.destroy.apply(n)}),this.layBridge.addChild(n)},g.prototype.getXFromDandY=function(t,i,n){var h,s,e;return h=i.x-t.x,e=-(s=i.y-t.y),-(h*n+(s*t.x-h*t.y))/e},g.prototype.update=function(t){var i=.001*t,n=this.speed+Math.max(0,3*Math.sin(.01*x.System.tickcount))+ +Math.max(0,3*Math.sin(.02*x.System.tickcount));this.tickcount+=1*n,this.speed=Math.min(6,this.speed+.1*i),this.cleanBuilding(),this.updateSpawner(t)},g.RoadHeight=60,g.RoadWidth=500,g.RoadStep=60,g}(h5ge.Container);x.MapCity=t}(GAME||(GAME={})),function(u){var t=function(n){function r(t){var i=n.call(this)||this;return i.lineCont=new h5ge.Container,i.bodyL=null,i.bodyR=null,i.road=null,i.falaiseL=null,i.falaiseL_R=null,i.bodyRecAngleL=null,i.lineL=null,i.lineL_R=null,i.falaiseR=null,i.falaiseR_L=null,i.lineR=null,i.lineR_L=null,i.visuLeft=!1,i.visuRight=!1,i.build(t),i.buildLeft(t.a,t.b),i.buildRight(t.d,t.c),i}return __extends(r,n),r.prototype.init=function(){},r.prototype.build=function(t){u.SceneGame.get().color;null==this.bodyL&&(this.bodyL=h5ge.Sprite.fromFrame(u.ASSETS.LIGHT),this.addChild(this.bodyL),this.bodyL.tint=4212816),this.bodyL.width=64,this.bodyL.height=r.width,this.bodyL.rotation=u.System.angle(t.a.x,t.a.y,t.b.x,t.b.y),this.bodyL.x=t.a.x+this.bodyL.height*Math.sin(this.bodyL.rotation),null==this.bodyR&&(this.bodyR=h5ge.Sprite.fromFrame(u.ASSETS.LIGHT),this.bodyR.tint=4212816,this.addChild(this.bodyR)),this.bodyR.width=64,t.d.x<=t.c.x&&(this.bodyR.width=80),this.bodyR.height=r.width,this.bodyR.rotation=u.System.angle(t.d.x,t.d.y,t.c.x,t.c.y),this.bodyR.x=t.d.x,null==this.road&&(this.road=new h5ge.Graphics),this.road.clear(),this.road.beginFill(1776675,1);if(this.road.moveTo(t.a.x,0),this.road.lineTo(t.b.x,-62),this.road.lineTo(t.c.x,-62),this.road.lineTo(t.d.x,0),this.road.endFill(),this.road.beginStroke(4,16777215,.8),this.road.moveTo(t.a.x+16,0),this.road.lineTo(t.b.x+16,-62),this.road.endStroke(),this.road.beginStroke(4,16777215,.8),this.road.moveTo(t.d.x-14,0),this.road.lineTo(t.c.x-14,-62),this.road.endStroke(),r.roadCount%5<1){var i=t.d.x-t.a.x;this.road.beginStroke(16,16777215,.8),this.road.moveTo(t.a.x+.5*i-8,0),this.road.lineTo(t.b.x+.5*i-8,-62),this.road.endStroke()}},r.prototype.rebuild=function(t){this.visuLeft=!1,this.visuRight=!1,this.build(t),this.buildLeft(t.a,t.b),this.buildRight(t.d,t.c)},r.prototype.kill=function(){this.road.removeSelf(),this.lineCont.removeSelf(),null==r.recycleList&&(r.recycleList=new u.ListH5),r.recycleList.addToList(new u.ListElemH5(this)),this.removeSelf()},r.getNewGround=function(t){if(r.roadCount+=1,r.recycleList&&null!=r.recycleList.start){var i=r.recycleList.start.content;return r.recycleList.removeFromList(r.recycleList.start),i.rebuild(t),i}return i=new r(t)},r.prototype.buildLeft=function(t,i){var n,h=i.y-t.y;u.SceneGame.get().color;i.x>t.x?(this.visuLeft=!0,null==(n=this.falaiseL)&&(n=h5ge.Sprite.fromFrame(u.ASSETS.MAP_CITY_ANGLE_BASE),this.addChild(n),this.falaiseL=n),n.x=t.x,n.y=h,n.width=i.x-t.x,n.width+=2*u.System.signOf(n.width),n.tint=2631728,n.visible=!0,this.falaiseL_R&&(this.falaiseL_R.visible=!1)):(null==(n=this.falaiseL_R)&&(n=h5ge.Sprite.fromFrame(u.ASSETS.MAP_CITY_ANGLE_BASE),this.addChild(n),this.falaiseL_R=n),n.x=t.x+r.width*Math.sin(u.System.angle(t.x,t.y,i.x,i.y)),n.y=h,n.width=i.x-t.x,n.width+=2*u.System.signOf(n.width),n.tint=2631728,n.visible=!0,this.falaiseL&&(this.falaiseL.visible=!1));Math.min(t.x,i.x);var s,e=this.bodyRecAngleL;null==e&&(e=h5ge.Sprite.fromFrame(u.ASSETS.MAP_CITY_ANGLE_LEFT),this.addChild(e),this.bodyRecAngleL=e),e.width=100,e.height=60,e.x=t.x,e.width=i.x-t.x,e.y=h,t.x>i.x&&(e.height=-e.height,e.width=-e.width,e.x-=Math.abs(e.width),e.y+=Math.abs(e.height)),e.tint=4212816,null==(s=this.lineL)?(s=new h5ge.Graphics,this.lineCont.addChild(s),this.lineL=s):s.clear(),s.beginStroke(4,0,.6),s.moveTo(0,0),s.lineTo(i.x-t.x,i.y-t.y),s.x=t.x+2,s.endStroke(),null==(s=this.lineL_R)?(s=new h5ge.Graphics,this.lineCont.addChild(s),this.lineL_R=s):s.clear(),s.beginStroke(4,0,.6),s.moveTo(0,0),s.lineTo(i.x-t.x,i.y-t.y),s.x=2+t.x+r.width*Math.sin(u.System.angle(t.x,t.y,i.x,i.y)),s.endStroke()},r.prototype.buildRight=function(t,i){var n,h=i.y-t.y;Math.abs(i.x-t.x),u.SceneGame.get().color;i.x<t.x?(this.visuRight=!0,null==(n=this.falaiseR)&&(n=h5ge.Sprite.fromFrame(u.ASSETS.MAP_CITY_ANGLE_BASE),this.addChild(n),this.falaiseR=n),n.x=t.x,n.y=h,n.width=i.x-t.x,n.width+=2*u.System.signOf(n.width),n.tint=2631728,n.visible=!0,this.falaiseR_L&&(this.falaiseR_L.visible=!1)):(null==(n=this.falaiseR_L)&&(n=h5ge.Sprite.fromFrame(u.ASSETS.MAP_CITY_ANGLE_BASE),this.addChild(n),this.falaiseR_L=n),n.x=t.x-r.width*Math.sin(u.System.angle(t.x,t.y,i.x,i.y)),n.y=h,n.width=i.x-t.x,n.width+=2*u.System.signOf(n.width),n.tint=2631728,n.visible=!0,this.falaiseR&&(this.falaiseR.visible=!1));var s;Math.max(t.x,i.x);null==(s=this.lineR)?(s=new h5ge.Graphics,this.lineCont.addChild(s),this.lineR=s):s.clear(),s.beginStroke(4,0,.6),s.moveTo(0,0),s.lineTo(i.x-t.x,i.y-t.y),s.x=2+t.x,s.endStroke(),null==(s=this.lineR_L)?(s=new h5ge.Graphics,this.lineCont.addChild(s),this.lineR_L=s):s.clear(),s.beginStroke(4,0,.6),s.moveTo(0,0),s.lineTo(i.x-t.x,i.y-t.y),s.x=2+t.x-r.width*Math.sin(u.System.angle(t.x,t.y,i.x,i.y)),s.endStroke()},r.width=30,r.recycleList=null,r}(h5ge.Container);u.CityGround=t}(GAME||(GAME={})),function(t){var i;(i=t.MapType||(t.MapType={}))[i.CITY=0]="CITY",i[i.CANYON=1]="CANYON",i[i.RACING=2]="RACING"}(GAME||(GAME={})),function(t){var i=function(s){function t(t,i,n){var h=s.call(this,934,934)||this;return h.moveRate=i,h.imageA=new h5ge.Sprite(t),h.imageB=new h5ge.Sprite(t),h.imageB.y=-h.imageB.height,h.cursorA=0,h.cursorB=-h.imageB.height,h.addChild(h.imageA),h.addChild(h.imageB),n&&(h.imageA.tint=n,h.imageB.tint=n),h}return __extends(t,s),t.prototype.refreshPlacement=function(){var t=2*this.imageA.height;this.imageA.y=-this.imageA.height+this.cursorA%t,this.imageB.y=-this.imageA.height+this.cursorB%t},t.prototype.setCameraY=function(t){var i=-this.moveRate*t>>0;this.cursorA=i+this.imageA.height,this.cursorB=i,this.refreshPlacement()},t.URL_CITY="game/assets/images/city.jpg",t.URL_CANYON="game/assets/images/canyon.jpg",t.URL_RACING="game/assets/images/racing.jpg",t}(h5ge.Container);t.MovingBack=i}(GAME||(GAME={})),function(y){var t=function(i){function w(){var t=i.call(this)||this;for(t.plotBuilder=0,t.reduceRoad=0,t.switchDest=!1,t.cleaningStep=0,t.tickcount=0,t.buildLayout(),t.cameraY=0,t.sequence=new y.ListH5,t.cellHeight=w.RoadStep,t.currentX=.5*y.Game.get().width,t.wayMax=400,t.wayWidth=400,t.wayMinWidth=300,t.speed=1,y.RacingGround.roadCount=0,t.screenHeight=Math.ceil(y.Game.get().height/t.cellHeight)+Math.ceil(w.RoadHeight/t.cellHeight),t.limitY=-t.screenHeight,t.currentY=0,t.listGround=new y.ListH5,t.listItem=new y.ListH5,t.progressTimeSpawner=0,t.spawnerCoin=new y.Spawner(3,3);t.newGround(!0),t.currentY>t.limitY;);return t}return __extends(w,i),w.prototype.getRandomGrass=function(){switch(Math.floor(20*Math.random())){case 0:return h5ge.Sprite.fromFrame(y.ASSETS.MAP_RACING_ELEMENT_2);default:return h5ge.Sprite.fromFrame(y.ASSETS.MAP_RACING_ELEMENT_1)}},w.prototype.buildLayout=function(){this.layGround=new h5ge.Container,this.layElement=new h5ge.Container,this.layElementTop=new h5ge.Container,this.layBridge=new h5ge.Container,this.layBridgeTop=new h5ge.Container,this.addChild(this.layGround),this.addChild(this.layElement),this.addChild(this.layElementTop),this.addChild(this.layBridge),this.addChild(this.layBridgeTop)},w.prototype.updateSpawner=function(t){var i=this.progressTimeSpawner+.001*t;this.progressTimeSpawner<10&&10<=i&&this.spawnerCoin.setFrequence(3,3),this.progressTimeSpawner<20&&20<=i&&this.spawnerCoin.setFrequence(3,3),this.progressTimeSpawner<30&&30<=i&&this.spawnerCoin.setFrequence(4,3),this.progressTimeSpawner<40&&40<=i&&this.spawnerCoin.setFrequence(4,3),this.progressTimeSpawner<50&&50<=i&&this.spawnerCoin.setFrequence(5,3),this.progressTimeSpawner<60&&60<=i&&this.spawnerCoin.setFrequence(5,3),this.progressTimeSpawner=i},w.prototype.newGround=function(t){var i={x:this.currentX-.5*this.wayWidth,y:this.currentY*this.cellHeight},n=(this.currentX,this.wayWidth);this.nextCur();var h={x:this.currentX-.5*this.wayWidth,y:this.currentY*this.cellHeight},s={a:{x:i.x,y:i.y+w.RoadHeight},b:{x:h.x,y:h.y+w.RoadHeight},c:{x:h.x+this.wayWidth,y:h.y+w.RoadHeight},d:{x:i.x+n,y:i.y+w.RoadHeight}},e=y.RacingGround.getNewGround(s);e.y=i.y,this.layBridge.addChildAt(e,0),e.road.y=e.y+w.RoadHeight,this.layGround.addChildAt(e.road,0),i.x+=n,h.x+=this.wayWidth;var r={bridge:e,visu:{left:e.visuLeft,right:e.visuRight},elem:[],y:i.y,polygone:s};this.listGround.addToList(new y.ListElemH5(r));var u,o=.5*(y.Game.get().width-934),f=o+934,a=(Math.max(s.a.x,s.b.x)+Math.min(s.c.x,s.d.x))/2,c=o-Math.min(s.a.x,s.b.x),l=f-Math.max(s.c.x,s.d.x);Math.random()<.1&&((u=this.getRandomGrass()).scaleXY=1+.4*Math.random(),u.x=Math.random()*(c-32)-.5*u.width,u.y=s.a.y+20-40*Math.random()-.9*u.height,this.layBridgeTop.addChild(u),r.elem.push(u));Math.random()<.1&&((u=this.getRandomGrass()).scaleXY=1+.4*Math.random(),u.x=s.c.x+Math.random()*(l-32)-.5*u.width,u.y=s.a.y+20-40*Math.random()-.9*u.height,this.layBridgeTop.addChild(u),r.elem.push(u));if(0==this.plotBuilder)Math.random()<.01&&(this.plotBuilder=(2+Math.floor(10*Math.random()))*(Math.random()<.5?1:-1));else if(200<this.wayWidth){if(this.plotBuilder<0&&this.currentY%3==0){this.plotBuilder+=1;var v=new y.Item(y.Item.TYPE_CONE);v.x=s.a.x+.5*v.width+10,v.y=s.a.y,this.layElement.addChild(v),this.listItem.addToList(new y.ListElemH5(v))}if(0<this.plotBuilder&&this.currentY%3==0){this.plotBuilder-=1;var d=new y.Item(y.Item.TYPE_CONE);d.x=s.c.x+.5*-d.width-10,d.y=s.a.y,this.layElement.addChild(d),this.listItem.addToList(new y.ListElemH5(d))}}if(1!=t&&this.spawnerCoin.haveToSpawn()){var g=y.Item.TYPE_GOLD;y.SceneGame.get().lifeBar.getLifeRatio()<.7&&Math.random()<.03&&(g=y.Item.TYPE_LIFE);var x=new y.Item(g);x.x=a,x.y=r.y-.5*w.RoadStep,this.layElement.addChild(x),this.listItem.addToList(new y.ListElemH5(x))}},w.prototype.addElement=function(t){this.layElement.addChild(t)},w.prototype.nextCur=function(){this.currentY-=1,0<this.reduceRoad?(this.wayWidth-=5,this.reduceRoad-=1):this.wayWidth+=10,this.wayMinWidth=Math.max(130,this.wayMinWidth-.1),this.wayWidth=y.System.range(this.wayMinWidth,this.wayWidth,this.wayMinWidth+200),this.wayWidth==this.wayMinWidth&&0<this.reduceRoad&&Math.random()<.01-5e-7*this.tickcount&&(this.reduceRoad=0);var t=.5*this.wayWidth+16,i=y.Game.get().width-.5*this.wayWidth-16;this.currentX+=10*Math.sin(.02*this.tickcount),this.currentX<t&&(this.currentX=t),this.currentX>i&&(this.currentX=i);var n=.01+1e-7*this.tickcount;Math.random()<n&&(this.reduceRoad=20+Math.floor(40*Math.random()))},w.prototype.getSign=function(t){var i=new h5ge.Container,n=h5ge.Sprite.fromFrame(y.ASSETS.MAP_CITY_SIGN_LEFT),h=h5ge.Sprite.fromFrame(y.ASSETS.MAP_CITY_SIGN_CENTER);h.x=n.width-2,h.width=t+4;var s=h5ge.Sprite.fromFrame(y.ASSETS.MAP_CITY_SIGN_RIGHT);s.x=h.x+h.width-2,i.addChild(n),i.addChild(h),i.addChild(s);var e=h5ge.Sprite.fromFrame(y.ASSETS.MAP_CITY_SIGN_LEFT);e.tint=0,e.alpha=.2,e.x=n.x,e.y=2*e.height,e.height*=-1;var r=h5ge.Sprite.fromFrame(y.ASSETS.MAP_CITY_SIGN_CENTER);r.tint=0,r.width=h.width,r.alpha=.2,r.x=h.x,r.y=2*r.height,r.height*=-1;var u=h5ge.Sprite.fromFrame(y.ASSETS.MAP_CITY_SIGN_RIGHT);return u.x=s.x,u.tint=0,u.alpha=.2,u.y=2*u.height,u.height*=-1,i.addChild(e),i.addChild(r),i.addChild(u),i.setSize(n.width+h.width+s.width-4,2*n.height),i},w.prototype.setCameraY=function(t){this.cameraY=t;var i=Math.ceil(this.cameraY/this.cellHeight)-this.screenHeight-1;i<this.limitY&&(this.limitY=i,this.refreshBuild()),this.y=y.Game.get().height-this.cameraY},w.prototype.getCameraY=function(){return this.cameraY},w.prototype.refreshBuild=function(){for(;this.newGround(),this.currentY>this.limitY;);},w.prototype.cleanBuilding=function(){var t=this.cameraY+w.RoadHeight+300;if(y.System.everyXTick(50))for(var i=this.listGround.start;null!=i;){var n=i.content;if(n.y>t){if(0<n.elem.length)for(var h=0;h<n.elem.length;h++)n.elem[h].removeSelf();n.bridge.kill(),this.listGround.removeFromList(i)}i=i.next}i=this.listItem.start;for(var s=y.SceneGame.get().speedCar;null!=i;){var e=i.content;e.update(),y.System.distance(s.x,s.y,e.x,e.y)<64?(e.fireDroped(),this.listItem.removeFromList(i),i=i.next):(e.y>t&&(e.removeSelf(),this.listItem.removeFromList(i)),i=i.next)}},w.prototype.isCollide=function(t){if(t.isDead())return null;for(var i=t.rotation-.5*Math.PI,n=.6*t.idleHeight*.5,h=t.x+n*Math.cos(i),s=t.y+n*Math.sin(i),e=.35*t.widthCollision,r=this.listGround.start;null!=r;){var u=r.content;if(!(u.y>s)){var o=u.polygone,f=this.getXFromDandY(o.a,o.b,s),a=this.getXFromDandY(o.c,o.d,s);return h-e<f?(u.visu.left&&this.buildImpact(f,s),{min:f,max:null}):a<h+e?(u.visu.right&&this.buildImpact(a,s),{min:null,max:a}):null}r=r.next}return null},w.prototype.buildImpact=function(t,i){var n=new y.AnimationH5;n.addAnimationFromTable("main",y.Anims.choc2),n.setPivotToCenter(),n.speed=30,n.x=t-.5*n.width,n.y=i-.5*n.height,n.scaleXY=.5,n.onEnd(function(){n.destroy.apply(n)}),this.layBridge.addChild(n)},w.prototype.getXFromDandY=function(t,i,n){var h,s,e;return h=i.x-t.x,e=-(s=i.y-t.y),-(h*n+(s*t.x-h*t.y))/e},w.prototype.update=function(t){var i=.001*t;this.speed=Math.min(6,this.speed+.1*i);var n=this.speed+Math.max(0,3*Math.sin(.01*y.System.tickcount))+Math.max(0,3*Math.sin(.02*y.System.tickcount)),h=Math.sin(.001*y.System.tickcount);.8<h&&(n-=6*(h-.8)/.2),this.tickcount+=1*n,this.cleanBuilding(),this.updateSpawner(t)},w.RoadHeight=10,w.RoadWidth=500,w.RoadStep=20,w}(h5ge.Container);y.MapRacing=t}(GAME||(GAME={})),function(s){var t=function(n){function h(t){var i=n.call(this)||this;return i.visuLeft=!1,i.visuRight=!1,i.build(t),i}return __extends(h,n),h.prototype.init=function(){},h.prototype.build=function(t){null==this.road&&(this.road=new h5ge.Graphics),this.road.clear(),this.road.beginFill(1776675,1);var i=-s.MapRacing.RoadStep-2;this.road.moveTo(t.a.x,0),this.road.lineTo(t.b.x,i),this.road.lineTo(t.c.x,i),this.road.lineTo(t.d.x,0),this.road.endFill(),this.road.beginStroke(4,16777215,.8),this.road.moveTo(t.a.x+16,0),this.road.lineTo(t.b.x+16,i),this.road.endStroke(),this.road.beginStroke(4,16777215,.8),this.road.moveTo(t.d.x-14,0),this.road.lineTo(t.c.x-14,i),this.road.endStroke()},h.prototype.rebuild=function(t){this.build(t)},h.prototype.kill=function(){this.road.removeSelf(),null==h.recycleList&&(h.recycleList=new s.ListH5),h.recycleList.addToList(new s.ListElemH5(this)),this.removeSelf()},h.getNewGround=function(t){if(h.roadCount+=1,h.recycleList&&null!=h.recycleList.start){var i=h.recycleList.start.content;return h.recycleList.removeFromList(h.recycleList.start),i.rebuild(t),i}return i=new h(t)},h.width=30,h.recycleList=null,h}(h5ge.Container);s.RacingGround=t}(GAME||(GAME={})),function(A){var t=function(n){function O(t){var i=n.call(this)||this;for(i.color=t,i.cleaningStep=0,i.tickcount=0,i.buildLayout(),i.cameraY=0,i.sequence=new A.ListH5,i.cellHeight=O.RoadStep,i.currentX=.5*A.Game.get().width,i.destX=.5*A.Game.get().width,i.wayMax=400,i.wayWidth=400,i.wayMinWidth=350,i.speed=1,i.screenHeight=Math.ceil((A.Game.get().height+400)/i.cellHeight)+Math.ceil(O.RoadHeight/i.cellHeight),i.limitY=-i.screenHeight,i.currentY=0,i.listGround=new A.ListH5,i.listItem=new A.ListH5,i.progressTimeSpawner=0,i.spawnerCoin=new A.Spawner(3,3),i.spawnerObstacle=new A.Spawner(1,3);i.newGround(!0),i.currentY>i.limitY;);return i}return __extends(O,n),O.prototype.buildLayout=function(){this.layGround=new h5ge.Container,this.layElement=new h5ge.Container,this.layElementTop=new h5ge.Container,this.layMountain=new h5ge.Container,this.layMountain2=new h5ge.Container,this.layRock=new h5ge.Container,this.addChild(this.layGround),this.addChild(this.layElement),this.addChild(this.layElementTop),this.addChild(this.layMountain),this.addChild(this.layMountain2),this.addChild(this.layRock)},O.prototype.updateSpawner=function(t){var i=this.progressTimeSpawner+.001*t;this.progressTimeSpawner<10&&10<=i&&(this.spawnerCoin.setFrequence(3,3),this.spawnerObstacle.setFrequence(2,3)),this.progressTimeSpawner<20&&20<=i&&(this.spawnerCoin.setFrequence(3,3),this.spawnerObstacle.setFrequence(2,3)),this.progressTimeSpawner<30&&30<=i&&(this.spawnerCoin.setFrequence(4,3),this.spawnerObstacle.setFrequence(3,3)),this.progressTimeSpawner<40&&40<=i&&(this.spawnerCoin.setFrequence(4,3),this.spawnerObstacle.setFrequence(4,3)),this.progressTimeSpawner<50&&50<=i&&(this.spawnerCoin.setFrequence(5,3),this.spawnerObstacle.setFrequence(5,3)),this.progressTimeSpawner<60&&60<=i&&(this.spawnerCoin.setFrequence(5,3),this.spawnerObstacle.setFrequence(6,3)),this.progressTimeSpawner=i},O.prototype.newGround=function(t){var i={x:this.currentX-.5*this.wayWidth,y:this.currentY*this.cellHeight},n=this.wayWidth;this.nextCur();var h={x:this.currentX-.5*this.wayWidth,y:this.currentY*this.cellHeight},s={a:{x:i.x,y:i.y+O.RoadHeight},b:{x:h.x,y:h.y+O.RoadHeight},c:{x:h.x+this.wayWidth,y:h.y+O.RoadHeight},d:{x:i.x+n,y:i.y+O.RoadHeight}},e=A.CanyonGround.getNewGround(s);e.y=i.y,e.road.y=e.y,e.contLine.y=e.y,this.layMountain2.addChild(e.contLine),this.layGround.addChild(e.road),this.layMountain.addChildAt(e,0),i.x+=n,h.x+=this.wayWidth;var r={mountain:e,visu:{left:e.visuLeft,right:e.visuRight},elem:[],y:i.y,polygone:s};this.listGround.addToList(new A.ListElemH5(r));var u=.5*(A.Game.get().width-934),o=u+934,f=(Math.max(s.a.x,s.b.x)+Math.min(s.c.x,s.d.x))/2,a=Math.min(s.a.x,s.b.x)-u-32,c=o-Math.max(s.c.x,s.d.x)-32;if(1!=t&&this.spawnerCoin.haveToSpawn()){var l=A.Item.TYPE_GOLD;A.SceneGame.get().lifeBar.getLifeRatio()<.7&&Math.random()<.03&&(l=A.Item.TYPE_LIFE),(d=new A.Item(l)).x=f,d.y=r.y-.5*O.RoadStep,this.layElement.addChild(d),this.listItem.addToList(new A.ListElemH5(d))}var v=n<this.wayWidth?n:this.wayWidth;if(this.currentY<10&&300<v&&this.spawnerObstacle.haveToSpawn()){var d,g=v-(d=new A.Item(A.Item.TYPE_CACTUS)).width-32;d.x=f+.5*-g+g*Math.random(),d.y=r.y-.5*O.RoadStep,this.layElement.addChild(d),this.listItem.addToList(new A.ListElemH5(d));var x=new A.Warning;x.x=d.x-.5*x.width,x.y=d.y-.5*d.height-.5*x.height-32,this.addChild(x),r.elem.push(x)}if(n<230&&Math.random()<.1){var w=h5ge.Sprite.fromFrame(A.ASSETS.MAP_CANYON_ROCK_ARCHE);w.x=s.a.x+.5*(s.c.x-s.a.x)-.5*w.width,w.y=r.y-.5*O.RoadStep-.8*w.height,this.layRock.addChildAt(w,0),r.elem.push(w);var y=h5ge.Sprite.fromFrame(A.ASSETS.MAP_CANYON_ROCK_ARCHE);y.tint=0,y.x=w.x,y.y=w.y+w.height+.8*w.height,y.height=-y.height,y.alpha=.2,this.layRock.addChildAt(y,0),r.elem.push(y)}var M=this.getRock(a);if(M&&Math.random()<.3){var b=!0;(_=h5ge.Sprite.fromFrame(M)).x=u+Math.random()*(a-_.width)+.5*_.width,_.width=-_.width,_.y=s.a.y,this.layRock.addChildAt(_,0),r.elem.push(_)}var p,m=this.getRock(c);if(m&&Math.random()<.3){var _,E=!0;(_=h5ge.Sprite.fromFrame(m)).x=o-Math.random()*(c-_.width)-.5*_.width,_.y=s.d.y,this.layRock.addChildAt(_,0),r.elem.push(_)}!b&&160<a&&Math.random()<.06&&((p=this.getRandomTree())&&(p.y+=s.a.y,p.x+=u+60+(a-80)*Math.random(),this.layRock.addChildAt(p,0),r.elem.push(p)));!E&&160<c&&Math.random()<.05&&((p=this.getRandomTree())&&(p.y+=r.y-.5*O.RoadStep,p.x+=o-60-(c-80)*Math.random(),this.layRock.addChildAt(p,0),r.elem.push(p)))},O.prototype.getRandomTree=function(){switch(Math.floor(3*Math.random())){case 0:return(t=h5ge.Sprite.fromFrame(A.ASSETS.MAP_CANYON_TREE_1)).x=-53,t.y=-170,t;case 1:return(t=h5ge.Sprite.fromFrame(A.ASSETS.MAP_CANYON_TREE_2)).x=-50,t.y=-135,t;case 2:var t;return(t=h5ge.Sprite.fromFrame(A.ASSETS.MAP_CANYON_TREE_3)).x=-64,t.y=-170,t}return null},O.prototype.getRock=function(t){var i=100;switch(139<=t?i=Math.floor(4*Math.random()):80<=t?i=Math.floor(3*Math.random()):77<=t?i=Math.floor(2*Math.random()):t<50&&(i=0),i){case 0:return A.ASSETS.MAP_CANYON_ROCK_ROCK2;case 1:return A.ASSETS.MAP_CANYON_ROCK_ROCK3;case 2:return A.ASSETS.MAP_CANYON_ROCK_ROCK4;case 3:return A.ASSETS.MAP_CANYON_ROCK_ROCK1}return null},O.prototype.addElement=function(t){this.layElement.addChild(t)},O.prototype.nextCur=function(){this.currentY-=1,this.wayWidth<this.wayMinWidth&&Math.random()<.6?this.wayWidth+=40*Math.random():this.wayWidth+=40*Math.random()*A.System.signOf(Math.cos(.015*A.System.tickcount)),this.wayMinWidth=Math.max(210,this.wayMinWidth-.1),this.wayWidth=A.System.range(210,this.wayWidth,this.wayMax);var t=.2*(this.destX-this.currentX);t=t*(.4+.8*Math.random())+(160*Math.random()-80),this.currentX+=t;var i=.5*this.wayWidth+16,n=A.Game.get().width-.5*this.wayWidth-16;this.currentX<i&&(this.currentX=i+40*Math.random()),this.currentX>n&&(this.currentX=n-40*Math.random()),this.destX+=90*Math.random()*A.System.signOf(Math.sin(.01*this.tickcount)),this.destX<i&&(this.destX=i),this.destX>n&&(this.destX=n)},O.prototype.setCameraY=function(t){this.cameraY=t;var i=Math.ceil(this.cameraY/this.cellHeight)-this.screenHeight-1;i<this.limitY&&(this.limitY=i,this.refreshBuild()),this.y=A.Game.get().height-this.cameraY},O.prototype.getCameraY=function(){return this.cameraY},O.prototype.refreshBuild=function(){for(;this.newGround(),this.currentY>this.limitY;);},O.prototype.cleanBuilding=function(){var t=this.cameraY+O.RoadHeight+300;if(A.System.everyXTick(50))for(var i=this.listGround.start;null!=i;){var n=i.content;if(n.y>t){if(0<n.elem.length)for(var h=0;h<n.elem.length;h++)n.elem[h].removeSelf();n.mountain.kill(),this.listGround.removeFromList(i)}i=i.next}i=this.listItem.start;for(var s=A.SceneGame.get().speedCar;null!=i;){var e=i.content;e.update(),A.System.distance(s.x,s.y,e.x,e.y)<64?(e.fireDroped(),this.listItem.removeFromList(i),i=i.next):(e.y>t&&(e.removeSelf(),this.listItem.removeFromList(i)),i=i.next)}},O.prototype.isCollide=function(t){if(t.isDead())return null;for(var i=t.rotation-.5*Math.PI,n=.6*t.idleHeight*.5,h=t.x+n*Math.cos(i),s=t.y+n*Math.sin(i),e=.35*t.widthCollision,r=this.listGround.start;null!=r;){var u=r.content;if(!(u.y>s)){var o=u.polygone,f=this.getXFromDandY(o.a,o.b,s),a=this.getXFromDandY(o.c,o.d,s);return h-e<f?(u.visu.left&&this.buildImpact(f,s),{min:f,max:null}):a<h+e?(u.visu.right&&this.buildImpact(a,s),{min:null,max:a}):null}r=r.next}return null},O.prototype.buildImpact=function(t,i){var n=new A.AnimationH5;n.addAnimationFromTable("main",A.Anims.choc2),n.setPivotToCenter(),n.speed=30,n.x=t-.5*n.width,n.y=i-.5*n.height,n.scaleXY=.5,n.onEnd(function(){n.destroy.apply(n)}),this.layRock.addChild(n)},O.prototype.getXFromDandY=function(t,i,n){var h,s,e;return h=i.x-t.x,e=-(s=i.y-t.y),-(h*n+(s*t.x-h*t.y))/e},O.prototype.update=function(t){var i=.001*t;this.tickcount+=1*this.speed,this.speed=Math.min(4,this.speed+.05*i),this.cleanBuilding(),this.updateSpawner(t)},O.RoadHeight=100,O.RoadWidth=500,O.RoadStep=100,O}(h5ge.Container);A.MapCanyon=t}(GAME||(GAME={})),function(n){var t=function(h){function t(t,i){var n=h.call(this)||this;return n.currentIdFrame=0,n.se=.2,n.ee=5,n.sys_destroyIn=-1,n.sys_onEndFctn=null,n.endedFrame=null,n.currentAnimation="NotDefinedAnimation",n.pingPong=!1,n.pingPongState=1,n.currentIdFrame=0,t&&i?n.addAnimation(t,i):n.currentAnimation="NotDefinedAnimation",n.speed=5,n.addUpdatable(),n}return __extends(t,h),t.prototype.destroyIn=function(t){this.sys_destroyIn=t,this.whiled=!0},t.prototype.addAnimation=function(t,i){null==this.animationList&&(this.animationList={}),this.animationList[t]=i.split(","),"NotDefinedAnimation"==this.currentAnimation&&(this.currentFrame=new h5ge.Sprite(h5ge.Texture.fromFrame(this.animationList[t][0])),this.addChild(this.currentFrame),this.setSizeFromChildren(),this.currentAnimation=t)},t.prototype.addAnimationFromTable=function(t,i){null==this.animationList&&(this.animationList={}),this.animationList[t]=i,"NotDefinedAnimation"==this.currentAnimation&&(this.currentFrame=new h5ge.Sprite(h5ge.Texture.fromFrame(this.animationList[t][0])),this.addChild(this.currentFrame),this.setSizeFromChildren(),this.currentAnimation=t)},t.prototype.setLooping=function(){this.whiled=!0},t.prototype.setNotLooping=function(){this.whiled=!1},t.prototype.play=function(t,i){null!=this.animationList&&this.animationList[t]&&(this.currentAnimation=t),null!=i&&(this.currentIdFrame=i),this.currentFrame.setFrame(this.animationList[this.currentAnimation][this.currentIdFrame]),this.addUpdatable()},t.prototype.setRandomFrame=function(){this.currentIdFrame=Math.floor(Math.random()*this.animationList[this.currentAnimation].length),this.se=Math.random()*(1/this.ee)},t.prototype.addUpdatable=function(){this.updatable||(this.updatable=!0,n.System.game.addUpdatable(this))},t.prototype.stopUdatable=function(){this.updatable&&(this.updatable=!1,n.System.game.removeUpdatable(this))},t.prototype.destroy=function(){this.stopUdatable(),this.currentFrame.removeSelf(),this.removeSelf()},Object.defineProperty(t.prototype,"speed",{get:function(){return this.ee},set:function(t){this.ee=t},enumerable:!0,configurable:!0}),t.prototype.onEnd=function(t){this.sys_onEndFctn=t},t.prototype.setPingPong=function(t){this.pingPong=t,this.pingPongState=1},t.prototype.nextFrame=function(t){this.whiled?this.pingPong?1==this.pingPongState?this.currentIdFrame+1==t?(this.pingPongState=-1,this.currentIdFrame=Math.max(0,t-2)):this.currentIdFrame+=1:0==this.currentIdFrame?(this.pingPongState=1,this.currentIdFrame=Math.min(1,t-1)):this.currentIdFrame-=1:this.currentIdFrame=this.currentIdFrame+1==t?0:this.currentIdFrame+1:this.currentIdFrame=Math.min(this.currentIdFrame+1,t-1)},t.prototype.update=function(t){if(t/=1e3,n.System.log("animationH5"),"NotDefinedAnimation"!=this.currentAnimation&&(0<this.ee&&(this.se=Math.min(this.se-1*t,1/this.ee)),this.se<=0)){var i=this.animationList[this.currentAnimation].length;this.currentIdFrame==i-1?(0<this.sys_destroyIn&&(this.sys_destroyIn-=1),this.endedFrame!=this.currentIdFrame&&(this.endedFrame=this.currentIdFrame,this.sys_onEndFctn&&this.sys_onEndFctn())):this.endedFrame=null,this.nextFrame(i),this.currentFrame.setFrame(this.animationList[this.currentAnimation][this.currentIdFrame]),this.se=1/this.ee,0==this.sys_destroyIn&&this.destroy()}},t}(h5ge.Container);n.AnimationH5=t}(GAME||(GAME={})),function(n){var t=function(i){function t(){var t=i.call(this)||this;return t.speedY=-50,t.speedX=0,t.cont=new h5ge.Container,t.re(t.cont),t.cont.scaleXY=.01,t.step=0,t.addUpdatable(),t}return __extends(t,i),t.prototype.re=function(t){return i.prototype.addChild.call(this,t)},t.prototype.addChild=function(t){return this.cont.addChild(t)},t.prototype.setMoveXY=function(t,i){this.speedX=t,this.speedY=i},t.prototype.destroy=function(){this.stopUpdatable(),this.removeSelf()},t.prototype.addUpdatable=function(){1!=this.updatable&&(this.updatable=!0,n.System.game.addUpdatable(this))},t.prototype.stopUpdatable=function(){1==this.updatable&&(this.updatable=!1,n.System.game.removeUpdatable(this))},t.prototype.update=function(t){var i=t/1e3;this.cont.y+=this.speedY*Math.min(1,this.cont.scaleXY)*i,this.cont.x+=this.speedX*Math.min(1,this.cont.scaleXY)*i,0==this.step&&this.cont.scaleXY<1.4?this.cont.scaleXY=this.cont.scaleXY+6*i:this.step=1,1==this.step&&1<this.cont.scaleXY&&(this.cont.scaleXY=Math.max(1,this.cont.scaleXY-6*i)),1==this.cont.scaleXY&&(this.cont.alpha=Math.max(0,this.cont.alpha-.7*i),0==this.cont.alpha&&this.destroy())},t}(h5ge.Container);n.DropH5=t}(GAME||(GAME={})),function(t){var i=function(t){this.prev=null,this.next=null,this.content=t};t.ListElemH5=i;var n=function(){function t(){this.len=0,this.start=null,this.lastListAdded=null}return t.prototype.addToList=function(t){null!=t&&(null==this.start?this.start=t:(this.lastListAdded.next=t).prev=this.lastListAdded,this.lastListAdded=t,this.len+=1)},t.prototype.removeFromList=function(t){if(null!=t)if(t===this.start)this.len-=1,this.start=this.start.next,this.start&&(this.start.prev=null),this.lastListAdded===t&&(this.lastListAdded=null);else{var i=t.prev,n=t.next;i&&(i.next=n),n&&(n.prev=i),this.lastListAdded===t&&(this.lastListAdded=i),(i||n)&&(this.len-=1)}},t.prototype.removeFromListWithContent=function(t){if(t===this.start.content)this.len-=1,this.start=this.start.next,this.start&&(this.start.prev=null),this.lastListAdded.content===t&&(this.lastListAdded=null);else{for(var i=this.start;null!=i&&i.content!=t;)i=i.next;null!=i&&(i.prev.next=i.next,i.next&&(i.next.prev=i.prev),this.lastListAdded.content==t&&(this.lastListAdded=i.prev),this.len-=1)}},t}();t.ListH5=n}(GAME||(GAME={})),function(a){var t=function(i){function f(){var t=i.call(this)||this;return t.instanData=null,t.fct=null,h5ge.Game.get().addUpdatable(t),t.updatable=!0,t.detachListener.add(t.stopUpdatable,t),t}return __extends(f,i),Object.defineProperty(f.prototype,"data",{get:function(){return this.instanData},enumerable:!0,configurable:!0}),f.prototype.removeSelf=function(){return this.stopUpdatable(),i.prototype.removeSelf.call(this)},f.prototype.setData=function(t,i){null==this.instanData&&(this.instanData={}),this.instanData[t]=i},f.prototype.getData=function(t){return null==this.instanData?null:this.instanData[t]},f.prototype.stopUpdatable=function(){1==this.updatable&&(this.updatable=!1,h5ge.Game.get().removeUpdatable(this))},f.prototype.setBehavior=function(t){this.fct=t},f.prototype.update=function(t){this.fct&&this.fct()},f.newExplode=function(t,i,n,h,s,e){for(var r=new h5ge.Container,u=0;u<t;u++){var o=this.newExplodeParticule(i,n,h,s,e);r.addChild(o)}return r},f.newExplodeParticule=function(t,i,n,h,s){var e=new f,r=h5ge.Sprite.fromFrame(t);null!=i&&(r.tint=i),r.setPivotToCenter(),r.x=.5*-r.width,r.y=.5*-r.height,r.rotation=Math.random()*Math.PI*2,null==h&&(h=1),null==s&&(s=.3);var u=h+Math.random()*s;r.scaleXY=s,e.addChild(r),null==n&&(n=1);var o=2*Math.PI*Math.random();return e.setData("vecX",100*n*Math.cos(o)),e.setData("vecY",100*n*Math.sin(o)),e.setData("z",-1),e.setData("y",0),e.setData("vecZ",-300*Math.random()*n-400),e.setBehavior(function(){var t=a.System.dt;e.data.z<0?(r.scaleXY=u+.001*-e.data.z,r.x+=e.data.vecX*t,r.y=e.data.y+.5*e.data.z,e.data.z+=e.data.vecZ*t,e.data.y+=e.data.vecY*t,e.data.vecZ+=1600*t):(e.stopUpdatable(),e.removeSelf())}),e},f}(h5ge.Container);a.ParticuleH5=t}(GAME||(GAME={})),function(i){var t=function(e){function t(t,i,n,h){var s=e.call(this)||this;return s.explosive=h,s.speed=0,s.callBack=i,s.param=n,s.delay=t||0,s.scaleXY=10,s.alpha=0,s.addUpdatable(),s}return __extends(t,e),t.prototype.onEnd=function(t){this.callBack=t},t.prototype.addUpdatable=function(){1!=this.updatable&&(i.System.game.addUpdatable(this),this.updatable=!0)},t.prototype.stopUpdatable=function(){1==this.updatable&&(i.System.game.removeUpdatable(this),this.updatable=!1)},t.prototype.destroy=function(){return this.stopUpdatable(),e.prototype.removeSelf.call(this)},t.prototype.moveScale=function(t){return this.explosive?(this.speed+=60*t,(-3-this.speed)*t):(6*(1-this.scaleXY)-3)*t},t.prototype.update=function(t){t/=1e3,i.System.log("splashH5"),0!=this.delay&&(this.delay=Math.max(0,this.delay-t)),0==this.delay&&(this.scaleXY+=this.moveScale(t),this.alpha=i.System.range(0,.4+.6/this.scaleXY,1)),this.scaleXY<=1&&(this.callBack&&(this.callBack(this.param)||(this.callBack=null)),this.scaleXY=1,this.stopUpdatable())},t}(h5ge.Container);i.SplashH5=t}(GAME||(GAME={})),function(a){var h=function(){function o(){}return o.ToUint32=function(t){return t>>>0},o.ToInt32=function(t){return t>>0},o.hiBit=function(t){return 2147483648&(t=o.ToUint32(t))},o.loBit=function(t){return 1&(t=o.ToUint32(t))},o.loBits=function(t){return 2147483647&(t=o.ToUint32(t))},o.mixBits=function(t,i){return t=o.ToUint32(t),i=o.ToUint32(i),o.hiBit(t)|o.loBits(i)},o.twist=function(t,i,n){return t=o.ToUint32(t),i=o.ToUint32(i),n=o.ToUint32(n),o.ToUint32(t^o.mixBits(i,n)>>>1^2567483615&o.ToUint32(-o.ToInt32(o.loBit(i))))},o.generate_seed=function(){return Math.random()*Number.MAX_VALUE},o.php_mt_initialize=function(t,i){t=o.ToUint32(t);var n=0,h=0,s=1;for(i[n++]=4294967295&t;s<o.N;++s){var e=i[h]^i[h]>>>30,r=65535&e,u=4294901760&e;i[n++]=o.ToUint32(o.ToUint32(1812433253*r)+o.ToUint32(1812433253*u)+s),h++}},o.php_mt_reload=function(){var t,i=o.Gh,n=0;for(t=o.N-o.M;t--;++n)i[n]=o.twist(i[n+o.M],i[n],i[n+1]);for(t=o.M;--t;++n)i[n]=o.twist(i[n+o.M-o.N],i[n],i[n+1]);i[n]=o.twist(i[n+o.M-o.N],i[n],i[0]),o.Xn=o.N,o.ue=0},o.php_mt_srand=function(t){o.php_mt_initialize(t,o.Gh),o.php_mt_reload(),o.oe=!0},o.php_mt_rand=function(){var t;return 0===o.Xn&&o.php_mt_reload(),--o.Xn,t=o.Gh[o.ue++],t^=t>>>11,t^=t<<7&2636928640,(t^=t<<15&4022730752)^t>>>18},o.srand=function(t){t=t||o.generate_seed(),o.php_mt_srand(t)},o.rand=function(){return o.oe||o.php_mt_srand(o.generate_seed()),(o.php_mt_rand()>>>1)/o.getrandmax()},o.getrandmax=function(){return o.PHP_MT_RAND_MAX},o.N=624,o.M=397,o.PHP_MT_RAND_MAX=2147483647,o.Gh=[],o.Xn=0,o.ue=0,o.oe=!1,o}();a.Mt=h;var i=function(){function t(){this.touchTab={},this.onTouch=null,this.isTouch=null}return t.prototype.getX=function(t){var i=this.touchTab[t];return i?i.x:null},t.prototype.getY=function(t){var i=this.touchTab[t];return i?i.y:null},t.prototype.getTouch=function(t){var i=this.touchTab[t];return i||null},t}();a.MultiTouch=i;var o=function(){this.isTouch=!1,this.onTouch=!1,this.onTouchEnd=!1};a.TouchH5Sys=o;var t=function(){function t(){}return t.up=2,t.down=4,t.left=1,t.right=3,t}();a.Direction=t;var n=function(){function u(){}return u.start=function(){if(!u.started){u.tickcount=0,u.started=!0,u.game=h5ge.Game.get(),u.mouse=u.game.inputManager.mouse,u.keyboard=u.game.inputManager.keyboard,(u.touch=new o).duration=0,u.colorList={white:u.rgb(255,255,255),dark:u.rgb(0,0,0),red:u.rgb(255,0,0),blue:u.rgb(0,0,255),green:u.rgb(0,255,0),yellow:u.rgb(255,255,0),aqua:u.rgb(0,255,255),brown:u.rgb(165,42,42),orange:u.rgb(255,150,0),purple:u.rgb(155,0,255),pink:u.rgb(255,100,255)};var t=new u;u.multiTouch=new i,u.game.addUpdatable(t)}},u.tokenChoose=function(t,i){var n=t.split(i);return n[Math.min(n.length-1,Math.floor(Math.random()*n.length))]},u.tokenAt=function(t,i,n){var h=t.split(i),s=h.length;return 0<=n?h[Math.max(0,Math.min(s-1,n))]:h[Math.max(0,Math.min(s-1,s+n))]},u.tokenCount=function(t,i){return t.split(i).length},u.tokenExist=function(t,i,n){for(var h=t.split(i),s=0;s<h.length;s++)if(t[s]==n)return!0;return!1},u.tokenListToArray=function(t,i){var n,h,s="";if(n=0,h=t.length,null!=t&&0!=h)for(s=""+t[n];++n<h;)s+=""+i+t[n];return s},u.decimal=function(t){return t-Math.floor(t)},u.move=function(t,i,n,h){return h=null==h?10:Math.abs(h),n||0==n||(n=(t-i)*h*u.dt),Math.abs(t-i)<Math.abs(n)?t:i+Math.abs(n)*u.signOf(t-i)},u.move2=function(t,i,n){var h=10*(t-i)*n*u.dt;return Math.abs(t-i)<Math.abs(h)?t:i+Math.abs(h)*u.signOf(t-i)},u.moveAngle=function(t,i,n,h){var s=u.angleDiffH(t,i),e=u.angleDiffAH(t,i),r=Math.min(s,e);return h=null==h?7:Math.abs(h),n=(null!=n?Math.abs(n):r*h)*u.dt,r<=(n*=e<s?1:-1)?t:i+n},u.signOf=function(t){return 0<=t?1:-1},u.roundBy=function(t,i){return Math.ceil(t/i)*i},u.range=function(t,i,n){var h=Math.min(t,n),s=Math.max(t,n);return Math.max(h,Math.min(i,s))},u.rand=function(t,i){var n,h;return n=Math.min(t,i),h=Math.max(t,i),Math.random()*(h-n)+n},u.randINT=function(t,i){var n,h;return n=Math.floor(Math.min(t,i)),h=Math.floor(Math.max(t,i)),Math.floor(Math.random()*(h-n))+n},u.angle=function(t,i,n,h){return Math.atan2(h-i,n-t)},u.isBetweenAngle=function(t,i,n){return u.angleDiffH(t,n)>=u.angleDiffH(t,i)},u.angleDiffO=function(t,i){var n=u.angleDiffAH(t,i),h=u.angleDiffH(t,i);return Math.min(n,h)*(n<h?-1:1)},u.angleDiff=function(t,i){return Math.min(u.angleDiffAH(t,i),u.angleDiffH(t,i))},u.angleDiffH=function(t,i){var n=2*Math.PI;return t+=n*-Math.floor(t/n),(i+=n*-Math.floor(i/n))<t?2*Math.PI-(t-i):i-t},u.angleDiffAH=function(t,i){var n=2*Math.PI;return t+=n*-Math.floor(t/n),(i+=n*-Math.floor(i/n))<=t?t-i:2*Math.PI-(i-t)},u.degToRad=function(t){return t<0&&(t=360-Math.abs(t)%360),360<t&&(t%=360),t*Math.PI/180},u.radToDeg=function(t){return 180*t/Math.PI},u.distance=function(t,i,n,h){var s=n-t,e=h-i;return Math.sqrt(s*s+e*e)},u.distanceFromRec=function(t,i,n){var h,s,e,r=-1;return t>=n.x&&t<=n.x+n.width&&i>=n.y&&i<=n.y+n.height?0:(t>=n.x&&t<=n.x?(s=Math.min(Math.abs(i-n.y),Math.abs(i-(n.y+n.height))),r=-1==r?s:Math.min(r,s)):i>=n.y&&i<=n.y+n.height?(h=Math.min(Math.abs(t-n.x),Math.abs(t-(n.x+n.width))),r=-1==r?h:Math.min(r,h)):(h=Math.min(Math.abs(t-n.x),Math.abs(t-(n.x+n.width))),s=Math.min(Math.abs(i-n.y),Math.abs(i-(n.y+n.height))),e=Math.sqrt(h*h+s*s),r=-1==r?e:Math.min(r,e)),r)},u.moveTo=function(t,i,n){n||0==n||(n=7*u.distance(i.x,i.y,t.x,t.y)*u.dt);var h=u.angle(t.x,t.y,i.x,i.y);Math.abs(t.x-i.x)<n?t.x=i.x:t.x+=n*Math.cos(h),Math.abs(t.y-i.y)<n?t.y=i.y:t.y+=n*Math.sin(h)},u.distanceD=function(t,i,n){var h,s,e,r,u;return h=n.x-i.x,e=-(s=n.y-i.y),r=h,u=s*i.x-h*i.y,Math.abs(e*t.x+r*t.y+u)/Math.sqrt(e*e+r*r)},u.onSegment=function(t,i,n,h){if(u.distanceD(t,i,n)<h){var s=new h5ge.Point(Math.min(i.x,n.x)-h,Math.min(i.y,n.y)-h),e=new h5ge.Point(Math.max(i.x,n.x)+h,Math.max(i.y,n.y)+h);if(t.x>s.x&&t.y>s.y&&t.x<e.x&&t.y<e.y)return!0}return!1},u.getTransformedPoint=function(t,i,n){for(var h,s,e=t.x,r=t.y,u=new a.ListH5;i!==n&&null!=i;)u.addToList(new a.ListElemH5(i)),i=i.parent;for(var o=u.start,f=new h5ge.Point(0,0);null!=o;)f.x=o.content.x+o.content.pivotX,f.y=o.content.y+o.content.pivotY,e=(e-f.x)/o.content.scaleX,r=(r-f.y)/o.content.scaleY,h=e*Math.cos(o.content.rotation)+r*Math.sin(o.content.rotation),s=-e*Math.sin(o.content.rotation)+r*Math.cos(o.content.rotation),e=h,r=s,o=o.next;return new h5ge.Point(e,r)},u.rgb=function(t,i,n,h){var s=0;if(t=Math.floor(t),n=Math.floor(n),i=Math.floor(i),h=Math.floor(h)){var e=t/255,r=n/255,u=i/255;s+=Math.max(0,Math.min(255,h*r+n)),s+=16*Math.max(0,Math.min(255,h*u+i))*16,s+=16*Math.max(0,Math.min(255,h*e+t))*16*16*16}else s+=Math.max(0,Math.min(255,n)),s+=16*Math.max(0,Math.min(255,i))*16,s+=16*Math.max(0,Math.min(255,t))*16*16*16;return s},u.rgbVar=function(t,i,n,h,s,e,r){return u.rgb((t=t<0?0:255<t?255:t)+((h=h<0?0:255<h?255:h)-t)*(r=1<r?1:r<0?0:r),(i=i<0?0:255<i?255:i)+((s=s<0?0:255<s?255:s)-i)*r,(n=n<0?0:255<n?255:n)+((e=e<0?0:255<e?255:e)-n)*r)},u.rgbString=function(t,i,n){var h="0123456789abcdef",s="#";return t=u.range(0,t,255),i=u.range(0,i,255),n=u.range(0,n,255),s+=h[Math.floor(t/16)],s+=h[t%16],s+=h[Math.floor(i/16)],s+=h[n%16],s+=h[Math.floor(n/16)],s+=h[n%16]},u.getTimeLeftBeforeNextDay=function(){var t=u.getTimeStamp();return 24*(u.getDayNumber(t)+1)*60*60*1e3-t},u.getCurrentDayNumber=function(){var t=u.getTimeStamp();return Math.floor(t/864e5)},u.getDayNumber=function(t){return Math.floor(t/864e5)},u.getTimeStamp=function(){return h5ge.UTCDate.now()},u.randomColor=function(){return u.rgb(u.randINT(0,255),u.randINT(0,255),u.randINT(0,255))},u.randomColorList=function(t){return t||(t="green,blue,red,yellow,orange,purple,pink"),u.colorStringToTint(u.tokenChoose(t,","))},u.colorStringToTint=function(t){return u.started?u.colorList[t]?u.colorList[t]:u.rgb(255,255,255):(alert("init System with System.start() before using colorString"),0)},u.tintToColorName=function(t){var i="black";return t==u.colorStringToTint("white")&&(i="white"),t==u.colorStringToTint("dark")&&(i="dark"),t==u.colorStringToTint("red")&&(i="red"),t==u.colorStringToTint("blue")&&(i="blue"),t==u.colorStringToTint("green")&&(i="green"),t==u.colorStringToTint("yellow")&&(i="yellow"),t==u.colorStringToTint("brown")&&(i="brown"),t==u.colorStringToTint("orange")&&(i="orange"),t==u.colorStringToTint("purple")&&(i="purple"),t==u.colorStringToTint("pink")&&(i="pink"),t==u.colorStringToTint("aqua")&&(i="aqua"),i},u.choose=function(t,i){if(null==t)return null;var n=null!=i?i:t.length;return 0==n?null:t[Math.floor(h.rand()*n)]},u.deleteTable=function(t){for(;t&&0<t.length;)t.shift();t=null},u.copyTable=function(t){var i;if(null==t)i=null;else{i=[];for(var n=0;n<t.length;n++)i.push(t[n])}return i},u.pickRandom=function(t){return t[Math.min(t.length-1,Math.floor(Math.random()*t.length))]},u.link=function(t,i,n){var h=Math.max(t,n),s=Math.min(t,n);if(h<i){var e=h-s;i=s+(r=i-h)-Math.floor(r/e)*e}else if(i<s){var r;e=h-s;i=h-((r=Math.abs(i-s))-Math.floor(r/e)*e)}return i},u.apply=function(t,i){if(u.aplStop=!1,i)for(var n=0;n<i.length&&(i[n]&&t(i[n]),!u.aplStop);n++);u.aplStop=!1},u.applyStop=function(){u.aplStop=!0},u.reduce=function(t,i){var n=[];if(i)for(var h=0;h<i.length;h++)1!=t(i[h])&&n.push(i[h]);return n},u.getNumberString=function(t){for(var i=""+Math.floor(t),n="",h=i.length,s=0;s<h;s++)n=i.charAt(h-s-1)+(0!=s&&s%3==0?" ":"")+n;return n},u.timeString=function(t,i,n,h){var s,e,r="";(s=i?["T ",":"," : ",h?".":""]:["d ","h ","m ","s "],n)?(86400<=t&&(r=r+Math.floor(t/86400)+s[0]),3600<=t&&(r=r+Math.floor(t%86400/3600)+s[1]),e=t%3600/60,r=(r+=Math.floor(e/10))+Math.floor(e%10)+s[2],e=t%60,r=(r+=Math.floor(e/10))+Math.floor(e%10)+s[3],h&&(e=t%1,r=r+Math.floor(10*e)+Math.floor(100*e)%10)):(86400<=t&&(r=r+Math.floor(t/86400)+s[0]),3600<=t&&(r=r+Math.floor(t%86400/3600)+s[1]),60<=t&&(r=r+Math.floor(t%3600/60)+s[2]),r=r+Math.floor(t%60)+s[3],h&&(t%=1,r=r+Math.floor(10*t)+Math.floor(100*t)%10));return r},u.strCut=function(t,i,n){if(!t)return null;if(i<t.length){for(var h=0,s=t.charAt(h++);s+=t.charAt(h++),h<i;);return n&&(s+="..."),s}return t},u.getXFromD=function(t,i,n){var h,s,e;return h=i.x-t.x,e=-(s=i.y-t.y),-(h*n+(s*t.x-h*t.y))/e},u.getYFromD=function(t,i,n){var h,s,e;return e=h=i.x-t.x,-(-(s=i.y-t.y)*n+(s*t.x-h*t.y))/e},u.angleToDir=function(t){return(Math.ceil(t/(Math.PI/2))+2)%4+1},u.dirToAngle=function(t){var i=0;return i=1==t?180:i,i=2==t?270:i,u.degToRad(i=4==t?90:i)},u.isFactorOf=function(t,i){return Math.floor(t/i)==t/i},Object.defineProperty(u,"mouseX",{get:function(){return u.game.inputManager.mouse.position.x},enumerable:!0,configurable:!0}),Object.defineProperty(u,"mouseY",{get:function(){return u.game.inputManager.mouse.position.y},enumerable:!0,configurable:!0}),u.middelWindow=function(){return new h5ge.Point(u.game.width/2,u.game.height/2)},u.trigger=function(t){null==this.triggerOnceList[t]&&(this.triggerOnceList[t]={}),null!=this.triggerOnceList[t].tickCount&&this.triggerOnceList[t].tickCount+1==u.tickcount?this.triggerOnceList[t].duration+=u.dt:this.triggerOnceList[t].duration=0,this.triggerOnceList[t].tickCount=u.tickcount},u.triggerDuration=function(t){return u.trigger(t),u.triggerOnceList[t].duration},u.triggerOnce=function(t){return u.trigger(t),0==this.triggerOnceList[t].duration},u.waitAndDo=function(t,i){u.waitTable||(u.waitTable=[]);var n=[];n[0]=t,n[1]=i,u.waitTable.push(n)},u.doWait=function(t){t/=1e3;for(var i=u.waitTable.length,n=0;n<i;n++)u.waitTable[n][0]-=t,u.waitTable[n][0]<=0&&(u.waitTable[n][1](),u.waitTable.splice(n,1),n--,i--)},Object.defineProperty(u.prototype,"tickCount",{get:function(){return u.started?u.tickcount:(alert("init System with System.start() before using System.tickCount"),0)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"dt",{get:function(){return u.started?u.dt:(alert("init System with System.start() before using System.dt"),0)},enumerable:!0,configurable:!0}),u.everyXTick=function(t){return u.started?(t=Math.max(1,t),Math.floor(u.tickcount/t)==u.tickcount/t):(alert("init System with System.start() before using tick comparaison"),!1)},u.addUpdatableFunct=function(t,i){u.sys_Updatablefunction[i]=t},u.removeUpdatableFunct=function(t){delete u.sys_Updatablefunction[t]},u.prototype.updateFunction=function(){var t;for(var i in u.sys_Updatablefunction)(t=u.sys_Updatablefunction[i])&&t()},u.addEventEveryX=function(t,i){var n={};return u.eventId++,n.id=u.eventId,n.interval=1e3*t,n.timeCount=0,n.action=i,u.eventTable.push(n),u.eventId},u.stopEvent=function(t){u.eventStopTable.push(t)},u.prototype.sys_stopEvent=function(){for(var t,i;0<u.eventStopTable.length;){t=u.eventStopTable.shift(),i=u.eventTable.length;for(var n=0;n<i;n++)if(u.eventTable[n].id==t){u.eventTable.splice(n);break}}},u.prototype.updateEvent=function(t){if(null!=u.eventTable)for(var i,n=u.eventTable.length,h=0;h<n;h++)(i=u.eventTable[h]).timeCount+=t,i.timeCount>=i.interval&&(i.timeCount=i.timeCount-i.interval,i.action())},u.prototype.updateTouchObject=function(){u.mouse.isDown?(u.touch.lastTouchX=u.touch.x,u.touch.lastTouchY=u.touch.y,u.touch.x=u.mouseX,u.touch.y=u.mouseY,u.touch.isTouch?(u.touch.onTouch=!1,u.touch.duration+=u.dt,u.touch.vecX=u.touch.x-u.touch.lastTouchX,u.touch.vecY=u.touch.y-u.touch.lastTouchY):(u.touch.onTouch=!0,u.touch.onTouchX=u.mouseX,u.touch.onTouchY=u.mouseY,u.touch.vecX=0,u.touch.vecY=0),u.touch.isTouch=!0):u.touch.isTouch?(u.touch.onTouchEnd=!0,u.touch.isTouch=!1):(u.touch.onTouchEnd=!1,u.touch.duration=0,u.touch.x=0,u.touch.y=0,u.touch.onTouchX=0,u.touch.onTouchY=0)},u.prototype.updateTouch=function(t){var i=t.pointer;i&&i.isActive()&&i.isDown?(t.lastTouchX=t.x,t.lastTouchY=t.y,t.x=i.position.x,t.y=i.position.y,t.isTouch?(t.onTouch=!1,t.duration+=u.dt,t.vecX=t.x-t.lastTouchX,t.vecY=t.y-t.lastTouchY):(t.onTouch=!0,u.multiTouch.onTouch=t.uid,t.onTouchX=i.position.x,t.onTouchY=i.position.y,t.vecX=0,t.vecY=0),t.isTouch=!0,u.multiTouch.isTouch=t.uid):t.isTouch?(t.onTouchEnd=!0,u.multiTouch.onTouchEnd=t.uid,t.isTouch=!1):(t.onTouchEnd=!1,t.duration=0,t.x=0,t.y=0,t.onTouchX=0,t.onTouchY=0)},u.prototype.updateMultiTouch=function(){u.multiTouch.isTouch=null,u.multiTouch.onTouch=null,u.multiTouch.onTouchEnd=null;for(var t=u.mouse.pointers,i=t?t.length:0,n=0;n<i;n++){var h=t[n];if(h&&h.isActive()){var s=h.identifier+"_uid";(r=u.multiTouch.touchTab[s])||((r=new o).pointer=h,r.uid=s,u.multiTouch.touchTab[s]=r,this.updateTouch(r))}}for(var e in u.multiTouch.touchTab){var r=u.multiTouch.touchTab[e];this.updateTouch(r),1!=r.isTouch&&1!=r.onTouchEnd&&delete u.multiTouch.touchTab[e]}},u.log=function(t){1==u.logOn&&console.log(t)},u.sleep=function(t){for(var i=new Date;(new Date).getMilliseconds()-i.getMilliseconds()<t;);},u.prototype.update=function(t){u.tickcount++,u.dt=t/1e3,this.sys_stopEvent(),this.updateEvent(t),u.waitTable&&u.doWait(t),this.updateTouchObject(),this.updateMultiTouch(),u.mouseVecX=u.mouseX-u.lastMouseX,u.mouseVecY=u.mouseY-u.lastMouseY,u.lastMouseX=u.mouseX,u.lastMouseY=u.mouseY,this.updateFunction()},u.sys_Updatablefunction={},u.triggerOnceList={},u.eventTable=[],u.eventStopTable=[],u.eventId=0,u.H5PNG_PATH="H5/",u}();a.System=n}(GAME||(GAME={})),function(i){var t=function(){function t(t){this.updatable=!1,this.objToUpdt=t}return t.prototype.addUpdatable=function(){1!=this.updatable&&(this.updatable=!0,i.Game.get().addUpdatable(this.objToUpdt))},t.prototype.stopUpdatable=function(){1==this.updatable&&(this.updatable=!1,i.Game.get().removeUpdatable(this.objToUpdt))},t}();i.UpdaterH5=t}(GAME||(GAME={})),function(t){var i;(i=t.factory||(t.factory={})).newText=function(t,i,n){return void 0===i&&(i=32),void 0===n&&(n="text"),new h5ge.BitmapText(t,n,i)},i.newTextDigit=function(t,i,n){return void 0===i&&(i=32),void 0===n&&(n="digit"),new h5ge.BitmapText(t,n,i)}}(GAME||(GAME={})),function(t){var i=function(){function i(){i.INSTANCE=this,i.audioManager=h5ge.AudioManager.get(),i.load(this)}return i.load=function(t){this.audioManager.loadSounds([{type:"soundsheet",name:"sounds",file:"game/assets/sounds/sounds.json"}],function(){i.ready=!0,i.sound=h5ge.AudioManager.get().getSoundSprite("sounds"),t.sound=i.sound,t.musicId=i.play("music"),t.sound.loop(!0,t.musicId),t.sound.setVolume(.5,t.musicId)})},i.prototype.setMusicOn=function(t){this.sound.setVolume(t?1:0,this.musicId)},i.get=function(){if(null==i.INSTANCE)new i;return i.INSTANCE},i.play=function(t,i){return this.ready?this.sound.play(t,function(){i&&i()}):null},i.ready=!1,i}();t.SoundManager=i}(GAME||(GAME={})),function(t){!function(t){t.fonts=[];t.fonts.push({face:"text",size:40,lineHeight:45,chars:[{id:260,x:2,y:2,width:30,height:37,xoffset:0,yoffset:7,xadvance:31},{id:350,x:34,y:2,width:22,height:37,xoffset:1,yoffset:7,xadvance:25},{id:280,x:58,y:2,width:20,height:37,xoffset:3,yoffset:7,xadvance:24},{id:106,x:80,y:2,width:8,height:37,xoffset:0,yoffset:7,xadvance:10},{id:199,x:90,y:2,width:24,height:37,xoffset:2,yoffset:7,xadvance:27},{id:255,x:116,y:2,width:21,height:37,xoffset:0,yoffset:7,xadvance:21},{id:81,x:139,y:2,width:28,height:37,xoffset:2,yoffset:7,xadvance:32},{id:311,x:169,y:2,width:21,height:36,xoffset:2,yoffset:7,xadvance:24},{id:192,x:192,y:2,width:30,height:36,xoffset:0,yoffset:0,xadvance:31},{id:194,x:224,y:2,width:30,height:36,xoffset:0,yoffset:0,xadvance:31},{id:207,x:256,y:2,width:11,height:36,xoffset:0,yoffset:0,xadvance:11},{id:1025,x:269,y:2,width:20,height:36,xoffset:3,yoffset:0,xadvance:24},{id:352,x:291,y:2,width:22,height:36,xoffset:1,yoffset:0,xadvance:25},{id:287,x:315,y:2,width:20,height:36,xoffset:1,yoffset:7,xadvance:23},{id:200,x:337,y:2,width:20,height:36,xoffset:3,yoffset:0,xadvance:24},{id:291,x:359,y:2,width:20,height:36,xoffset:1,yoffset:7,xadvance:23},{id:40,x:381,y:2,width:9,height:36,xoffset:2,yoffset:7,xadvance:13},{id:41,x:392,y:2,width:9,height:36,xoffset:1,yoffset:7,xadvance:13},{id:1065,x:403,y:2,width:37,height:36,xoffset:3,yoffset:7,xadvance:41},{id:1062,x:442,y:2,width:27,height:36,xoffset:3,yoffset:7,xadvance:30},{id:209,x:471,y:2,width:25,height:36,xoffset:3,yoffset:0,xadvance:31},{id:211,x:498,y:2,width:28,height:36,xoffset:2,yoffset:0,xadvance:32},{id:362,x:528,y:2,width:24,height:36,xoffset:3,yoffset:0,xadvance:30},{id:256,x:554,y:2,width:30,height:36,xoffset:0,yoffset:0,xadvance:31},{id:201,x:586,y:2,width:20,height:36,xoffset:3,yoffset:0,xadvance:24},{id:124,x:608,y:2,width:6,height:36,xoffset:3,yoffset:7,xadvance:11},{id:202,x:616,y:2,width:20,height:36,xoffset:3,yoffset:0,xadvance:24},{id:1044,x:638,y:2,width:34,height:36,xoffset:0,yoffset:7,xadvance:35},{id:381,x:674,y:2,width:21,height:36,xoffset:2,yoffset:0,xadvance:24},{id:64,x:697,y:2,width:38,height:36,xoffset:2,yoffset:7,xadvance:42},{id:1092,x:737,y:2,width:30,height:36,xoffset:1,yoffset:7,xadvance:32},{id:203,x:769,y:2,width:20,height:36,xoffset:3,yoffset:0,xadvance:24},{id:379,x:791,y:2,width:21,height:36,xoffset:2,yoffset:0,xadvance:24},{id:205,x:814,y:2,width:9,height:36,xoffset:3,yoffset:0,xadvance:11},{id:123,x:825,y:2,width:12,height:36,xoffset:2,yoffset:7,xadvance:15},{id:125,x:839,y:2,width:12,height:36,xoffset:1,yoffset:7,xadvance:15},{id:91,x:853,y:2,width:11,height:36,xoffset:2,yoffset:7,xadvance:13},{id:93,x:866,y:2,width:11,height:36,xoffset:1,yoffset:7,xadvance:13},{id:377,x:879,y:2,width:21,height:36,xoffset:2,yoffset:0,xadvance:24},{id:206,x:902,y:2,width:10,height:36,xoffset:1,yoffset:0,xadvance:11},{id:290,x:914,y:2,width:24,height:36,xoffset:2,yoffset:7,xadvance:27},{id:196,x:940,y:2,width:30,height:36,xoffset:0,yoffset:0,xadvance:31},{id:316,x:972,y:2,width:9,height:36,xoffset:-1,yoffset:7,xadvance:10},{id:268,x:983,y:2,width:24,height:36,xoffset:2,yoffset:0,xadvance:27},{id:274,x:2,y:43,width:20,height:36,xoffset:3,yoffset:0,xadvance:24},{id:262,x:24,y:43,width:24,height:36,xoffset:2,yoffset:0,xadvance:27},{id:212,x:50,y:43,width:28,height:36,xoffset:2,yoffset:0,xadvance:32},{id:214,x:80,y:43,width:28,height:36,xoffset:2,yoffset:0,xadvance:32},{id:218,x:110,y:43,width:24,height:36,xoffset:3,yoffset:0,xadvance:30},{id:217,x:136,y:43,width:24,height:36,xoffset:3,yoffset:0,xadvance:30},{id:286,x:162,y:43,width:24,height:36,xoffset:2,yoffset:0,xadvance:27},{id:346,x:188,y:43,width:22,height:36,xoffset:1,yoffset:0,xadvance:25},{id:325,x:212,y:43,width:25,height:36,xoffset:3,yoffset:7,xadvance:31},{id:219,x:239,y:43,width:24,height:36,xoffset:3,yoffset:0,xadvance:30},{id:220,x:265,y:43,width:24,height:36,xoffset:3,yoffset:0,xadvance:30},{id:323,x:291,y:43,width:25,height:36,xoffset:3,yoffset:0,xadvance:31},{id:315,x:318,y:43,width:17,height:36,xoffset:3,yoffset:7,xadvance:21},{id:310,x:337,y:43,width:26,height:36,xoffset:3,yoffset:7,xadvance:28},{id:298,x:365,y:43,width:10,height:36,xoffset:1,yoffset:0,xadvance:11},{id:1049,x:377,y:43,width:23,height:35,xoffset:3,yoffset:1,xadvance:29},{id:376,x:402,y:43,width:27,height:35,xoffset:0,yoffset:0,xadvance:25},{id:1073,x:431,y:43,width:22,height:31,xoffset:1,yoffset:5,xadvance:25},{id:121,x:455,y:43,width:21,height:29,xoffset:0,yoffset:15,xadvance:21},{id:1069,x:478,y:43,width:23,height:29,xoffset:2,yoffset:7,xadvance:27},{id:1057,x:503,y:43,width:24,height:29,xoffset:2,yoffset:7,xadvance:27},{id:1047,x:529,y:43,width:19,height:29,xoffset:2,yoffset:7,xadvance:22},{id:67,x:550,y:43,width:24,height:29,xoffset:2,yoffset:7,xadvance:27},{id:49,x:576,y:43,width:8,height:29,xoffset:2,yoffset:7,xadvance:13},{id:1054,x:586,y:43,width:28,height:29,xoffset:2,yoffset:7,xadvance:32},{id:1070,x:616,y:43,width:35,height:29,xoffset:3,yoffset:7,xadvance:39},{id:71,x:653,y:43,width:24,height:29,xoffset:2,yoffset:7,xadvance:27},{id:37,x:679,y:43,width:26,height:29,xoffset:2,yoffset:7,xadvance:29},{id:102,x:707,y:43,width:14,height:29,xoffset:2,yoffset:6,xadvance:13},{id:57,x:723,y:43,width:22,height:29,xoffset:2,yoffset:7,xadvance:25},{id:281,x:747,y:43,width:19,height:29,xoffset:1,yoffset:15,xadvance:22},{id:231,x:768,y:43,width:17,height:29,xoffset:1,yoffset:15,xadvance:19},{id:1091,x:787,y:43,width:21,height:29,xoffset:0,yoffset:15,xadvance:21},{id:351,x:810,y:43,width:18,height:29,xoffset:1,yoffset:15,xadvance:20},{id:79,x:830,y:43,width:28,height:29,xoffset:2,yoffset:7,xadvance:32},{id:56,x:860,y:43,width:22,height:29,xoffset:2,yoffset:7,xadvance:25},{id:54,x:884,y:43,width:22,height:29,xoffset:2,yoffset:7,xadvance:24},{id:48,x:908,y:43,width:25,height:29,xoffset:2,yoffset:7,xadvance:28},{id:83,x:935,y:43,width:22,height:29,xoffset:1,yoffset:7,xadvance:25},{id:51,x:959,y:43,width:19,height:29,xoffset:2,yoffset:7,xadvance:22},{id:261,x:980,y:43,width:19,height:29,xoffset:1,yoffset:15,xadvance:22},{id:84,x:2,y:83,width:22,height:28,xoffset:0,yoffset:7,xadvance:21},{id:87,x:26,y:83,width:36,height:28,xoffset:1,yoffset:7,xadvance:37},{id:74,x:64,y:83,width:11,height:28,xoffset:0,yoffset:7,xadvance:14},{id:33,x:77,y:83,width:6,height:28,xoffset:3,yoffset:7,xadvance:11},{id:82,x:85,y:83,width:24,height:28,xoffset:3,yoffset:7,xadvance:26},{id:88,x:111,y:83,width:29,height:28,xoffset:0,yoffset:7,xadvance:29},{id:224,x:142,y:83,width:19,height:28,xoffset:1,yoffset:7,xadvance:22},{id:226,x:163,y:83,width:19,height:28,xoffset:1,yoffset:7,xadvance:22},{id:228,x:184,y:83,width:19,height:28,xoffset:1,yoffset:7,xadvance:22},{id:80,x:205,y:83,width:21,height:28,xoffset:3,yoffset:7,xadvance:24},{id:78,x:228,y:83,width:25,height:28,xoffset:3,yoffset:7,xadvance:31},{id:233,x:255,y:83,width:19,height:28,xoffset:1,yoffset:7,xadvance:22},{id:90,x:276,y:83,width:21,height:28,xoffset:2,yoffset:7,xadvance:24},{id:235,x:299,y:83,width:19,height:28,xoffset:1,yoffset:7,xadvance:22},{id:89,x:320,y:83,width:27,height:28,xoffset:0,yoffset:7,xadvance:25},{id:223,x:349,y:83,width:21,height:28,xoffset:2,yoffset:7,xadvance:24},{id:239,x:372,y:83,width:11,height:28,xoffset:0,yoffset:7,xadvance:10},{id:241,x:385,y:83,width:19,height:28,xoffset:2,yoffset:7,xadvance:24},{id:243,x:406,y:83,width:21,height:28,xoffset:1,yoffset:7,xadvance:23},{id:77,x:429,y:83,width:30,height:28,xoffset:3,yoffset:7,xadvance:35},{id:246,x:461,y:83,width:21,height:28,xoffset:1,yoffset:7,xadvance:23},{id:250,x:484,y:83,width:19,height:28,xoffset:2,yoffset:7,xadvance:23},{id:249,x:505,y:83,width:19,height:28,xoffset:2,yoffset:7,xadvance:23},{id:251,x:526,y:83,width:19,height:28,xoffset:2,yoffset:7,xadvance:23},{id:252,x:547,y:83,width:19,height:28,xoffset:2,yoffset:7,xadvance:23},{id:53,x:568,y:83,width:19,height:28,xoffset:2,yoffset:7,xadvance:23},{id:257,x:589,y:83,width:19,height:28,xoffset:1,yoffset:7,xadvance:22},{id:232,x:610,y:83,width:19,height:28,xoffset:1,yoffset:7,xadvance:22},{id:234,x:631,y:83,width:19,height:28,xoffset:1,yoffset:7,xadvance:22},{id:269,x:652,y:83,width:17,height:28,xoffset:1,yoffset:7,xadvance:19},{id:275,x:671,y:83,width:19,height:28,xoffset:1,yoffset:7,xadvance:22},{id:75,x:692,y:83,width:26,height:28,xoffset:3,yoffset:7,xadvance:28},{id:76,x:720,y:83,width:17,height:28,xoffset:3,yoffset:7,xadvance:21},{id:72,x:739,y:83,width:24,height:28,xoffset:3,yoffset:7,xadvance:30},{id:299,x:765,y:83,width:10,height:28,xoffset:0,yoffset:7,xadvance:10},{id:237,x:777,y:83,width:9,height:28,xoffset:2,yoffset:7,xadvance:10},{id:70,x:788,y:83,width:19,height:28,xoffset:3,yoffset:7,xadvance:23},{id:322,x:809,y:83,width:11,height:28,xoffset:0,yoffset:7,xadvance:11},{id:324,x:822,y:83,width:19,height:28,xoffset:2,yoffset:7,xadvance:24},{id:238,x:843,y:83,width:10,height:28,xoffset:0,yoffset:7,xadvance:10},{id:347,x:855,y:83,width:18,height:28,xoffset:1,yoffset:7,xadvance:20},{id:244,x:875,y:83,width:21,height:28,xoffset:1,yoffset:7,xadvance:23},{id:353,x:898,y:83,width:18,height:28,xoffset:1,yoffset:7,xadvance:20},{id:363,x:918,y:83,width:19,height:28,xoffset:2,yoffset:7,xadvance:23},{id:378,x:939,y:83,width:17,height:28,xoffset:2,yoffset:7,xadvance:19},{id:380,x:958,y:83,width:17,height:28,xoffset:2,yoffset:7,xadvance:19},{id:382,x:977,y:83,width:17,height:28,xoffset:2,yoffset:7,xadvance:19},{id:69,x:996,y:83,width:20,height:28,xoffset:3,yoffset:7,xadvance:24},{id:263,x:2,y:115,width:17,height:28,xoffset:1,yoffset:7,xadvance:19},{id:68,x:21,y:115,width:25,height:28,xoffset:3,yoffset:7,xadvance:29},{id:66,x:48,y:115,width:22,height:28,xoffset:3,yoffset:7,xadvance:26},{id:65,x:72,y:115,width:30,height:28,xoffset:0,yoffset:7,xadvance:31},{id:1076,x:104,y:115,width:28,height:28,xoffset:0,yoffset:15,xadvance:29},{id:113,x:134,y:115,width:20,height:28,xoffset:1,yoffset:15,xadvance:23},{id:112,x:156,y:115,width:19,height:28,xoffset:2,yoffset:15,xadvance:23},{id:108,x:177,y:115,width:6,height:28,xoffset:2,yoffset:7,xadvance:10},{id:107,x:185,y:115,width:21,height:28,xoffset:2,yoffset:7,xadvance:24},{id:1081,x:208,y:115,width:20,height:28,xoffset:2,yoffset:7,xadvance:25},{id:55,x:230,y:115,width:20,height:28,xoffset:2,yoffset:7,xadvance:23},{id:105,x:252,y:115,width:6,height:28,xoffset:2,yoffset:7,xadvance:10},{id:104,x:260,y:115,width:19,height:28,xoffset:2,yoffset:7,xadvance:24},{id:103,x:281,y:115,width:20,height:28,xoffset:1,yoffset:15,xadvance:23},{id:100,x:303,y:115,width:19,height:28,xoffset:1,yoffset:7,xadvance:23},{id:98,x:324,y:115,width:19,height:28,xoffset:2,yoffset:7,xadvance:23},{id:1088,x:345,y:115,width:20,height:28,xoffset:2,yoffset:15,xadvance:23},{id:38,x:367,y:115,width:24,height:28,xoffset:2,yoffset:7,xadvance:26},{id:36,x:393,y:115,width:18,height:28,xoffset:1,yoffset:7,xadvance:20},{id:73,x:413,y:115,width:6,height:28,xoffset:3,yoffset:7,xadvance:11},{id:35,x:421,y:115,width:33,height:28,xoffset:2,yoffset:7,xadvance:37},{id:92,x:456,y:115,width:20,height:28,xoffset:0,yoffset:7,xadvance:21},{id:1094,x:478,y:115,width:24,height:28,xoffset:2,yoffset:15,xadvance:27},{id:47,x:504,y:115,width:20,height:28,xoffset:0,yoffset:7,xadvance:21},{id:63,x:526,y:115,width:18,height:28,xoffset:2,yoffset:7,xadvance:22},{id:1097,x:546,y:115,width:33,height:28,xoffset:2,yoffset:15,xadvance:36},{id:86,x:581,y:115,width:30,height:28,xoffset:0,yoffset:7,xadvance:30},{id:85,x:613,y:115,width:24,height:28,xoffset:3,yoffset:7,xadvance:30},{id:326,x:639,y:115,width:19,height:28,xoffset:2,yoffset:15,xadvance:24},{id:1066,x:660,y:115,width:32,height:28,xoffset:0,yoffset:7,xadvance:33},{id:1060,x:694,y:115,width:30,height:28,xoffset:2,yoffset:7,xadvance:34},{id:1059,x:726,y:115,width:24,height:28,xoffset:1,yoffset:7,xadvance:26},{id:1105,x:752,y:115,width:19,height:28,xoffset:1,yoffset:7,xadvance:22},{id:1058,x:773,y:115,width:22,height:28,xoffset:0,yoffset:7,xadvance:21},{id:1063,x:797,y:115,width:24,height:28,xoffset:2,yoffset:7,xadvance:27},{id:1056,x:823,y:115,width:21,height:28,xoffset:3,yoffset:7,xadvance:24},{id:52,x:846,y:115,width:23,height:28,xoffset:1,yoffset:7,xadvance:24},{id:1055,x:871,y:115,width:25,height:28,xoffset:3,yoffset:7,xadvance:31},{id:1064,x:898,y:115,width:33,height:28,xoffset:3,yoffset:7,xadvance:39},{id:1053,x:933,y:115,width:25,height:28,xoffset:3,yoffset:7,xadvance:31},{id:1052,x:960,y:115,width:30,height:28,xoffset:3,yoffset:7,xadvance:35},{id:1051,x:992,y:115,width:27,height:28,xoffset:0,yoffset:7,xadvance:30},{id:1050,x:2,y:147,width:24,height:28,xoffset:3,yoffset:7,xadvance:27},{id:50,x:28,y:147,width:19,height:28,xoffset:2,yoffset:7,xadvance:23},{id:1048,x:49,y:147,width:23,height:28,xoffset:3,yoffset:7,xadvance:29},{id:1067,x:74,y:147,width:30,height:28,xoffset:3,yoffset:7,xadvance:33},{id:1046,x:106,y:147,width:43,height:28,xoffset:0,yoffset:7,xadvance:43},{id:1045,x:151,y:147,width:20,height:28,xoffset:3,yoffset:7,xadvance:24},{id:1068,x:173,y:147,width:22,height:28,xoffset:3,yoffset:7,xadvance:25},{id:1043,x:197,y:147,width:19,height:28,xoffset:3,yoffset:7,xadvance:21},{id:1042,x:218,y:147,width:22,height:28,xoffset:3,yoffset:7,xadvance:26},{id:1041,x:242,y:147,width:21,height:28,xoffset:3,yoffset:7,xadvance:25},{id:1040,x:265,y:147,width:30,height:28,xoffset:0,yoffset:7,xadvance:31},{id:1071,x:297,y:147,width:24,height:28,xoffset:0,yoffset:7,xadvance:27},{id:321,x:323,y:147,width:20,height:28,xoffset:3,yoffset:7,xadvance:24},{id:1061,x:345,y:147,width:29,height:28,xoffset:0,yoffset:7,xadvance:29},{id:59,x:376,y:147,width:8,height:26,xoffset:2,yoffset:15,xadvance:12},{id:775,x:386,y:147,width:20,height:25,xoffset:1,yoffset:10,xadvance:22},{id:116,x:408,y:147,width:10,height:24,xoffset:2,yoffset:12,xadvance:13},{id:1086,x:420,y:147,width:22,height:22,xoffset:1,yoffset:14,xadvance:24},{id:118,x:444,y:147,width:21,height:21,xoffset:0,yoffset:15,xadvance:21},{id:117,x:467,y:147,width:19,height:21,xoffset:2,yoffset:15,xadvance:23},{id:120,x:488,y:147,width:21,height:21,xoffset:0,yoffset:15,xadvance:21},{id:115,x:511,y:147,width:18,height:21,xoffset:1,yoffset:15,xadvance:20},{id:122,x:531,y:147,width:17,height:21,xoffset:2,yoffset:15,xadvance:19},{id:114,x:550,y:147,width:11,height:21,xoffset:2,yoffset:15,xadvance:13},{id:111,x:563,y:147,width:21,height:21,xoffset:1,yoffset:15,xadvance:23},{id:110,x:586,y:147,width:19,height:21,xoffset:2,yoffset:15,xadvance:24},{id:1101,x:607,y:147,width:17,height:21,xoffset:1,yoffset:15,xadvance:18},{id:101,x:626,y:147,width:19,height:21,xoffset:1,yoffset:15,xadvance:22},{id:99,x:647,y:147,width:17,height:21,xoffset:1,yoffset:15,xadvance:19},{id:97,x:666,y:147,width:19,height:21,xoffset:1,yoffset:15,xadvance:22},{id:1072,x:687,y:147,width:19,height:21,xoffset:1,yoffset:15,xadvance:22},{id:1074,x:708,y:147,width:19,height:21,xoffset:2,yoffset:15,xadvance:22},{id:1075,x:729,y:147,width:14,height:21,xoffset:2,yoffset:15,xadvance:16},{id:1077,x:745,y:147,width:19,height:21,xoffset:1,yoffset:15,xadvance:22},{id:1078,x:766,y:147,width:36,height:21,xoffset:0,yoffset:15,xadvance:37},{id:119,x:804,y:147,width:30,height:21,xoffset:1,yoffset:15,xadvance:31},{id:1080,x:836,y:147,width:20,height:21,xoffset:2,yoffset:15,xadvance:25},{id:1082,x:858,y:147,width:21,height:21,xoffset:2,yoffset:15,xadvance:23},{id:1083,x:881,y:147,width:22,height:21,xoffset:0,yoffset:15,xadvance:24},{id:1084,x:905,y:147,width:25,height:21,xoffset:2,yoffset:15,xadvance:29},{id:1085,x:932,y:147,width:20,height:21,xoffset:2,yoffset:15,xadvance:25},{id:1079,x:954,y:147,width:15,height:21,xoffset:1,yoffset:15,xadvance:17},{id:1087,x:971,y:147,width:20,height:21,xoffset:2,yoffset:15,xadvance:25},{id:1089,x:993,y:147,width:17,height:21,xoffset:1,yoffset:15,xadvance:19},{id:1090,x:2,y:179,width:18,height:21,xoffset:0,yoffset:15,xadvance:18},{id:1093,x:22,y:179,width:21,height:21,xoffset:0,yoffset:15,xadvance:21},{id:1095,x:45,y:179,width:20,height:21,xoffset:2,yoffset:15,xadvance:24},{id:1096,x:67,y:179,width:30,height:21,xoffset:2,yoffset:15,xadvance:34},{id:1098,x:99,y:179,width:25,height:21,xoffset:0,yoffset:15,xadvance:26},{id:1099,x:126,y:179,width:26,height:21,xoffset:2,yoffset:15,xadvance:30},{id:1100,x:154,y:179,width:19,height:21,xoffset:2,yoffset:15,xadvance:22},{id:1103,x:175,y:179,width:19,height:21,xoffset:0,yoffset:15,xadvance:22},{id:1102,x:196,y:179,width:29,height:21,xoffset:2,yoffset:15,xadvance:32},{id:109,x:227,y:179,width:31,height:21,xoffset:2,yoffset:15,xadvance:35},{id:58,x:260,y:179,width:6,height:21,xoffset:2,yoffset:15,xadvance:10},{id:94,x:268,y:179,width:19,height:15,xoffset:1,yoffset:7,xadvance:21},{id:43,x:289,y:179,width:15,height:15,xoffset:2,yoffset:18,xadvance:19},{id:42,x:306,y:179,width:12,height:12,xoffset:2,yoffset:7,xadvance:16},{id:61,x:320,y:179,width:15,height:11,xoffset:2,yoffset:20,xadvance:19},{id:44,x:337,y:179,width:8,height:9,xoffset:0,yoffset:32,xadvance:9},{id:34,x:347,y:179,width:12,height:9,xoffset:2,yoffset:7,xadvance:16},{id:39,x:361,y:179,width:5,height:9,xoffset:2,yoffset:7,xadvance:9},{id:46,x:368,y:179,width:6,height:5,xoffset:2,yoffset:31,xadvance:9},{id:95,x:376,y:179,width:20,height:4,xoffset:0,yoffset:35,xadvance:21},{id:45,x:398,y:179,width:10,height:4,xoffset:2,yoffset:23,xadvance:14},{id:32,x:0,y:0,width:0,height:0,xoffset:2,yoffset:23,xadvance:9}]});t.fonts.push({face:"digit",size:80,lineHeight:78,chars:[{id:32,x:249,y:0,width:3,height:1,xoffset:-1,yoffset:77,xadvance:16},{id:48,x:0,y:0,width:33,height:43,xoffset:1,yoffset:21,xadvance:35},{id:49,x:225,y:0,width:23,height:42,xoffset:2,yoffset:21,xadvance:29},{id:50,x:164,y:0,width:30,height:42,xoffset:2,yoffset:21,xadvance:35},{id:51,x:134,y:0,width:29,height:43,xoffset:3,yoffset:21,xadvance:35},{id:52,x:0,y:44,width:36,height:41,xoffset:1,yoffset:22,xadvance:37},{id:53,x:195,y:0,width:29,height:42,xoffset:3,yoffset:22,xadvance:35},{id:54,x:68,y:0,width:32,height:43,xoffset:2,yoffset:21,xadvance:35},{id:55,x:37,y:44,width:31,height:41,xoffset:2,yoffset:22,xadvance:35},{id:56,x:34,y:0,width:33,height:43,xoffset:1,yoffset:21,xadvance:35},{id:57,x:101,y:0,width:32,height:43,xoffset:1,yoffset:21,xadvance:35}]})}(t.fonts||(t.fonts={}))}(GAME||(GAME={})),(GAME||(GAME={})).GAMECONFIG={publisher:"dummy",gameId:"raceinfernosport",gameVersion:"0.1.5",defaultLocale:"autodetect",customData:{},gsUrl:"",serverUrl:"",resourcesUrl:""},function(e){var t=function(h){function s(){var t=h.call(this)||this;t.stop=!1,t.progress=0,t.timeOut=2e3,t.waitTime=250;var i=new h5ge.Graphics;i.beginFill(16777215),i.drawRect(0,0,e.Game.get().width,e.Game.get().height),i.endFill(),t.addChild(i);var n=h5ge.Sprite.fromImage(s.URL_SPLASH);return t.addChild(n),h5ge.layout.centerOnXInParent(n),h5ge.layout.centerOnYInParent(n),t.splash=n,t}return __extends(s,h),s.prototype.buildRideau=function(){e.SoundManager.play("whoosh_transit");this.DISPLAY_WIDTH=934,this.rideauA=h5ge.Sprite.fromFrame(e.ASSETS.LIGHT),this.rideauA.tint=e.Game.get().options.rendering.backgroundColor,this.rideauA.width=.5*this.DISPLAY_WIDTH,this.rideauA.height=e.Game.get().height,this.rideauA.x=.5*(e.Game.get().width-this.DISPLAY_WIDTH)-this.rideauA.width,this.addChild(this.rideauA),this.rideauB=h5ge.Sprite.fromFrame(e.ASSETS.LIGHT),this.rideauB.tint=e.Game.get().options.rendering.backgroundColor,this.rideauB.width=.5*this.DISPLAY_WIDTH,this.rideauB.height=e.Game.get().height,this.rideauB.x=.5*(e.Game.get().width-this.DISPLAY_WIDTH)+this.DISPLAY_WIDTH,this.addChild(this.rideauB)},s.prototype.goToGame=function(){e.Game.get().switchScene(new e.MenuScene),this.stop=!0},s.prototype.update=function(t){if(!this.stop){var i=.001*t;if(this.progress+=t,this.progress>this.timeOut&&(this.progress=-1/0,this.buildRideau()),this.rideauA){var n=.5*(e.Game.get().width-this.DISPLAY_WIDTH);this.rideauA.x=Math.min(n,this.rideauA.x+1400*i),this.rideauB.x=Math.max(n+this.rideauB.width,this.rideauB.x-1400*i),Math.abs(this.rideauA.x-n)<1&&(this.waitTime-=t,this.waitTime<0&&this.goToGame())}}},s.URL_SPLASH="game/assets/images/splash.png",s}(h5ge.Scene);e.SplashScene=t}(GAME||(GAME={})),function(l){var t=function(a){function c(){var t=a.call(this)||this;(c.INSTANCE=t).buildLayout(),t.bestEffect=null,t.carSelector=null,t.started=!1;var i=h5ge.Sprite.fromImage(c.BACKGROUND_URL);i.x=.5*(l.Game.get().width-i.width),i.showCursor=!1,t.layBG.addChild(i);var n=new h5ge.Container;n.x=.5*l.Game.get().width,n.y=.5*l.Game.get().height,t.layMain.addChild(n);var h=h5ge.Sprite.fromFrame(l.ASSETS.GAMENAME);h.x=.5*-h.width,h.y=.5*-h.height-160,n.addChild(h),t.dynamicCont=n,t.reelWidth=h.width,t.dynamicCont.width=0;var s=t;if(!l.Storage.dataGet(l.DataKey.LANGUE)&&1==l.Storage.dataGet(l.DataKey.SESSION_COUNT)){var e=new l.LanguePopup;e.onChange(function(){l.Game.get().switchScene(new c)}),s.addChild(e)}var r=new l.CarSelector;if(r.y=.5*l.Game.get().height+200,t.layGUI.addChild(r),r.onGo(function(){s.start.apply(s)}),t.carSelector=r,"fbmessenger"==l.GAMECONFIG.publisher){l.Game.get().scoreManager.getPlayerScore("score",!1,function(t){t&&s.buildBestScore.apply(s,[t.score])});var u=new l.Button(l.ASSETS.VERSUS,.7);u.x=430,u.y=32,t.addChild(u),u.onClick(function(){l.Game.get().socialManager.chooseContext(function(t){t||l.Game.get().dataManager.logEvent("ECHEC to chose context",1)})})}else{var o=l.Storage.dataGet(l.DataKey.BEST_SCORE);t.buildBestScore.apply(s,[o])}var f=new l.Button(l.SPEAK.getIcone(),1);return f.x=l.Game.get().width-f.width,f.y=l.Game.get().height-f.height-42,t.layGUI.addChild(f),f.onClick(function(){var t=new l.LanguePopup;t.onChange(function(){l.Game.get().switchScene(new c)}),s.carSelector&&(s.carSelector.setPause(!0),t.detachListener.add(function(){s.carSelector.setPause(!1)})),s.addChild(t)}),t.buildRideau(),l.SoundManager.get().sound.setVolume(.5,l.SoundManager.get().musicId),l.SoundManager.get().sound.rate(1,l.SoundManager.get().musicId),t}return __extends(c,a),c.prototype.buildBestScore=function(t){var i=this;if(t){var n=l.SPEAK.BEST_SCORE.get(),h=l.factory.newText(n,32);h.x=.5*(l.Game.get().width-h.width),h.y=32;var s=l.factory.newText(n,32);s.tint=0,s.x=h.x,s.y=h.y+3,this.layBG.addChild(s),this.layBG.addChild(h);var e=""+t,r=l.factory.newText(e,42);r.tint=14677451,r.x=.5*(l.Game.get().width-r.width),r.y=s.y+s.height+4;var u=l.factory.newText(e,42);u.tint=0,u.x=r.x,u.y=r.y+3,this.layBG.addChild(u),this.layBG.addChild(r);var o=l.factory.newText(e,42);o.tint=6268189,o.x=r.x,o.y=r.y,this.layBG.addChild(o),this.bestEffect=o,this.moneyCounter=new l.MoneyCount,this.moneyCounter.x=16,this.moneyCounter.y=16,this.layGUI.addChild(this.moneyCounter);var f=new l.Button(l.ASSETS.LEADERBOARD_LEADERBOARD,.7);f.x=l.Game.get().width-f.width-16,f.y=32,this.layGUI.addChild(f),f.onClick(function(){var t=new l.LeaderBoard;i.addChild(t)})}},c.prototype.nextLevel=function(){c.selectedMapType==l.MapType.RACING?c.selectedMapType=l.MapType.CITY:c.selectedMapType==l.MapType.CITY?c.selectedMapType=l.MapType.CANYON:c.selectedMapType==l.MapType.CANYON&&(c.selectedMapType=l.MapType.RACING)},c.get=function(){return c.INSTANCE},c.prototype.start=function(){if(!this.started){var t=l.SoundManager.play("start");l.SoundManager.get().sound.setVolume(.7,t),l.SoundManager.get().sound.setVolume(.05,l.SoundManager.get().musicId),l.SoundManager.get().sound.rate(.6,l.SoundManager.get().musicId),this.started=!0,this.out=!0;var i=h5ge.Sprite.fromFrame(l.ASSETS.LIGHT);i.width=l.Game.get().width,i.height=l.Game.get().height,i.alpha=0,this.addChild(i),i.onClick(function(){}),i.showCursor=!1}},c.prototype.buildRideau=function(){this.DISPLAY_WIDTH=934,this.rideauA=h5ge.Sprite.fromFrame(l.ASSETS.LIGHT),this.rideauA.tint=l.Game.get().options.rendering.backgroundColor,this.rideauA.width=.5*this.DISPLAY_WIDTH,this.rideauA.height=l.Game.get().height,this.rideauA.x=.5*(l.Game.get().width-this.DISPLAY_WIDTH),this.layRideau.addChild(this.rideauA),this.rideauB=h5ge.Sprite.fromFrame(l.ASSETS.LIGHT),this.rideauB.tint=l.Game.get().options.rendering.backgroundColor,this.rideauB.width=.5*this.DISPLAY_WIDTH,this.rideauB.height=l.Game.get().height,this.rideauB.x=.5*(l.Game.get().width-this.DISPLAY_WIDTH)+this.DISPLAY_WIDTH-this.rideauB.width,this.layRideau.addChild(this.rideauB)},c.prototype.buildLayout=function(){this.layBG=new h5ge.Container,this.layMain=new h5ge.Container,this.layGUI=new h5ge.Container,this.layRideau=new h5ge.Container,this.layGUI.alpha=0,this.addChild(this.layBG),this.addChild(this.layMain),this.addChild(this.layGUI),this.addChild(this.layRideau)},c.prototype.fireOut=function(){this.out=!1;var t=new l.SceneGame(c.selectedMapType);l.Game.get().switchScene(t),this.nextLevel()},c.prototype.update=function(t){a.prototype.update.call(this,t);var i=.001*t;this.out&&(this.layGUI.alpha=Math.max(0,this.layGUI.alpha-3*i),this.layMain.alpha=this.layGUI.alpha,0==this.layGUI.alpha&&this.fireOut());var n=.5*(l.Game.get().width-this.DISPLAY_WIDTH);this.out?(this.rideauA.x=Math.min(n,this.rideauA.x+1400*i),this.rideauB.x=Math.max(n+this.rideauB.width,this.rideauB.x-1400*i)):(this.rideauA.x=Math.max(n-this.rideauA.width,this.rideauA.x-800*i),this.rideauB.x=Math.min(n+934,this.rideauB.x+800*i)),this.dynamicCont.y=.5*l.Game.get().height-100+5*Math.sin(.05*l.System.tickcount),this.layGUI.alpha=Math.min(1,this.layGUI.alpha+1*i),this.bestEffect&&(this.bestEffect.alpha=Math.pow(Math.sin(.1*l.System.tickcount),2)),l.System.keyboard.isJustDown(85)&&(c.selectedMapType=l.MapType.CITY),l.System.keyboard.isJustDown(73)&&(c.selectedMapType=l.MapType.CANYON),l.System.keyboard.isJustDown(79)&&(c.selectedMapType=l.MapType.RACING)},c.prototype.render=function(t){a.prototype.render.call(this,t)},c.prototype.onShow=function(){},c.BACKGROUND_URL="game/assets/images/bg.jpg",c.selectedMapType=l.MapType.CITY,c}(h5ge.Scene);l.MenuScene=t}(GAME||(GAME={})),function(e){var t=function(n){function h(t){var i=n.call(this)||this;return(h.INSTANCE=i).movingBack=null,i.mapType=t,i.addScoreGold=0,i.goldCount=0,i.shakePower=0,i.bestScore=null,i.started=!1,i.buildLayout(),i.setColor(),i.build(),e.SoundManager.get().sound.setVolume(.05,e.SoundManager.get().musicId),e.SoundManager.get().sound.rate(.6,e.SoundManager.get().musicId),i}return __extends(h,n),h.prototype.setColor=function(){var t=Math.floor(4*Math.random());0==t?this.color={rockElement:6770241,ground:5456179,falaiseGround:3943718,falaise_rgb1:{r:61,g:46,b:39},falaise_rgb2:{r:31,g:23,b:20}}:1==t?this.color={rockElement:6782085,ground:3946053,falaiseGround:4016719,falaise_rgb1:{r:53,g:45,b:60},falaise_rgb2:{r:35,g:30,b:39}}:2==t?this.color={rockElement:9006185,ground:4143672,falaiseGround:5259069,falaise_rgb1:{r:49,g:40,b:41},falaise_rgb2:{r:28,g:23,b:24}}:3==t&&(this.color={rockElement:7500402,ground:4339522,falaiseGround:4473924,falaise_rgb1:{r:50,g:50,b:50},falaise_rgb2:{r:31,g:31,b:31}})},h.get=function(){return h.INSTANCE},h.prototype.buildLayout=function(){this.layBack=new h5ge.Container,this.layRoad=new h5ge.Container,this.layGUI=new h5ge.Container,this.addChild(this.layBack),this.addChild(this.layRoad),this.addChild(this.layGUI)},h.prototype.buildGround=function(){this.mapType==e.MapType.CANYON&&(this.movingBack=new e.MovingBack(h5ge.Texture.fromImage(e.MovingBack.URL_CANYON),1),this.movingBack.x=.5*(e.Game.get().width-934),this.layRoad.addChildAt(this.movingBack,0),this.speedCar.setTraceAlpha(.2)),this.mapType==e.MapType.CITY&&(this.movingBack=new e.MovingBack(h5ge.Texture.fromImage(e.MovingBack.URL_CITY),.8),this.movingBack.x=.5*(e.Game.get().width-934),this.layRoad.addChildAt(this.movingBack,0),this.speedCar.setTraceAlpha(1)),this.mapType==e.MapType.RACING&&(this.movingBack=new e.MovingBack(h5ge.Texture.fromImage(e.MovingBack.URL_RACING),1),this.movingBack.x=.5*(e.Game.get().width-934),this.layRoad.addChildAt(this.movingBack,0),this.speedCar.noBlockingCollision(),this.speedCar.setTraceAlpha(1))},h.prototype.getMap=function(){return this.mapType==e.MapType.CANYON?new e.MapCanyon(this.color):this.mapType==e.MapType.CITY?new e.MapCity:this.mapType==e.MapType.RACING?new e.MapRacing:null},h.prototype.build=function(){var i=this;this.map=this.getMap(),this.map.y=e.Game.get().height,this.layRoad.addChild(this.map),this.speedCar=new e.SpeedCar,this.speedCar.x=.5*e.Game.get().width,this.speedCar.y=-200,this.map.addElement(this.speedCar),this.buildGround();var t=e.Car.getCarStat(e.Car.getMyCar());if(this.lifeBar=new e.LifeBar(t.life),this.lifeBar.x=.5*(e.Game.get().width-this.lifeBar.width),this.lifeBar.y=e.Game.get().height-this.lifeBar.height-8,this.layGUI.addChild(this.lifeBar),this.lifeBar.onDie(function(){i.fireDead.apply(i)}),this.score=new e.Score,this.score.x=.5*e.Game.get().width,this.score.y=32,this.layGUI.addChild(this.score),"fbmessenger"==e.GAMECONFIG.publisher)e.Game.get().scoreManager.getPlayerScore("score",!1,function(t){t&&i.buildBestScore.apply(i,[t.score])});else{var n=e.Storage.dataGet(e.DataKey.BEST_SCORE);this.buildBestScore.apply(i,[n])}var h=new e.StartScreen;h.onStart(function(){i.started=!0}),this.layGUI.addChild(h)},h.prototype.buildBestScore=function(t){if(t){var i=new h5ge.Container,n=h5ge.Sprite.fromFrame(e.ASSETS.BEST_ICONE);n.tint=11206570,i.addChild(n);var h=""+t,s=e.factory.newText(h,28);s.tint=11206570,s.x=n.width+10,s.y=.5*(n.height-s.height),i.addChild(s),i.setSizeFromChildren(),i.x=.5*(e.Game.get().width-i.width),i.y=12,this.score.y=70,this.layGUI.addChild(i),this.bestScore=i}},h.prototype.addLife=function(){this.lifeBar.addLife(10);var t=new e.ParticuleH5,i=h5ge.Sprite.fromFrame(e.ASSETS.ORBE);i.tint=16711680,i.setPivotToCenter(),i.width=this.lifeBar.width+32,i.height=this.lifeBar.height+32,t.addChild(i),t.scaleXY=.3,t.alpha=.3,t.setData("progress",0),t.setBehavior(function(){e.System.dt;t.data.progress+=.2,t.data.progress>=Math.PI?t.removeSelf():t.scaleXY=.3+1*Math.sin(t.data.progress)}),this.layGUI.addChildAt(t,0),t.x=this.lifeBar.x+.5*this.lifeBar.width,t.y=this.lifeBar.y+.5*this.lifeBar.height},h.prototype.addGold=function(){this.addScoreGold+=10,this.goldCount+=1;var t=new e.ParticuleH5,i=h5ge.Sprite.fromFrame(e.ASSETS.ORBE);i.tint=15899679,i.setPivotToCenter(),i.x=.5*-i.width,i.y=.5*-i.height,t.addChild(i),t.scaleXY=1,t.alpha=.8,t.setData("progress",0),t.setBehavior(function(){e.System.dt;t.data.progress+=.2,t.data.progress>=Math.PI?t.removeSelf():t.scaleXY=1+4*Math.sin(t.data.progress)}),this.layGUI.addChildAt(t,0),t.x=this.score.x,t.y=this.score.y},h.prototype.shake=function(t){this.shakePower=Math.max(this.shakePower,t)},h.prototype.fireDead=function(){if(!this.end){this.score.alpha=0,this.bestScore&&(this.bestScore.alpha=0),this.end=!0,this.speedCar.die(),this.shake(3);var t=this;h5ge.TimeManager.createAndStartTimer(1e3,function(){t.fireEndScreen.apply(t)})}},h.prototype.fireEndScreen=function(){var t=e.Storage.dataGet(e.DataKey.BEST_SCORE),i=this.score.getScore();e.Storage.submitScoreIfBetter(i),(!t||t<i)&&e.Storage.dataSave([e.DataKey.BEST_SCORE],[i]);var n=new e.EndGameScreen(i,t,this.goldCount);n.onRestart(function(){e.Game.get().switchScene(new e.MenuScene)}),this.layGUI.addChild(n)},h.prototype.updateControl=function(){var t=!1,i=!1,n=!1;e.System.touch.isTouch&&(e.System.touch.x<.5*e.Game.get().width?t=!0:i=!0),e.System.keyboard.isDown(37)&&(t=!0),e.System.keyboard.isDown(39)&&(i=!0),e.System.keyboard.isDown(38)&&(n=!0),n&&this.speedCar.boost(),t?this.speedCar.turnLeft():i?this.speedCar.turnRight():this.speedCar.noTurn()},h.prototype.updateShake=function(){this.layRoad.x=10*this.shakePower*Math.sin(1*e.System.tickcount),this.layRoad.y=10*this.shakePower*Math.cos(1*e.System.tickcount)*.5,this.shakePower=Math.max(0,this.shakePower-4*e.System.dt)},h.prototype.update=function(t){if(this.updateShake(),this.started){this.updateControl(),this.speedCar.update(t);var i=this.speedCar.y+180;this.map.setCameraY(i),this.movingBack&&this.movingBack.setCameraY(i),this.map.update(t);var n=this.map.isCollide(this.speedCar),h=Math.floor(.01*-this.speedCar.y)+this.addScoreGold;this.score.refreshScore(h),n&&(this.speedCar.collid(n),this.shake(1))}this.speedCar.isDead()&&(this.lifeBar.y+=2)},h}(h5ge.Scene);e.SceneGame=t}(GAME||(GAME={})),function(d){var t=function(v){function t(i,n,t){var h=v.call(this)||this;h.updatable=!1,h.DISPLAY_WIDTH=1200;var s=h5ge.Sprite.fromFrame(d.ASSETS.LIGHT);s.width=934,s.height=d.Game.get().height,s.alpha=0,s.x=.5*(d.Game.get().width-934),h.addChild(s),(h.bgClick=s).onClick(h.restart,h),h.fe=null,h.restartDelay=0,h.cont=new h5ge.Container;var e=h5ge.Sprite.fromFrame(d.ASSETS.SCORE_BOX);e.x=.5*-e.width,e.y=.5*-e.height,h.cont.addChild(e),h.cont.x=.5*d.Game.get().width,h.cont.y=.5*d.Game.get().height,h.addChild(h.cont);var r=new d.GoldToMoney(t);r.y=60,h.cont.addChild(r);var u=d.Storage.dataGet(d.DataKey.GOLD);u=u||0;var o=r.getMoney();0<o&&d.Storage.dataSave([d.DataKey.GOLD],[u+o]);var f=h;h5ge.TimeManager.createAndStartTimer(300,function(){var t=new d.ScoreSplash(i,16775859);t.y=-26,f.cont.addChild(t),t.onEnd(function(){n<i&&h5ge.TimeManager.createAndStartTimer(200,function(){f.buildBest.apply(f,[420,350])}),r.refresh()})});var a=d.factory.newText(d.SPEAK.SCORE.get(),32);a.x=.5*-a.width,a.y=-110,h.cont.addChild(a),h.cont.scaleXY=.01;var c=new h5ge.Container;c.x=.5*d.Game.get().width,c.y=d.Game.get().height-300;var l=d.factory.newText(d.SPEAK.GAME_OVER.get(),42);l.x=.5*-l.width,l.y=.5*-l.height,c.addChild(l),c.alpha=0,h.clickToPlay=c,h.addChild(h.clickToPlay),h.rideauA=h5ge.Sprite.fromFrame(d.ASSETS.LIGHT),h.rideauA.tint=d.Game.get().options.rendering.backgroundColor,h.rideauA.width=.5*h.DISPLAY_WIDTH,h.rideauA.height=d.Game.get().height,h.rideauA.x=.5*(d.Game.get().width-h.DISPLAY_WIDTH)-h.rideauA.width,h.rideauB=h5ge.Sprite.fromFrame(d.ASSETS.LIGHT),h.rideauB.tint=d.Game.get().options.rendering.backgroundColor,h.rideauB.width=.5*h.DISPLAY_WIDTH,h.rideauB.height=d.Game.get().height,h.rideauB.x=.5*(d.Game.get().width-h.DISPLAY_WIDTH)+934,h.addUpdatable(),h.detachListener.add(h.stopUpdatable,h);f=h;return h5ge.TimeManager.createAndStartTimer(1500,function(){f.ready=!0}),h.playCheer(i),h}return __extends(t,v),t.prototype.playCheer=function(t){if(t<200)var i=d.SoundManager.play("verysmall_cheer");else if(t<500)i=d.SoundManager.play("small_cheer");else if(t<1e3)i=d.SoundManager.play("medium_cheer");else i=d.SoundManager.play("big_cheer");d.SoundManager.get().sound.setVolume(.6,i)},t.prototype.buildBest=function(n,h){var s=this,t=d.SoundManager.play("best_score");d.SoundManager.get().sound.setVolume(4,t),h5ge.TimeManager.createAndStartTimer(1200,function(){d.SoundManager.play("yeah")});var e=new d.ParticuleH5,r=h5ge.Sprite.fromFrame(d.ASSETS.TAMPON);r.x=.5*-r.width,r.y=-800,e.addChild(r);var u=-r.height+(r.height-360),o=0,f=.5,a=this;e.setBehavior(function(){var t=d.System.dt;if(0==o&&(r.y=Math.min(u,r.y+2e3*t),r.y==u)){o=1,d.SceneGame.get().shake(1);var i=s.getBestScoreImage();i.x=n,i.y=h,a.addChildAt(i,a.getChildIndex(e))}1==o&&(f-=1*t)<=0&&(o=2),2==o&&(r.y-=1e3*t,r.y<-r.height-500&&e.removeSelf())}),e.x=n,e.y=h,this.addChild(e)},t.prototype.getBestScoreImage=function(){var t=new h5ge.Container,i=h5ge.Sprite.fromFrame(d.ASSETS.BESTSCORE);i.setPivotToCenter(),i.x=.5*-i.width,i.y=.5*-i.height,t.addChild(i);var n=d.factory.newText(d.SPEAK.NEW_BEST_SCORE.get(),24);return n.x=.5*-n.width,n.y=.5*-n.height,t.addChild(n),t.rotation=.0625*-Math.PI,t},t.prototype.addUpdatable=function(){1!=this.updatable&&(this.updatable=!0,d.Game.get().addUpdatable(this))},t.prototype.stopUpdatable=function(){1==this.updatable&&(this.updatable=!1,d.Game.get().removeUpdatable(this))},t.prototype.restart=function(){if(1==this.ready&&0==this.restartDelay){this.ready=!1;d.SoundManager.play("whoosh_transit");this.bgClick.interactive=!1,this.clickToPlay.alpha=1,this.restartDelay=1,this.addChild(this.rideauA),this.addChild(this.rideauB)}},t.prototype.onRestart=function(t){this.fe=t},t.prototype.fireRestart=function(){this.fe&&this.fe(),this.fe=null;var t=this;this.clickToPlay.visible=!1,this.cont.visible=!1,h5ge.TimeManager.createAndStartTimer(1e3,function(){t.removeSelf.apply(t)})},t.prototype.update=function(t){var i=.001*t;if(0!=this.restartDelay){this.restartDelay=this.restartDelay-1*i,this.cont.scaleXY=d.System.move(0,this.cont.scaleXY);var n=-Math.sin(Math.PI+Math.PI*(1-this.restartDelay));this.rideauA.x=.5*(d.Game.get().width-this.DISPLAY_WIDTH)-this.rideauA.width+this.rideauA.width*n,this.rideauB.x=.5*(d.Game.get().width-this.DISPLAY_WIDTH)+this.DISPLAY_WIDTH-this.rideauB.width*n,this.clickToPlay.visible&&this.restartDelay<=.5&&this.fireRestart()}else this.cont.scaleXY=d.System.move(1,this.cont.scaleXY),this.clickToPlay.alpha=.3+.7*Math.pow(Math.sin(.05*d.System.tickcount),2)},t}(h5ge.Container);d.EndGameScreen=t}(GAME||(GAME={})),function(o){var t=function(s){function t(){var t=s.call(this)||this;t.generale=!1,t.delayAnnulation=.2,t.delayAnnulationProgress=0,t.vecY=0,t.scrollMin=null,t.OY=null,t.isOver=!1;var i=new h5ge.Container(o.Game.get().width,o.Game.get().height);i.onClick(function(){}),i.showCursor=!1;var n=h5ge.Sprite.fromFrame(o.ASSETS.LIGHT);n.width=954,n.height=o.Game.get().height+20,n.x=.5*(o.Game.get().width-n.width),n.y=-10,n.tint=0,n.alpha=.8,t.addChild(n),t.addChild(i),t.build();var h=h5ge.Sprite.fromFrame(o.ASSETS.LEADERBOARD_RETURN);return h.x=12,h.y=32,t.addChild(h),h.onClick(t.close,t),o.Game.get().addUpdatable(t),t.detachListener.add(function(){o.Game.get().removeUpdatable(t)}),t}return __extends(t,s),t.prototype.close=function(){this.removeSelf()},t.prototype.build=function(){var t=o.factory.newText(o.SPEAK.LEADERBOARD_TOP.get(),60);t.x=.5*-t.width,t.y=.5*-t.height,this.topCont=new h5ge.Container(t.width,t.height),this.topCont.addChild(t),this.topCont.x=.5*o.Game.get().width,this.topCont.y=32+.5*this.topCont.height,this.addChild(this.topCont),this.layTab=new h5ge.Container,this.layTab.x=o.Game.get().width;var i=this,n={update:function(t){i.layTab.x=o.System.move(0,i.layTab.x),i.layTab.x<2&&(i.layTab.x=0,o.Game.get().removeUpdatable(n))}};o.Game.get().addUpdatable(n),this.addChild(this.layTab),this.buildGlobalOnglet(),this.buildDuelOnglet();i=this;var h=new h5ge.Container(o.Game.get().width,o.Game.get().height-290);this.layTab.addChild(h),h.onClick(function(){}),h.showCursor=!1,h.y=290,h.overHandler.add(function(){i.isOver=!0}),h.outHandler.add(function(){i.isOver=!1,i.onTouchEnd.apply(i)}),this.layMask=new h5ge.Container,this.layTab.addChild(this.layMask),this.layMask.mask=new h5ge.Mask,this.layMask.mask.rectangle(0,290,o.Game.get().width,o.Game.get().height-290),this.layerLead=new h5ge.Container,this.layerLead.y=250,this.layMask.addChild(this.layerLead),this.init()},t.prototype.init=function(){null!=o.Game.get().socialManager.getContextID()?(this.showDuel(),this.menuSwicth(this.duelOnglet)):(this.showGlobal(),this.menuSwicth(this.globaleOnglet))},t.prototype.buildGlobalOnglet=function(){var t=h5ge.Sprite.fromFrame(o.ASSETS.BUTTONS_BUTTONBIG1),i=new h5ge.Container(t.width,t.height);i.addChild(t);var n=h5ge.Sprite.fromFrame(o.ASSETS.LEADERBOARD_GLOBAL_ICONE);n.y=.5*(i.height-n.height),n.x=16;var h=o.factory.newText(o.SPEAK.LEADERBOARD_GLOBALE.get(),32);h.x=n.x+n.width+16,h.y=.5*(i.height-h.height),i.addChild(h),i.addChild(n),this.layTab.addChild(i),i.x=.5*o.Game.get().width,i.y=150,this.globaleOnglet=i;var s=this;i.onClick(function(){s.menuSwicth.apply(s,[i]),s.showGlobal.apply(s)})},t.prototype.buildDuelOnglet=function(){var t=h5ge.Sprite.fromFrame(o.ASSETS.BUTTONS_BUTTONBIG2),i=new h5ge.Container(t.width,t.height);i.addChild(t);var n=h5ge.Sprite.fromFrame(o.ASSETS.LEADERBOARD_GLOBAL_ICONE);n.y=.5*(i.height-n.height),n.x=16;var h=o.factory.newText(o.SPEAK.LEADERBOARD_DUEL.get(),32);h.x=n.x+n.width+16,h.y=.5*(i.height-h.height),i.addChild(h),i.addChild(n),this.layTab.addChild(i),i.y=150,this.duelOnglet=i;var s=this;i.onClick(function(){s.menuSwicth.apply(s,[i]),s.showDuel.apply(s)})},t.prototype.menuSwicth=function(t){this.duelOnglet.y=170,this.globaleOnglet.y=170,this.duelOnglet.alpha=.7,this.globaleOnglet.alpha=.7,t.y=145,t.alpha=1},t.prototype.clearLead=function(){this.layerLead.removeChildren(),this.layerLead.y=290},t.prototype.showGlobal=function(){this.clearLead();var t=o.Game.get().scoreManager;this.generale=!0;var i=this;"dummy"!=o.GAMECONFIG.publisher?(t.getScores("score",!1,function(t){i.generale&&i.buildLeadTab.apply(i,[t])},20),o.Game.get().dataManager.logEvent("leaderboard-open-GLOBAL",1)):this.buildLeadTab(this.getFakeEntryTab())},t.prototype.showDuel=function(){if(this.clearLead(),null!=o.Game.get().socialManager.getContextID()){var t=o.Game.get().scoreManager,i=this;this.generale=!1,t.getScores("score",!0,function(t){1!=i.generale&&i.buildLeadTab.apply(i,[t])},20),o.Game.get().dataManager.logEvent("leaderboard-open-DUEL",1)}else o.Game.get().socialManager.chooseContext(function(t){t?i.showDuel():o.Game.get().dataManager.logEvent("ECHEC to chose context",1)})},t.prototype.getFakeEntryTab=function(){return[{playerName:"fake_Luciano",score:1e4,timestamp:0,rank:1,extraData:null,playerID:null,playerPhoto:null},{playerName:"fake_Mathieu",score:8e3,timestamp:0,rank:2,extraData:null,playerID:null,playerPhoto:null},{playerName:"fake_Thomas",score:4e3,timestamp:0,rank:3,extraData:null,playerID:null,playerPhoto:null},{playerName:"fake_Thomas",score:4e3,timestamp:0,rank:3,extraData:null,playerID:null,playerPhoto:null},{playerName:"fake_Thomas",score:4e3,timestamp:0,rank:3,extraData:null,playerID:null,playerPhoto:null},{playerName:"fake_Thomas",score:4e3,timestamp:0,rank:3,extraData:null,playerID:null,playerPhoto:null},{playerName:"fake_Thomas",score:4e3,timestamp:0,rank:3,extraData:null,playerID:null,playerPhoto:null}]},t.prototype.getPlayerCard=function(t,h){var s=new h5ge.Container,i=h5ge.Sprite.fromFrame(o.ASSETS.LEADERBOARD_LEADERBOARD_SLOT),n=o.factory.newText(""+t,32);n.x=32-.5*n.width;var e=h5ge.Sprite.fromFrame(o.ASSETS.LEADERBOARD_PHOTO_PLACEHOLDER);e.x=96-.5*e.width,null!=h.playerPhoto&&h5ge.Loader.loadFile(h.playerPhoto,function(){var i=h5ge.Sprite.fromImage(h.playerPhoto);i.alpha=0;var n={update:function(t){0<i.width&&(i.width=e.width,i.height=e.height,i.alpha=1,o.Game.get().removeUpdatable(n))}};o.Game.get().addUpdatable(n),i.x=e.x,i.y=e.y,s.addChild(i)});var r=o.factory.newText(h.playerName,32);r.x=180;var u=o.factory.newText(h.score+"",32);return u.x=510-.5*u.width,u.y=.5*(e.height-u.height),n.y=.5*(e.height-n.height),r.y=.5*(e.height-r.height),i.y=.5*(e.height-i.height),s.addChild(i),s.addChild(n),s.addChild(e),s.addChild(r),s.addChild(u),s.setSize(i.width,i.height),s},t.prototype.buildLeadTab=function(t){this.clearLead();for(var i=0;i<t.length;i++){var n=this.getPlayerCard(i+1,t[i]);n.x=.5*(o.Game.get().width-n.width),n.y=8+(n.height+8)*i,this.layerLead.addChild(n),i==t.length-1&&(this.scrollMin=n.y+n.height+16-3*(n.height+32))}},t.prototype.onTouchStart=function(){this.OY=o.System.mouseY,this.lastY=this.layerLead.y},t.prototype.onTouchEnd=function(){this.OY=null},t.prototype.update=function(t){if(this.topCont.scaleXY=1+.02*Math.sin(.1*o.System.tickcount),this.isOver){if(this.OY&&(this.layerLead.y=Math.min(290,Math.max(210-this.scrollMin,this.lastY+(o.System.mouseY-this.OY)))),o.System.mouse.isDown){var i=20<Math.abs(o.System.mouseVecY);if(i?this.delayAnnulationProgress=0:(this.delayAnnulationProgress+=.001*t,this.delayAnnulationProgress>=this.delayAnnulation&&(this.vecY=0)),this.vecY*o.System.touch.vecY<0||i){var n=.5*o.System.touch.vecY;this.vecY=Math.abs(n)>Math.abs(this.vecY)?n:this.vecY}}o.System.mouse.isJustDown&&this.onTouchStart(),o.System.mouse.isJustUp&&this.onTouchEnd()}null==this.OY&&this.vecY&&(this.layerLead.y=Math.min(290,Math.max(210-this.scrollMin,this.layerLead.y+this.vecY)),this.vecY=o.System.move(0,this.vecY))},t}(h5ge.Container);o.LeaderBoard=t}(GAME||(GAME={})),function(h){var t=function(n){function t(){var t=n.call(this)||this;t.delay=.5,t.ae=null,t.started=!1,t.updatable=!1,t.cont=new h5ge.Container;var i=h.factory.newText(h.SPEAK.READY.get(),60);return i.x=.5*-i.width,i.y=.5*-i.height,t.cont.addChild(i),t.cont.x=.5*h.Game.get().width,t.cont.y=.5*h.Game.get().height,t.addChild(t.cont),t.buildRideau(),t.addUpdatable(),t}return __extends(t,n),t.prototype.addUpdatable=function(){1!=this.updatable&&(this.updatable=!0,h.Game.get().addUpdatable(this))},t.prototype.stopUpdatable=function(){1==this.updatable&&(this.updatable=!1,h.Game.get().removeUpdatable(this))},t.prototype.buildRideau=function(){this.DISPLAY_WIDTH=934,this.rideauA=h5ge.Sprite.fromFrame(h.ASSETS.LIGHT),this.rideauA.tint=h.Game.get().options.rendering.backgroundColor,this.rideauA.width=.5*this.DISPLAY_WIDTH,this.rideauA.height=h.Game.get().height,this.rideauA.x=.5*(h.Game.get().width-this.DISPLAY_WIDTH),this.addChild(this.rideauA),this.rideauB=h5ge.Sprite.fromFrame(h.ASSETS.LIGHT),this.rideauB.tint=h.Game.get().options.rendering.backgroundColor,this.rideauB.width=.5*this.DISPLAY_WIDTH,this.rideauB.height=h.Game.get().height,this.rideauB.x=.5*(h.Game.get().width-this.DISPLAY_WIDTH)+this.DISPLAY_WIDTH-this.rideauB.width,this.addChild(this.rideauB)},t.prototype.onStart=function(t){this.ae=t},t.prototype.buildGoEffect=function(){var t=new h.ParticuleH5;t.x=.5*h.Game.get().width,t.y=.5*h.Game.get().height,this.parent.addChild(t);var i=h.factory.newText(h.SPEAK.GO.get(),90);i.x=.5*-i.width,i.y=.5*-i.height,t.addChild(i),t.scaleXY=.1;var n=0;t.setBehavior(function(){t.scaleXY=Math.min(1,1.6*Math.sin(n)),(n+=.05)>=Math.PI&&t.removeSelf()})},t.prototype.fireStart=function(){1!=this.started&&(this.started=!0,this.buildGoEffect(),this.ae&&this.ae(),this.removeSelf())},t.prototype.update=function(t){var i=.001*t;this.delay-=i,this.started?this.cont.alpha=Math.max(0,this.cont.alpha-8*i):this.cont.scaleXY=1+.1*Math.sin(.1*h.System.tickcount),this.delay<=0&&(h.System.touch.onTouchEnd||h.System.keyboard.isJustDown(37)||h.System.keyboard.isJustDown(39))&&this.fireStart();var n=.5*(h.Game.get().width-this.DISPLAY_WIDTH);this.rideauA.x=Math.max(n-this.rideauA.width,this.rideauA.x-800*i),this.rideauB.x=Math.min(n+934,this.rideauB.x+800*i)},t}(h5ge.Container);h.StartScreen=t}(GAME||(GAME={}));
/*! howler.js v2.0.8 | (c) 2013-2018, James Simpson of GoldFire Studios | MIT License | howlerjs.com */
!function(){"use strict";var e=function(){this.init()};e.prototype={init:function(){var e=this||n;return e._counter=1e3,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.mobileAutoEnable=!0,e._setup(),e},volume:function(e){var t=this||n;if(e=parseFloat(e),t.ctx||_(),void 0!==e&&e>=0&&e<=1){if(t._volume=e,t._muted)return t;t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e,n.ctx.currentTime);for(var o=0;o<t._howls.length;o++)if(!t._howls[o]._webAudio)for(var r=t._howls[o]._getSoundIds(),a=0;a<r.length;a++){var u=t._howls[o]._soundById(r[a]);u&&u._node&&(u._node.volume=u._volume*e)}return t}return t._volume},mute:function(e){var t=this||n;t.ctx||_(),t._muted=e,t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e?0:t._volume,n.ctx.currentTime);for(var o=0;o<t._howls.length;o++)if(!t._howls[o]._webAudio)for(var r=t._howls[o]._getSoundIds(),a=0;a<r.length;a++){var u=t._howls[o]._soundById(r[a]);u&&u._node&&(u._node.muted=!!e||u._muted)}return t},unload:function(){for(var e=this||n,t=e._howls.length-1;t>=0;t--)e._howls[t].unload();return e.usingWebAudio&&e.ctx&&void 0!==e.ctx.close&&(e.ctx.close(),e.ctx=null,_()),e},codecs:function(e){return(this||n)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||n;if(e.state=e.ctx?e.ctx.state||"running":"running",e._autoSuspend(),!e.usingWebAudio)if("undefined"!=typeof Audio)try{var t=new Audio;void 0===t.oncanplaythrough&&(e._canPlayEvent="canplay")}catch(n){e.noAudio=!0}else e.noAudio=!0;try{var t=new Audio;t.muted&&(e.noAudio=!0)}catch(e){}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||n,t=null;try{t="undefined"!=typeof Audio?new Audio:null}catch(n){return e}if(!t||"function"!=typeof t.canPlayType)return e;var o=t.canPlayType("audio/mpeg;").replace(/^no$/,""),r=e._navigator&&e._navigator.userAgent.match(/OPR\/([0-6].)/g),a=r&&parseInt(r[0].split("/")[1],10)<33;return e._codecs={mp3:!(a||!o&&!t.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!o,opus:!!t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!t.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!t.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!t.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(t.canPlayType("audio/x-mp4;")||t.canPlayType("audio/mp4;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!t.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(t.canPlayType("audio/x-flac;")||t.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_enableMobileAudio:function(){var e=this||n,t=/iPhone|iPad|iPod|Android|BlackBerry|BB10|Silk|Mobi/i.test(e._navigator&&e._navigator.userAgent),o=!!("ontouchend"in window||e._navigator&&e._navigator.maxTouchPoints>0||e._navigator&&e._navigator.msMaxTouchPoints>0);if(!e._mobileEnabled&&e.ctx&&(t||o)){e._mobileEnabled=!1,e._mobileUnloaded||44100===e.ctx.sampleRate||(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var r=function(){n._autoResume();var t=e.ctx.createBufferSource();t.buffer=e._scratchBuffer,t.connect(e.ctx.destination),void 0===t.start?t.noteOn(0):t.start(0),"function"==typeof e.ctx.resume&&e.ctx.resume(),t.onended=function(){t.disconnect(0),e._mobileEnabled=!0,e.mobileAutoEnable=!1,document.removeEventListener("touchstart",r,!0),document.removeEventListener("touchend",r,!0)}};return document.addEventListener("touchstart",r,!0),document.addEventListener("touchend",r,!0),e}},_autoSuspend:function(){var e=this;if(e.autoSuspend&&e.ctx&&void 0!==e.ctx.suspend&&n.usingWebAudio){for(var t=0;t<e._howls.length;t++)if(e._howls[t]._webAudio)for(var o=0;o<e._howls[t]._sounds.length;o++)if(!e._howls[t]._sounds[o]._paused)return e;return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout(function(){e.autoSuspend&&(e._suspendTimer=null,e.state="suspending",e.ctx.suspend().then(function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())}))},3e4),e}},_autoResume:function(){var e=this;if(e.ctx&&void 0!==e.ctx.resume&&n.usingWebAudio)return"running"===e.state&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):"suspended"===e.state?(e.ctx.resume().then(function(){e.state="running";for(var n=0;n<e._howls.length;n++)e._howls[n]._emit("resume")}),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):"suspending"===e.state&&(e._resumeAfterSuspend=!0),e}};var n=new e,t=function(e){var n=this;if(!e.src||0===e.src.length)return void console.error("An array of source files must be passed with any new Howl.");n.init(e)};t.prototype={init:function(e){var t=this;return n.ctx||_(),t._autoplay=e.autoplay||!1,t._format="string"!=typeof e.format?e.format:[e.format],t._html5=e.html5||!1,t._muted=e.mute||!1,t._loop=e.loop||!1,t._pool=e.pool||5,t._preload="boolean"!=typeof e.preload||e.preload,t._rate=e.rate||1,t._sprite=e.sprite||{},t._src="string"!=typeof e.src?e.src:[e.src],t._volume=void 0!==e.volume?e.volume:1,t._xhrWithCredentials=e.xhrWithCredentials||!1,t._duration=0,t._state="unloaded",t._sounds=[],t._endTimers={},t._queue=[],t._playLock=!1,t._onend=e.onend?[{fn:e.onend}]:[],t._onfade=e.onfade?[{fn:e.onfade}]:[],t._onload=e.onload?[{fn:e.onload}]:[],t._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],t._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],t._onpause=e.onpause?[{fn:e.onpause}]:[],t._onplay=e.onplay?[{fn:e.onplay}]:[],t._onstop=e.onstop?[{fn:e.onstop}]:[],t._onmute=e.onmute?[{fn:e.onmute}]:[],t._onvolume=e.onvolume?[{fn:e.onvolume}]:[],t._onrate=e.onrate?[{fn:e.onrate}]:[],t._onseek=e.onseek?[{fn:e.onseek}]:[],t._onresume=[],t._webAudio=n.usingWebAudio&&!t._html5,void 0!==n.ctx&&n.ctx&&n.mobileAutoEnable&&n._enableMobileAudio(),n._howls.push(t),t._autoplay&&t._queue.push({event:"play",action:function(){t.play()}}),t._preload&&t.load(),t},load:function(){var e=this,t=null;if(n.noAudio)return void e._emit("loaderror",null,"No audio support.");"string"==typeof e._src&&(e._src=[e._src]);for(var r=0;r<e._src.length;r++){var u,i;if(e._format&&e._format[r])u=e._format[r];else{if("string"!=typeof(i=e._src[r])){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}u=/^data:audio\/([^;,]+);/i.exec(i),u||(u=/\.([^.]+)$/.exec(i.split("?",1)[0])),u&&(u=u[1].toLowerCase())}if(u||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),u&&n.codecs(u)){t=e._src[r];break}}return t?(e._src=t,e._state="loading","https:"===window.location.protocol&&"http:"===t.slice(0,5)&&(e._html5=!0,e._webAudio=!1),new o(e),e._webAudio&&a(e),e):void e._emit("loaderror",null,"No codec support for selected audio sources.")},play:function(e,t){var o=this,r=null;if("number"==typeof e)r=e,e=null;else{if("string"==typeof e&&"loaded"===o._state&&!o._sprite[e])return null;if(void 0===e){e="__default";for(var a=0,u=0;u<o._sounds.length;u++)o._sounds[u]._paused&&!o._sounds[u]._ended&&(a++,r=o._sounds[u]._id);1===a?e=null:r=null}}var i=r?o._soundById(r):o._inactiveSound();if(!i)return null;if(r&&!e&&(e=i._sprite||"__default"),"loaded"!==o._state){i._sprite=e,i._ended=!1;var d=i._id;return o._queue.push({event:"play",action:function(){o.play(d)}}),d}if(r&&!i._paused)return t||setTimeout(function(){o._emit("play",i._id)},0),i._id;o._webAudio&&n._autoResume();var _=Math.max(0,i._seek>0?i._seek:o._sprite[e][0]/1e3),s=Math.max(0,(o._sprite[e][0]+o._sprite[e][1])/1e3-_),l=1e3*s/Math.abs(i._rate);i._paused=!1,i._ended=!1,i._sprite=e,i._seek=_,i._start=o._sprite[e][0]/1e3,i._stop=(o._sprite[e][0]+o._sprite[e][1])/1e3,i._loop=!(!i._loop&&!o._sprite[e][2]);var c=i._node;if(o._webAudio){var f=function(){o._refreshBuffer(i);var e=i._muted||o._muted?0:i._volume;c.gain.setValueAtTime(e,n.ctx.currentTime),i._playStart=n.ctx.currentTime,void 0===c.bufferSource.start?i._loop?c.bufferSource.noteGrainOn(0,_,86400):c.bufferSource.noteGrainOn(0,_,s):i._loop?c.bufferSource.start(0,_,86400):c.bufferSource.start(0,_,s),l!==1/0&&(o._endTimers[i._id]=setTimeout(o._ended.bind(o,i),l)),t||setTimeout(function(){o._emit("play",i._id)},0)};"running"===n.state?f():(o.once("resume",f),o._clearTimer(i._id))}else{var p=function(){c.currentTime=_,c.muted=i._muted||o._muted||n._muted||c.muted,c.volume=i._volume*n.volume(),c.playbackRate=i._rate;try{var e=c.play();if("undefined"!=typeof Promise&&e instanceof Promise&&(o._playLock=!0,e.then(function(){o._playLock=!1,o._loadQueue()})),c.paused)return void o._emit("playerror",i._id,"Playback was unable to start. This is most commonly an issue on mobile devices where playback was not within a user interaction.");l!==1/0&&(o._endTimers[i._id]=setTimeout(o._ended.bind(o,i),l)),t||o._emit("play",i._id)}catch(e){o._emit("playerror",i._id,e)}},m=window&&window.ejecta||!c.readyState&&n._navigator.isCocoonJS;if(4===c.readyState||m)p();else{var v=function(){p(),c.removeEventListener(n._canPlayEvent,v,!1)};c.addEventListener(n._canPlayEvent,v,!1),o._clearTimer(i._id)}}return i._id},pause:function(e){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"pause",action:function(){n.pause(e)}}),n;for(var t=n._getSoundIds(e),o=0;o<t.length;o++){n._clearTimer(t[o]);var r=n._soundById(t[o]);if(r&&!r._paused&&(r._seek=n.seek(t[o]),r._rateSeek=0,r._paused=!0,n._stopFade(t[o]),r._node))if(n._webAudio){if(!r._node.bufferSource)continue;void 0===r._node.bufferSource.stop?r._node.bufferSource.noteOff(0):r._node.bufferSource.stop(0),n._cleanBuffer(r._node)}else isNaN(r._node.duration)&&r._node.duration!==1/0||r._node.pause();arguments[1]||n._emit("pause",r?r._id:null)}return n},stop:function(e,n){var t=this;if("loaded"!==t._state)return t._queue.push({event:"stop",action:function(){t.stop(e)}}),t;for(var o=t._getSoundIds(e),r=0;r<o.length;r++){t._clearTimer(o[r]);var a=t._soundById(o[r]);a&&(a._seek=a._start||0,a._rateSeek=0,a._paused=!0,a._ended=!0,t._stopFade(o[r]),a._node&&(t._webAudio?a._node.bufferSource&&(void 0===a._node.bufferSource.stop?a._node.bufferSource.noteOff(0):a._node.bufferSource.stop(0),t._cleanBuffer(a._node)):isNaN(a._node.duration)&&a._node.duration!==1/0||(a._node.currentTime=a._start||0,a._node.pause())),n||t._emit("stop",a._id))}return t},mute:function(e,t){var o=this;if("loaded"!==o._state)return o._queue.push({event:"mute",action:function(){o.mute(e,t)}}),o;if(void 0===t){if("boolean"!=typeof e)return o._muted;o._muted=e}for(var r=o._getSoundIds(t),a=0;a<r.length;a++){var u=o._soundById(r[a]);u&&(u._muted=e,u._interval&&o._stopFade(u._id),o._webAudio&&u._node?u._node.gain.setValueAtTime(e?0:u._volume,n.ctx.currentTime):u._node&&(u._node.muted=!!n._muted||e),o._emit("mute",u._id))}return o},volume:function(){var e,t,o=this,r=arguments;if(0===r.length)return o._volume;if(1===r.length||2===r.length&&void 0===r[1]){o._getSoundIds().indexOf(r[0])>=0?t=parseInt(r[0],10):e=parseFloat(r[0])}else r.length>=2&&(e=parseFloat(r[0]),t=parseInt(r[1],10));var a;if(!(void 0!==e&&e>=0&&e<=1))return a=t?o._soundById(t):o._sounds[0],a?a._volume:0;if("loaded"!==o._state)return o._queue.push({event:"volume",action:function(){o.volume.apply(o,r)}}),o;void 0===t&&(o._volume=e),t=o._getSoundIds(t);for(var u=0;u<t.length;u++)(a=o._soundById(t[u]))&&(a._volume=e,r[2]||o._stopFade(t[u]),o._webAudio&&a._node&&!a._muted?a._node.gain.setValueAtTime(e,n.ctx.currentTime):a._node&&!a._muted&&(a._node.volume=e*n.volume()),o._emit("volume",a._id));return o},fade:function(e,t,o,r){var a=this;if("loaded"!==a._state)return a._queue.push({event:"fade",action:function(){a.fade(e,t,o,r)}}),a;a.volume(e,r);for(var u=a._getSoundIds(r),i=0;i<u.length;i++){var d=a._soundById(u[i]);if(d){if(r||a._stopFade(u[i]),a._webAudio&&!d._muted){var _=n.ctx.currentTime,s=_+o/1e3;d._volume=e,d._node.gain.setValueAtTime(e,_),d._node.gain.linearRampToValueAtTime(t,s)}a._startFadeInterval(d,e,t,o,u[i],void 0===r)}}return a},_startFadeInterval:function(e,n,t,o,r,a){var u=this,i=n,d=t-n,_=Math.abs(d/.01),s=Math.max(4,_>0?o/_:o),l=Date.now();e._fadeTo=t,e._interval=setInterval(function(){var r=(Date.now()-l)/o;l=Date.now(),i+=d*r,i=Math.max(0,i),i=Math.min(1,i),i=Math.round(100*i)/100,u._webAudio?e._volume=i:u.volume(i,e._id,!0),a&&(u._volume=i),(t<n&&i<=t||t>n&&i>=t)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,u.volume(t,e._id),u._emit("fade",e._id))},s)},_stopFade:function(e){var t=this,o=t._soundById(e);return o&&o._interval&&(t._webAudio&&o._node.gain.cancelScheduledValues(n.ctx.currentTime),clearInterval(o._interval),o._interval=null,t.volume(o._fadeTo,e),o._fadeTo=null,t._emit("fade",e)),t},loop:function(){var e,n,t,o=this,r=arguments;if(0===r.length)return o._loop;if(1===r.length){if("boolean"!=typeof r[0])return!!(t=o._soundById(parseInt(r[0],10)))&&t._loop;e=r[0],o._loop=e}else 2===r.length&&(e=r[0],n=parseInt(r[1],10));for(var a=o._getSoundIds(n),u=0;u<a.length;u++)(t=o._soundById(a[u]))&&(t._loop=e,o._webAudio&&t._node&&t._node.bufferSource&&(t._node.bufferSource.loop=e,e&&(t._node.bufferSource.loopStart=t._start||0,t._node.bufferSource.loopEnd=t._stop)));return o},rate:function(){var e,t,o=this,r=arguments;if(0===r.length)t=o._sounds[0]._id;else if(1===r.length){var a=o._getSoundIds(),u=a.indexOf(r[0]);u>=0?t=parseInt(r[0],10):e=parseFloat(r[0])}else 2===r.length&&(e=parseFloat(r[0]),t=parseInt(r[1],10));var i;if("number"!=typeof e)return i=o._soundById(t),i?i._rate:o._rate;if("loaded"!==o._state)return o._queue.push({event:"rate",action:function(){o.rate.apply(o,r)}}),o;void 0===t&&(o._rate=e),t=o._getSoundIds(t);for(var d=0;d<t.length;d++)if(i=o._soundById(t[d])){i._rateSeek=o.seek(t[d]),i._playStart=o._webAudio?n.ctx.currentTime:i._playStart,i._rate=e,o._webAudio&&i._node&&i._node.bufferSource?i._node.bufferSource.playbackRate.setValueAtTime(e,n.ctx.currentTime):i._node&&(i._node.playbackRate=e);var _=o.seek(t[d]),s=(o._sprite[i._sprite][0]+o._sprite[i._sprite][1])/1e3-_,l=1e3*s/Math.abs(i._rate);!o._endTimers[t[d]]&&i._paused||(o._clearTimer(t[d]),o._endTimers[t[d]]=setTimeout(o._ended.bind(o,i),l)),o._emit("rate",i._id)}return o},seek:function(){var e,t,o=this,r=arguments;if(0===r.length)t=o._sounds[0]._id;else if(1===r.length){var a=o._getSoundIds(),u=a.indexOf(r[0]);u>=0?t=parseInt(r[0],10):o._sounds.length&&(t=o._sounds[0]._id,e=parseFloat(r[0]))}else 2===r.length&&(e=parseFloat(r[0]),t=parseInt(r[1],10));if(void 0===t)return o;if("loaded"!==o._state)return o._queue.push({event:"seek",action:function(){o.seek.apply(o,r)}}),o;var i=o._soundById(t);if(i){if(!("number"==typeof e&&e>=0)){if(o._webAudio){var d=o.playing(t)?n.ctx.currentTime-i._playStart:0,_=i._rateSeek?i._rateSeek-i._seek:0;return i._seek+(_+d*Math.abs(i._rate))}return i._node.currentTime}var s=o.playing(t);s&&o.pause(t,!0),i._seek=e,i._ended=!1,o._clearTimer(t),s&&o.play(t,!0),!o._webAudio&&i._node&&(i._node.currentTime=e),o._emit("seek",t)}return o},playing:function(e){var n=this;if("number"==typeof e){var t=n._soundById(e);return!!t&&!t._paused}for(var o=0;o<n._sounds.length;o++)if(!n._sounds[o]._paused)return!0;return!1},duration:function(e){var n=this,t=n._duration,o=n._soundById(e);return o&&(t=n._sprite[o._sprite][1]/1e3),t},state:function(){return this._state},unload:function(){for(var e=this,t=e._sounds,o=0;o<t.length;o++){if(t[o]._paused||e.stop(t[o]._id),!e._webAudio){/MSIE |Trident\//.test(n._navigator&&n._navigator.userAgent)||(t[o]._node.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"),t[o]._node.removeEventListener("error",t[o]._errorFn,!1),t[o]._node.removeEventListener(n._canPlayEvent,t[o]._loadFn,!1)}delete t[o]._node,e._clearTimer(t[o]._id);var a=n._howls.indexOf(e);a>=0&&n._howls.splice(a,1)}var u=!0;for(o=0;o<n._howls.length;o++)if(n._howls[o]._src===e._src){u=!1;break}return r&&u&&delete r[e._src],n.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,n,t,o){var r=this,a=r["_on"+e];return"function"==typeof n&&a.push(o?{id:t,fn:n,once:o}:{id:t,fn:n}),r},off:function(e,n,t){var o=this,r=o["_on"+e],a=0;if("number"==typeof n&&(t=n,n=null),n||t)for(a=0;a<r.length;a++){var u=t===r[a].id;if(n===r[a].fn&&u||!n&&u){r.splice(a,1);break}}else if(e)o["_on"+e]=[];else{var i=Object.keys(o);for(a=0;a<i.length;a++)0===i[a].indexOf("_on")&&Array.isArray(o[i[a]])&&(o[i[a]]=[])}return o},once:function(e,n,t){var o=this;return o.on(e,n,t,1),o},_emit:function(e,n,t){for(var o=this,r=o["_on"+e],a=r.length-1;a>=0;a--)r[a].id&&r[a].id!==n&&"load"!==e||(setTimeout(function(e){e.call(this,n,t)}.bind(o,r[a].fn),0),r[a].once&&o.off(e,r[a].fn,r[a].id));return o},_loadQueue:function(){var e=this;if(e._queue.length>0){var n=e._queue[0];e.once(n.event,function(){e._queue.shift(),e._loadQueue()}),n.action()}return e},_ended:function(e){var t=this,o=e._sprite;if(!t._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(t._ended.bind(t,e),100),t;var r=!(!e._loop&&!t._sprite[o][2]);if(t._emit("end",e._id),!t._webAudio&&r&&t.stop(e._id,!0).play(e._id),t._webAudio&&r){t._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=n.ctx.currentTime;var a=1e3*(e._stop-e._start)/Math.abs(e._rate);t._endTimers[e._id]=setTimeout(t._ended.bind(t,e),a)}return t._webAudio&&!r&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,t._clearTimer(e._id),t._cleanBuffer(e._node),n._autoSuspend()),t._webAudio||r||t.stop(e._id),t},_clearTimer:function(e){var n=this;return n._endTimers[e]&&(clearTimeout(n._endTimers[e]),delete n._endTimers[e]),n},_soundById:function(e){for(var n=this,t=0;t<n._sounds.length;t++)if(e===n._sounds[t]._id)return n._sounds[t];return null},_inactiveSound:function(){var e=this;e._drain();for(var n=0;n<e._sounds.length;n++)if(e._sounds[n]._ended)return e._sounds[n].reset();return new o(e)},_drain:function(){var e=this,n=e._pool,t=0,o=0;if(!(e._sounds.length<n)){for(o=0;o<e._sounds.length;o++)e._sounds[o]._ended&&t++;for(o=e._sounds.length-1;o>=0;o--){if(t<=n)return;e._sounds[o]._ended&&(e._webAudio&&e._sounds[o]._node&&e._sounds[o]._node.disconnect(0),e._sounds.splice(o,1),t--)}}},_getSoundIds:function(e){var n=this;if(void 0===e){for(var t=[],o=0;o<n._sounds.length;o++)t.push(n._sounds[o]._id);return t}return[e]},_refreshBuffer:function(e){var t=this;return e._node.bufferSource=n.ctx.createBufferSource(),e._node.bufferSource.buffer=r[t._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,n.ctx.currentTime),t},_cleanBuffer:function(e){var t=this;if(n._scratchBuffer){e.bufferSource.onended=null,e.bufferSource.disconnect(0);try{e.bufferSource.buffer=n._scratchBuffer}catch(e){}}return e.bufferSource=null,t}};var o=function(e){this._parent=e,this.init()};o.prototype={init:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++n._counter,t._sounds.push(e),e.create(),e},create:function(){var e=this,t=e._parent,o=n._muted||e._muted||e._parent._muted?0:e._volume;return t._webAudio?(e._node=void 0===n.ctx.createGain?n.ctx.createGainNode():n.ctx.createGain(),e._node.gain.setValueAtTime(o,n.ctx.currentTime),e._node.paused=!0,e._node.connect(n.masterGain)):(e._node=new Audio,e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(n._canPlayEvent,e._loadFn,!1),e._node.src=t._src,e._node.preload="auto",e._node.volume=o*n.volume(),e._node.load()),e},reset:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++n._counter,e},_errorListener:function(){var e=this;e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorFn,!1)},_loadListener:function(){var e=this,t=e._parent;t._duration=Math.ceil(10*e._node.duration)/10,0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue()),e._node.removeEventListener(n._canPlayEvent,e._loadFn,!1)}};var r={},a=function(e){var n=e._src;if(r[n])return e._duration=r[n].duration,void d(e);if(/^data:[^;]+;base64,/.test(n)){for(var t=atob(n.split(",")[1]),o=new Uint8Array(t.length),a=0;a<t.length;++a)o[a]=t.charCodeAt(a);i(o.buffer,e)}else{var _=new XMLHttpRequest;_.open("GET",n,!0),_.withCredentials=e._xhrWithCredentials,_.responseType="arraybuffer",_.onload=function(){var n=(_.status+"")[0];if("0"!==n&&"2"!==n&&"3"!==n)return void e._emit("loaderror",null,"Failed loading audio file with status: "+_.status+".");i(_.response,e)},_.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete r[n],e.load())},u(_)}},u=function(e){try{e.send()}catch(n){e.onerror()}},i=function(e,t){n.ctx.decodeAudioData(e,function(e){e&&t._sounds.length>0&&(r[t._src]=e,d(t,e))},function(){t._emit("loaderror",null,"Decoding audio data failed.")})},d=function(e,n){n&&!e._duration&&(e._duration=n.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue())},_=function(){try{"undefined"!=typeof AudioContext?n.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?n.ctx=new webkitAudioContext:n.usingWebAudio=!1}catch(e){n.usingWebAudio=!1}var e=/iP(hone|od|ad)/.test(n._navigator&&n._navigator.platform),t=n._navigator&&n._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),o=t?parseInt(t[1],10):null;if(e&&o&&o<9){var r=/safari/.test(n._navigator&&n._navigator.userAgent.toLowerCase());(n._navigator&&n._navigator.standalone&&!r||n._navigator&&!n._navigator.standalone&&!r)&&(n.usingWebAudio=!1)}n.usingWebAudio&&(n.masterGain=void 0===n.ctx.createGain?n.ctx.createGainNode():n.ctx.createGain(),n.masterGain.gain.setValueAtTime(n._muted?0:1,n.ctx.currentTime),n.masterGain.connect(n.ctx.destination)),n._setup()};"function"==typeof define&&define.amd&&define([],function(){return{Howler:n,Howl:t}}),"undefined"!=typeof exports&&(exports.Howler=n,exports.Howl=t),"undefined"!=typeof window?(window.HowlerGlobal=e,window.Howler=n,window.Howl=t,window.Sound=o):"undefined"!=typeof global&&(global.HowlerGlobal=e,global.Howler=n,global.Howl=t,global.Sound=o)}();