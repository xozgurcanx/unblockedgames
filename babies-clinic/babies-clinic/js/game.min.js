Global={Tuto:0,resolution:2,isPrivate:false,gamePaused:false,Goals:[250,300,350,375,400,450,500,550,600,650,700,750,800,850,900,950,1e3,1050,1100,1150,1200,1250,1300,1350,1400,1450,1500,1550,1600,1800],Aut_recipes:[3,3,4,4,6,6,7,7,8,8,9,9,10,10,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12],Tools:["kotra1","kotra2","injection","pancement","kotra3","mihrar","sirou","wdan","checkup","car","mizanO","tol","puppet"],Toolsf:["kotra1.png","kotra2.png","injection.png","pancement.png","kotra3.png","mihrar.png","sirou.png","wdan.png","checkup.png","car.png","mizanO.png","tol.png","puppet.png"],level:null,nombre_levels:30,sauvegarde:[],NmoneyT:0,ajout:4e3};var Music={enableMisic:true,enablePause:false,music:null,sound:null};Save={save_ecrit:function(){var str="";for(var i=0;i<Global.nombre_levels;i++){str+=""+Global.sauvegarde[i].numetoile+","+Global.sauvegarde[i].nbr_happy+","+Global.sauvegarde[i].nbr_unhappy;if(i<Global.nombre_levels-1)str+=","}this.Save_setItem("Babies_sauvegarde",str)},save_lire:function(str1){Global.sauvegarde=[];var str=str1.split(",");var ii=0;while(ii<str.length/3){Global.sauvegarde[ii]={numetoile:0,nbr_happy:0,nbr_unhappy:0};Global.sauvegarde[ii].numetoile=+str[ii*3];Global.sauvegarde[ii].nbr_happy=+str[ii*3+1];Global.sauvegarde[ii].nbr_unhappy=+str[ii*3+2];ii++}},Save_getItem:function(name,pardefaut){if(!Global.isPrivate)return localStorage.getItem(name);else return pardefaut},Save_setItem:function(name,value){if(!Global.isPrivate)localStorage.setItem(name,value)}};Babies={};Babies.Boot=function(game){};Babies.Boot.prototype={preload:function(){this.game.load.image("bgMenu1","assets/images/bgMenu.png");this.game.load.image("bar2","assets/images/bar2.png");this.game.load.atlasXML("S","assets/images/sheet.png","assets/images/sheet.xml");game.load.bitmapFont("blue","assets/fonts/blue.png","assets/fonts/blue.xml");game.load.bitmapFont("black","assets/fonts/black.png","assets/fonts/black.xml");game.load.bitmapFont("gray","assets/fonts/gray.png","assets/fonts/gray.xml");game.load.bitmapFont("white","assets/fonts/white.png","assets/fonts/white.xml");game.load.bitmapFont("smp","assets/fonts/smp.png","assets/fonts/smp.xml");game.load.bitmapFont("smpB","assets/fonts/smpB.png","assets/fonts/smpB.xml")},create:function(){if(this.game.device.desktop){this.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL;this.scale.pageAlignHorizontally=true;this.scale.pageAlignVertically=true}else{this.scale.scaleMode=Phaser.ScaleManager.EXACT_FIT}this.game.scale.enterPortrait.add(this.rescale,this);this.game.scale.enterLandscape.add(this.rescale,this);this.scale.setScreenSize(true);this.game.state.start("preload")},rescale:function(){var _game=this.game;setTimeout(function(){_game.scale.refresh();setTimeout(function(){_game.scale.refresh()},400)},400)}};Babies.Preload=function(){this.logo=null};Babies.Preload.prototype={preload:function(){game.add.image(0,0,"bgMenu1");this.logo={logo1:null,logo2:null};this.logo.logo1=game.add.image(480,850,"S");this.logo.logo1.frameName="logo1.png";this.logo.logo1.anchor.setTo(.5,.5);this.logo.logo1.scale.setTo(.5,.5);this.logo.logo1.tween=game.add.tween(this.logo.logo1).to({x:485},1200,Phaser.Easing.Quadratic.Out).to({x:475},1200,Phaser.Easing.Quadratic.Out,true);this.logo.logo1.tween.loop();this.logo.logo1.tween.start();this.logo.logo2=game.add.image(480,920,"S");this.logo.logo2.frameName="logo2.png";this.logo.logo2.anchor.setTo(.5,.5);this.logo.logo2.scale.setTo(.5,.5);this.logo.logo2.tween=game.add.tween(this.logo.logo2).to({x:475},1200,Phaser.Easing.Quadratic.Out).to({x:485},1200,Phaser.Easing.Quadratic.Out,true);this.logo.logo2.tween.loop();this.logo.logo2.tween.start();HTML5API_preloaderStarted();HTML5API_preloaderEnded();var progressBar=game.add.image(0,503,"bar2");progressBar.x=97;game.load.setPreloadSprite(progressBar);var txt_progress=game.add.bitmapText(110*Global.resolution,535,"blue","",110);game.load.onFileComplete.add(function(progress){txt_progress.setText(progress+"%")},this);game.load.image("video_bnt","assets/images/video_bnt.png");game.load.image("nrm_bg2","assets/images/background"+Global.resolution+".png");game.load.image("bg_levels","assets/images/bg_levels.png");game.load.image("noir","assets/images/noir.png");game.load.spritesheet("pers","assets/images/pers.png",174,170);game.load.spritesheet("pers_S","assets/images/pers_S.png",168,209);game.load.spritesheet("syrop","assets/images/syrop.png",160,99);game.load.image("pbar","assets/images/pbar.png");game.load.audio("song17",["assets/music/music.ogg","assets/music/music.mp3"],true);if(!this.game.device.ie)game.load.audio("sound",["assets/music/sound.ogg","assets/music/sound.mp3"],true);else this.game.sound.usingWebAudio&&game.load.audio("sound",["assets/music/sound.ogg","assets/music/sound.mp3"],true);this.ready=false},create:function(){if(!this.game.device.desktop)this.game.scale.forceOrientation(false,true);if(game.device.localStorage){this.TestPrivate();var str=Save.Save_getItem("Babies_sauvegarde",null);Global.level=Save.Save_getItem("Babies_level",0);if(str==null||str=="null"||Global.level==null||Global.level=="null"){Global.sauvegarde=[];for(var i=0;i<Global.nombre_levels;i++){Global.sauvegarde[i]={numetoile:0,nbr_happy:0,nbr_unhappy:0}}Save.save_ecrit();Save.Save_setItem("Babies_level",0);Global.level=0}else{Save.save_lire(str)}}},TestPrivate:function(){var testKey="qeTest",storage=window.sessionStorage;try{storage.setItem(testKey,"1");storage.removeItem(testKey)}catch(error){Global.isPrivate=error.code===DOMException.QUOTA_EXCEEDED_ERR&&storage.length===0}},update:function(){if(game.cache.isSoundDecoded("song17")&&this.ready==false){this.ready=true;game.onPause.add(function(){Global.gamePaused=true;Music.music.pause()},this);game.onResume.add(function(){Global.gamePaused=false;if(Music.enableMisic)Music.music.resume()},this);this.game.state.start("play");play.numLevel=parseInt(Global.level)+1;Music.music=this.game.add.audio("song17");Music.music.onLoop.add(function(){Music.music.play()},this);Music.sound=this.game.add.audio("sound");Music.sound.addMarker("crying",0,2.616984126984127);Music.sound.addMarker("heartbeat",4,2.688979591836734);Music.sound.addMarker("hello",8,.602947845804989);Music.sound.addMarker("laugh",10,1.751269841269842);Music.music.play();Music.music.onStop.add(function(){if(Global.gamePaused)return;if(Music.enableMisic)Music.music.play()},this)}}};var Bouton=function(game,x,y,key,callback,callbackContext,l,overFrame,outFrame,downFrame){Phaser.Button.call(this,game,x,y,key,callback,callbackContext,overFrame,outFrame,downFrame);var tween1,tween2;if(typeof l==="undefined")l=true;this.anchor.setTo(.5,.5);this.onInputDown.add(function(){if(play.noir&&play.noir.visible&&this.key!="close"&&this.key!="close_S")return;if(Music.enableMisic)Music.sound.play("click");if(!l){this.scale.setTo(1.1,1.1);this.txt.scale.setTo(1.1,1.1);game.world.bringToTop(this);game.world.bringToTop(this.txt)}else{tween1=this.game.add.tween(this.scale).to({x:1.3},100,Phaser.Easing.Linear.Out).to({x:.9,y:1.1},100,Phaser.Easing.Linear.In).to({x:1,y:1},100,Phaser.Easing.Linear.Out);tween1.start();if(this.txt){tween2=game.world.bringToTop(this.txt);this.game.add.tween(this.txt.scale).to({x:1.3},100,Phaser.Easing.Linear.Out).to({x:.9,y:1.1},100,Phaser.Easing.Linear.In).to({x:1,y:1},100,Phaser.Easing.Linear.Out);tween2.start()}}},this);this.onInputUp.add(function(){if(play.noir&&play.noir.visible)return;if(!l){this.scale.setTo(1,1);this.txt.scale.setTo(1,1)}if(this.txt){game.world.bringToTop(this.txt)}},this)};Bouton.prototype=Object.create(Phaser.Button.prototype);Bouton.prototype.constructor=Bouton;Babies.Menu=function(){this.musicbnt=null;this.bnt_play=null;this.bnt_credits=null;this.levels=null;this.acheiv=null;this.face=null;this.logo=null;this.right_arm=null;this.left_arm=null;this.shadow=null};Babies.Menu.prototype={create:function(){this.add.image(0,0,"bgMenu");this.shadow=game.add.sprite(146,783,"S");this.shadow.frameName="shadow.png";this.shadow.anchor.setTo(.5,1);this.shadow.tween=game.add.tween(this.shadow.scale).to({y:.95},1e3,Phaser.Easing.Quadratic.Out).to({y:1},1e3,Phaser.Easing.Quadratic.Out);this.shadow.tween.loop();this.shadow.tween.start();this.right_arm=game.add.sprite(161,662,"S");this.right_arm.frameName="right_arm.png";this.right_arm.anchor.setTo(1,.2);this.right_arm.tween=game.add.tween(this.right_arm).to({angle:5},1e3,Phaser.Easing.Quadratic.Out).to({angle:-5},1e3,Phaser.Easing.Quadratic.Out);this.right_arm.tween.loop();this.right_arm.tween.start();this.left_arm=game.add.sprite(200,645,"S");this.left_arm.frameName="left_arm.png";this.left_arm.anchor.setTo(0,.2);this.left_arm.tween=game.add.tween(this.left_arm).to({angle:-5},1e3,Phaser.Easing.Quadratic.Out).to({angle:5},1e3,Phaser.Easing.Quadratic.Out);this.left_arm.tween.loop();this.left_arm.tween.start();game.add.sprite(105,662.5,"S").frameName="body.png";this.face=game.add.sprite(171,670,"S");this.face.frameName="face.png";this.face.anchor.setTo(.5,1);this.face.tween=game.add.tween(this.face.scale).to({y:.97},1e3,Phaser.Easing.Quadratic.Out).to({y:1},1e3,Phaser.Easing.Quadratic.Out);this.face.tween.loop();this.face.tween.start();this.light=game.add.sprite(308,220,"S");this.light.frameName="light.png";this.light.anchor.setTo(.5,.5);this.logo={logo1:null,logo2:null,light:null};this.logo.logo1=game.add.image(305,210,"S");this.logo.logo1.frameName="logo1.png";this.logo.logo1.anchor.setTo(.5,.5);this.logo.logo1.tween=game.add.tween(this.logo.logo1).to({x:320},1200,Phaser.Easing.Quadratic.Out).to({x:290},1200,Phaser.Easing.Quadratic.Out);this.logo.logo1.tween.loop();this.logo.logo1.tween.start();this.logo.logo2=game.add.image(305,330,"S");this.logo.logo2.frameName="logo2.png";this.logo.logo2.anchor.setTo(.5,.5);this.logo.logo2.tween=game.add.tween(this.logo.logo2).to({x:290},1200,Phaser.Easing.Quadratic.Out).to({x:320},1200,Phaser.Easing.Quadratic.Out);this.logo.logo2.tween.loop();this.logo.logo2.tween.start();this.bnt_play=new Bouton(this.game,160.5,892,"S",this.actionPlay,this);this.bnt_play.frameName="play_bnt.png";this.world.add(this.bnt_play);this.acheiv=new Bouton(this.game,502,46.5,"S",this.resultat,this);this.acheiv.frameName="menu_bnt.png";this.world.add(this.acheiv);this.musicbnt=new Bouton(this.game,590,46.5,"S",this.actionMusic,this);this.musicbnt.frameName="sound_on_bnt.png";this.world.add(this.musicbnt);if(Music.enableMisic){this.musicbnt.frameName="sound_on_bnt.png"}else{this.musicbnt.frameName="sound_off_bnt.png"}},resultat:function(){game.time.events.add(300,function(){this.game.state.start("levels",true)},this)},moregames:function(){},actionMusic:function(){Music.enableMisic=!Music.enableMisic;if(Music.enableMisic){this.musicbnt.frameName="sound_on_bnt.png";Music.music.resume()}else{this.musicbnt.frameName="sound_off_bnt.png";Music.music.pause()}},actionPlay:function(){game.time.events.add(300,function(){this.game.state.start("play",true)},this)},funccredits:function(){game.time.events.add(300,function(){this.game.state.start("credits",true)},this)},update:function(){this.light.angle+=.5}};Babies.Levels=function(){this.groupBnt=null;this.Groupe_courant=null;this.All_buttons=[];this.Gr_buttons=[];this.translatTween={y:0};this.velocityY=0;this.tween=null;this.mouve=false;this.isDown=null;this.MaxNbrBnt=null;this.buttonUp=null;this.buttonDown=null;this.bnt_home=null;this.led=null};Babies.Levels.prototype={create:function(){this.initProprties();this.game.input.maxPointers=1;this.mouve=false;this.game.add.image(0,0,"bg_levels");var bar=this.game.add.image(320,914,"S");bar.frameName="bar_L.png";bar.anchor.setTo(.5,.5);this.groupCnt=this.game.add.group();this.groupBnt=this.game.add.group();this.MaxNbrBnt=Global.nombre_levels;this.Groupe_courant=Math.floor((play.numLevel-1)/9);this.led=game.add.sprite(265,910,"S");this.led.anchor.setTo(.5,.5);this.led.frameName="led.png";this.led.x=265+this.Groupe_courant*36;var numtxt=0;while(numtxt<=18){numtxt++;var button=new Bouton(this.game,0,0,"S",null,null,false);button.frameName="bnt.png";button.onInputUp.add(function(){game.time.events.add(220,function(){if(this.frameName=="bnt.png"){play.numLevel=parseInt(this.txt.text);game.state.start("play",true)}},this)},button);button.txt=game.add.bitmapText(0,button.y,"gray",""+(numtxt+this.Groupe_courant*9)+"",100);button.kill();button.txt.visible=false;button.cnt=game.add.sprite(0,0,"S");button.cnt.frameName="container.png";button.cnt.visible=false;button.cnt.anchor.setTo(.5,.5);this.groupCnt.add(button.cnt);button.txtM=game.add.bitmapText(0,button.y+60,"black","",23);button.txtM.visible=false;button.txth=game.add.bitmapText(0,button.y+80,"black","0",22);button.txth.visible=false;button.txthI=game.add.sprite(0,0,"S");button.txthI.frameName="happy.png";button.txthI.scale.setTo(.9,.9);button.txthI.visible=false;button.txtunh=game.add.bitmapText(0,button.y+80,"black","1",22);button.txtunh.visible=false;button.txtunhI=game.add.sprite(0,0,"S");button.txtunhI.frameName="mad.png";button.txtunhI.visible=false;button.txtunhI.scale.setTo(.9,.9);game.world.bringToTop(button);this.groupBnt.add(button);this.Gr_buttons.push(button);if(numtxt%9==0){this.All_buttons.push(this.Gr_buttons);this.Gr_buttons=[]}}this.positionnreBnts(this.All_buttons[0],0,this.Groupe_courant);this.buttonUp=new Bouton(this.game,586,910,"S",this.funcGrSuivant,this);this.buttonUp.frameName="next_bnt.png";this.world.add(this.buttonUp);this.buttonDown=new Bouton(this.game,57,910,"S",this.funcGrPrecedent,this);this.buttonDown.frameName="back_bnt.png";this.world.add(this.buttonDown)},initProprties:function(){this.groupBnt=null;this.All_buttons=[];this.Gr_buttons=[];this.translatTween={y:0};this.velocityY=0;this.tween=null;this.mouve=false;this.isDown=null},funcHome:function(){game.time.events.add(300,function(){this.game.state.start("menu",true)},this)},positionnreBnts:function(groupBnts,tr,numG){var endBnt=false,framebnt;for(var jj=0;jj<groupBnts.length;jj++){if(endBnt){groupBnts[jj].kill();groupBnts[jj].txt.visible=false;groupBnts[jj].txtM.visible=false;groupBnts[jj].txth.visible=false;groupBnts[jj].txthI.visible=false;groupBnts[jj].txtunh.visible=false;groupBnts[jj].txtunhI.visible=false;groupBnts[jj].cnt.visible=false;continue}if(!groupBnts[jj].exists)groupBnts[jj].revive();if(jj==0){groupBnts[jj].x=65*Global.resolution;groupBnts[jj].y=120*Global.resolution}else if(jj==1){groupBnts[jj].x=157*Global.resolution;groupBnts[jj].y=120*Global.resolution}else if(jj==2){groupBnts[jj].x=249*Global.resolution;groupBnts[jj].y=120*Global.resolution}else if(jj==3){groupBnts[jj].x=65*Global.resolution;groupBnts[jj].y=235*Global.resolution}else if(jj==4){groupBnts[jj].x=157*Global.resolution;groupBnts[jj].y=235*Global.resolution}else if(jj==5){groupBnts[jj].x=249*Global.resolution;groupBnts[jj].y=235*Global.resolution}else if(jj==6){groupBnts[jj].x=65*Global.resolution;groupBnts[jj].y=350*Global.resolution}else if(jj==7){groupBnts[jj].x=157*Global.resolution;groupBnts[jj].y=350*Global.resolution}else if(jj==8){groupBnts[jj].x=249*Global.resolution;groupBnts[jj].y=350*Global.resolution}groupBnts[jj].y-=30;groupBnts[jj].x+=tr;if(!endBnt){groupBnts[jj].cnt.visible=true;groupBnts[jj].cnt.x=groupBnts[jj].x+20;groupBnts[jj].cnt.y=groupBnts[jj].y+53}if(numG*9+jj<=Global.level){framebnt="bnt.png"}else{framebnt="lock_bnt.png"}groupBnts[jj].txt.visible=framebnt=="bnt.png";groupBnts[jj].txtM.visible=true;groupBnts[jj].txth.visible=true;groupBnts[jj].txthI.visible=true;groupBnts[jj].txtunh.visible=true;groupBnts[jj].txtunhI.visible=true;var numtext=numG*9+jj+1;groupBnts[jj].txt.setText(""+numtext);if(numtext==1)groupBnts[jj].txt.x=groupBnts[jj].x-8*Global.resolution;else if(numtext<10)groupBnts[jj].txt.x=groupBnts[jj].x-12*Global.resolution;else if(numtext==11)groupBnts[jj].txt.x=groupBnts[jj].x-15*Global.resolution;else if(numtext<20){groupBnts[jj].txt.x=groupBnts[jj].x-21*Global.resolution;groupBnts[jj].txt.fontSize=95}else{groupBnts[jj].txt.x=groupBnts[jj].x-24*Global.resolution;groupBnts[jj].txt.fontSize=90;if(numtext==21)groupBnts[jj].txt.x+=4}groupBnts[jj].txt.y=groupBnts[jj].y-36*Global.resolution;if(numtext==11)groupBnts[jj].txt.y+=4;else if(numtext>19){groupBnts[jj].txt.y+=6}groupBnts[jj].frameName=framebnt;if(numtext==this.MaxNbrBnt)endBnt=true;groupBnts[jj].txtM.setText(""+Global.sauvegarde[numG*9+jj].numetoile);groupBnts[jj].txtM.x=groupBnts[jj].cnt.x-22;if(Global.sauvegarde[numG*9+jj].numetoile>9)groupBnts[jj].txtM.x-=5;if(Global.sauvegarde[numG*9+jj].numetoile>99)groupBnts[jj].txtM.x-=10;if(Global.sauvegarde[numG*9+jj].numetoile>999)groupBnts[jj].txtM.x-=10;groupBnts[jj].txtM.y=groupBnts[jj].cnt.y+24;groupBnts[jj].txtunh.setText(""+Global.sauvegarde[numG*9+jj].nbr_unhappy);groupBnts[jj].txtunh.x=groupBnts[jj].cnt.x+29;groupBnts[jj].txtunh.y=groupBnts[jj].cnt.y+68;groupBnts[jj].txtunhI.x=groupBnts[jj].cnt.x-15;groupBnts[jj].txtunhI.y=groupBnts[jj].cnt.y+60;groupBnts[jj].txth.setText(""+Global.sauvegarde[numG*9+jj].nbr_happy);groupBnts[jj].txth.x=groupBnts[jj].cnt.x-45;groupBnts[jj].txth.y=groupBnts[jj].cnt.y+68;groupBnts[jj].txthI.x=groupBnts[jj].cnt.x-90;groupBnts[jj].txthI.y=groupBnts[jj].cnt.y+58}},funcGrSuivant:function(){game.time.events.add(100,function(){if(!this.mouve&&this.Groupe_courant<Math.ceil(this.MaxNbrBnt/9)-1){this.Groupe_courant++;this.setAnimation();this.isDown=true;this.led.x+=36}},this)},setAnimation:function(){this.mouve=true;this.translatTween.y=this.world.height;this.velocityY=-800*Global.resolution},funcGrPrecedent:function(){game.time.events.add(100,function(){if(!this.mouve&&this.Groupe_courant>0){this.Groupe_courant--;this.setAnimation();this.isDown=false;this.led.x-=36}},this)},killBnt:function(obj){obj.kill();obj.txt.visible=false},animation:function(){this.translatTween.y+=this.velocityY*this.game.time.elapsed*.001;if(this.isDown){this.positionnreBnts(this.All_buttons[0],this.translatTween.y,this.Groupe_courant);this.positionnreBnts(this.All_buttons[1],this.translatTween.y-this.world.height,this.Groupe_courant-1)}else{this.positionnreBnts(this.All_buttons[0],this.translatTween.y*-1,this.Groupe_courant);this.positionnreBnts(this.All_buttons[1],this.translatTween.y*-1+this.world.height,this.Groupe_courant+1)}if(this.translatTween.y<=0){this.positionnreBnts(this.All_buttons[0],0,this.Groupe_courant);this.translatTween.y=0;this.All_buttons[1].forEach(this.killBnt,this);this.mouve=false}},update:function(){if(this.mouve){this.animation()}}};Babies.Credits=function(){this.bnt_home=null};Babies.Credits.prototype={create:function(){this.add.image(0,0,"credits");this.bnt_home=new Bouton(this.game,this.game.width/2,-100,"S",this.funcHome,this);this.bnt_home.frameName="home_bnt.png";this.bnt_home.tween=game.add.tween(this.bnt_home).to({y:65},700,Phaser.Easing.Quadratic.Out);this.bnt_home.tween.start();this.world.add(this.bnt_home)},funcHome:function(){game.time.events.add(300,function(){this.game.state.start("menu",true)},this)},update:function(){}};Babies.Play=function(){this.numLevel=null;this.gameOver=false;this.next_level=null;this.bnt_pause=null;this.musicbnt=null;this.shopbnt=null;this.shop_menu=null;this.bnt_replay=null;this.bgPause=null;this.groupPause=null;this.groupNexLevel=null;this.textPauseLevel=null;this.stateMusic=null;this.pausePlay=false;this.gr_babies=null;this.TB_per=null;this.pos_pers=null;this.noir=null;this.noir2=null;this.drag_element=null;this.drag_per=null;this.drag_perI=null;this.drag_perI2=null;this.timer=null;this.minutes=null;this.secondss=null;this.bonus_time=null;this.bonus_timer=null;this.Begin_Level=null;this.order=null;this.bounds=null;this.End=null;this.gr_elemnts=null;this.toolsP=[];this.In_use_T=null;this.gr_In_use_T=null;this.Img=null;this.Torder=null;this.score=null;this.scoreT=null;this.nbr_happy=null;this.nbr_unhappy=null;this.prog_bar=null;this.Rbar=null;this.crop_height=null;this.hand=null;this.hand_tween=null;this.repeat_tut=null;this.flechs=null;this.babies_heights=null;this.hidenin_pause=null;this.gr_pricks=null;this.nbr_unhpyB=null;this.isCar=false};Babies.Play.prototype={create:function(){game.add.image(0,0,"nrm_bg2");if(this.numLevel>Global.nombre_levels){this.stateMusic=Music.enableMisic;this.createCongratulations();return}HTML5API_levelStarted();this.initAtributs();this.toolsP=[112,778,170,770,120,830,160,875,90,880,315,830,270,780,328,789,310,878,505,875,128.5,670,552,628,481,809];this.gr_babies=game.add.group();this.createButtonsPlay();this.create_pers();this.prog_bar=game.add.sprite(540,85,"S");this.prog_bar.frameName="bar.png";this.Rbar=game.add.sprite(540,85,"S");this.Rbar.frameName="rbar.png";this.Rbar.visible=false;this.prog_bar.Bar=game.add.sprite(577,287,"pbar");this.prog_bar.Bar.anchor.y=1;this.prog_bar.Bar.initHeight=this.prog_bar.Bar.height;this.prog_bar.Bar.crop_rect={x:0,y:0,width:play.prog_bar.Bar.width,height:this.prog_bar.Bar.initHeight};this.crop_height=this.prog_bar.Bar.initHeight/4;this.prog_bar.visible=false;this.prog_bar.Bar.visible=false;this.pos_pers=[0,0,0,0];this.minutes=2;this.secondss=0;this.bonus_time=this.minutes*60;this.bonus_timer=false;game.time.events.add(1e3,function(){play.bonus_timer=true});this.timer=game.add.bitmapText(203,29,"white",this.minutes+":"+this.secondss+"0",28);this.timer.time=1e3;this.scoreT=game.add.bitmapText(365,29,"white",""+this.score,28);var g=game.add.bitmapText(495,29,"white",""+Global.Goals[this.numLevel-1],28);if(Global.Goals[this.numLevel-1]>=1e3)g.x-=5;this.gr_elemnts=game.add.group();this.noir=game.add.image(0,0,"noir");this.noir.visible=false;if(Music.enableMisic){this.musicbnt.fameName="sound_onp.png"}else{Music.disableBoutton=true;this.musicbnt.fameName="sound_offp.png"}var element,nbr_tools=Global.Aut_recipes[this.numLevel-1]+1;for(var yy=0;yy<nbr_tools;yy++){element=game.add.sprite(0,0,"S");element.fameName="kotra2.png";element.anchor.setTo(.5,.5);if(yy<7&&yy!=5)element.lvl=4;if(yy!=11&&yy!=10){element.inputEnabled=true;element.events.onInputDown.add(this.func_dn,element);element.events.onInputUp.add(this.func_Up,element)}else if(yy==11){element.inputEnabled=true;element.events.onInputUp.add(this.func_up_tol,element);element.inputEnabled=false}else if(yy==10){element.inputEnabled=true;element.events.onInputUp.add(this.func_up_mizan,element);element.inputEnabled=false}switch(yy){case 0:{element.frameName="kotra1.png";element.x=this.toolsP[yy*2];element.y=this.toolsP[yy*2+1];break}case 1:{element.frameName="kotra2.png";element.x=this.toolsP[yy*2];element.y=this.toolsP[yy*2+1];break}case 2:{element.frameName="injection.png";element.x=this.toolsP[yy*2];element.y=this.toolsP[yy*2+1];break}case 3:{element.frameName="pancement.png";element.angle=-35;element.x=this.toolsP[yy*2];element.y=this.toolsP[yy*2+1];break}case 4:{element.frameName="kotra3.png";element.x=this.toolsP[yy*2];element.y=this.toolsP[yy*2+1];break}case 5:{element.frameName="mihrar.png";element.x=this.toolsP[yy*2];element.y=this.toolsP[yy*2+1];break}case 6:{element.frameName="sirou.png";element.x=this.toolsP[yy*2];element.y=this.toolsP[yy*2+1];break}case 7:{element.frameName="wdan.png";element.x=this.toolsP[yy*2];element.y=this.toolsP[yy*2+1];break}case 8:{element.frameName="checkup.png";element.scale.setTo(.8,.8);element.x=this.toolsP[yy*2];element.y=this.toolsP[yy*2+1];break}case 9:{element.frameName="car.png";element.x=this.toolsP[yy*2];element.y=this.toolsP[yy*2+1];element.scale.setTo(.9,.9);break}case 10:{element.frameName="mizan.png";element.x=this.toolsP[yy*2];element.y=this.toolsP[yy*2+1];element.flech=game.add.sprite(88.5,722,"S");element.flech.frameName="mizanF.png";element.flech.anchor.setTo(.5,1);element.cover=game.add.sprite(88.5,728,"S");element.cover.frameName="mizanAF.png";element.cover.anchor.setTo(.5,.5);this.flechs.mizan=element.flech;break}case 11:{element.frameName="tol.png";element.x=this.toolsP[yy*2];element.y=this.toolsP[yy*2+1];element.flech=game.add.sprite(594,695,"S");element.flech.frameName="tolF.png";element.flech.anchor.setTo(.5,.5);this.flechs.tol=element.flech;break}case 12:{element.frameName="puppet.png";element.x=this.toolsP[yy*2];element.y=this.toolsP[yy*2+1];break}}this.gr_elemnts.add(element)}for(var b=0;b<4;b++){this.In_use_T=game.add.sprite(0,0,"S");this.In_use_T.frameName="kotra1.png";this.In_use_T.scale.setTo(.7,.7);this.In_use_T.visible=false;this.In_use_T.baby=null;this.In_use_T.P_use_T=null;this.In_use_T.sp=game.add.sprite(0,356,"S");this.In_use_T.sp.frameName="dam3a.png";this.In_use_T.sp3=game.add.sprite(0,340,"S");this.In_use_T.sp3.frameName="dam3a.png";this.In_use_T.sp3.step=1;this.In_use_T.sp.Tween=game.add.tween(this.In_use_T.sp).to({y:385},500,Phaser.Easing.None,false);this.In_use_T.sp3.Tweenk3=game.add.tween(this.In_use_T.sp3).to({y:360},500,Phaser.Easing.None,false);this.In_use_T.sp.Tween.pos=null;this.In_use_T.sp3.Tweenk3.pos=null;this.In_use_T.sp.visible=false;this.In_use_T.sp3.visible=false;this.In_use_T.sp.Tween.onStart.add(function(){this.sp.visible=true;this.sp.x=this.x-10},this.In_use_T);this.In_use_T.sp3.Tweenk3.onStart.add(function(){this.sp3.visible=true;this.sp3.x=this.x;if(Math.floor(this.x/160)==3)this.sp3.x+=5},this.In_use_T);this.In_use_T.sp.Tween.onComplete.add(function(){this.sp.visible=false;this.sp.y-=20;if(this.sp.Tween.rep==0){this.sp.visible=false;this.sp.Tween.rep=2;this.visible=false;this.P_use_T.visible=true;this.P_use_T=null;play.baby_attded(this.baby,null)}else{this.sp.Tween.rep--;game.time.events.add(200,function(){this.sp.Tween.start()},this)}},this.In_use_T);this.In_use_T.sp3.Tweenk3.onComplete.add(function(){this.sp3.visible=false;this.sp3.y-=20;if(this.sp3.step==1){this.sp3.step++;this.x-=30;this.sp3.x-=30;game.time.events.add(500,function(){this.sp3.Tweenk3.start()},this)}else{this.visible=false;this.P_use_T.visible=true;this.sp3.step=1;this.x+=30;this.sp3.x+=30;this.P_use_T=null;play.baby_attded(this.baby,null)}},this.In_use_T);this.In_use_T.sp.Tween.rep=2;this.In_use_T.inputEnabled=true;this.In_use_T.events.onInputDown.add(this.Small_elem,this);this.In_use_T.inputEnabled=false;this.gr_In_use_T[b]=this.In_use_T}this.Img=game.add.sprite(0,0,"pers",0);this.Img.anchor.setTo(.5,.5);this.Img.P_pos=null;this.Img.inputEnabled=true;this.Img.events.onInputDown.add(this.downImg,this);this.Img.events.onInputUp.add(this.upImg,this);this.Img.inputEnabled=false;this.Img.visible=false;this.Img2=game.add.sprite(0,0,"pers",0);this.Img2.anchor.setTo(.5,.5);this.Img2.P_pos=null;this.Img2.inputEnabled=true;this.Img2.events.onInputDown.add(this.downImg2,this);this.Img2.events.onInputUp.add(this.upImg2,this);this.Img2.inputEnabled=false;this.Img2.visible=false;this.Torder=game.add.sprite(-200,0,"S");this.Torder.frameName="Torder.png";this.Torder.anchor.setTo(.5,1);this.Torder.visible=false;this.Torder2=game.add.sprite(-200,0,"S");this.Torder2.frameName="Torder.png";this.Torder2.anchor.setTo(.5,1);this.Torder2.visible=false;var prick;this.gr_pricks=[];for(var h=0;h<4;h++){prick={pr1:null,pr2:null,pr3:null,tween:null,syrop:null};prick.pr2=game.add.sprite(18+h*160,367,"S");prick.pr2.frameName="pr2.png";prick.pr2.scale.setTo(.7,.7);prick.pr2.angle=20;prick.pr1=game.add.sprite(2+h*160,345,"S");prick.pr1.frameName="pr1.png";prick.pr1.scale.setTo(.7,.7);prick.pr1.angle=20;prick.pr3=game.add.sprite(14+h*160,378,"S");prick.pr3.frameName="pr3.png";prick.pr3.scale.setTo(.8,.8);prick.pr3.angle=-130;prick.tween=game.add.tween(prick.pr1).to({x:9+h*160,y:354},700,Phaser.Easing.Linear.None);prick.elem=null;prick.tween.onComplete.add(function(){this.pr1.x=2+this.elem.sp.Tween.pos*160;this.pr1.y=345;this.pr2.x=18+this.elem.sp.Tween.pos*160;this.pr2.y=367;this.pr2.visible=this.pr1.visible=this.pr3.visible=false;this.elem.P_use_T.visible=true;this.elem.P_use_T=null;this.elem.baby.order.medic.frameName="pancement.png";if(!this.elem.baby.animations.getAnimation("sad").isPlaying){if(Music.enableMisic)Music.sound.play("crying");this.crying(this.elem.baby)}this.elem.baby.animations.play("sad",8,true)},prick);prick.pr1.visible=false;prick.pr2.visible=false;prick.pr3.visible=false;prick.syrop=game.add.sprite(h*160,367,"syrop");prick.syrop.tween1=game.add.tween(prick.syrop).to({alpha:.2},600,Phaser.Easing.Linear.None);prick.syrop.tween2=game.add.tween(prick.syrop.scale).to({x:.3,y:.3},600,Phaser.Easing.Linear.None);prick.syrop.tween3=game.add.tween(prick.syrop).to({x:h*160+60,y:370},600,Phaser.Easing.Linear.None);prick.syrop.tween3.onComplete.add(function(){play.gr_In_use_T[this.elem.sp.Tween.pos].P_use_T.visible=true;play.gr_In_use_T[this.elem.sp.Tween.pos].P_use_T=null;play.gr_In_use_T[this.elem.sp.Tween.pos].scale.setTo(.5,.5);this.syrop.alpha=1;this.syrop.scale.setTo(1,1);this.syrop.position.setTo(this.elem.sp.Tween.pos*160,367);this.syrop.visible=false;play.baby_attded(play.gr_In_use_T[this.elem.sp.Tween.pos].baby,null)},prick);var an=prick.syrop.animations.add("sr",[0,1,2,3,4]);an.onComplete.add(function(){play.gr_In_use_T[this.elem.sp.Tween.pos].visible=false;play.gr_In_use_T[this.elem.sp.Tween.pos].alpha=1;this.syrop.frame=5;this.syrop.tween1.start();this.syrop.tween2.start();this.syrop.tween3.start()},prick);prick.syrop.visible=false;this.gr_pricks[h]=prick}this.txtTut=game.add.bitmapText(150,650,"black","Drag medecines\nonto the babies.",40);this.txtTut.x=440-this.txtTut.textWidth/2;this.txtTut.visible=false;this.hand=game.add.sprite(-100,-100,"S");this.hand.frameName="hand.png";this.hand.scale.setTo(1.1,1.1);this.hand.anchor.setTo(.5,.5);this.hand.visible=false;if(this.numLevel==1){this.handShop=game.add.sprite(555,90,"S");this.handShop.frameName="hand.png";this.handShop.scale.setTo(-1.1,1.1);this.handShop.anchor.setTo(.5,.5);this.handShop.visible=false}this.shop_menu=game.add.sprite(320,470,"S");this.shop_menu.frameName="shop_menu.png";this.shop_menu.anchor.setTo(.5,.5);this.shop_menu.scale.setTo(.9,.9);this.shop_menu.txt=game.add.bitmapText(325,338,"white",""+this.score,35);this.shop_menu.txt.visible=false;this.shop_menu.elems=[];this.shop_menu.bnt=new Bouton(this.game,320,850,"S",this.Close_shop,this);this.shop_menu.bnt.frameName="close_S.png";this.game.world.add(this.shop_menu.bnt);for(var u=0;u<6;u++){this.shop_menu.elems[u]=game.add.sprite(0,0,"S");this.shop_menu.elems[u].frameName="kotra1.png";this.shop_menu.elems[u].visible=false;switch(u){case 0:{this.shop_menu.elems[u].x=158;this.shop_menu.elems[u].y=410;this.shop_menu.elems[u].bnt=game.add.sprite(174,450,"S");this.shop_menu.elems[u].bnt.frameName="SS.png";this.shop_menu.elems[u].bnt.anchor.setTo(.5,.5);this.shop_menu.elems[u].bnt.scale.setTo(.7,.7);this.shop_menu.elems[u].bnt.nbr=0;this.shop_menu.elems[u].bnt.inputEnabled=true;this.shop_menu.elems[u].bnt.events.onInputDown.add(this.Click_shop,this);this.shop_menu.elems[u].bnt.visible=false;this.shop_menu.elems[u].bnt.inputEnabled=false;break}case 1:{this.shop_menu.elems[u].frameName="kotra2.png";this.shop_menu.elems[u].scale.setTo(.88,.88);this.shop_menu.elems[u].x=297;this.shop_menu.elems[u].y=410;this.shop_menu.elems[u].bnt=game.add.sprite(313,450,"S");this.shop_menu.elems[u].bnt.frameName="SS.png";this.shop_menu.elems[u].bnt.anchor.setTo(.5,.5);this.shop_menu.elems[u].bnt.scale.setTo(.7,.7);this.shop_menu.elems[u].bnt.nbr=1;this.shop_menu.elems[u].bnt.inputEnabled=true;this.shop_menu.elems[u].bnt.events.onInputDown.add(this.Click_shop,this);this.shop_menu.elems[u].bnt.visible=false;this.shop_menu.elems[u].bnt.inputEnabled=false;break}case 2:{this.shop_menu.elems[u].frameName="injection1.png";this.shop_menu.elems[u].x=449;this.shop_menu.elems[u].y=335;this.shop_menu.elems[u].x-=35;this.shop_menu.elems[u].y+=85;this.shop_menu.elems[u].scale.setTo(.9,.9);this.shop_menu.elems[u].bnt=game.add.sprite(453,450,"S");this.shop_menu.elems[u].bnt.frameName="SS.png";this.shop_menu.elems[u].bnt.anchor.setTo(.5,.5);this.shop_menu.elems[u].bnt.scale.setTo(.7,.7);this.shop_menu.elems[u].bnt.nbr=2;this.shop_menu.elems[u].bnt.inputEnabled=true;this.shop_menu.elems[u].bnt.events.onInputDown.add(this.Click_shop,this);this.shop_menu.elems[u].bnt.visible=false;this.shop_menu.elems[u].bnt.inputEnabled=false;break}case 3:{this.shop_menu.elems[u].frameName="pancement.png";
this.shop_menu.elems[u].x=158;this.shop_menu.elems[u].y=585;this.shop_menu.elems[u].x-=20;this.shop_menu.elems[u].y+=35;this.shop_menu.elems[u].bnt=game.add.sprite(174,638,"S");this.shop_menu.elems[u].bnt.frameName="SS.png";this.shop_menu.elems[u].bnt.anchor.setTo(.5,.5);this.shop_menu.elems[u].bnt.scale.setTo(.7,.7);this.shop_menu.elems[u].bnt.nbr=3;this.shop_menu.elems[u].bnt.inputEnabled=true;this.shop_menu.elems[u].bnt.events.onInputDown.add(this.Click_shop,this);this.shop_menu.elems[u].bnt.visible=false;this.shop_menu.elems[u].bnt.inputEnabled=false;break}case 4:{this.shop_menu.elems[u].frameName="kotra3.png";this.shop_menu.elems[u].scale.setTo(.95,.95);this.shop_menu.elems[u].x=280;this.shop_menu.elems[u].y=594;this.shop_menu.elems[u].y+=18;this.shop_menu.elems[u].bnt=game.add.sprite(313,638,"S");this.shop_menu.elems[u].bnt.frameName="SS.png";this.shop_menu.elems[u].bnt.anchor.setTo(.5,.5);this.shop_menu.elems[u].bnt.scale.setTo(.7,.7);this.shop_menu.elems[u].bnt.nbr=4;this.shop_menu.elems[u].bnt.inputEnabled=true;this.shop_menu.elems[u].bnt.events.onInputDown.add(this.Click_shop,this);this.shop_menu.elems[u].bnt.visible=false;this.shop_menu.elems[u].bnt.inputEnabled=false;break}case 5:{this.shop_menu.elems[u].frameName="sirou.png";this.shop_menu.elems[u].scale.setTo(.97,.96);this.shop_menu.elems[u].x=440;this.shop_menu.elems[u].y=595;this.shop_menu.elems[u].bnt=game.add.sprite(453,638,"S");this.shop_menu.elems[u].bnt.frameName="SS.png";this.shop_menu.elems[u].bnt.anchor.setTo(.5,.5);this.shop_menu.elems[u].bnt.scale.setTo(.7,.7);this.shop_menu.elems[u].bnt.nbr=5;this.shop_menu.elems[u].bnt.inputEnabled=true;this.shop_menu.elems[u].bnt.events.onInputDown.add(this.Click_shop,this);this.shop_menu.elems[u].bnt.visible=false;this.shop_menu.elems[u].bnt.inputEnabled=false;break}}}this.shop_menu.bnt.visible=false;this.shop_menu.visible=false;if(this.gr_elemnts.length>=12)this.gr_elemnts.getAt(11).inputEnabled=false;if(this.gr_elemnts.length>=11)this.gr_elemnts.getAt(10).inputEnabled=false;this.noir2=game.add.image(0,0,"noir");this.noir2.visible=false;this.createPause();this.groupNexLevel=this.game.add.group()},crying:function(e){if(e.visible&&e.alive&&!this.game.gameOver&&!this.pausePlay){game.time.events.add(2700,function(){this.crying(e)},this);if(e.animations.getAnimation("sad").isPlaying&&Music.enableMisic)Music.sound.play("crying")}},New_tween_tol:function(){var element;for(var k=0;k<this.gr_elemnts.length;k++){if(this.gr_elemnts.getAt(k).frameName=="tol.png"){element=this.gr_elemnts.getAt(k);break}}element.flech.tween1=game.add.tween(element.flech).to({y:520},800,Phaser.Easing.Linear.Out);element.flech.tween1.onComplete.add(function(){element.flech.tween2.start()},this);element.flech.tween2=game.add.tween(element.flech).to({y:695},800,Phaser.Easing.Linear.Out);element.flech.tween2.onComplete.add(function(){element.flech.tween1.start()},this);element.flech.tween1.start();this.flechs.tol=element.flech;element.inputEnabled=true},New_tween_mizan:function(){var element;for(var k=0;k<this.gr_elemnts.length;k++){if(this.gr_elemnts.getAt(k).frameName=="mizan.png"){element=this.gr_elemnts.getAt(k);break}}element.flech.tween1=game.add.tween(element.flech).to({angle:95},900,Phaser.Easing.Linear.Out);element.flech.tween1.onComplete.add(function(){element.flech.tween2.start()},this);element.flech.tween2=game.add.tween(element.flech).to({angle:-95},900,Phaser.Easing.Linear.Out);element.flech.tween2.onComplete.add(function(){element.flech.tween1.start()},this);element.flech.tween1.start();this.flechs.mizan=element.flech;element.inputEnabled=true},func_up_tol:function(e){if(!play.gameOver){e.flech.tween1.pause();e.flech.tween2.pause();e.flech.tween1.pendingDelete=true;e.flech.tween2.pendingDelete=true;if(play.hand_tween!=null){play.hand_tween.pause();play.hand.x=play.hand.y=-100;play.hand.visible=false;play.repeat_tut--}if(Math.abs(play.babies_heights[Math.floor(play.Img2.frame/2)]-e.flech.y)>17)play.Img2.loadTexture("pers_S",play.Img2.frame+1);e.inputEnabled=false;game.time.events.add(2e3,function(){play.Torder2.visible=true;play.Torder2.x=play.Img2.x;play.Torder2.y=play.Img2.y-80;play.Img2.inputEnabled=true},this)}},func_up_mizan:function(e){if(!play.gameOver){if(e.flech.angle<=95||e.flech.angle>=-95){e.flech.tween1.pause();e.flech.tween2.pause();e.flech.tween1.pendingDelete=true;e.flech.tween2.pendingDelete=true;if(play.hand_tween!=null){play.hand_tween.pause();play.hand.x=play.hand.y=-100;play.hand.visible=false;play.repeat_tut--}if(e.flech.angle>-56&&e.flech.angle<58){play.Img.frame=play.Img.frame+6}else{play.Img.frame=Math.floor(play.Img.frame/13)+78}e.inputEnabled=false;game.time.events.add(2e3,function(){play.Torder.visible=true;play.Torder.x=play.Img.x;play.Torder.y=play.Img.y-50;play.Img.inputEnabled=true},this)}}},Small_elem:function(e){if(e.frameName=="injection.png"){e.visible=false;e.alpha=1;e.angle=0;e.scale.setTo(.2,.2);play.gr_pricks[e.sp.Tween.pos].elem=e;play.gr_pricks[e.sp.Tween.pos].tween.start()}else if(e.frameName=="wdan.png"){e.x=e.x-67;if(Math.floor(e.x/160)==2)e.x+=2;else if(Math.floor(e.x/160)==3)e.x+=4;play.gr_babies.forEachAlive(function(b){if(Math.floor(b.x/160)==Math.floor(e.x/160)&&b.frameName!="chair.png"){if(Math.floor(e.x/160)==3){if(b.type/13==0||b.type/13==4)play.gr_In_use_T[Math.floor(e.x/160)].x-=1;else if(b.type/13==2)play.gr_In_use_T[Math.floor(e.x/160)].x-=2}else if(b.type/13==2&&(Math.floor(e.x/160)==0||Math.floor(e.x/160)==1)){play.gr_In_use_T[Math.floor(e.x/160)].x+=1}}},this);e.scale.y=-.7;game.time.events.add(2e3,function(){e.visible=false;e.P_use_T.visible=true;e.P_use_T=null;e.scale.setTo(.7,.7);this.baby_attded(e.baby,null)},this)}if(this.hand_tween!=null)this.hand_tween.pause();if(e.frameName!="checkup.png"){this.hand.x=this.hand.y=-100;this.hand.visible=false;e.inputEnabled=false}this.repeat_tut--},Hand_tween:function(elem){var tr=0,tv=0;switch(elem.frameName){case"wdan.png":{tr=29;break}case"mizan.png":{tv=30;break}case"tol.png":{tv=30;break}}this.hand.visible=true;this.hand.x=elem.x+40+tr;this.hand.y=elem.y+40+tv;this.hand_tween=game.add.tween(this.hand).to({x:elem.x+10+tr,y:elem.y+10+tv},300,Phaser.Easing.Linear.Out).to({x:elem.x+40+tr,y:elem.y+40+tv},400,Phaser.Easing.Linear.Out);this.hand_tween.loop();this.hand_tween.start()},set_shop_score:function(){this.shop_menu.txt.setText(""+this.score);if(this.score<10)this.shop_menu.txt.x=322;else if(this.score<100)this.shop_menu.txt.x=320;else this.shop_menu.txt.x=305},Click_shop:function(e){var p;switch(e.nbr){case 0:{if(this.shop_menu.elems[e.nbr].alpha==1){this.score-=15;this.set_shop_score();this.Close_shop();for(p=0;p<this.gr_elemnts.length;p++){if(this.gr_elemnts.getAt(p).frameName=="kotra1.png"){this.gr_elemnts.getAt(p).lvl=4;this.gr_elemnts.getAt(p).alpha=1;break}}this.set_score_text()}break}case 1:{if(this.shop_menu.elems[e.nbr].alpha==1){this.score-=15;this.set_shop_score();this.Close_shop();for(p=0;p<this.gr_elemnts.length;p++){if(this.gr_elemnts.getAt(p).frameName=="kotra2.png"){this.gr_elemnts.getAt(p).lvl=4;this.gr_elemnts.getAt(p).alpha=1;break}}this.set_score_text()}break}case 2:{if(this.shop_menu.elems[e.nbr].alpha==1){this.score-=20;this.set_shop_score();this.Close_shop();for(p=0;p<this.gr_elemnts.length;p++){if(this.gr_elemnts.getAt(p).frameName=="injection.png"){this.gr_elemnts.getAt(p).lvl=4;this.gr_elemnts.getAt(p).alpha=1;break}}this.set_score_text()}break}case 3:{if(this.shop_menu.elems[e.nbr].alpha==1){this.score-=20;this.set_shop_score();this.Close_shop();for(p=0;p<this.gr_elemnts.length;p++){if(this.gr_elemnts.getAt(p).frameName=="pancement.png"){this.gr_elemnts.getAt(p).lvl=4;this.gr_elemnts.getAt(p).alpha=1;break}}this.set_score_text()}break}case 4:{if(this.shop_menu.elems[e.nbr].alpha==1){this.score-=25;this.set_shop_score();this.Close_shop();for(p=0;p<this.gr_elemnts.length;p++){if(this.gr_elemnts.getAt(p).frameName=="kotra3.png"){this.gr_elemnts.getAt(p).lvl=4;this.gr_elemnts.getAt(p).alpha=1;break}}this.set_score_text()}break}case 5:{if(this.shop_menu.elems[e.nbr].alpha==1){this.score-=25;this.set_shop_score();this.Close_shop();for(p=0;p<this.gr_elemnts.length;p++){if(this.gr_elemnts.getAt(p).frameName=="sirou.png"){this.gr_elemnts.getAt(p).lvl=4;this.gr_elemnts.getAt(p).alpha=1;break}}this.set_score_text()}break}}},Close_shop:function(){game.time.events.add(400,function(){this.shop_menu.bnt.visible=false;this.shop_menu.visible=false;this.gameOver=false;this.shop_menu.txt.visible=false;this.noir.visible=false;for(var u=0;u<6;u++){this.shop_menu.elems[u].visible=false;this.shop_menu.elems[u].bnt.inputEnabled=false;this.shop_menu.elems[u].bnt.visible=false}},this)},getbounds:function(e){this.bounds.x=e.x;this.bounds.width=e.width;this.bounds.y=e.y;this.bounds.height=e.height;return this.bounds},func_dn:function(){if(!play.gameOver){if(play.numLevel==1&&play.isTuto==1&&play.hand.visible)play.hand.visible=false;play.drag_element=this;for(var t=0;t<play.gr_elemnts.length;t++){if(t!=play.gr_elemnts.getIndex(this))play.gr_elemnts.sendToBack(play.gr_elemnts.getAt(t))}if(this.frameName=="kotra1.png"||this.frameName=="kotra2.png"||this.frameName=="injection.png"||this.frameName=="pancement.png"||this.frameName=="kotra3.png"||this.frameName=="sirou.png"){play.prog_bar.Bar.crop_rect.height=play.crop_height*this.lvl;play.prog_bar.Bar.crop(new Phaser.Rectangle(0,0,play.prog_bar.Bar.width,play.prog_bar.Bar.crop_rect.height));play.prog_bar.visible=true;play.prog_bar.Bar.visible=true;if(this.alpha!=1)play.Rbar.visible=true}}},InBaby:function(b,x,y){var x1=b.x-80;if(x>=x1&&x<=x1+160){var y1=b.y-b.height/2;if(y>=y1&&y<=y1+b.height){return true}}return false},func_Up:function(e){if(!play.gameOver){if(play.noir.visible||play.noir2.visible)return;play.prog_bar.visible=false;play.prog_bar.Bar.visible=false;play.Rbar.visible=false;play.gr_babies.forEachAlive(function(a){if(a.frameName!="chair.png"&&play.InBaby(play.getbounds(a),play.drag_element.x,play.drag_element.y)&&!a.eat){if(a.order.medic.frameName==this.frameName){if(play.numLevel==1&&play.isTuto==1){play.isTuto++;play.txtTut.destroy();play.HandTween.stop();play.HandTween.pause();play.HandTween.pendingDelete=true;play.hand.visible=false}var pos=Math.floor(a.x/160);play.gr_In_use_T[pos].sp.Tween.pos=pos;this.visible=false;play.gr_In_use_T[pos].P_use_T=this;play.gr_In_use_T[pos].baby=a;if(this.frameName!="pancement.png"&&this.frameName!="car.png"&&this.frameName!="puppet.png")play.gr_In_use_T[pos].visible=true;if(this.frameName=="injection.png")play.gr_pricks[pos].pr1.visible=play.gr_pricks[pos].pr2.visible=play.gr_pricks[pos].pr3.visible=true;play.gr_In_use_T[pos].frameName=this.frameName;if(this.frameName=="checkup.png")play.gr_In_use_T[pos].frameName="setho.png";play.animationT(pos);if(this.frameName=="wdan.png"||this.frameName=="injection.png")play.gr_In_use_T[pos].inputEnabled=true;if(play.repeat_tut>0){if(this.frameName=="injection.png"&&play.numLevel==1){play.Hand_tween(play.gr_In_use_T[pos])}else if(this.frameName=="wdan.png"&&play.numLevel==7){play.Hand_tween(play.gr_In_use_T[pos])}}play.drag_element.lvl--;if(play.drag_element.lvl==0){e.alpha=.6;if(play.numLevel==1){play.handShop.visible=true;play.HandTweenS=game.add.tween(play.handShop).to({x:585,y:60},500,Phaser.Easing.Quadratic.Out,false).to({x:555,y:90},500,Phaser.Easing.Quadratic.Out,false);play.HandTweenS.loop();play.HandTweenS.start();play.txtTutS=game.add.bitmapText(160,670,"black","Enter to the shop to buy\nmore medical materials.",25);play.txtTutS.x=440-play.txtTutS.textWidth/2}}play.prog_bar.Bar.crop_rect.height=play.crop_height*play.drag_element.lvl;play.prog_bar.Bar.crop(new Phaser.Rectangle(0,0,play.prog_bar.Bar.width,play.prog_bar.Bar.crop_rect.height))}else if(play.numLevel>25){if(!a.animations.getAnimation("sad").isPlaying){if(Music.enableMisic)Music.sound.play("crying");this.crying(a)}a.animations.play("sad",8,true);game.time.events.add(2e3,function(){play.per_out(a,null)},this)}if(a.order.medic.frameName!=this.frameName&&play.numLevel==1&&play.isTuto==1&&!play.hand.visible){play.hand.visible=true}}else if(play.numLevel==1&&play.isTuto==1&&!play.hand.visible){play.hand.visible=true}},this);switch(this.frameName){case"kotra1.png":{this.x=play.toolsP[0];this.y=play.toolsP[1];break}case"kotra2.png":{this.x=play.toolsP[2];this.y=play.toolsP[3];break}case"injection.png":{this.x=play.toolsP[4];this.y=play.toolsP[5];break}case"pancement.png":{this.x=play.toolsP[6];this.y=play.toolsP[7];break}case"kotra3.png":{this.x=play.toolsP[8];this.y=play.toolsP[9];break}case"mihrar.png":{this.x=play.toolsP[10];this.y=play.toolsP[11];break}case"sirou.png":{this.x=play.toolsP[12];this.y=play.toolsP[13];break}case"wdan.png":{this.x=play.toolsP[14];this.y=play.toolsP[15];break}case"checkup.png":{this.x=play.toolsP[16];this.y=play.toolsP[17];break}case"car.png":{this.x=play.toolsP[18];this.y=play.toolsP[19];break}case"puppet.png":{this.x=play.toolsP[24];this.y=play.toolsP[25];break}}play.drag_element=null}},animationT:function(pos){switch(play.gr_elemnts.getAt(play.gr_elemnts.length-1).frameName){case"kotra1.png":{play.gr_In_use_T[pos].x=Math.floor(game.input.activePointer.x/160)*160+90;if(pos==0)play.gr_In_use_T[pos].x-=6;else if(pos==1)play.gr_In_use_T[pos].x-=3;play.gr_In_use_T[pos].y=365;play.gr_In_use_T[pos].scale.setTo(.8,.8);play.gr_In_use_T[pos].angle=-140;play.gr_In_use_T[pos].sp.Tween.rep--;play.gr_In_use_T[pos].sp.Tween.start();play.gr_In_use_T[pos].baby.animations.stop();if(Music.enableMisic)Music.sound.stop("crying");play.gr_In_use_T[pos].baby.frame=play.gr_In_use_T[pos].baby.type+9;break}case"kotra2.png":{play.gr_In_use_T[pos].x=Math.floor(game.input.activePointer.x/160)*160+90;if(pos==0)play.gr_In_use_T[pos].x-=6;else if(pos==1)play.gr_In_use_T[pos].x-=3;play.gr_In_use_T[pos].scale.setTo(.7,.7);play.gr_In_use_T[pos].y=368;play.gr_In_use_T[pos].angle=-140;play.gr_In_use_T[pos].sp.Tween.rep--;play.gr_In_use_T[pos].sp.Tween.start();play.gr_In_use_T[pos].baby.animations.stop();if(Music.enableMisic)Music.sound.stop("crying");play.gr_In_use_T[pos].baby.frame=play.gr_In_use_T[pos].baby.type+9;break}case"injection.png":{play.gr_In_use_T[pos].x=Math.floor(game.input.activePointer.x/160)*160+35;play.gr_In_use_T[pos].y=400;play.gr_In_use_T[pos].angle=230;play.gr_In_use_T[pos].scale.setTo(.7,.7);play.gr_In_use_T[pos].alpha=0;play.gr_In_use_T[pos].baby.animations.stop();if(Music.enableMisic)Music.sound.play("crying");if(!play.gr_In_use_T[pos].baby.animations.getAnimation("sad").isPlaying&&play.gr_In_use_T[pos].baby.itime>2){if(Music.enableMisic)Music.sound.play("crying");this.crying(play.gr_In_use_T[pos].baby)}play.gr_In_use_T[pos].baby.animations.play("sad",8,true);break}case"pancement.png":{play.gr_In_use_T[pos].baby.animations.stop();if(Music.enableMisic)Music.sound.stop("crying");play.gr_In_use_T[pos].baby.frame=Math.floor(play.gr_In_use_T[pos].baby.frame/13)*13+12;game.time.events.add(2e3,function(){this.gr_In_use_T[pos].P_use_T.visible=true;this.gr_In_use_T[pos].P_use_T=null;play.gr_In_use_T[pos].scale.setTo(.5,.5);this.baby_attded(this.gr_In_use_T[pos].baby,null)},this);break}case"kotra3.png":{play.gr_In_use_T[pos].x=Math.floor(game.input.activePointer.x/160)*160+90;play.gr_In_use_T[pos].y=300;play.gr_In_use_T[pos].scale.setTo(.6,.8);play.gr_In_use_T[pos].angle=0;play.gr_In_use_T[pos].sp3.Tweenk3.rep--;play.gr_In_use_T[pos].sp3.Tweenk3.start();break}case"mihrar.png":{play.gr_In_use_T[pos].x=Math.floor(game.input.activePointer.x/160)*160+10;play.gr_In_use_T[pos].y=400;play.gr_In_use_T[pos].angle=-75;play.gr_In_use_T[pos].scale.setTo(.85,.75);game.time.events.add(2e3,function(){play.gr_In_use_T[pos].visible=false;play.gr_In_use_T[pos].P_use_T.visible=true;play.gr_In_use_T[pos].P_use_T=null;play.gr_In_use_T[pos].baby.order.medic.frameName="sirou.png"},this);break}case"sirou.png":{play.gr_In_use_T[pos].x=Math.floor(game.input.activePointer.x/160)*160+85;play.gr_In_use_T[pos].y=380;play.gr_In_use_T[pos].angle=-135;play.gr_In_use_T[pos].scale.setTo(.7,.7);play.gr_In_use_T[pos].alpha=0;play.gr_pricks[pos].elem=play.gr_In_use_T[pos];play.gr_pricks[pos].syrop.visible=true;play.gr_pricks[pos].syrop.animations.play("sr",5,false);game.time.events.add(3e3,function(){},this);break}case"wdan.png":{play.gr_In_use_T[pos].x=Math.floor(game.input.activePointer.x/160)*160+112;if(pos==2)play.gr_In_use_T[pos].x+=2;else if(pos==3)play.gr_In_use_T[pos].x+=4;play.gr_In_use_T[pos].y=415;play.gr_In_use_T[pos].angle=-90;play.gr_In_use_T[pos].scale.setTo(.7,.7);play.gr_babies.forEachAlive(function(b){if(Math.floor(b.x/160)==pos&&b.frameName!="chair.png"){if(b.animations.getAnimation("normal").isPlaying)b.animations.getAnimation("normal").paused=true;else b.animations.getAnimation("sad").paused=true;if(b.type/13==2&&pos==2)play.gr_In_use_T[pos].x-=2;else if(b.type/13==2&&pos==3)play.gr_In_use_T[pos].x-=3;else if(b.type/13==2&&pos==1)play.gr_In_use_T[pos].x-=2;else if(b.type/13==2&&pos==0)play.gr_In_use_T[pos].x-=4}},this);break}case"checkup.png":{play.gr_In_use_T[pos].x=pos*160+60;play.gr_In_use_T[pos].y=392;play.gr_In_use_T[pos].angle=-30;play.gr_In_use_T[pos].scale.setTo(.8,.8);play.gr_babies.forEachAlive(function(b){if(Math.floor(b.x/160)==pos&&b.frameName!="chair.png")b.animations.getAnimation("normal").paused=true},this);if(Music.enableMisic)Music.sound.play("heartbeat");game.time.events.add(3e3,function(){play.gr_In_use_T[pos].visible=false;play.gr_In_use_T[pos].P_use_T.visible=true;play.gr_In_use_T[pos].P_use_T=null;play.gr_In_use_T[pos].scale.setTo(.7,.7);play.baby_attded(play.gr_In_use_T[pos].baby,null)},this);break}case"car.png":{this.task(pos,0);break}case"puppet.png":{this.task(pos,1);break}}},task:function(pos,cas){var baby;play.gr_babies.forEachAlive(function(a){if(Math.floor(a.x/160)==pos&&a.frameName!="chair.png"){a.animations.stop();if(Music.enableMisic)Music.sound.stop("crying");a.frame=a.type+10+cas;baby=a}},this);game.time.events.add(2e3,function(){this.gr_In_use_T[pos].visible=false;this.gr_In_use_T[pos].P_use_T.visible=true;baby.animations.play("normal",8,true);this.isCar=true;play.gr_In_use_T[pos].baby.order.medic.scale.setTo(1,1);var t=this.get_Order();if(t<9+3*cas-3)t+=Math.round(Math.random()*3);if(t==3||t==6)t++;if(t==11)play.gr_In_use_T[pos].baby.order.medic.scale.setTo(.24,.24);else if(t==8)play.gr_In_use_T[pos].baby.order.medic.scale.setTo(.6,.6);else if(t==9){t--;play.gr_In_use_T[pos].baby.order.medic.scale.setTo(.6,.6)}else if(t==12){t--;play.gr_In_use_T[pos].baby.order.medic.scale.setTo(.24,.24)}else play.gr_In_use_T[pos].baby.order.medic.scale.setTo(.8,.8);play.gr_In_use_T[pos].P_use_T=null;play.gr_In_use_T[pos].baby.order.medic.frameName=Global.Toolsf[t]},this)},initAtributs:function(){this.stateMusic=Music.enableMisic;this.gameOver=false;this.pausePlay=false;this.game.input.maxPointers=1;this.Begin_Level=1;this.order=null;this.bounds=new Phaser.Rectangle;this.End=0;this.gr_In_use_T=[];this.drag_per=null;this.drag_perI=null;this.drag_perI2=null;this.Torder=null;this.Img=null;this.score=0;this.scoreT=null;this.nbr_happy=0;this.nbr_unhappy=0;this.repeat_tut=3;this.flechs={mizan:null,tol:null};this.babies_heights=[540,543,540,527,545,550];this.hidenin_pause=[];this.nbr_unhpyB=3;this.isCar=false;this.isTuto=0},Show_shop:function(){if(!this.gameOver){if(this.numLevel==1&&play.handShop.visible){play.handShop.visible=false;play.txtTutS.visible=false;play.HandTweenS.pendingDelete=true}this.shop_menu.bnt.visible=true;this.shop_menu.visible=true;this.gameOver=true;this.noir.visible=true;this.shop_menu.txt.visible=true;for(var u=0;u<6;u++){this.shop_menu.elems[u].visible=true;this.shop_menu.elems[u].bnt.inputEnabled=true;this.shop_menu.elems[u].bnt.visible=true;switch(u){case 0:{if(this.score<15)this.shop_menu.elems[u].alpha=.7;else this.shop_menu.elems[u].alpha=1;break}case 1:{if(this.score<15)this.shop_menu.elems[u].alpha=.7;else this.shop_menu.elems[u].alpha=1;break}case 2:{if(this.score<20)this.shop_menu.elems[u].alpha=.7;else this.shop_menu.elems[u].alpha=1;break}case 3:{if(this.score<20)this.shop_menu.elems[u].alpha=.7;else this.shop_menu.elems[u].alpha=1;break}case 4:{if(this.score<25)this.shop_menu.elems[u].alpha=.7;else this.shop_menu.elems[u].alpha=1;break}case 5:{if(this.score<25)this.shop_menu.elems[u].alpha=.7;else this.shop_menu.elems[u].alpha=1;break}}this.shop_menu.elems[u].bnt.visible=true}this.shop_menu.txt.setText(""+this.score);if(this.score<10)this.shop_menu.txt.x=322;else if(this.score<100)this.shop_menu.txt.x=320;else this.shop_menu.txt.x=305}},createButtonsPlay:function(){this.bnt_pause=new Bouton(this.game,36,40,"S",this.funcPause,this);this.bnt_pause.frameName="pause_bnt.png";this.game.world.add(this.bnt_pause);this.musicbnt=new Bouton(this.game,105,40,"S",this.actionMusic,this);this.musicbnt.frameName="sound_onp.png";this.game.world.add(this.musicbnt);this.shopbnt=new Bouton(this.game,603,40,"S",this.Show_shop,this);this.shopbnt.frameName="shop_bnt.png";this.game.world.add(this.shopbnt);this.Videobnt=new Bouton(this.game,320,120,"video_bnt",this.funcVideo,this);this.Videobnt.scale.setTo(.9,.9);this.game.world.add(this.Videobnt)},funcVideo:function(){window.open("https://codecanyon.net/user/matelmas/portfolio")},game_over:function(){if(Music.enableMisic){Music.enableMisic=false;Music.music.pause()}this.Img.kill();this.Img2.kill();this.Torder.kill();this.Torder2.kill();if(this.flechs.tol!=null)this.flechs.tol.kill();if(this.flechs.mizan!=null)this.flechs.mizan.kill();this.End=-1;this.gameOver=true;this.bnt_pause.visible=false;this.musicbnt.visible=false;this.noir2.visible=true;this.grPause.setAll("scale.x",.1);this.grPause.setAll("scale.y",.1);this.groupPause.forEach(function(obj){if(obj.frameName!="pause.png"&&obj.frameName!="win.png")obj.visible=true},this);this.bgPause.pause.visible=false;this.bgPause.x=96;this.bgPause.scale.setTo(.85,.82);this.bgPause.lose.visible=true;this.resumebtn.visible=false;this.menubntt.y-=80;this.bnt_replay.x=420;this.bnt_replay.y=this.menubntt.y;this.menubntt.x=this.bnt_replay.x-200;this.textPauseLevel.visible=false;this.groupPause.x=this.groupPause.x-200*Global.resolution;game.add.tween(this.groupPause).to({x:this.groupPause.x+200*Global.resolution},1500,Phaser.Easing.Elastic.Out,true,0);game.time.events.add(700,function(){this.grPause.getAt(2).visible=true;game.time.events.add(300,function(){this.grPause.getAt(1).visible=true},this);game.time.events.add(600,function(){this.grPause.getAt(3).visible=true},this);game.add.tween(this.grPause.getAt(2).scale).to({x:1,y:1},1500,Phaser.Easing.Elastic.Out,true,0);game.add.tween(this.grPause.getAt(1).scale).to({x:1,y:1},1500,Phaser.Easing.Elastic.Out,true,300)},this)},createPause:function(){this.bgPause=new Phaser.Image(this.game,55,131,"S");this.bgPause.frameName="bg_pause.png";this.bgPause.pause=new Phaser.Image(this.game,319.5,368,"S");this.bgPause.pause.frameName="pause.png";this.bgPause.lose=game.add.sprite(324,286,"S");this.bgPause.lose.frameName="lose.png";this.bgPause.lose.anchor.setTo(.5,0);this.bgPause.lose.scale.setTo(.95,.95);this.bgPause.lose.visible=false;this.bgPause.pause.anchor.setTo(.5,.5);this.resumebtn=new Bouton(this.game,540,624,"S",this.funcResume,this,true);this.resumebtn.frameName="resume_p.png";this.menubntt=new Bouton(this.game,240,654,"S",this.funcBack,this,true);this.menubntt.frameName="menu_p.png";this.bnt_replay=new Bouton(this.game,400,654,"S",this.funReplay,this,true);this.bnt_replay.frameName="replay_p.png";this.groupPause=this.game.add.group();this.grPause=game.add.group();this.groupPause.add(this.bgPause);this.groupPause.add(this.bgPause.pause);this.groupPause.add(this.bgPause.lose);this.grPause.add(this.resumebtn);this.grPause.add(this.menubntt);this.grPause.add(this.bnt_replay);this.grPause.setAll("visible",false);this.grPause.setAll("scale.x",.1);this.grPause.setAll("scale.y",.1);this.textPauseLevel=game.add.bitmapText(345,378,"smp"," "+this.numLevel,100);this.textPauseLevel.align="center";if(this.numLevel<10)this.textPauseLevel.x+=10;this.groupPause.add(this.textPauseLevel);this.groupPause.forEach(function(obj){obj.visible=false},this)},createCongratulations:function(){game.add.image(0,0,"noir");this.grPause=game.add.group();this.numLevel=Global.nombre_levels;this.gameOver=true;Global.level=Global.sauvegarde.length-1;Save.Save_setItem("Babies_level",Global.sauvegarde.length-1);var b=this.game.add.image(35*Global.resolution,90*Global.resolution,"S");b.frameName="bg_pause.png";b.x=94;b.scale.setTo(.85,.82);this.grPause.add(b);b=game.add.sprite(320,393,"S");b.frameName="congratz.png";b.anchor.setTo(.5,.5);this.grPause.add(b);this.b=new Bouton(this.game,158*Global.resolution,680,"S",function(){game.time.events.add(300,function(){if(this.stateMusic){Music.enableMisic=true;Music.music.resume()}this.game.state.start("levels")},this)},this,true);this.b.frameName="resume_p.png";this.b.scale.setTo(.1,.1);this.b.visible=false;this.world.add(this.b);this.grPause.x=this.grPause.x-200*Global.resolution;game.add.tween(this.grPause).to({x:this.grPause.x+200*Global.resolution},1500,Phaser.Easing.Elastic.Out,true,0);game.time.events.add(700,function(){play.b.visible=true;game.add.tween(play.b.scale).to({x:1,y:1},1500,Phaser.Easing.Elastic.Out,true,0)},this)},cacherPause:function(){if(Music.enableMisic){Music.enableMisic=false;Music.music.pause()}this.noir2.visible=true;this.bnt_pause.visible=false;this.musicbnt.visible=false;this.menubntt.y=this.bnt_replay.y=this.resumebtn.y=620;this.menubntt.x=160;this.bnt_replay.x=320;this.resumebtn.x=480;this.grPause.setAll("scale.x",.1);this.grPause.setAll("scale.y",.1);this.groupPause.setAll("visible",true);this.bgPause.lose.visible=false;this.groupPause.x=-200*Global.resolution;game.add.tween(this.groupPause).to({x:0},1500,Phaser.Easing.Elastic.Out,true,0);game.time.events.add(700,function(){this.grPause.getAt(0).visible=true;game.add.tween(this.grPause.getAt(0).scale).to({x:1,y:1},1500,Phaser.Easing.Elastic.Out,true,0);game.time.events.add(250,function(){if(this.gameOver){this.grPause.getAt(2).visible=true;game.add.tween(this.grPause.getAt(2).scale).to({x:1,y:1},1500,Phaser.Easing.Elastic.Out,true,0)}},this);game.time.events.add(500,function(){if(this.gameOver){this.grPause.getAt(1).visible=true;game.add.tween(this.grPause.getAt(1).scale).to({x:1,y:1},1500,Phaser.Easing.Elastic.Out,true,0)}},this)},this)},funcPause:function(){if((!this.noir.visible||!this.noir2.visible)&&!this.gameOver){game.time.events.add(300,function(){this.cacherPause();this.pausePlay=true;this.gameOver=true;if(this.flechs.tol!=null)this.flechs.tol.visible=false;if(this.flechs.mizan!=null)this.flechs.mizan.visible=false;this.shopbnt.visible=false;if(this.Img.visible){this.Img.visible=false;this.hidenin_pause[this.hidenin_pause.length]=this.Img}if(this.Img2.visible){this.Img2.visible=false;this.hidenin_pause[this.hidenin_pause.length]=this.Img2}if(this.Torder.visible){this.Torder.visible=false;this.hidenin_pause[this.hidenin_pause.length]=this.Torder}if(this.Torder2.visible){this.Torder2.visible=false;this.hidenin_pause[this.hidenin_pause.length]=this.Torder2}},this)}},funcResume:function(){game.time.events.add(300,function(){this.afficherPause();if(this.musicbnt.frameName=="sound_onp.png"){Music.enableMisic=true;Music.music.resume()}this.pausePlay=false;this.gameOver=false;this.gr_babies.forEachAlive(function(e){if(e.frameName!="chair.png"&&e.animations.getAnimation("sad").isPlaying&&Music.enableMisic)this.crying(e)},this);this.noir2.visible=false;if(this.flechs.tol!=null)this.flechs.tol.visible=true;if(this.flechs.mizan)this.flechs.mizan.visible=true;this.shopbnt.visible=true;for(var t=0;t<this.hidenin_pause.length;t++){this.hidenin_pause[t].visible=true}this.hidenin_pause=[]},this)},afficherPause:function(){this.bnt_pause.visible=true;this.musicbnt.visible=true;this.groupPause.setAll("visible",false);this.grPause.setAll("visible",false)},funReplay:function(){game.time.events.add(300,function(){HTML5API_levelEnded();if(this.End>0){this.numLevel--;Global.level=this.numLevel}if(this.musicbnt.frameName=="sound_onp.png"){Music.enableMisic=true;Music.music.resume()}else{Music.enableMisic=false;Music.music.pause()}this.game.state.start("play",true)},this)},funcBack:function(){game.time.events.add(300,function(){HTML5API_levelEnded();if(this.musicbnt.frameName=="sound_onp.png"){Music.enableMisic=true;Music.music.resume()}else{Music.enableMisic=false;Music.music.pause()}this.game.state.start("levels",true)},this)},Fin_level:function(){if(this.numLevel>Global.level){Global.level=this.numLevel;Save.Save_setItem("Babies_level",Global.level)}if(this.score>Global.sauvegarde[this.numLevel-1].numetoile){Global.sauvegarde[this.numLevel-1].numetoile=this.score;Global.sauvegarde[this.numLevel-1].nbr_happy=this.nbr_happy;Global.sauvegarde[this.numLevel-1].nbr_unhappy=this.nbr_unhappy;Save.save_ecrit()}if(this.numLevel<=Global.nombre_levels){this.numLevel++}play.createNextLevel()},funcnextlevel:function(){game.time.events.add(300,function(){HTML5API_levelEnded();if(this.musicbnt.frameName=="sound_onp.png"){Music.enableMisic=true;Music.music.resume()}else{Music.enableMisic=false;Music.music.pause()}this.game.state.start("play")},this)},createNextLevel:function(){if(Music.enableMisic){Music.enableMisic=false;Music.music.pause()}this.Img.kill();this.Img2.kill();this.Torder.kill();this.Torder2.kill();if(this.flechs.tol!=null)this.flechs.tol.kill();if(this.flechs.mizan!=null)this.flechs.mizan.kill();this.grNexLevel=game.add.group();this.End=1;this.gameOver=true;this.bnt_pause.visible=false;this.musicbnt.visible=false;this.noir2.visible=true;this.next_level=new Bouton(this.game,540,701,"S",this.funcnextlevel,this,true);this.next_level.frameName="resume_p.png";var h=game.add.image(95,146,"S");h.frameName="bg_pause.png";h.scale.setTo(.85,.82);h.win=game.add.image(324,401,"S");h.win.frameName="win.png";h.win.anchor.setTo(.5,.5);h.setho=game.add.image(125,620,"S");h.setho.frameName="sethoW.png";h.setho.anchor.setTo(.5,.5);h.score=game.add.bitmapText(265,375,"smpB",""+this.score,85);if(this.score>999)h.score.x=258;h.happy=game.add.bitmapText(245,485,"smpB",""+this.nbr_happy,65);h.unhappy=game.add.bitmapText(415,485,"smpB",""+this.nbr_unhappy,65);this.groupNexLevel.add(h);this.groupNexLevel.add(h.win);this.groupNexLevel.add(h.score);this.groupNexLevel.add(h.happy);this.groupNexLevel.add(h.unhappy);this.groupNexLevel.add(h.setho);this.grNexLevel.add(this.next_level);this.grNexLevel.add(this.menubntt);this.grNexLevel.add(this.bnt_replay);this.menubntt.y=this.bnt_replay.y=this.next_level.y=800;this.menubntt.x=160;this.bnt_replay.x=320;this.next_level.x=480;this.grNexLevel.setAll("visible",false);this.grNexLevel.setAll("scale.x",.1);this.grNexLevel.setAll("scale.y",.1);this.groupNexLevel.x=this.groupNexLevel.x-200*Global.resolution;this.groupNexLevel.forEach(function(obj){obj.visible=true},this);game.add.tween(this.groupNexLevel).to({x:this.groupNexLevel.x+200*Global.resolution},1500,Phaser.Easing.Elastic.Out,true,0);game.time.events.add(700,function(){this.grNexLevel.getAt(0).visible=true;game.time.events.add(300,function(){this.grNexLevel.getAt(2).visible=true},this);game.time.events.add(600,function(){this.grNexLevel.getAt(1).visible=true},this);game.time.events.add(900,function(){this.grNexLevel.getAt(3).visible=true},this);game.add.tween(this.grNexLevel.getAt(0).scale).to({x:1,y:1},1500,Phaser.Easing.Elastic.Out,true,0);game.add.tween(this.grNexLevel.getAt(2).scale).to({x:1,y:1},1500,Phaser.Easing.Elastic.Out,true,300);game.add.tween(this.grNexLevel.getAt(1).scale).to({x:1,y:1},1500,Phaser.Easing.Elastic.Out,true,600)},this)},actionMusic:function(){if(this.noir.visible||this.noir2.visible)return;Music.enableMisic=!Music.enableMisic;if(Music.enableMisic){this.musicbnt.frameName="sound_onp.png";Music.music.resume()}else{this.musicbnt.frameName="sound_offp.png";Music.music.pause()}},update:function(){if(this.gameOver)return;if(this.Begin_Level>=1){if(this.bonus_time>=0&&this.bonus_timer&&!this.pausePlay){if(this.bonus_time!=0){if(this.bonus_time==240||this.bonus_time==180||this.bonus_time==120||this.bonus_time==60){this.minutes--;
this.secondss=59;this.timer.setText(this.minutes+":"+this.secondss)}else{this.secondss--;if(this.secondss<10)this.timer.setText(this.minutes+":0"+this.secondss);else this.timer.setText(this.minutes+":"+this.secondss)}this.bonus_time--;this.bonus_timer=false;game.time.events.add(1e3,function(){play.bonus_timer=true})}else{this.bonus_time--;this.timer.setText("0:00");if(this.score>=Global.Goals[this.numLevel-1]){this.Fin_level()}else{this.game_over()}}}if(this.Begin_Level==1){this.TB_per=Math.floor(Math.random()*1e3)/1e3*Global.ajout+1e3;this.Begin_Level++}this.TB_per-=this.time.elapsed;if(this.TB_per<0){if(this.numLevel==1&&this.isTuto==1){this.TB_per=1e3}else{if(this.check_place())this.add_per();else this.TB_per=1e3}}}this.gr_babies.forEachAlive(function(e){if(e.visible&&this.gr_In_use_T[Math.floor(e.x/160)].P_use_T==null&&e.frameName!="chair.png"){if(e.itime<2&&e.b_led[0].alive&&!e.animations.getAnimation("sad").isPlaying){e.animations.play("sad",8,true);if(Music.enableMisic)Music.sound.play("crying");this.crying(e)}if(e.time>0&&!e.eat){if(this.numLevel!=1||this.isTuto!=1){e.time-=this.game.time.elapsed;if(e.Ttype==1){if(Math.floor(e.time/1e3)<e.itime){e.r_led[e.itime].kill();if(e.itime==2&&!e.animations.getAnimation("sad").isPlaying){e.animations.play("sad",8,true);if(Music.enableMisic)Music.sound.play("crying");this.crying(e)}e.itime--}}else{if(Math.floor(e.time/5e3)<e.itime){e.r_led[e.itime].kill();if(e.itime==2&&!e.animations.getAnimation("sad").isPlaying){e.animations.play("sad",8,true);if(Music.enableMisic)Music.sound.play("crying");this.crying(e)}e.itime--}}}if(e.time<=0)this.per_out(e,null)}else if(e.Teat>0){e.Teat-=this.game.time.elapsed;if(e.Teat<=0){this.per_out(e,1)}}}},this);if(this.drag_element&&this.drag_element.alpha==1){this.drag_element.x=this.game.input.activePointer.x;this.drag_element.y=this.game.input.activePointer.y}else if(this.drag_per&&this.drag_per.order.medic.frameName=="mizanO.png"||this.drag_perI){this.Img.x=this.game.input.activePointer.x;this.Img.y=this.game.input.activePointer.y}else if(this.drag_per&&this.drag_per.order.medic.frameName=="tol.png"||this.drag_perI2){this.Img2.x=this.game.input.activePointer.x;this.Img2.y=this.game.input.activePointer.y}},check_place:function(){var a=false;for(var i=0;i<this.pos_pers.length;i++){if(this.pos_pers[i]==0)a=true}return a},exist_frame:function(f){var t=false;this.gr_babies.forEachAlive(function(e){if(e.type==f)t=true},this);return t},add_per:function(){var f=Math.round(Math.random()*5)*13;while(this.exist_frame(f)){f=Math.round(Math.random()*5)*13}var a=this.gr_babies.getFirstDead();a.revive();a.frame=f;a.type=f;var n1,n2,n3;n1=f;n2=f+1;n3=f+2;a.animations.add("normal",[n1,n2,n3,n2]);n1=f+3;n2=f+4;n3=f+5;a.animations.add("sad",[n1,n2,n3,n2]);n1=f+6;n2=f+7;n3=f+8;a.animations.add("happy",[n1,n2,n3,n2]);a.animations.play("normal",8,true,false);a.inputEnabled=true;f=Math.round(Math.random()*3);while(this.pos_pers[f]==1||this.pos_pers[f]==-1){f=Math.round(Math.random()*3)}if(this.numLevel==1&&this.isTuto==0)f=1;this.pos_pers[f]=1;a.x=f*162+77;a.y=377;if(this.bonus_time<100&&this.nbr_unhpyB==3||this.bonus_time<60&&this.nbr_unhpyB==2||this.bonus_time<20&&this.nbr_unhpyB==1){a.Ttype=1;a.time=6e3;this.nbr_unhpyB--}else{a.Ttype=0;a.time=3e4}a.itime=5;this.add_order(a);for(var c=0;c<6;c++){a.b_led[c].revive();a.r_led[c].revive();a.b_led[c].x=a.r_led[c].x=a.order.x-42+c*14+c;a.b_led[c].y=a.r_led[c].y=a.order.y}this.TB_per=Math.floor(Math.random()*1e3)/1e3*Global.ajout+4e3;if(Music.enableMisic)Music.sound.play("hello");if(this.numLevel==1&&this.isTuto==0){this.isTuto++;var prevX,prevY;this.hand.visible=true;switch(a.order.medic.frameName){case"kotra1.png":{this.hand.x=this.toolsP[0]+this.hand.width/2;this.hand.y=this.toolsP[1]+this.hand.height/2;break}case"kotra2.png":{this.hand.x=this.toolsP[2]+this.hand.width/2;this.hand.y=this.toolsP[3]+this.hand.height/2;break}case"injection.png":{this.hand.x=this.toolsP[4]+this.hand.width/2;this.hand.y=this.toolsP[5]+this.hand.height/2;break}}prevX=this.hand.x;prevY=this.hand.y;this.txtTut.visible=true;this.HandTween=game.add.tween(this.hand).to({x:a.x+this.hand.width/2,y:a.y+this.hand.height/2},1e3,Phaser.Easing.Quadratic.Out,false).to({x:prevX,y:prevY},2e3,Phaser.Easing.Quadratic.Out,false);this.HandTween.loop();this.HandTween.start()}},add_order:function(p){p.order.revive();p.order.x=p.x;p.order.y=250;p.order.medic.revive();p.order.medic.x=p.order.x;p.order.medic.y=p.order.y-35;var t=this.get_Order();p.order.medic.scale.setTo(1,1);if(p.type==26&&t==2)t--;else if(p.type==13&&t==7){if(this.numLevel==7)t--;else t++}if(this.numLevel>21){t+=2;if(t>12)t=12}if(t==10){p.order.medic.scale.setTo(.8,.8);p.inputEnabled=true}if(t==8||t==9){p.order.medic.scale.setTo(.6,.6);p.inputEnabled=true}else if(t==11){p.order.medic.scale.setTo(.24,.24);p.inputEnabled=true}else if(t==12){p.order.medic.scale.setTo(.7,.7);p.inputEnabled=true}else p.order.medic.scale.setTo(.8,.8);if(this.numLevel==8&&t==9)t--;p.order.medic.frameName=Global.Toolsf[t]},get_Order:function(){var t=Math.round(Math.random()*Global.Aut_recipes[this.numLevel-1]);if(this.numLevel>26&&Math.random()>.65&&t<6)t=Math.round(Math.random()*(Global.Aut_recipes[this.numLevel-1]-6)+6);while(this.order==t){t=Math.round(Math.random()*Global.Aut_recipes[this.numLevel-1]);if(this.numLevel>26&&Math.random()>.65&&t<6)t=Math.round(Math.random()*(Global.Aut_recipes[this.numLevel-1]-6)+6)}this.order=t;if(t==3||t==6){t=Global.Aut_recipes[this.numLevel-1];if(this.numLevel==1||this.numLevel==11||this.numLevel==18)t--}if(this.numLevel==1&&this.isTuto==0&&!this.hand.visible)t=1;return t},downImg:function(a){if(!play.gameOver){this.drag_perI=a;this.Torder.visible=false}},downImg2:function(a){if(!play.gameOver){this.drag_perI2=a;if(a.frame%2==0)a.loadTexture("pers",a.frame/2*13);else a.loadTexture("pers",Math.floor(a.frame/2)+78);this.Torder2.visible=false}},upImg:function(){if(!play.gameOver){if(this.Img.x<this.Img.P_pos*160+154&&this.Img.x>this.Img.P_pos*160&&this.Img.y>343&&this.Img.y<553){this.gr_babies.forEachAlive(function(a){if(a.frameName!="chair.png"&&this.Img.P_pos!=null&&a.x==this.Img.P_pos*162+77){play.flechs.mizan.angle=0;a.visible=true;a.order.visible=true;a.order.medic.visible=true;for(var c=0;c<6;c++){if(a.r_led[c].alive)a.r_led[c].visible=true;a.b_led[c].visible=true}this.pos_pers[this.Img.P_pos]=1;this.Img.P_pos=null;this.Img.visible=false;this.Img.x=-200;this.Torder.x=-200;this.Img.inputEnabled=false;if(this.Img.frame%13==6)this.baby_attded(a,"happy");else this.baby_attded(a,"sad")}},this)}else{this.Torder.visible=true;this.Img.x=this.Img.Px;this.Img.y=this.Img.Py}this.drag_perI=null}},upImg2:function(){if(!play.gameOver){if(this.Img2.x<this.Img2.P_pos*160+154&&this.Img2.x>this.Img2.P_pos*160&&this.Img2.y>343&&this.Img2.y<553){this.gr_babies.forEachAlive(function(a){if(a.frameName!="chair.png"&&this.Img2.P_pos!=null&&a.x==this.Img2.P_pos*162+77){play.flechs.tol.y=695;a.visible=true;a.order.visible=true;a.order.medic.visible=true;for(var c=0;c<6;c++){if(a.r_led[c].alive)a.r_led[c].visible=true;a.b_led[c].visible=true}this.pos_pers[this.Img2.P_pos]=1;this.Img2.P_pos=null;this.Img2.visible=false;this.Img2.x=-200;this.Torder2.x=-200;this.Img2.inputEnabled=false;if(this.Img2.frame%13==0)this.baby_attded(a,"happy");else this.baby_attded(a,"sad")}},this)}else{this.Torder2.visible=true;this.Img2.x=this.Img2.Px;this.Img2.y=this.Img2.Py;if(this.Img2.frame>78)this.Img2.loadTexture("pers_S",(this.Img2.frame-78)*2+1);else this.Img2.loadTexture("pers_S",Math.floor(this.Img2.frame/13)*2)}this.drag_perI2=null}},down_per:function(e){if(!play.gameOver&&(e.order.medic.frameName=="mizanO.png"||e.order.medic.frameName=="tol.png")){var c;if(e.order.medic.frameName=="mizanO.png"&&this.Img.P_pos==null){this.drag_per=e;this.Img.visible=true;this.Img.frame=Math.floor(e.frame/13)*13;this.Img.P_pos=Math.floor(e.x/160);this.pos_pers[this.Img.P_pos]=-1;for(c=0;c<6;c++){e.r_led[c].visible=false;e.b_led[c].visible=false}e.visible=false;e.order.visible=false;e.order.medic.visible=false}else if(e.order.medic.frameName=="tol.png"&&this.Img2.P_pos==null){this.drag_per=e;this.Img2.visible=true;this.Img2.frame=e.frame;this.Img2.P_pos=Math.floor(e.x/160);this.pos_pers[this.Img2.P_pos]=-1;for(c=0;c<6;c++){e.r_led[c].visible=false;e.b_led[c].visible=false}e.visible=false;e.order.visible=false;e.order.medic.visible=false}}},Dist:function(a,b){var dx=a.x-b.x;var dy=a.y-b.y;return Math.sqrt(dx*dx+dy*dy)},up_per:function(e){if(!play.gameOver){var m,c;if(e.order.medic.frameName=="mizanO.png"&&!e.visible){var mizan;for(m=0;m<13;m++){if(this.gr_elemnts.getAt(m).frameName=="mizan.png"){mizan=this.gr_elemnts.getAt(m);break}}if(this.Img.y<mizan.y&&this.Dist(mizan,this.Img)<150&&Math.abs(this.Img.x-mizan.x)<85){if(Music.enableMisic)Music.sound.stop("crying");this.Img.x=mizan.x-35;this.Img.Px=this.Img.x;this.Img.y=mizan.y-118;this.Img.Py=this.Img.y;this.New_tween_mizan();if(this.numLevel==13&&play.repeat_tut>0)this.Hand_tween(mizan)}else{this.Img.visible=false;this.Img.x=-200;this.pos_pers[this.Img.P_pos]=1;this.Img.P_pos=null;for(c=0;c<6;c++){if(e.r_led[c].alive)e.r_led[c].visible=true;e.b_led[c].visible=true}e.visible=true;e.order.visible=true;e.order.medic.visible=true}this.drag_per=null}else if(e.order.medic.frameName=="tol.png"&&!e.visible){var tol;for(m=0;m<13;m++){if(this.gr_elemnts.getAt(m).frameName=="tol.png"){tol=this.gr_elemnts.getAt(m);break}}if(Math.abs(this.Img2.x-tol.x)<65&&Math.abs(this.Img2.y-tol.y)<75){if(Music.enableMisic)Music.sound.stop("crying");this.Img2.x=tol.x-10;this.Img2.Px=this.Img2.x;this.Img2.y=tol.y;this.Img2.Py=this.Img2.y;this.Img2.loadTexture("pers_S",Math.floor(this.Img2.frame/13)*2);this.New_tween_tol();if(this.numLevel==16&&play.repeat_tut>0)this.Hand_tween(tol)}else{this.Img2.visible=false;this.Img2.x=-200;this.pos_pers[this.Img2.P_pos]=1;this.Img2.P_pos=null;for(c=0;c<6;c++){if(e.r_led[c].alive)e.r_led[c].visible=true;e.b_led[c].visible=true}e.visible=true;e.order.visible=true;e.order.medic.visible=true}this.drag_per=null}}},create_pers:function(){var a;for(var i=0;i<5;i++){a=game.add.sprite(i*100,i*100,"pers",i*13);a.order=game.add.image(0,0,"S");a.order.frameName="order.png";a.order.anchor.setTo(.5,.5);a.anchor.setTo(.5,.5);a.order.scale.setTo(.9,.9);a.inputEnabled=true;a.events.onInputDown.add(this.down_per,this);a.events.onInputUp.add(this.up_per,this);a.order.medic=game.add.image(0,0,"S");a.order.medic.frameName="kotra.png";a.order.medic.anchor.setTo(.5,.5);a.b_led=[];a.r_led=[];for(var c=0;c<6;c++){a.b_led[c]=game.add.image(a.order.x,a.order.y+80,"S");a.b_led[c].frameName="led1.png";a.r_led[c]=game.add.image(a.order.x,a.order.y+80,"S");a.r_led[c].frameName="led2.png";a.r_led[c].kill();a.b_led[c].kill()}a.Ttype=null;a.type=null;a.time=null;a.itime=null;a.eat=false;a.Teat=null;a.earned=null;a.order.medic.kill();a.order.kill();a.kill();this.gr_babies.add(a)}for(i=0;i<4;i++){a=game.add.sprite(80+i*160,430,"S");a.frameName="chair.png";a.anchor.setTo(.5,0);this.gr_babies.add(a)}},Get_pos_order:function(order){for(var i=0;i<Global.Tools.length;i++){if(Global.Toolsf[i]==order)return i}},per_out:function(e,s){for(var c=0;c<6;c++){e.b_led[c].kill();e.r_led[c].kill()}e.eat=false;e.Teat=null;if(s!=null){this.nbr_happy++;e.earned=Math.round(e.time/1e3);if(this.Get_pos_order(e.order.medic.frameName)-5>0){if(this.numLevel<23)e.earned+=(this.Get_pos_order(e.order.medic.frameName)-5)*10;else e.earned+=(this.Get_pos_order(e.order.medic.frameName)-5)*20}if(this.isCar){if(this.numLevel<23)e.earned=e.earned*2;else e.earned=e.earned*3;this.isCar=false}if(e.animations.getAnimation("sad").isPlaying){e.earned-=Math.floor(e.earned/2)}if(e.itime<2)this.nbr_unhappy++;if(!this.gameOver){if(e.earned>120&&this.numLevel>22)e.earned=120;this.score+=e.earned;this.set_score_text()}this.TB_per=Math.floor(Math.random()*1e3)/1e3*Global.ajout+1e3;this.pos_pers[Math.floor(e.x/160)]=0}else{this.nbr_unhappy++;this.TB_per=Math.floor(Math.random()*1e3)/1e3*Global.ajout+1e3;this.pos_pers[Math.floor(e.x/160)]=0}e.earned=null;e.type=null;e.order.medic.kill();e.order.kill();e.kill();e.time=null;e.itime=null},baby_attded:function(e,anim){e.inputEnabled=false;if(anim!=null){if(anim=="sad"&&!e.animations.getAnimation("sad").isPlaying){if(Music.enableMisic)Music.sound.play("crying");this.crying(e)}else if(anim=="happy"&&Music.enableMisic){Music.sound.play("laugh")}e.animations.play(anim,8,true)}else if(e.itime<2){e.animations.stop();Music.sound.stop("crying");e.frame=Math.floor(e.type/13)+78}else{e.animations.play("happy",8,true);if(Music.enableMisic){Music.sound.play("laugh")}}e.order.medic.visible=false;e.eat=true;e.Teat=2e3;for(var t=0;t<6;t++){e.r_led[t].kill();e.b_led[t].kill()}},set_score_text:function(){this.scoreT.setText(""+this.score);if(this.score<9)this.scoreT.x=365;else if(this.score>9&&this.score<100)this.scoreT.x=360;else if(this.score>99&&this.score<1e3)this.scoreT.x=355;else if(this.score>999)this.scoreT.x=347}};window.onload=function(){setTimeout(function(){window.scrollTo(0,1)},10);game=new Phaser.Game(320*Global.resolution,480*Global.resolution,Phaser.CANVAS);play=game.state.add("play",Babies.Play,false);game.state.add("levels",Babies.Levels,false);game.state.add("menu",Babies.Menu,false);game.state.add("preload",Babies.Preload,false);game.state.add("credits",Babies.Credits,false);game.state.add("boot",Babies.Boot,true)};