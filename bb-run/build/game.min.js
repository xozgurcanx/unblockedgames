"use strict";var __extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e=function(){function t(t){this._howl=t,this.muted=!1}return t.prototype.play0=function(t,e){if(this.muted)return e&&e(),0;var i=this._howl.play(t);return null!=e&&this._howl.once("end",function(){e()},i),i},t.prototype.pause=function(t){this._howl.pause(t)},t.prototype.stop=function(t){this._howl.stop(t)},t.prototype.mute=function(t){this.muted=!0,this._howl.mute(!0,t)},t.prototype.unmute=function(t){this.muted=!1,this._howl.mute(!1,t)},t.prototype.fade=function(t,e,i,n,o){this.muted?o&&o():(this._howl.fade(t,e,i,n),o&&this._howl.once("fade",function(t){o()},n))},t.prototype.loop=function(t,e){this._howl.loop(t,e)},t.prototype.seek=function(t,e){this._howl.seek(t,e)},t.prototype.rate=function(t,e){this._howl.rate(t,e)},t.prototype.setVolume=function(t,e){this._howl.volume(t,e)},t.prototype.getVolume=function(){return this._howl.volume()},t}();t.AbstractSound=e}(h5ge||(h5ge={})),function(o){var t=function(){function e(t){this._visibilityManager=t,this._soundSprites={},this._musics={},this._enableMusics=!0,this._enableSoundsSprites=!0,this._musicWasEnable=!0,this._soundWasEnable=!0,this.musicStateChangeHandlers=new o.HandlerCollection,(e._INSTANCE=this)._visibilityManager.addVisibilityChangeHandler(this.onVisibilityChange.bind(this))}return e.prototype.loadSounds=function(t,e){new o.Loader(t).load(function(t){e(t)})},e.prototype.registerSoundsheet=function(t,e){var i=o.JSONS.safeJson(e);if(null!=i){i.src=i.urls;var n=new Howl(i);this.getSpriteCount(i.sprite)<=1?(o.logger.debug("Registering music: "+t),this.addMusic(t,new o.Music(n,i.sprite))):(o.logger.debug("Registering sound: "+t),this.addSoundSprite(t,new o.Sound(n)))}},e.prototype.getSpriteCount=function(t){if(null==t)return 0;var e=0;for(var i in t)e++;return e},e.prototype.mute=function(){Howler.mute(!0)},e.prototype.unmute=function(){Howler.mute(!1)},e.prototype.volume=function(t){Howler.volume(t)},e.prototype.addMusic=function(t,e){this._enableMusics||e.mute(),this._musics[t]=e},e.prototype.getMusic=function(t){var e=this._musics[t];return e||(o.logger.error("Can't find music with name: "+t),null)},e.prototype.muteMusics=function(){for(var t in o.logger.debug("muting musics "),this._musics)this._musics[t].mute();this._enableMusics=!1,this.musicStateChangeHandlers.fire(!1)},e.prototype.unmuteMusics=function(){for(var t in o.logger.debug("unmuting musics "),this._musics)this._musics[t].unmute();this._enableMusics=!0,this.musicStateChangeHandlers.fire(!0)},e.prototype.volumeMusics=function(t){for(var e in this._musics)this._musics[e].setVolume(t)},Object.defineProperty(e.prototype,"enableMusics",{get:function(){return this._enableMusics},set:function(t){t?this.unmuteMusics():this.muteMusics()},enumerable:!0,configurable:!0}),e.prototype.addSoundSprite=function(t,e){this._soundSprites[t]=e,this._enableSoundsSprites||e.mute()},e.prototype.getSoundSprite=function(t){var e=this._soundSprites[t];return e||(o.logger.error("Can't find sound sprite with name: "+t+". Sprite may not be loaded yet or load failed."),null)},e.prototype.muteSoundSprites=function(t,e){var i=this._soundSprites[t];null!=i&&(e?i.mute():i.unmute())},e.prototype.muteSoundsSprites=function(){for(var t in this._soundSprites)this._soundSprites[t].mute();this._enableSoundsSprites=!1},e.prototype.unmuteSoundsSprites=function(){for(var t in this._soundSprites)this._soundSprites[t].unmute();this._enableSoundsSprites=!0},e.prototype.volumeSoundsSprites=function(t){for(var e in this._soundSprites)this._soundSprites[e].setVolume(t)},Object.defineProperty(e.prototype,"enableSoundsSprites",{get:function(){return this._enableSoundsSprites},set:function(t){t?this.unmuteSoundsSprites():this.muteSoundsSprites()},enumerable:!0,configurable:!0}),e.prototype.onVisibilityChange=function(t){t?(this.enableMusics=this._musicWasEnable,this.enableSoundsSprites=this._soundWasEnable):(this._musicWasEnable=this._enableMusics,this._soundWasEnable=this._enableSoundsSprites,this.muteMusics(),this.muteSoundsSprites())},e.get=function(){return e._INSTANCE},e}();o.AudioManager=t}(h5ge||(h5ge={})),function(t){var e=function(o){function t(t,e){var i=o.call(this,t)||this;if((i._spriteName=null)!=e)for(var n in e){i._spriteName=n;break}return i}return __extends(t,o),t.prototype.play=function(t){return o.prototype.play0.call(this,this._spriteName,t)},t}(t.AbstractSound);t.Music=e}(h5ge||(h5ge={})),function(t){var e=function(i){function t(t){return i.call(this,t)||this}return __extends(t,i),t.prototype.play=function(t,e){return i.prototype.play0.call(this,t,e)},t}(t.AbstractSound);t.Sound=e}(h5ge||(h5ge={})),h5ge||(h5ge={}),function(t){if(Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),!t.performance||!t.performance.now){var e=Date.now();t.performance||(t.performance={}),t.performance.now=function(){return Date.now()-e}}for(var n=Date.now(),i=["ms","moz","webkit","o"],o=0;o<i.length&&!t.requestAnimationFrame;++o)t.requestAnimationFrame=t[i[o]+"RequestAnimationFrame"],t.cancelAnimationFrame=t[i[o]+"CancelAnimationFrame"]||t[i[o]+"CancelRequestAnimationFrame"];t.requestAnimationFrame||(t.requestAnimationFrame=function(t){if("function"!=typeof t)throw new TypeError(t+"is not a function");var e=Date.now(),i=16+n-e;return i<0&&(i=0),n=e,setTimeout(function(){n=Date.now(),t(performance.now())},i)}),t.cancelAnimationFrame||(t.cancelAnimationFrame=function(t){clearTimeout(t)})}(window),function(o){var r=function(){function t(t,e,i){void 0===i&&(i=60),this.callback=t,this.forceSetTimeOut=e,this._running=!1,this._setTimeoutSleep=1e3/i,this._onSetTimeoutCbBound=this.onSetTimeoutCb.bind(this),this._onRafCbBound=this.onRafCb.bind(this)}return t.prototype.start=function(){this._running||(this._running=!0,this._tick=performance.now(),this._timeoutId=this.forceSetTimeOut?window.setTimeout(this._onSetTimeoutCbBound,0):window.requestAnimationFrame(this._onRafCbBound))},t.prototype.stop=function(){this._running&&(this._running=!1,this.forceSetTimeOut?clearTimeout(this._timeoutId):window.cancelAnimationFrame(this._timeoutId))},t.prototype.onSetTimeoutCb=function(){this._tick=performance.now(),this.callback(this._tick);var t=Math.min(this._setTimeoutSleep,performance.now()-this._tick);this._timeoutId=window.setTimeout(this._onSetTimeoutCbBound,t)},t.prototype.onRafCb=function(t){this._tick=t,this.callback(t),this._timeoutId=window.requestAnimationFrame(this._onRafCbBound)},t}();o.RequestAnimationFrame=r;var t=function(){function t(t,e){this.updateCb=t,this.renderCb=e,this.started=!1,this.lastTime=0,this._deltaHistoryIndex=0,this._deltaHistoryCount=10,this._deltaHistory=[],this._frameDelta=0}return t.prototype.start=function(){if(!this.started){var t=o.Game.get().options.gameLoop,e=null!=t&&null!=t.desiredFps?t.desiredFps:60,i=null!=t&&null!=t.forceSetTimeout&&t.forceSetTimeout;if(this.started=!0,this._targetDeltaTime=1e3/e,this._timestep=1e3/e,this.lastTime=performance.now(),t.smoothDelta){this.raf=new r(this.ticksmooth.bind(this),i,e);for(var n=0;n<this._deltaHistoryCount;n++)this._deltaHistory[n]=this._targetDeltaTime}else this.raf=new r(this.tick.bind(this),i,e);this.raf.start()}},t.prototype.tick=function(t){var e=(t=performance.now())-this.lastTime;e=Math.min(e,100);var i=o.Maths.clamp(this._targetDeltaTime/e,0,1);this.lastTime=t,this.updateCb(t,e),this.renderCb(t,i)},t.prototype.ticksmooth=function(t){var e=(t=performance.now())-this.lastTime;100<e&&(e=this._deltaHistory[this._deltaHistoryIndex]),this._deltaHistory[this._deltaHistoryIndex]=e,this._deltaHistoryIndex++,this._deltaHistoryIndex>=this._deltaHistoryCount&&(this._deltaHistoryIndex=0);for(var i=0,n=0;n<this._deltaHistoryCount;n++)i+=this._deltaHistory[n];var o=(i/=this._deltaHistoryCount)/e;this.lastTime=t,this.updateCb(t,i),this.renderCb(t,o)},t.prototype.stop=function(){this.started&&(this.started=!1,this.raf.stop())},t}();o.MainLoop=t}(h5ge||(h5ge={})),function(o){var t=function(){function e(){this._root=!1,this.showCursor=!0,this._visible=!0,this._interactive=!1,this._hasInteractiveChild=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._rotation=0,this._alpha=1,this._scaleX=1,this._scaleY=1,this._pivotX=0,this._pivotY=0,this._flipX=!1,this._flipY=!1,this._tint=16777215,this._transformDirty=!1,this._worldAlpha=1,this._cachedAsBitmap=!1,this._x=0,this._y=0,this._scaleX=1,this._scaleY=1,this._id=e._idCount++,this._debugId="DisplayObject-"+this._id,this._transform=new o.Matrix,this._worldTransform=new o.Matrix,this._hitTransform=new o.Matrix}return e.prototype.addDebugBorder=function(t){void 0===t&&(t="#00FFBB"),this.debug=!0},Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=null==t?16777215:t},enumerable:!0,configurable:!0}),e.prototype.draw=function(t){if(this.visible){this.computeWorldTransform();var e=this.getParentAlpha();this._worldAlpha=this._alpha*e,t.globalAlpha=this._worldAlpha,t.save(),this._worldTransform.applyToContext(t),null!=this._mask&&this._mask._applyMask(t),this.cachedAsBitmap?(null==this._cachedTexture&&this.createCachedTexture(),this.drawCachedTexture(t)):this.draw0(t),t.restore()}},e.prototype.computeWorldTransform=function(){this._transformDirty&&(this._transformDirty=!1,this._transform.reset(),0==this._x&&0==this._y||this._transform.translate(this._x,this._y),(0!=this._rotation||1!=this._scaleX||1!=this._scaleY||this._flipX||this._flipY)&&(0==this._pivotX&&0==this._pivotY||this._transform.translate(this._pivotX,this._pivotY),0!=this._rotation&&this._transform.rotate(this._rotation),1==this._scaleX&&1==this._scaleY||this._transform.scale(this._scaleX,this._scaleY),0==this._pivotX&&0==this._pivotY||this._transform.translate(-this._pivotX,-this._pivotY),(this._flipX||this._flipY)&&(this._transform.translate(this._width*(this._flipX?1:0),this._height*(this._flipY?1:0)),this._transform.scale(this._flipX?-1:1,this._flipY?-1:1))));var t=this.getParentWorldTransform(),e=new o.Matrix;e.setTransform(t.a,t.b,t.c,t.d,t.e,t.f),e.transform(this._transform.a,this._transform.b,this._transform.c,this._transform.d,this._transform.e,this._transform.f);var i=this.getParentHitTransform(),n=new o.Matrix;(i&&n.setTransform(i.a,i.b,i.c,i.d,i.e,i.f),this._root||n.transform(this._transform.a,this._transform.b,this._transform.c,this._transform.d,this._transform.e,this._transform.f),this._interactive)&&((!n.isEqual(this._hitTransform)||null==this._worldHitArea)&&this.updateWorldHitArea(n));this._worldTransform=e,this._hitTransform=n},e.prototype.getParentWorldTransform=function(){return null==this._parent?new o.Matrix:this._parent._worldTransform},e.prototype.getParentAlpha=function(){return null==this._parent?1:this._parent._worldAlpha},e.prototype.getParentHitTransform=function(){return this._root?this._hitTransform:this._parent?this._parent._hitTransform:null},e.prototype.updateWorldHitArea=function(t){var e;if(null!=this._hitArea)e=t.applyToArray([this._hitArea.x,this._hitArea.y,this._hitArea.x+this._hitArea.width,this._hitArea.y,this._hitArea.x+this._hitArea.width,this._hitArea.y+this._hitArea.height,this._hitArea.x,this._hitArea.y+this._hitArea.height]);else{if(this._width<=0||this.height<=0)return void o.logger.warn("Cannot compute hit area on no-size object. Check bounds of #"+this.getDebugId()+". Size:"+this._width+"x"+this._height);e=t.applyToArray([0,0,this._width,0,this._width,this._height,0,this._height])}e.push(e[0]),e.push(e[1]),this._worldHitArea=e},e.prototype.draw0=function(t){},e.prototype.createCachedTexture=function(){},e.prototype.drawCachedTexture=function(t){t.drawImage(this._cachedTexture.getImpl(),this._cachedTexture.x,this._cachedTexture.y,this._cachedTexture.width,this._cachedTexture.height,0,0,this._cachedTexture.width,this._cachedTexture.height)},e.prototype.onDetach=function(){null!=this._detachListener&&this._detachListener.fire()},e.prototype.removeSelf=function(){return null!=this._parent&&null!=this._parent.removeChild(this)},e.prototype.getDebugId=function(){return this._debugId},e.prototype.setDebugId=function(t,e){void 0===e&&(e=!1),this._debugId=t,e&&(this._debugId+=this._id)},e.prototype.hitPoint=function(t){return null!=this._worldHitArea&&0<this._worldHitArea.length?o.Collisions.pointInPolygon2(this._worldHitArea,t.x,t.y):!this._transformDirty&&(o.logger.error("Using containsPoint without worldHitArea. Check object bounds of #"+this.getDebugId()+". Size:"+this._width+"x"+this._height+", Hit area: "+this._hitArea),this.containsPoint(t))},e.prototype.containsPoint=function(t){return!1},Object.defineProperty(e.prototype,"interactive",{get:function(){return this._interactive},set:function(t){e.interactiveDirty=!0,this._worldHitArea=null,this._interactive=t,this._transformDirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hitArea",{get:function(){return this._hitArea},set:function(t){this._hitArea=t,this._worldHitArea=null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasInteractiveChild",{get:function(){return this._hasInteractiveChild},set:function(t){this._hasInteractiveChild=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mask",{get:function(){return this._mask},set:function(t){this._mask=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactiveDirty",{get:function(){return this._interactiveDirty},set:function(t){this._interactiveDirty=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visible",{get:function(){return this._visible},set:function(t){this._visible=t},enumerable:!0,configurable:!0}),e.prototype.onClick=function(t,e,i){this.interactive=!0,null!=i&&1==i?this.clickHandler.once(t,e):this.clickHandler.add(t,e)},e.prototype.hasDownHandler=function(){return null!=this._downHandler&&0<this._downHandler.length},e.prototype.hasUpHandler=function(){return null!=this._upHandler&&0<this._upHandler.length},e.prototype.hasOverHandler=function(){return null!=this._overHandler&&0<this._overHandler.length},e.prototype.hasOutHandler=function(){return null!=this._outHandler&&0<this._outHandler.length},e.prototype.hasClickHandler=function(){return null!=this._clickHandler&&0<this._clickHandler.length},Object.defineProperty(e.prototype,"downHandler",{get:function(){return null==this._downHandler&&(this._downHandler=new o.HandlerCollection),this._downHandler},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"upHandler",{get:function(){return null==this._upHandler&&(this._upHandler=new o.HandlerCollection),this._upHandler},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"overHandler",{get:function(){return null==this._overHandler&&(this._overHandler=new o.HandlerCollection),this._overHandler},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outHandler",{get:function(){return null==this._outHandler&&(this._outHandler=new o.HandlerCollection),this._outHandler},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"clickHandler",{get:function(){return null==this._clickHandler&&(this._clickHandler=new o.HandlerCollection),this._clickHandler},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"detachListener",{get:function(){return null==this._detachListener&&(this._detachListener=new o.HandlerCollection),this._detachListener},enumerable:!0,configurable:!0}),e.prototype.setPivot=function(t,e){this._pivotX=t,this._pivotY=e,this._transformDirty=!0},e.prototype.setPivotToCenter=function(){if(this._width<=0||this._height<=0)throw new Error("Cannot set pivot to center on display object without size");this._pivotX=this._width/2,this._pivotY=this._height/2,this._transformDirty=!0},Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._transformDirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._transformDirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){this._alpha=t,1<this._alpha?this._alpha=1:this._alpha<0&&(this.alpha=0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleX",{get:function(){return this._scaleX},set:function(t){this._scaleX=t,this._transformDirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleY",{get:function(){return this._scaleY},set:function(t){this._scaleY=t,this._transformDirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleXY",{get:function(){return this._scaleX},set:function(t){this._scaleX=t,this._scaleY=t,this._transformDirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"debug",{get:function(){return this._debug},set:function(t){this._debug=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pivotX",{get:function(){return this._pivotX},set:function(t){this._pivotX=t,this._transformDirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pivotY",{get:function(){return this._pivotY},set:function(t){this._pivotY=t,this._transformDirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"flipX",{get:function(){return this._flipX},set:function(t){this._flipX=t,this._transformDirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"flipY",{get:function(){return this._flipY},set:function(t){this._flipY=t,this._transformDirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"angle",{get:function(){return this._rotation*o.Maths.RADIAN_TO_DEG},set:function(t){this.rotation=t*o.Maths.DEG_TO_RADIAN},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width*this._scaleX},set:function(t){0!=this._width&&(this.scaleX=t/this._width)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height*this._scaleY},set:function(t){0!=this._height&&(this.scaleY=t/this._height)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},set:function(t){throw new Error("parent is readonly")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation=t,this._transformDirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cachedAsBitmap",{get:function(){return this._cachedAsBitmap},set:function(t){this._cachedAsBitmap=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),e._interactiveDirty=!1,e._idCount=0,e}();o.DisplayObject=t}(h5ge||(h5ge={})),function(i){var t=function(n){function r(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var i=n.call(this)||this;return i._children=[],i._debugId="Container-"+i._id,i._width=t,i._height=e,i}return __extends(r,n),r.prototype.addChild=function(t){return this.addChildAt(t,this._children.length)},r.prototype.addChildAt=function(t,e){if(t._parent){if(t._parent==this)return console.error("Child already in H5Container. Use setChildIndex."),t;t._parent.removeChild(t)}return this._children.splice(e,0,t),t._parent=this,t},r.prototype.removeChild=function(t){var e=this._children.indexOf(t);return-1===e?null:this.removeChildAt(e)},r.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e._parent=null,e.onDetach(),this._children.splice(t,1),e},r.prototype.removeChildren=function(t,e){var i=null==t?0:t,n=(null==e?this._children.length:e)-i;if(n<=0)return[];for(var o=this._children.splice(i,n),r=0;r<o.length;r++){var s=o[r];s._parent=null,s.onDetach()}return o},r.prototype.getChildIndex=function(t){return this._children.indexOf(t)},r.prototype.getChildById=function(t){for(var e=0;e<this._children.length;e++){var i=this._children[e];if(i.getDebugId()==t)return i}return null},r.prototype.setChildIndex=function(t,e){var i=this.getChildIndex(t);i!=e?(this._children.splice(i,1),this._children.splice(e,0,t)):console.error("Child "+t.getDebugId()+"already @ that index : "+e)},r.prototype.onDetach=function(){n.prototype.onDetach.call(this);for(var t=this._children.length,e=0;e<t;e++)this._children[e].onDetach()},r.prototype.getChildAt=function(t){return this._children[t]},r.prototype.getChildrenCount=function(){return this._children.length},r.prototype._outputToConsole=function(t,e){void 0===e&&(e=[]);for(var i="",n=0;n<t;n++)i+="  ";for(n=0;n<this._children.length;n++){var o=this._children[n];console.log(i+this.getDebugPropertyString(o,e)),o instanceof r&&o._outputToConsole(t++,e)}},r.prototype._countElements=function(t){if(void 0===t&&(t=!1),t&&!this.visible)return 0;for(var e=1,i=0;i<this._children.length;i++){var n=this._children[i];e+=n instanceof r?n._countElements():1}return e},r.prototype.getDebugPropertyString=function(e,t){var i=e.getDebugId()+" ";return t.forEach(function(t){i+=t+"="+e[t]+" "}),i},r.prototype.draw0=function(t){n.prototype.draw0.call(this,t);for(var e=0;e<this._children.length;e++){this._children[e].draw(t)}},r.prototype.setSize=function(t,e){this._width=t,this._height=e},r.prototype.setSizeFromChildren=function(t){void 0===t&&(t=!1);var e=i.layout.computeBounds(this,t);this.setSize(e.width,e.height)},r}(i.DisplayObject);i.Container=t}(h5ge||(h5ge={})),function(e){var t=function(){function t(){this._childs=new e.HashMap,this._dirty=!1,this._root=new e.Container,this._root._root=!0,this._root.setDebugId("root")}return t.prototype.destroy=function(){this._childs.clear()},t.prototype.update=function(){this._dirty&&(this.sortLayers(),this._dirty=!1)},t.prototype.getChild=function(t){return this.ensureLayer(t).container},t.prototype.addChild=function(t,e){void 0===e&&(e=1);var i=this.ensureLayer(t);return i.zindex=e,i.container},t.prototype.removeChild=function(t){var e=this._childs.remove(t);return null!=e&&this._root.removeChild(e.container),e.container},t.prototype.setChildIndex=function(t,e){this.ensureLayer(t).zindex=e,this._dirty=!0},t.prototype.sortLayers=function(){for(var t=this._childs.values().sort(function(t,e){return t.zindex-e.zindex}),e=0;e<t.length;e++){var i=t[e];this._root.getChildIndex(i.container)!=e&&this._root.setChildIndex(i.container,e)}},t.prototype.ensureLayer=function(t){var e=this._childs.get(t);return null==e&&(e=new i(t),this._root.addChild(e.container),this._childs.put(t,e),this._dirty=!0),e},Object.defineProperty(t.prototype,"root",{get:function(){return this._root},set:function(t){throw new Error("root is read-only")},enumerable:!0,configurable:!0}),t}();e.ContainerGroup=t;var i=function(t){this.container=new e.Container,this.container.setDebugId(t),this.zindex=1,this.name=t}}(h5ge||(h5ge={})),function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"background",{get:function(){return null==this._background&&(this._background=this.addChild("background",1)),this._background},set:function(t){throw new Error("background is read-only")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scene",{get:function(){return null==this._scene&&(this._scene=this.addChild("scene",100)),this._scene},set:function(t){throw new Error("scene is read-only")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gameplayHUD",{get:function(){return null==this._gameplayHUD&&(this._gameplayHUD=this.addChild("gameplayHUD",150)),this._gameplayHUD},set:function(t){throw new Error("gameplayHUD is read-only")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sceneHUD",{get:function(){return null==this._gameplayHUD&&(this._gameplayHUD=this.addChild("sceneHUD",180)),this._gameplayHUD},set:function(t){throw new Error("sceneHUD is read-only")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"popup",{get:function(){return null==this._popup&&(this._popup=this.addChild("popup",200)),this._popup},set:function(t){throw new Error("popup is read-only")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return null==this._top&&(this._top=this.addChild("top",300)),this._top},set:function(t){throw new Error("top is read-only")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"technical",{get:function(){return null==this._technical&&(this._technical=this.addChild("technical",400)),this._technical},set:function(t){throw new Error("technical is read-only")},enumerable:!0,configurable:!0}),e}(t.ContainerGroup);t.GameContainerGroup=e}(h5ge||(h5ge={})),function(r){var t=function(){function n(t,e,i){void 0===i&&(i={}),this._updatables=[],this._renderables=[],this._doingUpdate=!1,this._afterUpdate=[],this._statsIndex=0,this._statsStartTime=performance.now(),this._frames=0,this._updateTime=[],this._renderTime=[],this._deltaTime=[],n.GAME_INSTANCE=this,i.gameLoop=i.gameLoop||{},i.gameLoop.desiredFps=i.gameLoop.desiredFps||60,i.gameLoop.forceSetTimeout=i.gameLoop.forceSetTimeout||!1,i.gameLoop.smoothDelta=i.gameLoop.smoothDelta||!1,i.input=i.input||{},i.input.maxTouchPointer=i.input.maxTouchPointer||1,i.rendering=i.rendering||{},i.rendering.backgroundColor=null==i.rendering.backgroundColor?-1:i.rendering.backgroundColor,i.rendering.canvasFullscreen=null==i.rendering.canvasFullscreen||i.rendering.canvasFullscreen,this.updt_LastTime=Date.now(),this.options=i,this._bounds=new r.Rectangle(0,0,t,e),this.timeManager=r.TimeManager.get(),this.deviceManager=new r.DeviceManager,this.audioManager=this.newAudioManager(),this.layers=new r.GameContainerGroup,this.renderer=new r.GameCanvas(t,e)}return n.prototype.start=function(){var t=this;this.deviceManager.whenReady(function(){try{t.start0()}catch(t){r.logger.error("Error occured while starting game",t)}})},n.prototype.newAudioManager=function(){return new r.AudioManager(this.deviceManager.visibilityManager)},n.prototype.newScaleManager=function(){return new r.ScaleManager(this)},n.get=function(){return n.GAME_INSTANCE},n.options=function(){return n.GAME_INSTANCE.options},n.prototype.start0=function(){var t=this;this.scaleManager=this.newScaleManager(),this.inputManager=new r.InputManager(this),this.mainLoop=new r.MainLoop(this.update.bind(this),this.render.bind(this)),this.mainLoop.start(),this.onCreate(),window.addEventListener("load",function(){t.scaleManager.resize()}),window.parent&&document.addEventListener("click",function(){document.hasFocus()||window.focus()},!1)},n.prototype.onCreate=function(){},n.prototype.update=function(t,e){r.Time._refresh(t);var i=performance.now();this._doingUpdate=!0;try{this.inputManager.update(e),this.timeManager.update(e),this.layers.update(),this.scene&&this.scene.update(e);for(var n=0;n<this._updatables.length;n++)this._updatables[n].update(e);if(this._doingUpdate=!1,0<this._afterUpdate.length){for(n=0;n<this._afterUpdate.length;n++)this._afterUpdate[n]();this._afterUpdate=[]}}catch(t){this._doingUpdate=!1,r.logger.error("Error occured in game update:"+t.message,t)}var o=performance.now();this._frames++,this._updateTime[this._statsIndex]=o-i,this._deltaTime[this._statsIndex]=e,this._statsIndex++,120<this._statsIndex&&(this._statsIndex=0)},n.prototype.render=function(t,e){performance.now();try{this.scene&&this.scene.render(e);for(var i=0;i<this._renderables.length;i++)this._renderables[i].render(e);this.renderer.beginDraw(),this.layers.root.draw(this.renderer.context),this.renderer.endDraw()}catch(t){r.logger.error("Error occured in game render: ",t)}performance.now()},n.prototype.getStats=function(){for(var t=performance.now(),e=99,i=0,n=0,o=0;o<this._updateTime.length;o++)n+=this._updateTime[o],e=Math.min(e,this._updateTime[o]),i=Math.max(i,this._updateTime[o]);n/=this._updateTime.length;var r=0,s=99,a=0;for(o=0;o<this._renderTime.length;o++)r+=this._renderTime[o],s=Math.min(s,this._renderTime[o]),a=Math.max(a,this._renderTime[o]);r/=this._renderTime.length;var h=0,c=99,l=0;for(o=0;o<this._deltaTime.length;o++)h+=this._deltaTime[o],c=Math.min(c,this._deltaTime[o]),l=Math.max(l,this._deltaTime[o]);h/=this._deltaTime.length;var u=(t-this._statsStartTime)/1e3,p=this._frames/u;return this._frames=0,this._statsStartTime=t,{update:{min:this.roundStat(e),max:this.roundStat(i),avg:this.roundStat(n)},render:{min:this.roundStat(s),max:this.roundStat(a),avg:this.roundStat(r)},delta:{min:this.roundStat(c),max:this.roundStat(l),avg:this.roundStat(h)},fps:this.roundStat(p)}},n.prototype.roundStat=function(t){return Math.round(100*t)/100},n.prototype.switchScene=function(t,e,i){var n=this;void 0===e&&(e=!0),void 0===i&&(i=!0),this.scene?(this._currentOrPendingScene=t,this.scene.hide(function(){n.layers.scene.removeChild(n.scene.container),n.pushScene(t,i)},e)):(this._currentOrPendingScene=t,this.pushScene(t,i))},n.prototype.pushScene=function(t,e){r.logger.debug("Change scene"),this.scene=t,this.scene&&(this.layers.scene.addChild(this.scene.container),this.scene.show(e))},n.prototype.addRenderable=function(t){this._renderables.push(t)},n.prototype.removeRenderable=function(t){var e=this._renderables.indexOf(t);this._renderables.splice(e,1)},n.prototype.addUpdatable=function(t){if(this._doingUpdate){var e=this;this._afterUpdate.push(function(){e._updatables.push(t)})}else this._updatables.push(t)},n.prototype.removeUpdatable=function(t){if(this._doingUpdate){var e=this;this._afterUpdate.push(function(){e.removeUpdatable(t)})}else{var i=this._updatables.indexOf(t);this._updatables.splice(i,1)}},n.prototype.getCurrentOrPendingScene=function(){return this._currentOrPendingScene},Object.defineProperty(n.prototype,"width",{get:function(){return this._bounds.width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this._bounds.height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bounds",{get:function(){return this._bounds},enumerable:!0,configurable:!0}),n.prototype.getOrCreateBackground=function(t,e){return null!=this._background||(this._background=new r.Background(t,e)),this._background},n.prototype._addDebugBorder=function(t,e){void 0===t&&(t=65467),void 0===e&&(e=!1);var i=new r.Graphics;i.beginStroke(1,t),i.drawRect(0,0,this.width,this.height),e&&(i.moveTo(0,this.height/2),i.lineTo(this.width,this.height/2),i.moveTo(this.width/2,0),i.lineTo(this.width/2,this.height)),i.endStroke(),this.layers.root.addChild(i)},n}();r.Game=t}(h5ge||(h5ge={})),function(e){var t=function(){function t(t){this._pendingResize=!1,this.enable=!0,this._fullscreenrendering=!0,this._game=t,this._fullscreenrendering=this._game.options.rendering.canvasFullscreen,this.init()}return t.prototype.init=function(){this._scalingStategy=new i;var t=this;window.addEventListener("resize",function(){t._pendingResize||(t._pendingResize=!0,t.resize())}),window.addEventListener("deviceOrientation",function(){t._pendingResize||(t._pendingResize=!0,t.resize())}),this.resizeHandler=new e.HandlerCollection,this.resize()},t.prototype.resize=function(){if(this._pendingResize=!1,this.enable){var t=document.documentElement.clientWidth,e=document.documentElement.clientHeight;if(null!=this._windowSizeProvider){var i=this._windowSizeProvider();t=i.width,e=i.height}var n=this._game.bounds;this._currentScaling=this._scalingStategy.getScaling(n.width,n.height,t,e);var o=window.devicePixelRatio||1;if(this._fullscreenrendering){var r=this._game.renderer,s=this._game.layers.root;r.canvas.width=t*o,r.canvas.height=e*o,r.canvas.style.width=t+"px",r.canvas.style.height=e+"px",s.scaleXY=this._currentScaling.scale*o,s.x=this._currentScaling.x*o,s.y=this._currentScaling.y*o}else{o=1,(r=this._game.renderer).canvas.width=n.width*o,r.canvas.height=n.height*o,r.canvas.style.width=n.width*o*this._currentScaling.scale+"px",r.canvas.style.height=n.height*o*this._currentScaling.scale+"px",r.canvas.style.left=this._currentScaling.x+"px",r.canvas.style.top=this._currentScaling.y+"px"}window.scrollTo&&window.scrollTo(0,0),this.resizeHandler.fire()}},t.prototype.setWindowSizeProvider=function(t){this._windowSizeProvider=t},t.prototype.setScalingStategy=function(t){this._scalingStategy=t},t.prototype.getAbsoluteGameSize=function(){var t=e.Game.get();return{width:t.width*this._currentScaling.scale,height:t.height*this._currentScaling.scale,marginX:this._currentScaling.x,marginY:this._currentScaling.y}},t.prototype.getWindowSize=function(){var t=window.innerWidth,e=window.innerHeight;if(null!=this._windowSizeProvider){var i=this._windowSizeProvider();t=i.width,e=i.height}return{width:t,height:e}},t.prototype.getCurrentScaling=function(){return this._currentScaling},Object.defineProperty(t.prototype,"offsetX",{get:function(){return this._currentScaling.x},set:function(t){this._currentScaling.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"offsetY",{get:function(){return this._currentScaling.y},set:function(t){this._currentScaling.y=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scale",{get:function(){return this._currentScaling.scale},set:function(t){this._currentScaling.scale=t},enumerable:!0,configurable:!0}),t}();e.ScaleManager=t;var i=function(){function t(){}return t.prototype.getScaling=function(t,e,i,n){var o=e/t<n/i?i/t:n/e;return{x:(i-t*o)/2,y:(n-e*o)/2,scale:o}},t}();e.FitScalingStrategy=i;var n=function(){function t(){}return t.prototype.getScaling=function(t,e,i,n){var o=n/i<e/t?i/t:n/e;return{x:(i-t*o)/2,y:(n-e*o)/2,scale:o}},t}();e.FillScalingStrategy=n}(h5ge||(h5ge={})),function(r){var n,t;(t=n=r.DeadZone||(r.DeadZone={}))[t.Lock=0]="Lock",t[t.TopDown=1]="TopDown",t[t.TopDownTight=2]="TopDownTight";var e=function(){function t(t,e,i,n,o){this.targetOffsetX=0,this.targetOffsetY=0,this._container=t,this._view=new r.Rectangle(e,i,n,o)}return t.prototype.moveBy=function(t,e){this._view.left+=t,this._view.top+=e},t.prototype.update=function(t){this.followTarget(),this.checkBounds(),this._container.x=-this.x,this._container.y=-this.y},t.prototype.setLimits=function(t,e,i,n){},t.prototype.follow=function(t){this._target=t},t.prototype.setDeadZone=function(t){this._deadzone=t},t.prototype.setDeadZonePreset=function(t){switch(t){case n.Lock:this._deadzone=null;break;case n.TopDown:var e=Math.max(this._view.width,this._view.height)/4;this._deadzone=new r.Rectangle((this._view.width-e)/2,(this._view.height-e)/2,e,e);break;case n.TopDownTight:var i=Math.max(this._view.width,this._view.height)/8;this._deadzone=new r.Rectangle((this._view.width-i)/2,(this._view.height-i)/2,i,i)}},t.prototype.followTarget=function(){if(null!=this._target){var t=this._view.width/2,e=this._view.height/2,i=this._target.x,n=this._target.y;if(null!=this.targetOffsetX&&(i-=this.targetOffsetX),null!=this.targetOffsetY&&(n-=this.targetOffsetY),null!=this._deadzone){var o=i-this._view.x,r=n-this._view.y;o<this._deadzone.left?this._view.x=i-this._deadzone.left:o>this._deadzone.right&&(this._view.x=i-this._deadzone.right),r<this._deadzone.top?this._view.y=n-this._deadzone.top:r>this._deadzone.bottom&&(this._view.y=n-this._deadzone.bottom)}else this._view.x=i-t,this._view.y=n-e}},t.prototype.checkBounds=function(){null!=this.limitLeft&&this._view.left<=this.limitLeft&&(this._view.left=this.limitLeft),null!=this.limitRight&&this._view.right>=this.limitRight&&(this._view.right=this.limitRight),null!=this.limitTop&&this._view.top<=this.limitTop&&(this._view.top=this.limitTop),null!=this.limitBottom&&this._view.bottom>=this.limitBottom&&(this._view.bottom=this.limitBottom)},Object.defineProperty(t.prototype,"x",{get:function(){return this._view.x},set:function(t){this._view.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._view.y},set:function(t){this._view.y=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"zoom",{get:function(){return this._container.scaleX},set:function(t){this._container.scaleX=this._container.scaleY=t},enumerable:!0,configurable:!0}),t}();r.Camera=e}(h5ge||(h5ge={})),function(o){var t=function(n){function e(t){var e=n.call(this)||this;if(e._texture=t,e._debugId="Sprite-"+e._id,e.setSizeFromTexture(),!e.texture.isLoaded()){var i=e;e.texture.addLoadedHandler(function(){i.setSizeFromTexture()})}return e}return __extends(e,n),e.prototype.setSizeFromTexture=function(){if(this.texture.trimmed){var t=this.texture.getTrim();this._width=t.width,this._height=t.height}else this._width=this.texture.width,this._height=this.texture.height},e.fromFrame=function(t){return new e(o.Texture.getTexture(t))},e.fromImage=function(t){return new e(o.Texture.fromImage(t))},e.fromTexture=function(t){return new e(t)},e.prototype.setTexture=function(t){this._texture=t},e.prototype.setFrame=function(t){this._texture=o.Texture.getTexture(t)},e.prototype.addLoadedHandler=function(t){this.texture.addLoadedHandler(t)},Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},enumerable:!0,configurable:!0}),e.prototype.draw0=function(t){var e=16777215==this._tint?this._texture:o.Tinter.tint(this._texture,this._tint),i=0,n=0;this.texture.trimmed&&(i=this.texture.getTrim().x,n=this.texture.getTrim().y),t.drawImage(e.getImpl(),e.x,e.y,e.width,e.height,i,n,e.width,e.height)},e}(o.DisplayObject);o.Sprite=t}(h5ge||(h5ge={})),function(r){var t=function(o){function i(t,e){var i=o.call(this,t[0])||this;i.fps=1e3/60,i._curIndex=0,i._textures=[],i._playing=!1,i._startTime=0,i._startFrame=0,i._lastIndex=-1,i._from=0,i._to=0,i._repeats=1,i.forward=!0,i.animationSpeed=1,i.paused=!1,i.pausedDuration=0;var n=i;return t.forEach(function(t){n._textures.push(t)}),r.Game.get().addUpdatable(i),i.detachListener.once(i.destroy,i),null!=e&&i.setDebugId(e),i}return __extends(i,o),i.fromFrames=function(t,e){return new i(r.Texture.fromFrames(t),e)},i.fromTextures=function(t,e){return new i(t,e)},i.prototype.destroy=function(){this.stop(),r.Game.get().removeUpdatable(this)},i.prototype.setTextures=function(t){this.setTextures2(r.Texture.fromFrames(t))},i.prototype.setTextures2=function(t){var e=this.isPlaying();1==e&&this.stop(),this._textures=t,this.gotoAndStop(0),1==e&&this.play()},i.prototype.setFrameIndex=function(t){var e=this._textures[t];this.setTexture(e),0==this._playing&&(this._playing=!0)},i.prototype.setActiveFrame=function(t){var e;if(null!=t&&(e=t<0?(t%this._totalFrames+this._totalFrames)%this._totalFrames:t%this._totalFrames)!=this._curIndex){this._curIndex=e;var i=this._from+this._curIndex%this._totalFrames;this.setFrameIndex(i),0<this._lastIndex&&(t=Math.abs(t))>=this._lastIndex&&(this.setFrameIndex(this._to),this.onAnimationEnded())}},i.prototype.onAnimationEnded=function(){this._playing=!1,this.onEnd&&this.onEnd()},i.prototype.gotoAndStop=function(t){this.setFrameIndex(t),this._playing=!1},i.prototype.gotoAndPlay=function(t){this.setFrameIndex(t)},i.prototype.update=function(t){if(this.paused)this.pausedDuration+=t;else if(this._playing){var e=Math.floor((r.Time.now()-this._startTime)/this.fps);e=Math.floor(e*this.animationSpeed);var i=this._startFrame;this.forward?i+=e:i-=e,this.setActiveFrame(i)}},i.prototype.getTotalFrames=function(){return this._totalFrames},i.prototype.getCurrentFrame=function(){return this._curIndex},i.prototype.play0=function(){this._playing=!0,this._startTime=r.Time.now(),this._startFrame=this._curIndex},i.prototype.play=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._from=t,this._to=0<e?e:this._textures.length-1,this._totalFrames=this._to-this._from+1,this._curIndex=t,this.setFrameIndex(t),this._repeats<0?this._lastIndex=-1:this._lastIndex=this._curIndex+this._totalFrames*this._repeats,this.play0()},i.prototype.repeat=function(t){void 0===t&&(t=0),this._repeats=t},i.prototype.isPlaying=function(){return this._playing},i.prototype.stop=function(){this._playing=!1},i.prototype.pause=function(){this.paused=!0},i.prototype.resume=function(){this._startTime+=this.pausedDuration,this.pausedDuration=0,this.paused=!1},i}(r.Sprite);r.Animation=t}(h5ge||(h5ge={})),function(t){var e=function(e){function t(){var t=e.call(this)||this;return t._enabled=!0,t.disableAlpha=.5,t.interactive=!0,t.downHandler.add(t.onStateDown,t),t.upHandler.add(t.onStateUp,t),t.overHandler.add(t.onStateOver,t),t.outHandler.add(t.onStateOut,t),t.enable(),t}return __extends(t,e),t.prototype.enable=function(){this._enabled=!0,this.interactive=!0,this.alpha=1},t.prototype.disable=function(){this._enabled=!1,this.interactive=!1,this.alpha=this.disableAlpha},t.prototype.onStateDown=function(){this._down=!0},t.prototype.onStateUp=function(){this._over=!1,this._down=!1},t.prototype.onStateOver=function(){this._over=!0},t.prototype.onStateOut=function(){this._over=!1,this._down=!1},t}(t.Container);t.Button=e}(h5ge||(h5ge={})),function(a){var n=function(){function s(t,e,i){this._stateUp=t,this._stateDown=e,this._stateOver=i}return s.fromFrames=function(t,e,i){var n=a.Sprite.fromFrame(t),o=null,r=null;return null!=e&&(o=a.Sprite.fromFrame(e)),null!=i&&(r=a.Sprite.fromFrame(i)),new s(n,o,r)},s.fromTextures=function(t,e,i){var n=a.Sprite.fromTexture(t),o=null,r=null;return null!=e&&(o=a.Sprite.fromTexture(e)),null!=i&&(r=a.Sprite.fromTexture(i)),new s(n,o,r)},s}();a.ImageButtonStyle=n;var t=function(i){function r(t){var e=i.call(this)||this;return e._text=null,e._icon=null,e._style=t,e.addChild(e._style._stateDown),e.addChild(e._style._stateOver),e.addChild(e._style._stateUp),e.setSize(e._style._stateUp.width,e._style._stateUp.height),e}return __extends(r,i),r.fromFramesArray=function(t){var e=t.length;if(e<1||3<e)throw new Error("Invalid states array size");var i=t[0],n=null,o=null;return 1<e&&(n=t[1]),2<e&&(o=t[2]),r.fromFrames(i,n,o)},r.fromFrames=function(t,e,i){return new r(n.fromFrames(t,e,i))},r.fromTextures=function(t,e,i){return new r(n.fromTextures(t,e,i))},r.prototype.setFrames=function(t,e,i){this._style._stateDown&&this._style._stateDown.removeSelf(),this._style._stateOver&&this._style._stateOver.removeSelf(),this._style._stateUp&&this._style._stateUp.removeSelf(),this._style=n.fromFrames(t,e,i),this.addChildAt(this._style._stateUp,0),this._style._stateDown&&this.addChildAt(this._style._stateDown,0),this._style._stateOver&&this.addChildAt(this._style._stateOver,0)},r.prototype.setFramesArray=function(t){var e=t[0],i=null,n=null;1<t.length&&(i=t[1]),2<t.length&&(n=t[2]),this.setFrames(e,i,n)},r.prototype.setContent=function(t){this.addChild(t),a.layout.centerOnX(t,this,!1),a.layout.centerOnY(t,this,!1)},r.prototype.setText=function(t){null!=this._text&&this._text.removeSelf(),this._text=t,this.addChild(t),a.layout.centerOnX(t,this,!1),a.layout.centerOnY(t,this,!1)},r.prototype.setIcon=function(t,e){null!=this._icon&&this._icon.removeSelf(),this._icon=a.Sprite.fromFrame(t),null!=e&&(this._icon.scaleXY=e),a.layout.centerOnX(this._icon,this,!1),a.layout.centerOnY(this._icon,this,!1),this.addChild(this._icon)},r.prototype.setStateTexture=function(){this._style._stateDown&&(this._style._stateDown.visible=!1),this._style._stateOver&&(this._style._stateDown.visible=!1),this._style._stateUp.visible=!1,this._down?this._style._stateDown&&(this._style._stateDown.visible=!0):this._over?this._style._stateOver&&(this._style._stateOver.visible=!0):this._style._stateUp&&(this._style._stateUp.visible=!0)},r.prototype.onStateDown=function(){i.prototype.onStateDown.call(this),this.setStateTexture()},r.prototype.onStateUp=function(){i.prototype.onStateUp.call(this),this.setStateTexture()},r.prototype.onStateOver=function(){i.prototype.onStateOver.call(this),this.setStateTexture()},r.prototype.onStateOut=function(){i.prototype.onStateOut.call(this),this.setStateTexture()},Object.defineProperty(r.prototype,"style",{get:function(){return this._style},enumerable:!0,configurable:!0}),r}(a.Button);a.ImageButton=t}(h5ge||(h5ge={})),function(t){var e=function(){function t(t,e){this._sprite=t,this._properties=e,this._savedValues={},this.apply(0)}return t.prototype.apply=function(t){for(var e=0;e<this._properties.length;e++){var i=this._properties[e],n=this._savedValues[i],o=this._sprite[i];null!=n&&(o=n+(o-n)*t,this._sprite[i]=o),this._savedValues[i]=o}},t.prototype.get=function(t){return this._savedValues[t]},t}();t.SpriteInterpolator=e}(h5ge||(h5ge={})),function(r){var t=function(){function i(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this.maxWidth=t,this.maxHeight=e,this.bounds=new r.Rectangle(0,0,0,0),(i.INSTANCE=this).game=r.Game.get(),this.sm=this.game.scaleManager,this.sm.resizeHandler.add(this.onResize,this),this.onResize()}return i.getInstance=function(){return this.INSTANCE},i.get=function(){return this.getInstance().bounds},i.prototype.onResize=function(){var t=this.sm.getCurrentScaling(),e=t.x/t.scale,i=t.y/t.scale;if(null!=this.maxWidth){var n=this.game.width+2*e;n>this.maxWidth&&(e-=(n-this.maxWidth)/2)}if(null!=this.maxHeight){var o=this.game.height+2*i;o>this.maxHeight&&(i-=(o-this.maxHeight)/2)}this.bounds=new r.Rectangle(-e,-i,this.game.width+2*e,this.game.height+2*i)},i}();r.ExpandedBounds=t}(h5ge||(h5ge={})),function(l){!function(t){function e(t,e,i){void 0===i&&(i=!0);var n=Math.round((e.width-t.width)/2);t.x=i?e.x+n:n}function i(t,e,i){void 0===i&&(i=!0);var n=Math.round((e.height-t.height)/2);t.y=i?e.y+n:n}function c(t,e){void 0===e&&(e=!1);for(var i=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,r=Number.NEGATIVE_INFINITY,s=0;s<t.getChildrenCount();s++){var a,h=t.getChildAt(s);a=e&&h instanceof l.Container?c(h,!0):h,i=Math.min(i,a.x),n=Math.min(n,a.y),0<a.width&&(r=Math.max(r,a.x+a.width)),0<a.height&&(o=Math.max(o,a.y+a.height))}return{x:i,y:n,width:r-i,height:o-n}}t.centerOnX=e,t.centerOnY=i,t.centerOnXInParent=function(t){e(t,t.parent,!1)},t.centerOnYInParent=function(t){i(t,t.parent,!1)},t.centerOnXYInParent=function(t){e(t,t.parent,!1),i(t,t.parent,!1)},t.computeBounds=c,t.setContainerSize=function(t,e){void 0===e&&(e=!1);var i=c(t,e);t.setSize(i.width,i.height)}}(l.layout||(l.layout={}))}(h5ge||(h5ge={})),function(h){var t=function(a){function t(t,e,i,n){var o=a.call(this)||this;o._itemWidth=t,o._itemHeight=e,o._visibleItems=i,o._vertical=n,o._items=[],o.optShowItemOverlay=!0;o._scrollableContainer=new h.ScrollableContainer,o.addChild(o._scrollableContainer);var r=t,s=e;return n?(s=(o._itemSize=e)*i,o._scrollableContainer.scrollEnableOnX=!1):(r=(o._itemSize=t)*i,o._scrollableContainer.scrollEnableOnY=!1),o._scrollableContainer.setContainerSize(r,s),o._scrollableContainer.addScrollHandler(o.onScroll,o),o._scrollableContainer.wheelOnY=o._vertical,o._contentBounds=new h.Rectangle(0,0,r,s),o.setSize(r,s),o.updateVisibleItems(0),o}return __extends(t,a),t.prototype.getContentBounds=function(){return this._contentBounds},t.prototype.addItem=function(t){var e=this._items.length;this._vertical?(t.x=0,t.y=e*this._itemHeight):(t.x=e*this._itemWidth,t.y=0),this._scrollableContainer.addDisplayObject(t),this._items.push(t),this.updateVisibleItems()},t.prototype.clear=function(){this._scrollableContainer.clear(),this._items=[],this.updateVisibleItems(0)},t.prototype.setControlButton=function(t,e){var i=this;this._upOrLeft=t,this._downOrRight=e,this._upOrLeft.onClick(function(){i.moveUpOrLeft()}),this._downOrRight.onClick(function(){i.moveDownOrRight()})},t.prototype.moveUpOrLeft=function(){this._vertical?this.moveUp():this.moveLeft()},t.prototype.moveDownOrRight=function(){this._vertical?this.moveDown():this.moveRight()},t.prototype.moveUp=function(){this._vertical&&this.moveUp0()},t.prototype.moveDown=function(){this._vertical&&this.moveDown0()},t.prototype.moveLeft=function(){this._vertical||this.moveUp0()},t.prototype.moveRight=function(){this._vertical||this.moveDown0()},t.prototype.scrollToItem=function(t){t>this._items.length-this._visibleItems&&(t=this._items.length-this._visibleItems),0<=t&&this.moveTo(t)},t.prototype.getItems=function(){return this._items},t.prototype.onScroll=function(t,e,i,n){this.updateVisibleItems()},t.prototype.moveUp0=function(){var t=this.getMoveByCount();this.moveBy(-t)},t.prototype.moveDown0=function(){var t=this.getMoveByCount();this.moveBy(t)},t.prototype.getMoveByCount=function(){return 3<this._visibleItems?this._visibleItems-2:1},t.prototype.moveBy=function(t){var e=t*this._itemSize;this._vertical?this._scrollableContainer.moveByAbout(null,e):this._scrollableContainer.moveByAbout(e,null),this.updateVisibleItems()},t.prototype.moveTo=function(t){var e=t*this._itemSize;this._vertical?this._scrollableContainer.moveTo(null,e):this._scrollableContainer.moveTo(e,null),this.updateVisibleItems()},t.prototype.updateVisibleItems=function(t){if(void 0===t&&(t=null),null==t){var e=this._scrollableContainer.getContentBound();t=this._vertical?e.y:e.x}null!=this._topItemOverlay&&(this._topItemOverlay.visible=!1),null!=this._bottomItemOverlay&&(this._bottomItemOverlay.visible=!1);for(var i=t+this._visibleItems*this._itemSize,n=0;n<this._items.length;n++){var o=this._items[n],r=this._vertical?o.y:o.x,s=this._vertical?o.y+this._itemSize:o.x+this._itemSize;t<=r&&s<=i?o.visible=!0:i<=r||s<=t?o.visible=!1:(o.visible=!0,r+this._itemSize/2<t?this.addTopItemOverlay(o):s-this._itemSize/2>i&&this.addBottomItemOverlay(o))}},t.prototype.addTopItemOverlay=function(t){this.optShowItemOverlay&&(null==this._topItemOverlay&&(this._topItemOverlay=this.buildItemOverlay(t),this._scrollableContainer.addDisplayObject(this._topItemOverlay)),this._topItemOverlay.visible=!0,this._topItemOverlay.x=t.x,this._topItemOverlay.y=t.y)},t.prototype.addBottomItemOverlay=function(t){this.optShowItemOverlay&&(null==this._bottomItemOverlay&&(this._bottomItemOverlay=this.buildItemOverlay(t),this._scrollableContainer.addDisplayObject(this._bottomItemOverlay)),this._bottomItemOverlay.visible=!0,this._bottomItemOverlay.x=t.x,this._bottomItemOverlay.y=t.y)},t.prototype.buildItemOverlay=function(t){var e=this._itemWidth,i=this._itemWidth;t instanceof h.Container&&(e=Math.min(this._itemWidth,t.width),i=Math.min(this._itemHeight,t.height));var n=new h.Graphics;return n.beginFill(0,.2),n.drawRect(0,0,e,i),n.endFill(),n.showCursor=!1,n},t}(h.Container);h.ScrollableList=t}(h5ge||(h5ge={})),function(t){var e=function(){function t(){this._command=[]}return t.prototype.moveTo=function(t,e){this._command.push(-1),this._command.push(t),this._command.push(e)},t.prototype.lineTo=function(t,e){this._command.push(-2),this._command.push(t),this._command.push(e)},t.prototype.rectangle=function(t,e,i,n){this._command.push(-3),this._command.push(t),this._command.push(e),this._command.push(i),this._command.push(n)},t.prototype.arc=function(t,e,i,n,o){void 0===n&&(n=0),void 0===o&&(o=2*Math.PI),this._command.push(-4),this._command.push(t),this._command.push(e),this._command.push(i),this._command.push(n),this._command.push(o)},t.prototype._applyMask=function(t){t.beginPath();for(var e=0;e<this._command.length;e++){var i=this._command[e];-1==i?(t.moveTo(this._command[e+1],this._command[e+2]),e+=2):-2==i?(t.lineTo(this._command[e+1],this._command[e+2]),e+=2):-3==i?(t.rect(this._command[e+1],this._command[e+2],this._command[e+3],this._command[e+4]),e+=4):-4==i&&(t.arc(this._command[e+1],this._command[e+2],this._command[e+3],this._command[e+4],this._command[e+5]),e+=5)}t.clip()},t}();t.Mask=e}(h5ge||(h5ge={})),function(r){var t=function(n){function t(){var t=n.call(this)||this;t.applyVelocity=!0,t.velocityTheshold=.2,t.dragDurationVelocityTheshold=400,t.wheelOnY=!0,t.scrollEnableOnX=!0,t.scrollEnableOnY=!0,t._innerVelocity=new r.Vector,t._dragStartPosition=new r.Point,t._dragStartTime=0,t._lastInnerPosition=new r.Point,t._scrollHandler=new r.HandlerCollection;var e=t,i=r.Game.get().bounds;return t.interactive=!0,t.showCursor=!1,t._game=r.Game.get(),t._game.addUpdatable(t),t._inner=new r.Container,t.addChild(t._inner),t._dragManager=new r.DragManager(t),t._dragManager.setStartDragController(function(t){return e.canStartDrag(t)}),t._game.inputManager.mouse.mouseWheelHandlers.add(t.onMouseWheel,t),t.detachListener.once(function(){e.destroy()}),t.setContainerSize(i.width,i.height),t}return __extends(t,n),t.prototype.setContainerSize=function(t,e){this.setSize(t,e),this._contentBounds=new r.Rectangle(0,0,t,e),this._contentMask=new r.Mask,this._contentMask.rectangle(0,0,t,e),this.mask=this._contentMask},t.prototype.onDragBegin=function(t){this._dragStartPosition=t.copy(),this._dragStartTime=Date.now(),this._innerVelocity.x=0,this._innerVelocity.y=0},t.prototype.onDragMove=function(t,e,i){this.scrollEnableOnX&&(this._inner.x+=t),this.scrollEnableOnY&&(this._inner.y+=e),this.checkBoundLimit()},t.prototype.onDragEnd=function(t){var e=t.x-this._dragStartPosition.x,i=t.y-this._dragStartPosition.y,n=Date.now()-this._dragStartTime;this.scrollEnableOnX||(e=0),this.scrollEnableOnY||(i=0),this.applyVelocity&&n<this.dragDurationVelocityTheshold&&(this._innerVelocity.x=e/n,this._innerVelocity.y=i/n)},t.prototype.onMouseWheel=function(t){var e=r.Game.get().inputManager.mouse.position;if(this.canStartDrag(e)){var i=0,n=0,o=50*-t;this.wheelOnY?n=o:i=o,this.doFakeDrag(i,n,1e3)}},t.prototype.addDisplayObject=function(t,e){var i;return i=null!=e?this._inner.addChildAt(t,e):this._inner.addChild(t),this.computeInnerMinMax(),i},t.prototype.clear=function(){this._inner.removeChildren(),this.computeInnerMinMax()},t.prototype.moveTo=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),null!=t&&(this._inner.x=-t),null!=e&&(this._inner.y=-e),this.checkBoundLimit()},t.prototype.moveBy=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),null!=t&&(this._inner.x-=t),null!=e&&(this._inner.y-=e),this.checkBoundLimit()},t.prototype.moveByAbout=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this.canMove()&&(null==t&&(t=0),null==e&&(e=0),this._inner.x+=t,this._inner.y+=e,this.doFakeDrag(-t,-e,300))},t.prototype.update=function(t){0==this._innerVelocity.x&&0==this._innerVelocity.y||(this._innerVelocity.x*=.95,this._innerVelocity.y*=.95,Math.abs(this._innerVelocity.x)<this.velocityTheshold&&(this._innerVelocity.x=0),Math.abs(this._innerVelocity.y)<this.velocityTheshold&&(this._innerVelocity.y=0),this._inner.x=this._inner.x+t*this._innerVelocity.x,this._inner.y=this._inner.y+t*this._innerVelocity.y,this.checkBoundLimit())},t.prototype.getContentBound=function(){return this._contentBounds.x=-this._inner.x,this._contentBounds.y=-this._inner.y,this._contentBounds},t.prototype.doFakeDrag=function(t,e,i){var n=new r.Point(this._inner.x,this._inner.y),o=n.copy();o.x=o.x+t,o.y=o.y+e,this.onDragBegin(n),this._dragStartTime=Date.now()-i,this.onDragMove(t,e,o),this.onDragEnd(o)},t.prototype.computeInnerMinMax=function(){var t=r.layout.computeBounds(this._inner,!1);this._inner.setSize(t.width,t.height);var e=this._inner.width,i=this._inner.height;this._innerMin=new r.Point(-e+this._contentBounds.width,-i+this._contentBounds.height),this._innerMax=new r.Point(0,0)},t.prototype.canMove=function(){return!(this._inner.width<=this._contentBounds.width&&this._inner.height<=this._contentBounds.height)},t.prototype.canStartDrag=function(t){return!!this.canMove()&&this.hitPoint(t)},t.prototype.checkBoundLimit=function(){this.scrollEnableOnX&&(this._inner.x<this._innerMin.x?this._inner.x=this._innerMin.x:this._inner.x>this._innerMax.x&&(this._inner.x=this._innerMax.x)),this.scrollEnableOnY&&(this._inner.y<this._innerMin.y?this._inner.y=this._innerMin.y:this._inner.y>this._innerMax.y&&(this._inner.y=this._innerMax.y));var t=this._lastInnerPosition.x-this._inner.x,e=this._lastInnerPosition.y-this._inner.y;this._lastInnerPosition.x=this._inner.x,this._lastInnerPosition.y=this._inner.y,0==t&&0==e||this._scrollHandler.fire(t,e,-this._lastInnerPosition.x,-this._lastInnerPosition.y)},t.prototype.destroy=function(){this._dragManager.destroy(),this._game.inputManager.mouse.mouseWheelHandlers.remove(this.onMouseWheel),this._game.removeUpdatable(this)},t.prototype.addScrollHandler=function(t,e){this._scrollHandler.add(t,e)},t.prototype.removeScrollHandler=function(t){this._scrollHandler.remove(t)},t}(r.Container);r.ScrollableContainer=t}(h5ge||(h5ge={})),function(u){var t=function(o){function n(t,e,i){var n=o.call(this,t,e)||this;return n.objectFactory=i,n._tilePositionX=0,n._tilePositionY=0,n._dirty=!0,n._elementW=0,n._elementH=0,n._elementCountW=0,n._elementCountH=0,n.mask=new u.Mask,n.mask.rectangle(0,0,t,e),n}return __extends(n,o),n.fromFrame=function(t,e,i){return new n(t,e,function(){return u.Sprite.fromFrame(i)})},n.prototype.draw0=function(t){this._dirty&&(this.create(),this._dirty=!1),o.prototype.draw0.call(this,t)},n.prototype.create=function(){if(0==this._elementCountW){var t=this.objectFactory(),e=t.width,i=t.height;this._elementCountW=Math.ceil(this.width/e+1),this._elementCountH=Math.ceil(this.height/i+1),this.addChild(t);for(var n=this._elementCountW*this._elementCountH,o=1;o<n;o++)this.addChild(this.objectFactory());this._elementW=e,this._elementH=i}for(var r=u.Maths.mod(this._tilePositionX,this._elementW)-this._elementW,s=u.Maths.mod(this._tilePositionY,this._elementH)-this._elementH,a=0;a<this._elementCountW;a++)for(var h=0;h<this._elementCountH;h++){var c=a*this._elementCountH+h,l=this.getChildAt(c);l.x=r+a*this._elementW,l.y=s+h*this._elementH}},Object.defineProperty(n.prototype,"tilePositionX",{get:function(){return this._tilePositionX},set:function(t){this._tilePositionX=t,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"tilePositionY",{get:function(){return this._tilePositionY},set:function(t){this._tilePositionY=t,this._dirty=!0},enumerable:!0,configurable:!0}),n}(u.Container);u.TilingSprite=t}(h5ge||(h5ge={})),function(y){var t=function(){function f(){}return f.isMultiplySupported=function(){if(null===this.multiplyDetected){var t=document.createElement("canvas"),e=t.getContext("2d");t.width=1,t.height=1,e.clearRect(0,0,1,1),e.globalCompositeOperation="source-over",e.fillStyle="#000",e.fillRect(0,0,1,1),e.globalCompositeOperation="multiply",e.fillStyle="#fff",e.fillRect(0,0,1,1),this.multiplyDetected=0===e.getImageData(0,0,1,1).data[0],this.multiplyDetected||y.logger.warn("Tinter : globalCompositeOperation multiply not supported, fallback to manual multiply")}return this.multiplyDetected},f.tint=function(t,e,i){void 0===i&&(i=!0);var n=e>>16&255,o=e>>8&255,r=255&e;n=Math.min(255,Math.round(n/f.rounding)*f.rounding),o=Math.min(255,Math.round(o/f.rounding)*f.rounding),r=Math.min(255,Math.round(r/f.rounding)*f.rounding);var s=t.name+"-tint-"+n+","+o+","+r;if(i){var a=y.Texture.containsTexture(s);if(null!=a)return a}var h=document.createElement("canvas"),c=h.getContext("2d");if(h.width=t.width,h.height=t.height,c.fillStyle="rgba("+n+","+o+","+r+",1)",c.fillRect(0,0,t.width,t.height),this.isMultiplySupported())c.globalCompositeOperation="multiply",c.drawImage(t.getImpl(),t.x,t.y,t.width,t.height,0,0,t.width,t.height);else{c.drawImage(t.getImpl(),t.x,t.y,t.width,t.height,0,0,t.width,t.height);for(var l=c.getImageData(0,0,h.width,h.height),u=l.data,p=0;p<u.length;p+=4)u[p]=n*u[p]/255,u[p+1]=o*u[p+1]/255,u[p+2]=r*u[p+2]/255;c.putImageData(l,0,0)}c.globalCompositeOperation="destination-atop",c.drawImage(t.getImpl(),t.x,t.y,t.width,t.height,0,0,t.width,t.height);var d=new y.Texture(s,0,0,t.width,t.height);return d.setImpl(h),i&&y.Texture.addTexture(d),d},f.rounding=8,f.multiplyDetected=null,f}();y.Tinter=t}(h5ge||(h5ge={})),function(i){var t=function(){function r(){}return r.merge=function(t,e){for(var i in t){var n=t[i],o=typeof n;"constructor"!==o&&"function"!=o&&(i in e&&"object"==typeof n?r.merge(n,e[i]):e[i]=n)}},r.safeJson=function(e,t){if(void 0===t&&(t=null),null==e||0==e.length)return t;try{return JSON.parse(e)}catch(t){i.logger.error("Failed to parse json data="+e,t)}return t},r}();i.JSONS=t}(h5ge||(h5ge={})),function(r){var t=function(){function o(){}return o.setAvailableLocales=function(t){o.availableLocales=t},o.registerTranslation=function(t,e){null==o.translations[t]&&(o.translations[t]={}),r.JSONS.merge(e,o.translations[t])},o.setDefaultLocale=function(t){o.defaultLocale=t},o.setLocale=function(t){o.locale=0<=o.availableLocales.indexOf(t)?t:o.defaultLocale},o.isAvailableLocale=function(t){return 0<=o.availableLocales.indexOf(t)},o.get=function(t,e){var i=o.translations[o.locale][t];if(i)return null!=e?r.Strings.interpolate(i,e):i;var n=o.translations[o.defaultLocale][t];return n?null!=e?r.Strings.interpolate(n,e):n:t},o.getPluralForm=function(t,e){null==e&&(e=o.locale);return"fr"==e?1<t?1:0:"lv"==e?0==t?0:t%10==1&&t%100!=11?1:2:"pl"==e?1==t?0:2<=t%10&&t%10<=4&&(t%100<10||20<=t%100)?1:2:"ru"==e?t%10==1&&t%100!=11?0:2<=t%10&&t%10<=4&&(t%100<10||20<=t%100)?1:2:1==t?0:1},o.getPlural=function(t,e,i){null==i&&(i={n:t});var n=o.getPluralForm(t);return o.get(e+"_F"+n,i)},o.availableLocales=[],o.defaultLocale="en",o.locale="en",o.translations=[],o}();r.I18N=t}(h5ge||(h5ge={})),function(e){var t=function(){function t(){this.isDown=!1,this.isUp=!0,this.isJustDown=!1,this.isJustUp=!1,this.timeDown=0,this.timeUp=0,this.downDuration=0,this.justUpdated=!1,this._duration=0}return t.prototype.update=function(){this.isDown&&(this.downDuration=e.Time.now()-this.timeDown),this.justUpdated?(this.isJustDown=this.isDown,this.isJustUp=this.isUp):(this.isJustDown=!1,this.isJustUp=!1),this.justUpdated=!1},t.prototype.ondown=function(){this.isDown||(this.justUpdated=!0,this.isDown=!0,this.isUp=!1,this.timeDown=e.Time.now(),this.downDuration=0)},t.prototype.onup=function(){this.isUp||(this.justUpdated=!0,this.isDown=!1,this.isUp=!0,this.timeUp=e.Time.now())},t}();e.AbstractInput=t}(h5ge||(h5ge={})),function(o){var t=function(){function t(t){this._pointerDirty=!1,this._maxTouchPointer=1,this._clickHandlerCount=0,this._disabled=!1,this.noCursor=!1,this._maxTouchPointer=null==t.options.input?1:null==t.options.input.maxTouchPointer?1:t.options.input.maxTouchPointer,this.rootContainer=t.layers.root,this.desktop=t.deviceManager.os.desktop,this.keyboard=new o.KeyboardHandler(t,this),this.mouse=new o.MouseHandler(t,this)}return t.prototype.update=function(t){this._disabled||(this.keyboard.update(),this.mouse.update(),this.triggerMouseHit())},t.prototype.triggerImmediateClick=function(){if(!(this._clickHandlerCount<=0))for(var t=0;t<this.mouse.pointers.length;t++){var e=this.mouse.pointers[t];e.isActive()&&e._triggerImmediateClick()}},t.prototype.triggerMouseHit=function(){var t=this._pointerDirty;if(this._pointerDirty=!1,o.DisplayObject.interactiveDirty&&(this._clickHandlerCount=0,this.invalidateInteractive(this.rootContainer),t=!(o.DisplayObject.interactiveDirty=!1)),t)for(var e=0;e<this.mouse.pointers.length;e++){this.mouse.pointers[e]._triggerMouseHit()}},t.prototype.invalidateInteractive=function(t){t.hasInteractiveChild=!1;for(var e=t.getChildrenCount(),i=0;i<e;i++){var n=t.getChildAt(i);n instanceof o.Container?(this.invalidateInteractive(n),(n.hasInteractiveChild||n.interactive)&&(t.hasInteractiveChild=!0)):n.interactive&&(t.hasInteractiveChild=!0),n.hasClickHandler()&&this._clickHandlerCount++}},Object.defineProperty(t.prototype,"maxTouchPointer",{get:function(){return this._maxTouchPointer},enumerable:!0,configurable:!0}),t.prototype.enable=function(){this._disabled=!1},t.prototype.disable=function(){this._disabled=!0,this.mouse.update()},t.prototype.hideCursor=function(){this.noCursor=!0,o.Game.get().renderer.canvas.style.cursor="none"},t}();o.InputManager=t}(h5ge||(h5ge={})),function(t){var e=function(){function t(){}return t.fromChar=function(t){return t.charCodeAt(0)-32},t.SHIFT=17,t.CTRL=17,t.ALT=18,t.SPACEBAR=32,t.LEFT=37,t.PAGEUP=33,t.PAGEDOWN=34,t.END=35,t.HOME=36,t.UP=38,t.RIGHT=39,t.DOWN=40,t.INSERT=45,t.DELETE=46,t.F1=112,t.F2=113,t.F3=114,t.F4=115,t.F5=116,t.F6=117,t.F7=118,t.F8=119,t.F9=120,t.F10=121,t.F11=122,t.F12=123,t}();t.KeyCode=e}(h5ge||(h5ge={})),function(t){var e=function(i){function t(t){var e=i.call(this)||this;return e.keycode=t,e}return __extends(t,i),t.prototype.keydown=function(t){this.isDown||i.prototype.ondown.call(this)},t.prototype.keyup=function(t){this.isUp||i.prototype.onup.call(this)},t}(t.AbstractInput);t.KeyInput=e}(h5ge||(h5ge={})),function(n){var t=function(){function t(t,e){var i=this;this._enable=!1,this.keys=[],this.propagatedKeys=new n.HashSet,this.propagateAllKeys=!1,this.keydown=function(t){var e=i.ensureKey(t.which);e.keydown(t),i.keyDownHandlers.fire(e,t),i.stopEvent(t)},this.keyup=function(t){var e=i.ensureKey(t.which);e.keyup(t),i.keyUpHandlers.fire(e,t),i.stopEvent(t)},this.enable(),this.propagatedKeys.add(n.KeyCode.F5),this.propagatedKeys.add(n.KeyCode.F12),this.keyUpHandlers=new n.HandlerCollection,this.keyDownHandlers=new n.HandlerCollection}return t.prototype.update=function(){if(this.enable)for(var t=0;t<this.keys.length;t++){var e=this.keys[t];null!=e&&e.update()}},t.prototype.enable=function(){this._enable||(this._enable=!0,window.addEventListener("keydown",this.keydown,!1),window.addEventListener("keyup",this.keyup,!1))},t.prototype.disable=function(){this._enable&&(this._enable=!1,window.removeEventListener("keydown",this.keydown),window.removeEventListener("keyup",this.keyup))},t.prototype.key=function(t){return this.ensureKey(t)},t.prototype.isDown=function(t){var e=this.keys[t];return null!=e&&e.isDown},t.prototype.isUp=function(t){var e=this.keys[t];return null==e||e.isUp},t.prototype.isJustDown=function(t){var e=this.keys[t];return null!=e&&e.isJustDown},t.prototype.isJustUp=function(t){var e=this.keys[t];return null!=e&&e.isJustUp},t.prototype.downDuration=function(t){var e=this.keys[t];return null==e?0:e.downDuration},t.prototype.stopEvent=function(t){if(!this.propagateAllKeys){var e=t.which;e&&this.propagatedKeys.contains(e)||(t.preventDefault(),t.stopPropagation())}},t.prototype.ensureKey=function(t){var e=this.keys[t];return null==e&&(e=new n.KeyInput(t),this.keys[t]=e),e},t}();n.KeyboardHandler=t}(h5ge||(h5ge={})),function(n){var t=function(){function t(t,e){var o=this;this._enable=!1,this.propagateAllEvents=!1,this.touchEndFired=!1,this.mousedown=function(t){o.pointer.mousedown(t),o.inputManager._pointerDirty=!0,o.stopEvent(t)},this.mousemove=function(t){o.pointer.mousemove(t),o.inputManager._pointerDirty=!0,o.stopEvent(t)},this.mouseup=function(t){o.pointer.mouseup(t),o.inputManager._pointerDirty=!0,o.stopEvent(t)},this.mouseout=function(t){},this.mousewheel=function(t){if(t.deltaY){var e=t.deltaY;e<-1?e=-1:1<e&&(e=1),0!=e&&o.mouseWheelHandlers.fire(e,t)}o.stopEvent(t)},this.touchstart=function(t){for(var e=0;e<t.changedTouches.length;e++){var i=t.changedTouches[e],n=o.getPointerOrFirstFree(i);null!=n&&n.touchdown(i)}o.inputManager._pointerDirty=!0,o.stopEvent(t)},this.touchmove=function(t){for(var e=0;e<t.changedTouches.length;e++){var i=t.changedTouches[e],n=o.getPointerOrFirstFree(i);null!=n&&n.touchmove(i)}o.inputManager._pointerDirty=!0,o.stopEvent(t)},this.touchend=function(t){for(var e=0;e<t.changedTouches.length;e++){var i=t.changedTouches[e],n=o.getPointerOrFirstFree(i);null!=n&&n.touchup(i)}o.inputManager._pointerDirty=!0,o.touchEndFired?o.stopEvent(t):o.touchEndFired=!0},this.touchcancel=function(t){o.touchend(t)},this.touchleave=function(t){o.touchend(t)},this.game=t,this.inputManager=e,this.pointer=new n.PointerInput(t,e),this.pointers=new Array(e.maxTouchPointer),this.pointers[0]=this.pointer;for(var i=1;i<e.maxTouchPointer;i++)this.pointers[i]=new n.PointerInput(t,e);this.element=n.Game.get().renderer.canvas,this.mouseWheelHandlers=new n.HandlerCollection,this.enable()}return t.prototype.update=function(){for(var t=0;t<this.pointers.length;t++)this.pointers[t].update()},t.prototype.enableOnElement=function(t){this.disable(),this.element=t,this.enable()},t.prototype.enable=function(){this._enable||(this._enable=!0,this.element.addEventListener("mousedown",this.mousedown),this.element.addEventListener("mousemove",this.mousemove),this.element.addEventListener("mouseup",this.mouseup),this.element.addEventListener("mouseout",this.mouseout),this.element.addEventListener("wheel",this.mousewheel),this.element.addEventListener("touchstart",this.touchstart),this.element.addEventListener("touchmove",this.touchmove),this.element.addEventListener("touchend",this.touchend),this.element.addEventListener("touchcancel",this.touchcancel),this.element.addEventListener("touchleave",this.touchleave))},t.prototype.disable=function(){this._enable&&(this._enable=!1,this.element.removeEventListener("mousedown",this.mousedown),this.element.removeEventListener("mousemove",this.mousemove),this.element.removeEventListener("mouseup",this.mouseup),this.element.removeEventListener("mouseout",this.mouseout),this.element.removeEventListener("touchstart",this.touchstart),this.element.removeEventListener("touchmove",this.touchmove),this.element.removeEventListener("touchend",this.touchend),this.element.removeEventListener("touchcancel",this.touchcancel),this.element.removeEventListener("touchleave",this.touchleave))},Object.defineProperty(t.prototype,"isDown",{get:function(){return this.pointer.isDown},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isUp",{get:function(){return this.pointer.isUp},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isJustDown",{get:function(){return this.pointer.isJustDown},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isJustUp",{get:function(){return this.pointer.isJustUp},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"downDuration",{get:function(){return this.pointer.downDuration},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"downPosition",{get:function(){return this.pointer.downPosition},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this.pointer.position},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"upPosition",{get:function(){return this.pointer.upPosition},enumerable:!0,configurable:!0}),t.prototype.getPointerOrFirstFree=function(t){for(var e=t.identifier,i=null,n=null,o=0;o<this.pointers.length;o++){var r=this.pointers[o];if(null==r.identifier&&null==i)i=r;else if(r.identifier==e){n=r;break}}return null!=n?n:i},t.prototype.stopEvent=function(t){this.propagateAllEvents||(t.preventDefault(),t.stopPropagation())},t.prototype.debugTouch=function(t,e){for(var i="",n=0;n<e.changedTouches.length;n++)i+=""+e.changedTouches[n].identifier,n<e.changedTouches.length-1&&(i+=",");console.log("#### MouseHandler: "+t+", changes: "+i)},t}();n.MouseHandler=t}(h5ge||(h5ge={})),function(s){var t=function(n){function i(t,e){var i=n.call(this)||this;return i.downPosition=new s.Point,i.position=new s.Point,i.upPosition=new s.Point,i.mouseActive=!1,i._touchInProgress=!1,i._touchEndTime=0,i._touchEndDebounce=4e3,i._prevMousePosition=new s.Point(-1,-1),i._prevMouseBState=-1,i._previousHit=null,i._lastDownTarget=null,i._fullscreenCanvas=!0,i._pixelRatio=1,i.inputManager=e,i.scaleManager=t.scaleManager,i._fullscreenCanvas=t.options.rendering.canvasFullscreen,i._pixelRatio=window.devicePixelRatio||1,i._rootContainer=t.layers.root,i._canvas=t.renderer.canvas,i._desktop=t.deviceManager.os.desktop,i}return __extends(i,n),i.prototype.update=function(){n.prototype.update.call(this),null!=this._touchEndTime&&this._touchEndTime<s.Time.now()&&(this._touchEndTime=null,this._touchInProgress=!1),this.isUp&&null!=this.identifier&&this.releasePointer()},i.prototype.isActive=function(){return this.mouseActive||null!=this.identifier},i.prototype.mousedown=function(t){this._touchInProgress||this.isDown||(n.prototype.ondown.call(this),this.downPosition.x=this.getXValue(t.pageX),this.downPosition.y=this.getYValue(t.pageY),this.position.x=this.downPosition.x,this.position.y=this.downPosition.y,this._lastMouseEvent=t)},i.prototype.mousemove=function(t){this.position.x=this.getXValue(t.pageX),this.position.y=this.getYValue(t.pageY),this._lastMouseEvent=t,this.mouseActive=!0},i.prototype.mouseup=function(t){this._touchInProgress||this.isUp||(n.prototype.onup.call(this),this.upPosition.x=this.getXValue(t.pageX),this.upPosition.y=this.getYValue(t.pageY),this._lastMouseEvent=t,this.inputManager.triggerImmediateClick())},i.prototype.touchdown=function(t){this.isDown||null==this.identifier&&(n.prototype.ondown.call(this),this._touchInProgress=!0,this._touchEndTime=null,this.identifier=t.identifier,this.downPosition.x=this.getXValue(t.pageX),this.downPosition.y=this.getYValue(t.pageY),this.position.x=this.downPosition.x,this.position.y=this.downPosition.y,this.acquirePointer())},i.prototype.touchmove=function(t){this.isDown&&this.identifier==t.identifier&&(this._touchInProgress=!0,this.position.x=this.getXValue(t.pageX),this.position.y=this.getYValue(t.pageY))},i.prototype.touchup=function(t){this.isUp||this.identifier==t.identifier&&(n.prototype.onup.call(this),this._touchInProgress=!0,this._touchEndTime=s.Time.now()+this._touchEndDebounce,this.upPosition.x=this.getXValue(t.pageX),this.upPosition.y=this.getYValue(t.pageY),this.inputManager.triggerImmediateClick())},i.prototype.getXValue=function(t){return Math.round((t-this.scaleManager.offsetX)/this.scaleManager.scale)},i.prototype.getYValue=function(t){return Math.round((t-this.scaleManager.offsetY)/this.scaleManager.scale)},i.pageXToGameX=function(t){var e=s.Game.get().scaleManager;return Math.round((t-e.offsetX)/e.scale)},i.pageYToGameY=function(t){var e=s.Game.get().scaleManager;return Math.round((t-e.offsetY)/e.scale)},i.prototype.acquirePointer=function(){this._previousHit=null,this._lastDownTarget=null,this._prevMousePosition.x=-1,this._prevMousePosition.y=-1,this._prevMouseBState=-1},i.prototype.releasePointer=function(){this.identifier=null},i.prototype.mouseChanged=function(){var t=!1,e=this.isDown?0:1,i=this.position.x,n=this.position.y;return e!=this._prevMouseBState&&(t=!0),t||this._prevMousePosition.x==i&&this._prevMousePosition.y==n||(t=!0),this._prevMouseBState=e,this._prevMousePosition.x=i,this._prevMousePosition.y=n,t},i.prototype._triggerMouseHit=function(){if(this.mouseChanged()){var t=new Array;if(i._collectInteractiveHit(this.position,this._rootContainer,t),0<t.length){var e=t[t.length-1];this.interactiveElement=e,this.isJustDown?(this._lastDownTarget=e).hasDownHandler()&&e.downHandler.fire():this.isJustUp&&e.hasUpHandler()&&e.upHandler.fire(),e!=this._previousHit&&(e.hasOverHandler()&&e.overHandler.fire(),null!=this._previousHit&&this._previousHit.hasOutHandler()&&this._previousHit.outHandler.fire()),this._previousHit=e}else(this.interactiveElement=null)!=this._previousHit&&this._previousHit.hasOutHandler()&&this._previousHit.outHandler.fire(),this._previousHit=null;this._desktop&&!this.inputManager.noCursor&&(null!=this._previousHit&&this._previousHit.showCursor?this._canvas.style.cursor="pointer":this._canvas.style.cursor="default")}},i.prototype._triggerImmediateClick=function(){var t=new Array;if(i._collectInteractiveHit(this.position,this._rootContainer,t),0<t.length){var e=t[t.length-1];e.hasClickHandler()&&(this.wasSwipe()||e.clickHandler.fire())}},i._collectInteractiveHit=function(t,e,i){if(e.visible){if(e.interactive)e.hitPoint(t)&&i.push(e);if(e.hasInteractiveChild)for(var n=e.getChildrenCount(),o=0;o<n;o++){var r=e.getChildAt(o);r instanceof s.Container?this._collectInteractiveHit(t,r,i):r.visible&&r.interactive&&r.hitPoint(t)&&i.push(r)}}},i.prototype.wasSwipe=function(){return 60<=s.Point.distance(this.upPosition,this.downPosition)},i.prototype.getLastMouseEvent=function(){return this._lastMouseEvent},i}(s.AbstractInput);s.PointerInput=t}(h5ge||(h5ge={})),function(i){var t=function(){function t(t){this._enabled=!0;var e=i.Game.get();e.addUpdatable(this),this._dragListener=t,this._pointer=e.inputManager.mouse.pointer}return t.prototype.enable=function(){this._enabled=!0},t.prototype.disable=function(){this._enabled=!1},t.prototype.onStateDown=function(t){if(null!=this._startDragController&&!this._startDragController(t))return;this._down||(this._previousPosition=new i.Point(t.x,t.y),this._down=!0,this._dragListener.onDragBegin(t))},t.prototype.hasMoved=function(t){if(this._down){var e=1<=Math.abs(t.x-this._previousPosition.x),i=1<=Math.abs(t.y-this._previousPosition.y);if(e||i)return!0}return!1},t.prototype.onStateMove=function(t){this._down&&this._dragListener.onDragMove(t.x-this._previousPosition.x,t.y-this._previousPosition.y,t),this._previousPosition=new i.Point(t.x,t.y)},t.prototype.onStateUp=function(t){this._down&&(this._down=!1,this._dragListener.onDragEnd(t))},t.prototype.update=function(t){this._enabled&&(this._pointer.isJustDown?this.onStateDown(this._pointer.downPosition):this._pointer.isJustUp?this.onStateUp(this._pointer.upPosition):this._pointer.isDown&&this.hasMoved(this._pointer.position)&&this.onStateMove(this._pointer.position))},t.prototype.destroy=function(){i.Game.get().removeUpdatable(this)},t.prototype.setStartDragController=function(t){this._startDragController=t},t}();i.DragManager=t}(h5ge||(h5ge={})),function(e){var t=function(){function t(t,e,i){this._x=t,this._y=e,this._radius=i}return t.prototype.containsPoint=function(t){var e=this.x-t.x,i=this.y-t.y;return e*e+i*i<=this._radius*this._radius},t.prototype.overlap=function(t){return e.Collisions.overlapCircles(this,t)},t.prototype.toString=function(){return this.x+","+this.y+" | "+this.radius},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"radius",{get:function(){return this._radius},set:function(t){this._radius=t},enumerable:!0,configurable:!0}),t}();e.Circle=t}(h5ge||(h5ge={})),function(f){var t=function(){function s(){}return s.rotateFromOrigin=function(t,e,i){return{x:t*Math.cos(i)-e*Math.sin(i),y:t*Math.sin(i)+e*Math.cos(i)}},s.rotate=function(t,e,i,n,o){var r=s.rotateFromOrigin(t-n,e-o,i);return r.x+=n,r.y+=o,r},s.clamp=function(t,e,i){return Math.max(e,Math.min(i,t))},s.clamp01=function(t){return this.clamp(t,0,1)},s.mod=function(t,e){return(t%e+e)%e},s.lerp=function(t,e,i){return i<=0?t:1<=i?e:(1-i)*t+i*e},s.inverseLerp=function(t,e,i){return t==e?0:(i-t)/(e-t)},s.sign=function(t){return 0<=t?1:-1},s.repeat=function(t,e){return this.mod(t,e)},s.pingPong=function(t,e){t<0&&(t=-t);var i=t%e;return Math.ceil(t/e)%2==0?0===i?0:e-i:0===i?e:i},s.map=function(t,e,i,n,o){return t<e?t=e:i<t&&(t=i),(t-e)*(o-n)/(i-e)+n},s.smoothDamp=function(t,e,i,n,o,r){var s=2/(n=Math.max(1e-4,n)),a=s*(r/=1e3),h=1/(1+a+.48*a*a+.235*a*a*a),c=t-e,l=e;if(null!=o){var u=o*n;c=f.Maths.clamp(c,-u,u)}var p=(i+s*c)*r;i=(i-s*p)*h;var d=(e=t-c)+(c+p)*h;return 0<l-t==l<d&&(i=((d=l)-l)/r),{smoothValue:d,newVelocity:i}},s.smoothDampAngle=function(t,e,i,n,o,r){return e=t+this.deltaAngle(t,e),this.smoothDamp(t,e,i,n,o,r)},s.deltaAngle=function(t,e){var i=f.Maths.repeat(e-t,this.PI2);return i>Math.PI&&(i-=this.PI2),i},s.PI2=2*Math.PI,s.PIPI=Math.PI*Math.PI,s.DEG_TO_RADIAN=Math.PI/180,s.RADIAN_TO_DEG=180/Math.PI,s}();f.Maths=t}(h5ge||(h5ge={})),function(e){var t=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._x=t,this._y=e}return t.prototype.copy=function(){return new t(this._x,this._y)},t.prototype.asVector=function(){return new e.Vector(this._x,this._y)},t.prototype.equals=function(t){return null!=t&&(this.x==t.x&&this.y==t.y)},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t},enumerable:!0,configurable:!0}),t.prototype.toString=function(){return this._x+","+this._y},t.distance=function(t,e){var i=0,n=0;return i=e.x-t.x,i*=i,n=e.y-t.y,n*=n,Math.sqrt(i+n)},t}();e.Point=t}(h5ge||(h5ge={})),function(h){var t=function(){function r(){this._localVertices=[],this._rotation=0,this._dirty=!0,this._dirtyBounds=!0,this._transformedVertices=[],this._pivot=new h.Point(0,0),this._position=new h.Point(0,0)}return r.prototype.addVertice=function(t){this._localVertices.push(t),this._transformedVertices.push(t.copy()),this._dirty=!0},r.fromValues=function(t){for(var e=new r,i=0;i<t.length;i+=2){var n=t[i],o=t[i+1];e.addVertice2(n,o)}return e},r.fromRectangle=function(t){var e=new r;return e.addVertice2(0,0),e.addVertice2(t.width,0),e.addVertice2(t.width,t.height),e.addVertice2(0,t.height),e.setPosition(t.x,t.y),e},r.prototype.addVertice2=function(t,e){this.addVertice(new h.Point(t,e))},r.prototype.getVertices=function(){return this._localVertices},r.prototype.getTransformedVertices=function(){if(!this._dirty)return this._transformedVertices;this._dirty=!1,this._dirtyBounds=!0;for(var t=Math.cos(this._rotation*h.Maths.DEG_TO_RADIAN),e=Math.sin(this._rotation*h.Maths.DEG_TO_RADIAN),i=0;i<this._localVertices.length;i++){var n=this._localVertices[i],o=n.x-this._pivot.x,r=n.y-this._pivot.y;if(0!=this._rotation){var s=o;o=t*o-e*r,r=e*s+t*r}var a=this._transformedVertices[i];a.x=this._position.x+this._pivot.x+o,a.y=this._position.y+this._pivot.y+r}return this._transformedVertices},r.prototype.getAABB=function(){if(!this._dirty&&!this._dirtyBounds)return this._transformedBounds;var t=this.getTransformedVertices();null==this._transformedBounds&&(this._transformedBounds=new h.Rectangle(0,0,0,0));for(var e=t[0].x,i=t[0].y,n=t[0].x,o=t[0].y,r=1;r<t.length;r++){var s=t[r];e=Math.min(e,s.x),i=Math.min(i,s.y),n=Math.max(n,s.x),o=Math.max(o,s.y)}return this._transformedBounds.x=e,this._transformedBounds.y=i,this._transformedBounds.width=n-e,this._transformedBounds.height=o-i,this._dirtyBounds=!1,this._transformedBounds},r.prototype.overlap=function(t){return h.Collisions.overlapPolygons(this,t)},r.prototype.setPivot=function(t,e){this.pivotX=t,this.pivotY=e,this._dirty=!0},r.prototype.setPosition=function(t,e){this.positionX=t,this.positionY=e,this._dirty=!0},r.prototype.getProjection=function(t){for(var e=this.getTransformedVertices(),i=t.dot2(e[0].x,e[0].y),n=i,o=1;o<e.length;o++){var r=e[o],s=t.dot2(r.x,r.y);s<i?i=s:n<s&&(n=s)}return new h.Range(i,n)},Object.defineProperty(r.prototype,"pivotX",{get:function(){return this._pivot.x},set:function(t){this._pivot.x=t,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"pivotY",{get:function(){return this._pivot.y},set:function(t){this._pivot.y=t,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"positionX",{get:function(){return this._position.x},set:function(t){this._position.x=t,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"positionY",{get:function(){return this._position.y},set:function(t){this._position.y=t,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation=t,this._dirty=!0},enumerable:!0,configurable:!0}),r}();h.Polygon=t}(h5ge||(h5ge={})),function(t){var e=function(){function i(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.min=t,this.max=e}return i.prototype.overlap=function(t){return t.min<=this.max&&this.min<=t.max},i.prototype.sort=function(){if(this.min>this.max){var t=this.min;this.min=this.max,this.max=t}},i.prototype.copy=function(t){this.min=t.min,this.max=t.max},i.prototype.clone=function(){return new i(this.min,this.max)},i.prototype.combine=function(t){var e=new i;return e.min=this.min,e.max=this.max,t.min<this.min&&(e.min=t.min),t.max>this.max&&(e.max=t.max),e},i.prototype.extend=function(t){t>this.max?this.max=t:t<this.min&&(this.min=t)},i.prototype.clamp=function(t){return t<this.min?this.min:t>this.max?this.max:t},i}();t.Range=e}(h5ge||(h5ge={})),function(e){var t=function(){function t(t,e,i,n){this._left=t,this._top=e,this._width=i,this._height=n}return t.prototype.getCenter=function(){return new e.Point(this._left+Math.round(this._width/2),this._top+Math.round(this._height/2))},t.prototype.containsPoint=function(t){return this.containsPoint2(t.x,t.y)},t.prototype.containsPoint2=function(t,e){return t>=this.left&&t<=this.right&&(e>=this.top&&e<=this.bottom)},t.prototype.overlap=function(t){return e.Collisions.overlapRectangles(this,t)},t.prototype.toString=function(){return this.x+","+this.y+" | "+this._width+","+this._height},t.prototype.copy=function(){return new t(this._left,this._top,this._width,this._height)},Object.defineProperty(t.prototype,"x",{get:function(){return this._left},set:function(t){this._left=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){return this._left},set:function(t){this._left=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this._left+this._width},set:function(t){this._left=t-this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._top},set:function(t){this._top=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this._top},set:function(t){this._top=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this._top+this._height},set:function(t){this._top=t-this._height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t},enumerable:!0,configurable:!0}),t}();e.Rectangle=t}(h5ge||(h5ge={})),function(s){var t=function(){function i(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._x=t,this._y=e}return i.prototype.copy=function(){return new i(this._x,this._y)},i.prototype.copy2=function(t){this._x=t.x,this._y=t.y},i.prototype.clone=function(){return new i(this._x,this._y)},i.prototype.length=function(){return Math.sqrt(this._x*this._x+this._y*this._y)},i.prototype.mag=function(){return this.length()},i.prototype.magSq=function(){return this.lengthApprox()},i.prototype.lengthApprox=function(){return this._x*this._x+this._y*this._y},i.prototype.sub=function(t){this._x-=t.x,this._y-=t.y},i.sub=function(t,e){return new i(t.x-e.x,t.y-e.y)},i.prototype.sub2=function(t,e){this._x-=t,this._y-=e},i.prototype.add=function(t){this._x+=t.x,this._y+=t.y},i.prototype.minus=function(t){this._x-=t.x,this._y-=t.y},i.prototype.add2=function(t,e){this._x+=t,this._y+=e},i.prototype.dot=function(t){return this._x*t.x+this._y*t.y},i.prototype.dot2=function(t,e){return this._x*t+this._y*e},i.prototype.angle=function(t){var e=this.cross(t),i=this.dot(t);return Math.atan2(e,i)},i.prototype.project=function(t){var e=this.dot(t),i=t.clone();return i.scale1(e),i},i.prototype.scale=function(t){this.x*=t.x,this.y*=t.y},i.prototype.scale1=function(t){this.x*=t,this.y*=t},i.prototype.scale2=function(t,e){this.x*=t,this.y*=e},i.prototype.cross=function(t){return this.x*t.y-this.y*t.x},i.prototype.cross2=function(t,e){return this.x*e-this.y*t},i.prototype.perp=function(){var t=this._y;this.y=-this._x,this.x=t},i.prototype.normalize=function(){var t=this.length();this.x/=t,this.y/=t},i.prototype.rotate=function(t){var e=s.Maths.DEG_TO_RADIAN*t,i=Math.cos(e),n=Math.sin(e),o=this.x*i-this.y*n,r=this.x*n+this.y*i;this.x=o,this.y=r},i.prototype.rotate2=function(t){var e=Math.cos(t),i=Math.sin(t),n=e*this.x+i*this.y,o=e*this.y-i*this.x;this.x=n,this.y=o},i.prototype.rotate90=function(){var t=-this.y,e=this.x;this.x=t,this.y=e},i.prototype.unit=function(){var t=this.length();0!=t?(this.x=this.x/t,this.y=this.y/t):(this.x=0,this.y=0)},Object.defineProperty(i.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t},enumerable:!0,configurable:!0}),i.prototype.toString=function(){return"("+this._x+","+this._y+")"},i}();s.Vector=t}(h5ge||(h5ge={})),function(t){var e=function(){function h(t){this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0,this.context=t||null,t&&t.setTransform(1,0,0,1,0,0)}return h.prototype.toString=function(){return"["+this.a+","+this.b+","+this.c+","+this.d+","+this.e+","+this.f+"]"},h.prototype.flipX=function(){return this.transform(-1,0,0,1,0,0),this},h.prototype.flipY=function(){return this.transform(1,0,0,-1,0,0),this},h.prototype.reset=function(){return this.a=this.d=1,this.b=this.c=this.e=this.f=0,this._setCtx(),this},h.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t);return this.transform(e,i,-i,e,0,0),this},h.prototype.rotateDeg=function(t){return this.rotate(.017453292519943295*t),this},h.prototype.scale=function(t,e){return this.transform(t,0,0,e,0,0),this},h.prototype.scaleX=function(t){return this.transform(t,0,0,1,0,0),this},h.prototype.scaleY=function(t){return this.transform(1,0,0,t,0,0),this},h.prototype.skew=function(t,e){return this.transform(1,e,t,1,0,0),this},h.prototype.skewX=function(t){return this.transform(1,0,t,1,0,0),this},h.prototype.skewY=function(t){return this.transform(1,t,0,1,0,0),this},h.prototype.setTransform=function(t,e,i,n,o,r){return this.a=t,this.b=e,this.c=i,this.d=n,this.e=o,this.f=r,this._setCtx(),this},h.prototype.translate=function(t,e){return this.transform(1,0,0,1,t,e),this},h.prototype.translateX=function(t){return this.transform(1,0,0,1,t,0),this},h.prototype.translateY=function(t){return this.transform(1,0,0,1,0,t),this},h.prototype.transform=function(t,e,i,n,o,r){var s=this.a,a=this.b,h=this.c,c=this.d,l=this.e,u=this.f;return this.a=s*t+h*e,this.b=a*t+c*e,this.c=s*i+h*n,this.d=a*i+c*n,this.e=s*o+h*r+l,this.f=a*o+c*r+u,this._setCtx(),this},h.prototype.getInverse=function(){var t=this.a,e=this.b,i=this.c,n=this.d,o=this.e,r=this.f,s=new h,a=t*n-e*i;return s.a=n/a,s.b=-e/a,s.c=-i/a,s.d=t/a,s.e=(i*r-n*o)/a,s.f=-(t*r-e*o)/a,s},h.prototype.interpolate=function(t,e){var i=new h;return i.a=this.a+(t.a-this.a)*e,i.b=this.b+(t.b-this.b)*e,i.c=this.c+(t.c-this.c)*e,i.d=this.d+(t.d-this.d)*e,i.e=this.e+(t.e-this.e)*e,i.f=this.f+(t.f-this.f)*e,i},h.prototype.applyToPoint=function(t,e){return{x:t*this.a+e*this.c+this.e,y:t*this.b+e*this.d+this.f}},h.prototype.applyToArray=function(t){for(var e,i=0,n=t.length,o=new Array(n);i<n;)e=this.applyToPoint(t[i],t[i+1]),o[i++]=e.x,o[i++]=e.y;return o},h.prototype.applyToContext=function(t){return t.setTransform(this.a,this.b,this.c,this.d,this.e,this.f),this},h.prototype.isIdentity=function(){return this._isEqual(this.a,1)&&this._isEqual(this.b,0)&&this._isEqual(this.c,0)&&this._isEqual(this.d,1)&&this._isEqual(this.e,0)&&this._isEqual(this.f,0)},h.prototype.isEqual=function(t){return this._isEqual(this.a,t.a)&&this._isEqual(this.b,t.b)&&this._isEqual(this.c,t.c)&&this._isEqual(this.d,t.d)&&this._isEqual(this.e,t.e)&&this._isEqual(this.f,t.f)},h.prototype._isEqual=function(t,e){return Math.abs(t-e)<1e-14},h.prototype._setCtx=function(){this.context&&this.context.setTransform(this.a,this.b,this.c,this.d,this.e,this.f)},h}();t.Matrix=e}(h5ge||(h5ge={})),function(t){var e=function(){function r(){}return r.overlapCircles=function(t,e){return this.overlapCircles2(t,e.x,e.y,e.radius)},r.overlapCircles2=function(t,e,i,n){var o=t.x-e,r=t.y-i;return Math.sqrt(o*o+r*r)<t.radius+n},r.overlapRectangles=function(t,e){return t.left<e.right&&t.right>e.left&&t.top<e.bottom&&t.bottom>e.top},r.overlapPolygonRectangle=function(t,e){t.getTransformedVertices();return!0},r.overlapPolygons=function(t,e){var i=t.getAABB(),n=e.getAABB(),o=r.overlapRectangles(i,n);return!!o&&(!!(o=this.overlapPolygons0(t,e))&&(o=this.overlapPolygons0(e,t)))},r.overlapPolygons0=function(t,e){for(var i=t.getTransformedVertices(),n=0;n<i.length;n++){var o=i[n].asVector(),r=i[n+1==i.length?0:n+1];o.sub2(r.x,r.y),o.perp(),o.normalize();var s=t.getProjection(o),a=e.getProjection(o);if(!s.overlap(a))return!1}return!0},r.pointInPolygon=function(t,e,i){var n=t.getVertices().length,o=t.getVertices(),r=0,s=n-1,a=!1;for(r=0;r<n;r++)(o[r].y<i&&o[s].y>=i||o[s].y<i&&o[r].y>=i)&&o[r].x+(i-o[r].y)/(o[s].y-o[r].y)*(o[s].x-o[r].x)<e&&(a=!a),s=r;return a},r.pointInPolygon2=function(t,e,i){var n=t.length,o=0,r=t.length-2,s=!1;for(o=0;o<n;o+=2)(t[o+1]<i&&t[r+1]>=i||t[r+1]<i&&t[o+1]>=i)&&t[o]+(i-t[o+1])/(t[r+1]-t[o+1])*(t[r]-t[o])<e&&(s=!s),r=o;return s},r}();t.Collisions=e}(h5ge||(h5ge={})),function(t){var e=function(){function t(){}return t.prototype.get=function(t,e,i){var n=this;this.initHTTPRequest(i),this._xhr_object&&(n._xhr_object.open("GET",t,!0),n._xhr_object.onreadystatechange=function(){4==n._xhr_object.readyState&&(200==n._xhr_object.status||window.cordova?e(n._xhr_object.responseText):i("invalid status: "+n._xhr_object.status+" text="+n._xhr_object.responseText+" statusText: "+n._xhr_object.statusText),n._xhr_object.onreadystatechange=null),n._xhr_object.readyState<=0&&(i("invalid ready state: "+n._xhr_object.readyState),n._xhr_object.onreadystatechange=null)},this._xhr_object.onerror=function(t){i("XHR onerror statusText: "+n._xhr_object.statusText)},this._xhr_object.send(null))},t.prototype.initHTTPRequest=function(t){if(window.XMLHttpRequest)this._xhr_object=new XMLHttpRequest;else{if(!window.ActiveXObject)return void t("Not Supported");this._xhr_object=new ActiveXObject("Microsoft.XMLHTTP")}},t.prototype.post=function(t,e,i,n){var o=this;this.initHTTPRequest(n),this._xhr_object&&(o._xhr_object.open("POST",t,!0),o._xhr_object.onreadystatechange=function(){4==o._xhr_object.readyState&&(200==o._xhr_object.status?(i(o._xhr_object.responseText),o._xhr_object.onreadystatechange=null):n("invalid status: "+o._xhr_object.status)),o._xhr_object.readyState<=0&&(n("invalid ready state: "+o._xhr_object.readyState),o._xhr_object.onreadystatechange=null)},this._xhr_object.setRequestHeader("Content-type","application/x-www-form-urlencoded"),this._xhr_object.send(e))},t}();t.HttpRequest=e}(h5ge||(h5ge={})),function(b){var t=function(r){function t(t,e,i){var n=r.call(this)||this;n._missingChar=!1,n._ratio=1,n._align="left",n._maxWidth=1e4,n._dirty=!0;var o=b.Resources.fonts[e];if(null==o)throw new Error("Font not loaded: "+e);return n._fontName=e,n._font=o,n._text=t,n._size=null==i?o.size:i,n._ratio=n._size/o.size,n._debugId="Text-"+n._id,n}return __extends(t,r),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(t){t!=this._text&&(this._text=t,this._dirty=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"align",{get:function(){return this._align},set:function(t){this._align=t,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(t){this._maxWidth=t,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._dirty&&this.create(),this._width*this._scaleX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._dirty&&this.create(),this._height*this._scaleY},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tint",{set:function(t){this._tint=null==t?16777215:t,this._dirty=!0},enumerable:!0,configurable:!0}),t.prototype.hasMissingChar=function(){return this._dirty&&this.create(),this._missingChar},t.prototype.draw0=function(t){this._dirty&&(this.create(),this._dirty=!1),r.prototype.draw0.call(this,t)},t.prototype.create=function(){this.removeChildren(),null!=this.text&&""!=this.text||this.setSize(0,0),this._missingChar=!1;var t=[],e=0,i={width:0,letters:[],xposition:[]};t.push(i);for(var n=-1,o=0,r=0;r<this._text.length;r++){if(10!=(g=this._text.charCodeAt(r)))if(null!=(m=this._font.lettersByCode[g])){32==g&&(n=0,e),-1<n&&n++,i.letters.push(m),i.xposition.push(e),e+=this.getLetterWidthToDraw(m),i.width=e;var s=m.yoffset+m.height;if(o<s&&(o=s),0<this._maxWidth&&e>this._maxWidth&&0<n){var a=i.letters.length-n;i.letters.splice(a,n),i.xposition.splice(a,n);var h=i.xposition[a-1]+this.getLetterWidthToDraw(i.letters[a-1]);i.width=h,r=r-n+1,i={width:0,letters:[],xposition:[]},t.push(i),e=0,n=-1}}else this._missingChar=!0;else i={width:0,letters:[],xposition:[]},t.push(i),e=0,n=-1}var c=0;for(r=0;r<t.length;r++){var l=t[r];c=Math.max(l.width,c)}var u=Math.ceil(c),p=t.length<=1?this.normalizeSize(o):this.normalizeSize(this._font.lineHeight),d=Math.ceil(t.length*p);this.setSize(u,d);var f=0;for(r=0;r<t.length;r++){l=t[r];var y=0;"center"==this._align?y=(c-l.width)/2:"right"==this._align&&(y=c-l.width);for(var g=0;g<l.letters.length;g++){var m=l.letters[g],v=l.xposition[g];if(v+=y,0<m.width&&0<m.height){var S=this._font.textureByCode[m.id];if(16777215!=this._tint)S=b.Tinter.tint(S,this._tint,!0);var _=new b.Sprite(S);_.scaleXY=this._ratio,_.x=v+m.xoffset*this._ratio,_.y=f+m.yoffset*this._ratio,this.addChild(_)}}f+=p}},t.prototype.normalizeSize=function(t){return t*this._ratio},t.prototype.getLetterWidthToDraw=function(t){return 32==t.id?t.xadvance*this._ratio:(t.xoffset+t.width)*this._ratio},t}(b.Container);b.BitmapText=t}(h5ge||(h5ge={})),function(o){var t=function(){function n(t,e){if(this._game=o.Game.get(),null!=this._game.options.rendering&&null!=this._game.options.rendering.canvasId){var i=this._game.options.rendering.canvasId;if(this.canvas=document.getElementById(i),null==this.canvas)throw new Error("Unable to find canvas: "+i)}else this.canvas=document.createElement("canvas"),this.canvas.style.position="absolute",document.body.appendChild(this.canvas);this.canvas.width=t,this.canvas.height=e,this._context2D=this.canvas.getContext("2d"),null!=this._game.options.rendering&&null!=this._game.options.rendering.backgroundColor&&0<=this._game.options.rendering.backgroundColor&&(this._backgroundColor=o.Colors.toString(this._game.options.rendering.backgroundColor)),n._applyStyle(this.canvas)}return n.prototype.beginDraw=function(){null!=this._backgroundColor?(this._context2D.fillStyle=this._backgroundColor,this._context2D.fillRect(0,0,this.canvas.width,this.canvas.height)):this._context2D.clearRect(0,0,this.canvas.width,this.canvas.height)},n.prototype.endDraw=function(){},Object.defineProperty(n.prototype,"context",{get:function(){return this._context2D},enumerable:!0,configurable:!0}),n._applyStyle=function(e){["-webkit-","-khtml-","-moz-","-ms-",""].forEach(function(t){e.style[t+"user-select"]="none"}),e.style["-webkit-touch-callout"]="none",e.style["-webkit-tap-highlight-color"]="rgba(0, 0, 0, 0)"},n}();o.GameCanvas=t}(h5ge||(h5ge={})),function(o){var t=function(n){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var i=n.call(this)||this;return i._ops=new Array,i._debugId="Graphics-"+i._id,i._width=t,i._height=e,i}return __extends(t,n),t.prototype.customDraw=function(t){return this._ops.push(t),this},t.prototype.beginFill=function(e,i){return void 0===i&&(i=1),this._ops.push(function(t){t.fillStyle=o.Colors.toString(e,i),t.beginPath()}),this},t.prototype.beginStroke=function(e,i,n){void 0===n&&(n=1);return this._ops.push(function(t){t.lineWidth=e,t.strokeStyle=o.Colors.toString(i,n),t.beginPath()}),this},t.prototype.endStroke=function(){return this._ops.push(function(t){t.stroke()}),this},t.prototype.endFill=function(){return this._ops.push(function(t){t.fill()}),this},t.prototype.moveTo=function(e,i){return this._ops.push(function(t){t.moveTo(e,i)}),this},t.prototype.lineTo=function(e,i){return this._ops.push(function(t){t.lineTo(e,i)}),this},t.prototype.quadraticCurveTo=function(e,i,n,o){return this._ops.push(function(t){t.quadraticCurveTo(e,i,n,o)}),this},t.prototype.bezierCurveTo=function(e,i,n,o,r,s){return this._ops.push(function(t){t.bezierCurveTo(e,i,n,o,r,s)}),this},t.prototype.arcTo=function(e,i,n,o,r){return this._ops.push(function(t){t.arcTo(e,i,n,o,r)}),this},t.prototype.arc=function(e,i,n,o,r,s){return void 0===o&&(o=0),void 0===r&&(r=2*Math.PI),this._ops.push(function(t){t.arc(e,i,n,o,r,s)}),this},t.prototype.drawRect=function(e,i,n,o){return this._ops.push(function(t){t.rect(e,i,n,o)}),this},t.prototype.drawRoundedRect=function(e,i,n,o,r){return this._ops.push(function(t){t.moveTo(e+r,i),t.lineTo(e+n-r,i),t.quadraticCurveTo(e+n,i,e+n,i+r),t.lineTo(e+n,i+o-r),t.quadraticCurveTo(e+n,i+o,e+n-r,i+o),t.lineTo(e+r,i+o),t.quadraticCurveTo(e,i+o,e,i+o-r),t.lineTo(e,i+r),t.quadraticCurveTo(e,i,e+r,i)}),this},t.prototype.drawCircle=function(e,i,n){return this._ops.push(function(t){t.arc(e,i,n,0,2*Math.PI)}),this},t.prototype.clear=function(){return this._ops.length=0,this},t.prototype.createCachedTexture=function(){var t=document.createElement("canvas");t.width=this._width,t.height=this._height,0!=this._width&&0!=this._height||o.logger.warn("Caching graphics without size.");var e=t.getContext("2d");this.draw0(e),this._cachedTexture=new o.Texture("graphics",0,0,this._width,this._height),this._cachedTexture.setImpl(t)},t.prototype.draw0=function(e){this._ops.forEach(function(t){t(e)})},t.prototype.setSize=function(t,e){this._width=t,this._height=e},t}(o.DisplayObject);o.Graphics=t}(h5ge||(h5ge={})),function(t){var e=function(){function t(){}return t.prototype.render=function(t){var e=document.createElement("canvas"),i=e.getContext("2d");e.width=t.x+t.width,e.height=t.y+t.height;var n=t._parent;return t._parent=null,t.draw(i),t._parent=n,e.toDataURL("image/png")},t}();t.RenderTexture=e}(h5ge||(h5ge={})),function(s){var a,t=function(r){function t(t,e,i,n){void 0===n&&(n=16777215);var o=r.call(this)||this;return o._text=t,o._fontName=e,o._fontSize=i,o._color=n,o._align="left",o._dirty=!0,o._heightRatio=1.4,o._font=i+"px "+e,o._debugId="Text-"+o._id,o._colorString=s.Colors.toHexString(n),o}return __extends(t,r),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(t){t!=this._text&&(this._text=t,this._dirty=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._dirty&&this.create(),this._width*this._scaleX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._dirty&&this.create(),this._height*this._scaleY},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"align",{get:function(){return this._align},set:function(t){this._align=t,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"color",{set:function(t){this.color=null==t?16777215:t,this._colorString=s.Colors.toHexString(t),this._dirty=!0},enumerable:!0,configurable:!0}),t.prototype.draw0=function(t){this._dirty&&(this.create(),this._dirty=!1),null!=this._canvas&&0!=this._height&&0!=this._width&&(r.prototype.draw0.call(this,t),t.drawImage(this._canvas,0,0))},t.prototype.setFontStyle=function(t){t.textBaseline="alphabetic",t.font=this._font,t.fillStyle=this._colorString},t.prototype.create=function(){if(null==this.text||""==this.text)return this._width=0,this._height=0,void(this._canvas=null);if(null!=this._canvas&&(this._canvas=null),this._canvas=document.createElement("canvas"),0<this._text.indexOf("\n"))this.createMultiline();else{var t=this._canvas.getContext("2d");this.setFontStyle(t);var e=t.measureText(this._text).width,i=p(this._fontName,this._fontSize);this._canvas.width=e,this._canvas.height=i*this._heightRatio,this._width=this._canvas.width,this._height=this._canvas.height,this.setFontStyle(t),t.fillText(this._text,0,i)}},t.prototype.createMultiline=function(){var t=this._canvas.getContext("2d"),e=this._text.split("\n"),i=p(this._fontName,this._fontSize),n=i*this._heightRatio,o=0,r=[];this.setFontStyle(t);for(var s=0;s<e.length;s++){var a=e[s],h=t.measureText(a).width;r.push({x:0,y:s*n,width:h}),o=Math.max(o,h)}this._canvas.width=o,this._canvas.height=n*r.length,this._width=this._canvas.width,this._height=this._canvas.height;for(s=0;s<r.length;s++){a=r[s];var c=e[s],l=s*n,u=(h=a.width,0);"center"==this._align?u=(o-h)/2:"right"==this.align&&(u=o-h),this.setFontStyle(t),t.fillText(c,u,l+i)}},t}(s.DisplayObject);function p(t,e){null==a&&(a=new s.HashMap);var i=t+e,n=a.get(i);if(null!=n)return n;var o=document.createElement("div");o.innerHTML="(|MÃ‰qgy",o.style.position="absolute",o.style.top="-9999px",o.style.left="-9999px",o.style.fontFamily=t,o.style.fontWeight="normal",o.style.fontSize=e+"px",document.body.appendChild(o);var r=o.offsetHeight;return a.put(i,r),document.body.removeChild(o),r}s.Text=t}(h5ge||(h5ge={})),function(t){var e=function(){function t(){this._data={},this._size=0}return t.prototype.isEmpty=function(){return 0==this._size},t.prototype.size=function(){return this._size},t.prototype.clear=function(){this._data={},this._size=0},t.prototype.containsKey=function(t){return null!=this._data[t]},t.prototype.get=function(t){return this._data[t]},t.prototype.put=function(t,e){var i=this._data[t];return this._data[t]=e,null==i&&this._size++,i},t.prototype.remove=function(t){var e=this._data[t];return null!=e&&(delete this._data[t],this._size--),e},t.prototype.removeValues=function(t){var e=[];for(var i in this._data){var n=this._data[i];null!=n&&n==t&&e.push(i)}for(var o=0;o<e.length;o++)this.remove(e[o])},t.prototype.keys=function(){var t=[];for(var e in this._data)t.push(e);return t},t.prototype.values=function(){var t=[];for(var e in this._data){var i=this._data[e];null!=i&&t.push(i)}return t},t.prototype.forEach=function(t,e){for(var i in this._data){var n=this._data[i];if(null!=n)if(!1===t.call(e,i,n))break}},t.prototype.computeIfAbsent=function(t,e){var i=this.get(t);if(null!=i)return i;var n=e(t);return this.put(t,n),n},t}();t.HashMap=e}(h5ge||(h5ge={})),function(o){var r,t;(t=r=o.TextureType||(o.TextureType={}))[t.IMG=0]="IMG",t[t.CANVAS=1]="CANVAS";var e=function(){function a(t,e,i,n,o){this.name=t,this.x=e,this.y=i,this.width=n,this.height=o,this._type=r.IMG,this._loaded=!1}return a.prototype.setTrim=function(t,e,i,n){this._trim=new o.Rectangle(t,e,i,n)},a.prototype.getTrim=function(){return this._trim},a.prototype.getFrameTexture=function(t,e,i,n,o){if(o&&a.containsTexture(o))return a.getTexture(o);var r=this._trim;r&&(t+=r.x,e+=r.y);var s=new a(o||"useless",t,e,i,n);return s.setImpl(this._impl),s.setTrim(0,0,i,n),o&&a.addTexture(s),s},Object.defineProperty(a.prototype,"trimmed",{get:function(){return null!=this._trim},set:function(t){throw new Error("trimmed is read-only")},enumerable:!0,configurable:!0}),a.addTexture=function(t){a.textures.put(t.name,t)},a.getTexture=function(t){var e=a.textures.get(t);if(null==e)throw new Error("Texture "+t+" not loaded.");return e},a.containsTexture=function(t){return a.textures.get(t)},a.fromFrame=function(t){return a.getTexture(t)},a.fromImage=function(t){var e=a.containsTexture(t);return null!=e?e:e=new o.HImage(t,t).getTexture()},a.fromFrames=function(t){var e=[];return t.forEach(function(t){e.push(a.fromFrame(t))}),e},a.prototype.setLoaded=function(t){(this._loaded=t)&&null!=this._loadedHadler&&this._loadedHadler.fire()},a.prototype.isLoaded=function(){return this._loaded},a.prototype.setImpl=function(t){this._impl=t},a.prototype.getImpl=function(){return this._impl},a.prototype.addLoadedHandler=function(t){this._loaded?t():(null==this._loadedHadler&&(this._loadedHadler=new o.HandlerCollection),this._loadedHadler.once(t))},a.textures=new o.HashMap,a}();o.Texture=e}(h5ge||(h5ge={})),function(t){var e=function(){function t(){this._success=!1,this._failed=!1}return t.prototype.onSuccess0=function(){this._success=!0,null!=this._onSuccess&&this._onSuccess()},t.prototype.onFailed0=function(){this._failed=!0,null!=this._onFailed&&this._onFailed()},t.prototype.onSuccess=function(t){this._onSuccess=t,this._success&&t()},t.prototype.onFailed=function(t){this._onFailed=t,this._failed&&t()},t.prototype.isSuccess=function(){return this._success},t.prototype.isFailed=function(){return this._failed},t.prototype.isTerminated=function(){return 1==this._success||1==this._failed},t}();t.AbstractLoadingResource=e}(h5ge||(h5ge={})),function(o){var t=function(n){function t(t){var e=n.call(this)||this;e.file=t;var i=e;return o.LoaderProxy.get().loadXHR(e.file,function(t){i.data=t,i.onSuccess0()},function(t){o.logger.error("Can't load "+i.file+", reason: "+t),i.onFailed0()}),e}return __extends(t,n),t.prototype.getAssetDef=function(){return{type:"file",name:this.file,file:this.file}},t}(o.AbstractLoadingResource);o.FileResource=t}(h5ge||(h5ge={})),function(c){var t=function(s){function t(t,e,i){var n=s.call(this)||this;n._name=t,n._img=e,n._def=i;var o=n,r=new c.WaitQueue(2);return r.onComplete=function(){o.onAllLoaded()},n.chars=[],n.lettersByCode=new Array(65e3),n.textureByCode=new Array(65e3),n._atlas=new c.FileResource(i),n._image=c.Resources.addImage(t,e),n.resource=n._image.resource,n._atlas.onSuccess(function(){r.resolve(0,null)}),n._atlas.onFailed(function(){r.resolve(0,null)}),n._image.onSuccess(function(){r.resolve(1,null)}),n._image.onFailed(function(){r.resolve(1,null)}),n}return __extends(t,s),t.prototype.onAllLoaded=function(){this._image.isTerminated()&&this._atlas.isTerminated()?this._image.isSuccess()&&this._atlas.isSuccess()?(this.createFont(),this.onSuccess0()):this.onFailed0():c.logger.error("Bad font loading. Image and atlas should be success/failed here")},t.prototype.createFont=function(){var t;window.DOMParser?t=(new DOMParser).parseFromString(this._atlas.data,"text/xml"):((t=new ActiveXObject("Microsoft.XMLDOM")).async=!1,t.loadXML(this._atlas.data));var e=t.getElementsByTagName("font")[0],i=e.getElementsByTagName("info")[0],n=e.getElementsByTagName("common")[0];this.size=parseInt(i.getAttribute("size")),this.lineHeight=parseInt(n.getAttribute("lineHeight"));for(var o=e.getElementsByTagName("char"),r=0;r<o.length;r++){var s=o[r],a={id:parseInt(s.getAttribute("id")),x:parseInt(s.getAttribute("x")),y:parseInt(s.getAttribute("y")),xoffset:parseInt(s.getAttribute("xoffset")),yoffset:parseInt(s.getAttribute("yoffset")),width:parseInt(s.getAttribute("width")),height:parseInt(s.getAttribute("height")),xadvance:parseInt(s.getAttribute("xadvance"))};this.lettersByCode[a.id]=a;var h=new c.Texture(this._name+"/"+a.id,a.x,a.y,a.width,a.height);h.setImpl(this.resource),this.textureByCode[a.id]=h,this.chars.push(a.id)}},t.prototype.getAssetDef=function(){return{type:"font",name:this._name,file:this._img,atlas:this._def}},t}(c.AbstractLoadingResource);c.HFont=t}(h5ge||(h5ge={})),function(p){var t=function(){function i(){}return i.loadAll=function(t){for(var e=0;e<t.length;e++)i.load(t[e])},i.load=function(t){var e=p.Sprite.fromFrame(t.face+".png"),i=new Array,n=new Array(65e3),o=new Array(65e3),r={size:t.size,lettersByCode:n,lineHeight:t.lineHeight,textureByCode:o,chars:i,resource:e.texture.getImpl()},s=e.texture.x,a=e.texture.y;e.texture.trimmed&&(s-=e.texture.getTrim().x,a-=e.texture.getTrim().y);for(var h=0;h<t.chars.length;h++){var c=t.chars[h],l={id:c.id,x:c.x+s,y:c.y+a,xoffset:c.xoffset,yoffset:c.yoffset,width:c.width,height:c.height,xadvance:c.xadvance},u=new p.Texture(t.face+"/"+l.id,l.x,l.y,l.width,l.height);u.setImpl(e.texture.getImpl()),n[c.id]=l,o[c.id]=u,i.push(c.id)}p.Resources.addLoadedFont(t.face,r)},i}();p.FontLoader=t}(h5ge||(h5ge={})),function(s){var t=function(r){function t(t,e){var i=r.call(this)||this;i._name=t,i._src=e,i.created=!1;var n=i,o=s.LoaderProxy.get();return i.resource=new Image,i._texture=new s.Texture(i._name,0,0,0,0),i._texture.setImpl(i.resource),s.Texture.addTexture(i._texture),o.loadImage(i.resource,e),i.resource.onload=function(){n.onSuccess0()},i.resource.onerror=function(){n.onFailed0()},i.resource.complete&&n.onSuccess0(),i}return __extends(t,r),t.prototype.onSuccess0=function(){this.createTexture(),r.prototype.onSuccess0.call(this)},t.prototype.createTexture=function(){this.created||(this._texture.x=0,this._texture.y=0,this._texture.width=this.resource.width,this._texture.height=this.resource.height,this._texture.setLoaded(!0),this.created=!0)},t.prototype.getTexture=function(){return this._texture},t.prototype.getAssetDef=function(){return{type:"img",name:this._name,file:this._src}},t}(s.AbstractLoadingResource);s.HImage=t}(h5ge||(h5ge={})),function(s){var t=function(){function e(t,e){void 0===e&&(e=3),this._ressources=t,this._retryAttempt=e,this._state=0,this._failedResources=[],this._successResources=[],this._attempt=0,this._progressHandler=new s.HandlerCollection}return e.prototype.load=function(t){this._completeCb=t,this._timer=s.TimeManager.get().createTimer(100,this.checkLoaded,this),this._timer.setRepeat(-1),this._timer.start(),this.load0()},e.prototype.getResourcesLoaded=function(){return this._successResources},e.prototype.checkLoaded=function(){if(1==this._state){for(var t=this,e=!1,i=this._loadingResources.length-1;0<=i;i--){var n=this._loadingResources[i];n.isTerminated()&&(this._loadingResources.splice(i,1),n.isSuccess()?(e=!0,this._successResources.push(n)):(s.logger.error("Failed to load "+n.getAssetDef().file),this._failedResources.push(n.getAssetDef())))}if(e){var o=this._loadingResources.length+this._successResources.length+this._failedResources.length,r=this._successResources.length/o;this._progressHandler.fire(r)}this._loadingResources.length<=0&&(0<this._failedResources.length?(this._state=0,setTimeout(function(){t.retry()},250)):(this._state=2,this.terminate()))}},e.prototype.load0=function(){var r=this;this._attempt++,this._loadingResources=[],this._failedResources=[],this._ressources.forEach(function(t){if("img"==t.type){var e=s.Resources.addImage(t.name,t.file);r._loadingResources.push(e)}else if("font"==t.type){var i=s.Resources.addFont(t.name,t.file,t.atlas);r._loadingResources.push(i)}else if("spritesheet"==t.type){var n=s.Resources.addSpriteSheet(t.name,t.file,t.atlas);r._loadingResources.push(n)}else if("soundsheet"==t.type){var o=s.Resources.addSoundsheet(t.name,t.file);r._loadingResources.push(o)}else if("file"==t.type){o=s.Resources.addFile(t.name,t.file);r._loadingResources.push(o)}}),this._state=1},e.prototype.retry=function(){var e=this;this._attempt>=this._retryAttempt?this.terminate():(this._ressources=[],this._failedResources.forEach(function(t){e._ressources.push(t)}),this.load0())},e.prototype.terminate=function(){this._timer.cancel(),0<this._failedResources.length?this._completeCb(!1):this._completeCb(!0)},e.prototype.getStatus=function(){return{loading:this._loadingResources.length,loaded:this._successResources.length,failed:this._failedResources.length}},e.prototype.getProgress=function(){var t=this._loadingResources.length+this._successResources.length+this._failedResources.length;return this._successResources.length/t},e.loadFile=function(t,i){var n=new e([{type:"file",name:t,file:t}],5);n.load(function(t){if(t){var e=n.getResourcesLoaded()[0];i(e.data)}else i(null)})},e}();s.Loader=t}(h5ge||(h5ge={})),function(n){var t=function(){function t(){}return t.get=function(){return null==this._INST&&(this._INST=new t),this._INST},t.set=function(t){this._INST=t},t.prototype.loadXHR=function(t,e,i){(new n.HttpRequest).get(t,e,i)},t.prototype.loadImage=function(t,e){t.src=e},t}();n.LoaderProxy=t}(h5ge||(h5ge={})),function(o){var t=function(){function t(){}return t.Destroy=function(){return delete t.images,delete t.spritesheets,delete t.fonts,this},t.addImage=function(t,e){var i=new o.HImage(t,e);return this.images[t]=i},t.addFont=function(t,e,i){var n=new o.HFont(t,e,i);return this.fonts[t]=n},t.addLoadedFont=function(t,e){return this.fonts[t]=e},t.addSpriteSheet=function(t,e,i){var n=new o.Spritesheet(t,e,i);return this.spritesheets[t]=n},t.addSoundsheet=function(t,e){return new o.Soundsheet(t,e)},t.addFile=function(t,e){return new o.FileResource(e)},t.images={},t.spritesheets={},t.fonts={},t}();o.Resources=t}(h5ge||(h5ge={})),function(i){var t=function(n){function t(t,e){var i=n.call(this)||this;i._name=t,i.file=e;return i.load(),i}return __extends(t,n),t.prototype.load=function(){var e=this;i.LoaderProxy.get().loadXHR(this.file,function(t){e.data=t,e.onSuccess0()},function(t){i.logger.error("Can't load "+e.file+", reason: "+t),e.onFailed0()})},t.prototype.onSuccess0=function(){n.prototype.onSuccess0.call(this),i.AudioManager.get().registerSoundsheet(this._name,this.data)},t.prototype.getAssetDef=function(){return{type:"soundsheet",name:this._name,file:this.file}},t}(i.AbstractLoadingResource);i.Soundsheet=t}(h5ge||(h5ge={})),function(a){var t=function(s){function t(t,e,i){var n=s.call(this)||this;n._name=t,n._img=e,n._def=i;var o=n,r=new a.WaitQueue(2);return r.onComplete=function(){o.onAllLoaded()},n._atlas=new a.FileResource(i),n._image=a.Resources.addImage(t,e),n._atlas.onSuccess(function(){r.resolve(0,null)}),n._atlas.onFailed(function(){r.resolve(0,null)}),n._image.onSuccess(function(){r.resolve(1,null)}),n._image.onFailed(function(){r.resolve(1,null)}),n}return __extends(t,s),t.prototype.onAllLoaded=function(){this._image.isTerminated()&&this._atlas.isTerminated()?this._image.isSuccess()&&this._atlas.isSuccess()?(this.createSpritesheet(),this.onSuccess0()):this.onFailed0():a.logger.error("Bad spritesheet loading. Image and atlas should be success/failed here")},t.prototype.createSpritesheet=function(){var t=JSON.parse(this._atlas.data);for(var e in t.frames){var i=t.frames[e].frame,n=new a.Texture(e,i.x,i.y,i.w,i.h);if(t.frames[e].trimmed){var o=t.frames[e].sourceSize,r=t.frames[e].spriteSourceSize;n.setTrim(r.x,r.y,o.w,o.h)}n.setImpl(this._image.resource),n.setLoaded(!0),a.Texture.addTexture(n)}},t.prototype.getAssetDef=function(){return{type:"spritesheet",name:this._name,file:this._img,atlas:this._def}},t}(a.AbstractLoadingResource);a.Spritesheet=t}(h5ge||(h5ge={})),function(h){var t=function(){function t(){}return t.prototype.initialize=function(t){this._assetByName=new h.HashMap;var e=window.__gb_assets;if(null!=e)for(var i=0;i<e.length;i++){var n=e[i];this._assetByName.get(n.name),this._assetByName.put(n.name,n)}var o=window.__gb_adshandler;if(null!=o){var r=o.assets;for(var s in r){var a=this._assetByName.get(s);null==a?h.logger.warn("No asset def found for "+s):(h.logger.debug("Replacing asset "+a.name),a.data=r[s])}}},t.prototype._getLocalUrl=function(t){var e=this._assetByName.get(t);return null==e?(h.logger.warn("No inline ressource found for "+t),t):"png"==e.t?e.data:"bin"==e.t?"data:arraybuffer;base64,"+e.data:"json"==e.t?"data:json,"+e.data:(h.logger.warn("unsupported type: "+e.t+" for "+e.name),t)},t.prototype._onLoaded=function(){},t}();h.InlineLoadingManager=t}(h5ge||(h5ge={})),function(h){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.assetExportName="__gb_assets",t}return __extends(t,e),t.prototype.loadXHR=function(t,e,i){var n=this.getAsset(t);if(null==n)return h.logger.error("Asset not found: "+t),void i("Not found "+t);var o="";if("json"==n.t){if(null!=n.zlib)try{var r=n.data,s=atob(r),a=pako.inflate(s,{raw:!1,to:"string"});n.data=a}catch(t){h.logger.error("failed to decompress json",t)}o=n.data}else o=n.data;e(o)},t.prototype.loadImage=function(t,e){var i=this.getAsset(e);if(null==i)return"data:"!=e.substr(0,5)?void h.logger.error("Image not found: "+e):void(t.src=e);t.src=i.data},t.prototype.getAsset=function(t){return this.ensureInititalized(),this.assetByName.get(t)},t.prototype.ensureInititalized=function(){if(null==this.assetByName){this.assetByName=new h.HashMap;for(var t=window[this.assetExportName],e=0;e<t.length;e++){var i=t[e];this.assetByName.put(i.name,i)}}},t}(h.LoaderProxy);h.InlineLoader=t}(h5ge||(h5ge={})),function(o){var t=function(){function t(t,e){if(this.width=t,this.height=e,this._game=o.Game.get(),this.container=new o.Container(this._game.width,this._game.height),this.container.debugName="Background",t<=this._game.bounds.width&&e<=this._game.bounds.height)o.logger.warn("Background won't be visible. Ignoring.");else{var i=this,n=this._game.renderer.canvas;this._canvas=document.createElement("canvas"),this._canvas.style.position="absolute",document.body.insertBefore(this._canvas,n),this._canvas.width=t,this._canvas.height=e,this._context2d=this._canvas.getContext("2d"),this._scalingStategy=new o.FillScalingStrategy,this._game.scaleManager.resizeHandler.add(function(){i._resize()}),i._resize()}}return t.prototype._resize=function(){var t=window.innerWidth,e=window.innerHeight,i=this._scalingStategy.getScaling(this.width,this.height,t,e);this._canvas.width=1*this.width,this._canvas.height=1*this.height,this._canvas.style.width=1*this.width*i.scale+"px",this._canvas.style.height=1*this.height*i.scale+"px",this._canvas.style.left=i.x+"px",this._canvas.style.top=i.y+"px",this.redraw()},t.prototype.redraw=function(){this._context2d.clearRect(0,0,this._canvas.width,this._canvas.height),this.container.draw(this._context2d)},t}();o.Background=t}(h5ge||(h5ge={})),function(n){var t=function(){function t(){this.game=n.Game.get(),this.container=new n.Container(this.game.width,this.game.height),this.container.debugName="Scene"}return t.prototype.addChild=function(t){this.container.addChild(t)},t.prototype.removeChild=function(t){this.container.removeChild(t)},t.prototype.update=function(t){},t.prototype.render=function(t){},t.prototype.show=function(t){var e=this;void 0===t&&(t=!0);var i=this;1==t?this.animateIn(function(){e.game.inputManager.enable(),n.DisplayObject.interactiveDirty=!0,i.onShow()}):(this.game.inputManager.enable(),n.DisplayObject.interactiveDirty=!0,this.onShow())},t.prototype.animateIn=function(t){t()},t.prototype.onShow=function(){},t.prototype.hide=function(t,e){void 0===e&&(e=!0),n.Game.get().inputManager.disable(),this.container.interactive=!1,this.container.hasInteractiveChild=!1,null!=this._hideHandler&&(this._hideHandler.fire(),this._hideHandler.clear());var i=this;1==e?this.animateOut(function(){i.onHide(),t()}):(this.onHide(),t())},t.prototype.animateOut=function(t){t()},t.prototype.onHide=function(){},Object.defineProperty(t.prototype,"hideHandler",{get:function(){return null==this._hideHandler&&(this._hideHandler=new n.HandlerCollection),this._hideHandler},enumerable:!0,configurable:!0}),t}();n.Scene=t}(h5ge||(h5ge={})),function(r){var t=function(n){function t(t,e){var i=n.call(this)||this;return i.progressListener=new r.HandlerCollection,i.timeCounted=0,i.startLoadTime=0,i.optDelayBeforeCompleteFire=0,i.optProgressAlgo=1,i.optEstimateLoadingTime=2e3,i.estimatedProgress=-1,i.lastEstimatedProgress=-1,i.assetList=t,i.callback=e,i}return __extends(t,n),t.prototype.onLoadComplete=function(){var t=this,e=performance.now()-this.startLoadTime;r.logger.debug("Loading time: "+e);for(var i=0;i<this.assetList.length;i++){var n=this.assetList[i];if("spritesheet"==n.type){var o=n.atlas.split("/");if(-1!=o[o.length-1].indexOf(".json"))n.name}}0<this.optDelayBeforeCompleteFire?r.TimeManager.get().createAndStartTimer(this.optDelayBeforeCompleteFire,function(){t.progressListener.fire(100),t.callback()}):(t.progressListener.fire(100),t.callback())},t.prototype.addProgressListener=function(t,e){this.progressListener.add(t,e)},t.prototype.onShow=function(){var e=this;this.startLoadTime=performance.now(),this.loader=new r.Loader(this.assetList,t.retryMax),this.loader.load(function(t){t?e.onLoadComplete():r.logger.error("Failed to load all assets :/")}),this.loadingStatus=this.loader.getStatus()},t.prototype.update=function(t){if(n.prototype.update.call(this,t),!(this.startLoadTime<=0)){if(this.lastEstimatedProgress=this.estimatedProgress,this.updateProgress(t),null!=this.optOnProgress&&this.optOnProgress(this.estimatedProgress),null!=this.loadingStatus){var e=this.loader.getStatus();e.loaded!=this.loadingStatus.loaded&&(this.loadingStatus=e)}this.lastEstimatedProgress!=this.estimatedProgress&&this.progressListener.fire(100*this.estimatedProgress)}},t.prototype.render=function(t){},t.prototype.updateProgress=function(t){2==this.optProgressAlgo?this._updateProgress_AssetsSmooth(t):3==this.optProgressAlgo?this._updateProgress_FakeDuration(t):this._updateProgress_Assets(t)},t.prototype._updateProgress_AssetsSmooth=function(t){var e=this.loadingStatus.loading+this.loadingStatus.loaded+this.loadingStatus.failed,i=(this.loadingStatus.loaded+1)/e;i=Math.min(i,1);var n=this.timeCounted/this.optEstimateLoadingTime;n<i&&(this.timeCounted+=t),this.estimatedProgress=Math.min(n,1)},t.prototype._updateProgress_FakeDuration=function(t){var e=(performance.now()-this.startLoadTime)/this.optEstimateLoadingTime;this.estimatedProgress=Math.min(e,1)},t.prototype._updateProgress_Assets=function(t){var e=this.loadingStatus.loading+this.loadingStatus.loaded+this.loadingStatus.failed,i=this.loadingStatus.loaded/e;this.estimatedProgress=Math.min(i,1)},t.retryMax=5,t}(r.Scene);r.H5PreLoadingScene=t}(h5ge||(h5ge={})),function(e){var t=function(){function t(){var t=this;this.os=new e.OS,this.fullscreenManager=new e.FullScreenManager,this.visibilityManager=new e.VisibilityManager,this.checkReady=function(){document.body?(t.os.init(),document.removeEventListener("DOMContentLoaded",t.checkReady),window.removeEventListener("load",t.checkReady),t.readyCallback()):window.setTimeout(t.checkReady,20)}}return t.prototype.whenReady=function(t){var e="complete"==document.readyState;this.readyCallback=t,e?(this.os.init(),this.readyCallback()):(document.addEventListener("DOMContentLoaded",this.checkReady),window.addEventListener("load",this.checkReady))},t}();e.DeviceManager=t}(h5ge||(h5ge={})),function(e){var t=function(){function t(){var t=this;this.onFullscreenChange=function(){t._isInFullScreen=t.hasFullscreenElement(),null!=t._changeHandler&&t._changeHandler.fire()},this.fullscreenEnabled=document.fullscreenEnabled||document.msFullscreenEnabled||document.mozFullScreenEnabled||document.webkitFullscreenEnabled,this._element=document.documentElement,this._isInFullScreen=this.hasFullscreenElement(),document.addEventListener("fullscreenchange",this.onFullscreenChange),document.addEventListener("msfullscreenchange",this.onFullscreenChange),document.addEventListener("mozfullscreenchange",this.onFullscreenChange),document.addEventListener("webkitfullscreenchange",this.onFullscreenChange)}return Object.defineProperty(t.prototype,"isInFullScreen",{get:function(){return this._isInFullScreen},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"changeHandler",{get:function(){return null==this._changeHandler&&(this._changeHandler=new e.HandlerCollection),this._changeHandler},enumerable:!0,configurable:!0}),t.prototype.requestFullScreen=function(){if(this.fullscreenEnabled)if(document.documentElement.requestFullscreen)document.documentElement.requestFullscreen();else if(document.documentElement.msRequestFullscreen)document.documentElement.msRequestFullscreen();else if(document.documentElement.mozRequestFullScreen)document.documentElement.mozRequestFullScreen();else if(document.documentElement.webkitRequestFullscreen){Element.ALLOW_KEYBOARD_INPUT;document.documentElement.webkitRequestFullscreen()}},t.prototype.exitFullscreen=function(){this.fullscreenEnabled&&(document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen())},t.prototype.hasFullscreenElement=function(){return null!=(document.fullscreenElement||document.msFullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement)},t.prototype.toggleFullScreen=function(){this.fullscreenEnabled?this.isInFullScreen?this.exitFullscreen():this.requestFullScreen():e.logger.info("FullScreen is not enabled")},t}();e.FullScreenManager=t}(h5ge||(h5ge={})),function(e){var t=function(){function t(){this.level=0}return t.prototype.setLevel=function(t){this.level=t},t.prototype.debug=function(t){0<this.level||(console.debug(t),null!=this.listeners&&this.listeners.fire("debug",t))},t.prototype.info=function(t){1<this.level||(console.info(t),null!=this.listeners&&this.listeners.fire("info",t))},t.prototype.warn=function(t){2<this.level||(console.warn(t),null!=this.listeners&&this.listeners.fire("warn",t))},t.prototype.error=function(t,e){3<this.level||(console.error(t,e),null!=this.listeners&&this.listeners.fire("error",t,e))},t.prototype.addListener=function(t){null==this.listeners&&(this.listeners=new e.HandlerCollection),this.listeners.add(t)},t}();e.Logger=t,e.logger=new t}(h5ge||(h5ge={})),function(t){var e=function(){function t(){this.vita=!1,this.kindle=!1,this.android=!1,this.chromeOS=!1,this.iOS=!1,this.iPhone=!1,this.iPad=!1,this.linux=!1,this.macOS=!1,this.windows=!1,this.windowsPhone=!1,this.desktop=!1,this.iOSVersion=0,this.pixelRatio=1}return t.prototype.init=function(){var t=navigator.userAgent;/Playstation Vita/.test(t)?this.vita=!0:/Kindle/.test(t)||/\bKF[A-Z][A-Z]+/.test(t)||/Silk.*Mobile Safari/.test(t)?this.kindle=!0:/Android/.test(t)?this.android=!0:/CrOS/.test(t)?this.chromeOS=!0:/iP[ao]d|iPhone/i.test(t)?(this.iOS=!0,navigator.appVersion.match(/OS (\d+)/),this.iOSVersion=parseInt(RegExp.$1,10)):/Linux/.test(t)?this.linux=!0:/Mac OS/.test(t)?this.macOS=!0:/Windows/.test(t)&&(this.windows=!0),(/Windows Phone/i.test(t)||/IEMobile/i.test(t))&&(this.android=!1,this.iOS=!1,this.macOS=!1,this.windows=!0,this.windowsPhone=!0);var e=/Silk/.test(t);(this.windows||this.macOS||this.linux&&!e||this.chromeOS)&&(this.desktop=!0),(this.windowsPhone||/Windows NT/i.test(t)&&/Touch/i.test(t))&&(this.desktop=!1),this.iPhone=-1!==t.toLowerCase().indexOf("iphone"),this.iPad=-1!==t.toLowerCase().indexOf("ipad"),this.pixelRatio=window.devicePixelRatio||1},t}();t.OS=e}(h5ge||(h5ge={})),function(i){var t=function(){function t(){this._isUnloading=!1,this._isVisible=!0,this._isExtendedVisible=!0,this.visibilityChangeHandler=new i.HandlerCollection,this.extendedVisibilityChangeHandler=new i.HandlerCollection,this.beforeUnloadHandler=new i.HandlerCollection,this.browserPrefixes=["moz","ms","o","webkit"];var t=this,e=this.getBrowserPrefix();this.hiddenPropertyName=this.getHiddenPropertyName(e),this.visibilityEventName=this.getVisibilityEvent(e),document.addEventListener(this.visibilityEventName,this.handleVisibilityChange.bind(this),!1),document.addEventListener("focus",function(){t.handleExtendedVisibilityChange(!0,"document-focus")},!1),document.addEventListener("blur",function(){t.handleExtendedVisibilityChange(!1,"document-blur")},!1),window.addEventListener("focus",function(){t.handleExtendedVisibilityChange(!0,"window-focus")},!1),window.addEventListener("blur",function(){t.handleExtendedVisibilityChange(!1,"window-blur")},!1),window.addEventListener("beforeunload",this.handleOnBeforeUnload.bind(this),!1)}return t.prototype.getHiddenPropertyName=function(t){return t?t+"Hidden":"hidden"},t.prototype.getVisibilityEvent=function(t){return(t||"")+"visibilitychange"},t.prototype.getBrowserPrefix=function(){for(var t=0;t<this.browserPrefixes.length;t++)if(this.getHiddenPropertyName(this.browserPrefixes[t])in document)return this.browserPrefixes[t];return null},t.prototype.handleVisibilityChange=function(){if(document[this.hiddenPropertyName])return this._isVisible=!1,this.visibilityChangeHandler.fire(!1),void this.onExtendedHidden(this.hiddenPropertyName);this._isVisible=!0,this.visibilityChangeHandler.fire(!0),this.onExtendedVisible(this.hiddenPropertyName)},t.prototype.handleExtendedVisibilityChange=function(t,e){return t?this.onExtendedVisible(e):this.onExtendedHidden(e)},t.prototype.onExtendedVisible=function(t){this._isExtendedVisible||(this._isExtendedVisible=!0,this.extendedVisibilityChangeHandler.fire(this._isExtendedVisible,t))},t.prototype.onExtendedHidden=function(t){this._isExtendedVisible&&(this._isExtendedVisible=!1,this.extendedVisibilityChangeHandler.fire(this._isExtendedVisible,t))},t.prototype.handleOnBeforeUnload=function(t){this._isUnloading=!0,this.beforeUnloadHandler.fire(t)},t.prototype.addVisibilityChangeHandler=function(t){this.visibilityChangeHandler.add(t)},t.prototype.removeVisibilityChangeHandler=function(t){this.visibilityChangeHandler.remove(t)},t.prototype.addExtendedVisibilityChangeHandler=function(t){this.extendedVisibilityChangeHandler.add(t)},t.prototype.removeExtendedVisibilityChangeHandler=function(t){this.extendedVisibilityChangeHandler.remove(t)},t.prototype.addBeforeUnloadHandler=function(t){this.beforeUnloadHandler.add(t)},t.prototype.removeBeforeUnloadHandler=function(t){this.beforeUnloadHandler.remove(t)},t.prototype.isVisible=function(){return this._isVisible},t.prototype.isUnloading=function(){return this._isUnloading},Object.defineProperty(t.prototype,"hidden",{get:function(){return!this._isVisible},set:function(t){throw"Read only"},enumerable:!0,configurable:!0}),t}();i.VisibilityManager=t}(h5ge||(h5ge={})),function(t){var e;(e=t.UTCDate||(t.UTCDate={})).oneday=864e5,e.serverTimeDiff=0,e.now=function(){return Date.now()-e.serverTimeDiff}}(h5ge||(h5ge={})),function(t){var e,i,n;e=t.Time||(t.Time={}),i=performance.now(),n=performance.now(),e._refresh=function(t){t=performance.now(),n=t-i,i=t},e.now=function(){return i},e.ellapsed=function(){return n}}(h5ge||(h5ge={})),function(r){var t=function(){function o(){this._timers=[],this._inUpdateLoop=!1,this._timersToAdd=[],this._timersToRemove=[],o._TIME_MANAGER=this}return o.get=function(){return null==o._TIME_MANAGER&&(o._TIME_MANAGER=new o),o._TIME_MANAGER},o.prototype.update=function(t){this._inUpdateLoop=!0,this._now=r.Time.now();for(var e=this,i=this._timers.length-1;0<=i;i--){var n=this._timers[i];n.update(this._now)&&n.hasExpired()&&this._timersToRemove.push(n)}this._inUpdateLoop=!1,0<this._timersToRemove.length&&(this._timersToRemove.forEach(function(t){e.remove(t)}),this._timersToRemove.length=0),0<this._timersToAdd.length&&(this._timersToAdd.forEach(function(t){e.pushTimer(t)}),this._timersToAdd.length=0)},o.prototype.pushTimer=function(t){this._timers.push(t)},o.prototype.remove=function(t){if(this._inUpdateLoop)this._timersToRemove.push(t);else{var e=this._timers.indexOf(t);0<=e&&this._timers.splice(e,1)}},o.prototype.removeAll=function(){for(var t=0;t<this._timers.length;t++)this._timers[t]._expired=!0;this._timers=[]},o.prototype.cancelAll=function(){for(var t=this._timers.length-1;0<=t;t--)this._timers[t].cancel()},o.prototype.createTimer=function(t,e,i,n){var o=new r.Timer(this,t,e,i,n);return this._inUpdateLoop?this._timersToAdd.push(o):this.pushTimer(o),o},o.prototype.createAndStartTimer=function(t,e,i,n){var o=this.createTimer(t,e,i,n);return o.start(),o},o.createAndStartTimer=function(t,e,i,n){return o.get().createAndStartTimer(t,e,i,n)},Object.defineProperty(o.prototype,"activeTimersCount",{get:function(){return this._timers.length},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"activeTimers",{get:function(){return this._timers.map(function(t){return t.id}).join()},enumerable:!0,configurable:!0}),o}();r.TimeManager=t}(h5ge||(h5ge={})),function(e){var t=function(){function t(t,e,i,n,o){this.id="DefaultId",this._repeatCount=1,this._running=!1,this._expired=!1,this._timeManager=t,this._delay=e,this._callback=i,this._thisArg=n,this._argArray=o}return t.prototype.setRepeat=function(t){this._repeatCount=t},t.prototype.update=function(t){return!this._running||this._tick-t<=0&&(null!=this._callback&&this._callback.call(this._thisArg,this._argArray),this._repeatCount--,0==this._repeatCount?(this._running=!1,this._expired=!0):(this._repeatCount<-1&&(this._repeatCount=-1),this._tick=t+this._delay,this._startTime=t,!1))},t.prototype.start=function(){this._running||(this._running=!0,this._tick=e.Time.now()+this._delay,this._startTime=e.Time.now())},t.prototype.cancel=function(){this._running=!1,this._timeManager.remove(this)},t.prototype.hasExpired=function(){return this._expired},t.prototype.getProgress=function(){return this._expired?1:this._running?(e.Time.now()-this._startTime)/this._delay:0},t.prototype.getDuration=function(){return this._delay},t}();e.Timer=t}(h5ge||(h5ge={})),function(h){var t=function(){function t(){}return t.getRgb=function(t){return[t>>16&255,t>>8&255,255&t]},t.fromRgb=function(t,e,i){return t<<16|e<<8|i},t.fromHSV=function(t,e,i){var n,o,r,s=Math.floor(6*t),a=6*t-s,h=i*(1-e),c=i*(1-a*e),l=i*(1-(1-a)*e);switch(s%6){case 0:n=i,o=l,r=h;break;case 1:n=c,o=i,r=h;break;case 2:n=h,o=i,r=l;break;case 3:n=h,o=c,r=i;break;case 4:n=l,o=h,r=i;break;case 5:n=i,o=h,r=c}return n=Math.round(255*n),o=Math.round(255*o),r=Math.round(255*r),this.fromRgb(n,o,r)},t.toString=function(t,e){return void 0===e&&(e=1),"rgba("+((16711680&t)>>>16)+","+((65280&t)>>>8)+","+(255&t)+","+e+")"},t.toHexString=function(t){return"#"+h.Strings.pads(t.toString(16),6)},t.fromString=function(t){return 7!=t.length?0:parseInt(t.replace("#",""),16)},t.lerp=function(t,e,i){var n=this.getRgb(t),o=this.getRgb(e),r=h.Maths.lerp(n[0],o[0],i),s=h.Maths.lerp(n[1],o[1],i),a=h.Maths.lerp(n[2],o[2],i);return this.fromRgb(r,s,a)},t}();h.Colors=t}(h5ge||(h5ge={})),function(t){var e=function(){function t(){}return t.init=function(t){this._seed=t,this._seed<=0&&(this._seed+=2147483646)},t.currentSeed=function(){return this._seed},t.get=function(t){return void 0===t&&(t=!1),t?this.random0():Math.random()},t.inRange=function(t,e,i){return void 0===i&&(i=!1),this.get(i)*(e-t+1)+t},t.sign=function(t){return void 0===t&&(t=!1),this.get(t)<.5?1:-1},t.intInRange=function(t,e,i){return void 0===i&&(i=!1),Math.floor(this.get(i)*(e-t+1))+t},t.getSeededInt=function(){return this._seed=16807*this._seed%2147483647},t.random0=function(){return(this.getSeededInt()-1)/2147483646},t._seed=Date.now(),t}();t.Random=e}(h5ge||(h5ge={})),function(r){var t=function(){function i(){this.params=i.urlParametersToHashMap(document.location.href)}return i.getInstance=function(){return null==i._INSTANCE&&(i._INSTANCE=new i),i._INSTANCE},i.add=function(t,e){i.getInstance().params.put(t,e)},i.remove=function(t){i.getInstance().params.remove(t)},i.get=function(t){return i.getInstance().params.get(t)},i.has=function(t){return i.getInstance().params.containsKey(t)},i.urlParametersToHashMap=function(t){for(var e=new r.HashMap,i=t.substring(t.indexOf("?")+1).split("&"),n=0;n<i.length;n++)if(i[n]){var o=i[n].split("=");e.put(decodeURIComponent(o[0]),decodeURIComponent(o[1]))}return e},i}();r.StartupParams=t}(h5ge||(h5ge={})),function(t){var e=function(){function e(){}return e.ellipsis=function(t,e,i){if(null==t)return t;if(t.length<=e)return t;var n=t.substring(0,e);return null!=i&&(n+=i),n},e.capitalize=function(t){return null==t?null:t.length<=1?t.toUpperCase():t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()},e.interpolate=function(t,i){return t.replace(/{([^{}]*)}/g,function(t,e){return i[e]})},e.pad=function(t,e){for(var i=t+"";i.length<e;)i="0"+i;return i},e.pads=function(t,e){for(;t.length<e;)t="0"+t;return t},e.pad2=function(t){return e.pad(t,2)},e.randomUUID=function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},e}();t.Strings=e}(h5ge||(h5ge={})),function(r){var t=function(){function o(){}return o.shuffle=function(t,e){void 0===e&&(e=!1);var i=0,n=0,o=null;for(i=t.length-1;0<i;i-=1)n=Math.floor(r.Random.get(e)*(i+1)),o=t[i],t[i]=t[n],t[n]=o},o.rotate=function(t,e){for(;e--;){var i=t.shift();t.push(i)}},o.concat=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=[],n=0;n<t.length;n++)for(var o=t[n],r=0;r<o.length;r++)i.push(o[r]);return i},o.addAll=function(t,e){if(null!=e)for(var i=0;i<e.length;i++)t.push(e[i])},o.copy=function(t){return null==t?null:t.slice()},o.one=function(t,e){return void 0===e&&(e=!1),null==t||t.length<1?null:1==t.length?t[0]:t[r.Random.intInRange(0,t.length-1,e)]},o.some=function(t,e,i){if(void 0===i&&(i=!1),null==t||t.length<1)return null;var n=o.copy(t);return o.shuffle(n,i),n.length<=e?n:n.slice(0,e)},o.remove=function(t,e){var i=t.indexOf(e);if(0<=i){var n=t.splice(i,1);if(null!=n&&0<n.length)return!0}return!1},o}();r.Collections=t}(h5ge||(h5ge={})),function(t){var e=function(){function t(){this._data=[],this._size=0}return t.prototype.isEmpty=function(){return 0==this._data.length},t.prototype.size=function(){return this._data.length},t.prototype.clear=function(){this._data=[],this._data.length=0},t.prototype.add=function(t){return 0<=this._data.indexOf(t)||this._data.push(t),!1},t.prototype.remove=function(t){var e=this._data.indexOf(t);return!(e<0)&&(this._data.splice(e,1),!0)},t.prototype.contains=function(t){return 0<=this._data.indexOf(t)},t.prototype.values=function(){return this._data},t.prototype.forEach=function(t,e){for(var i in this._data){var n=this._data[i];if(null!=n)if(!1===t.call(e,i,n))break}},t}();t.HashSet=e}(h5ge||(h5ge={})),function(i){var n=function(){function t(){var t=document.createElement("div");t.style.backgroundColor="white",t.style.fontFamily="Consolas, monaco, monospace",t.style.fontSize="10px",t.style.display="inline-block",t.style.padding="5px",t.style.position="absolute",t.style.zIndex="11",document.body.appendChild(t),this.div=t}return t.prototype.update=function(t){var e=t.join("<br>");this.div.innerHTML=e},t}(),t=function(){function t(t,e){void 0===t&&(t=!0),void 0===e&&(e=!1),this.outputConsole=t,this.outputUI=e,this.debugGameData=!0,this._last1Count=0,this._last1UpdateTime=0,this._last1FPS=0,this._last5Count=0,this._last5UpdateTime=0,this._last5FPS=0,this._min=240,this._max=0,this._minMaxRAZ=-1,this._additionalCounter={},this._game=i.Game.get(),this._game.addRenderable(this),this._last1UpdateTime=performance.now(),this._last5UpdateTime=performance.now(),e&&(this._ui=new n)}return t.prototype.render=function(t){var e=performance.now(),i=e-this._last1UpdateTime;1e3<i&&(this._last1FPS=Math.round(1e3*this._last1Count/i),this._last1Count=0,this._last1UpdateTime=e,this._minMaxRAZ--,this._minMaxRAZ<0&&(this._minMaxRAZ=30,this._min=240,this._max=0),this._min=Math.min(this._min,this._last1FPS),this._max=Math.max(this._max,this._last1FPS),this.outputUI&&this.logToUi());var n=e-this._last5UpdateTime;5e3<n&&(this._last5FPS=Math.round(1e3*this._last5Count/n),this._last5Count=0,this._last5UpdateTime=e,this.outputConsole&&this.logToConsole()),this._last1Count++,this._last5Count++},t.prototype.addCounter=function(t,e){this._additionalCounter[t]=e},t.prototype.start=function(){this._last1UpdateTime=performance.now(),this._last5UpdateTime=performance.now()},t.prototype.logToConsole=function(){console&&(console.log("FPS: 1s: %d, 5s: %d, min: %s, max: %s",this._last1FPS,this._last5FPS,this._min,this._max),this.outputDebugGameData())},t.prototype.logToUi=function(){var t=["fps (1):&nbsp;&nbsp; "+this._last1FPS,"fps (min): "+this._min,"fps (max): "+this._max];this._ui.update(t)},t.prototype.outputDebugGameData=function(){if(this.debugGameData)for(var t in console.log("Graph contains "+this._game.layers.root._countElements()+" ui elements"),console.log("Active timers: "+this._game.timeManager.activeTimersCount+" :  ["+this._game.timeManager.activeTimers+"]"),console.log("Active updatables: "+this._game._updatables.length),console.log("Active renderables: "+this._game._renderables.length),this._additionalCounter){var e=this._additionalCounter[t];console.log(t+": "+e())}},t}();i.FPSLogger=t}(h5ge||(h5ge={})),function(r){var t=function(){function t(){}return t.clearYOffset=function(t){var e=r.Resources.fonts[t];if(null==e)throw new Error("Font not loaded: "+t);for(var i=Number.POSITIVE_INFINITY,n=0;n<e.chars.length;n++){(o=e.lettersByCode[e.chars[n]]).height<=0||o.yoffset<i&&(i=o.yoffset)}for(n=0;n<e.chars.length;n++){var o;(o=e.lettersByCode[e.chars[n]]).height<=0||(o.yoffset=o.yoffset-i)}},t}();r.Fonts=t}(h5ge||(h5ge={})),function(t){var e=function(){function t(t,e){this.callback=t,this.context=e}return t.prototype.execute=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.callback.apply(this.context,t)},t}();t.ContextualCallback=e}(h5ge||(h5ge={})),function(n){var t=function(){function t(){this._handlers=[],this._onces=[]}return Object.defineProperty(t.prototype,"length",{get:function(){return this._handlers.length+this._onces.length},enumerable:!0,configurable:!0}),t.prototype.once=function(t,e){var i=new n.ContextualCallback(t,e);this._onces.push(i)},t.prototype.add=function(t,e){var i=new n.ContextualCallback(t,e);return this._handlers.push(i),i},t.prototype.remove=function(t){for(var e=-1,i=0;i<this._handlers.length;i++)if(this._handlers[i].callback==t){e=i;break}-1<e&&this._handlers.splice(e,1)},t.prototype.removeCtx=function(t){var e=this._handlers.indexOf(t);-1<e&&this._handlers.splice(e,1)},t.prototype.removeIdx=function(t){return this._handlers.splice(t,1)[0]},t.prototype.clear=function(){0<this._handlers.length&&this._handlers.splice(0,this._handlers.length),0<this._onces.length&&this._onces.splice(0,this._onces.length)},t.prototype.fire=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._handlers.forEach(function(t){t.callback.apply(t.context,e)}),0<this._onces.length&&(this._onces.forEach(function(t){t.callback.apply(t.context,e)}),this._onces.splice(0,this._onces.length))},t}();n.HandlerCollection=t}(h5ge||(h5ge={})),function(t){var e=function(){function t(t){this.size=t,this._data=[],this._resolved=[];for(var e=0;e<t;e++)this._resolved[e]=!1}return t.prototype.resolve=function(t,e){this._data[t]=e,this._resolved[t]=!0,this.allDone()&&this.onComplete(this._data)},t.prototype.allDone=function(){for(var t=0;t<this._resolved.length;t++)if(!this._resolved[t])return!1;return!0},t}();t.WaitQueue=e}(h5ge||(h5ge={})),function(i){var t=function(){function t(t){if(this._id=t,this.available=!1,this.available=this.isAvailable(),this.available){var e=localStorage.getItem(this._id);this.cacheData=i.JSONS.safeJson(e,{})}else this.cacheData={}}return t.prototype.isAvailable=function(){try{return localStorage.setItem("test123456789","test123456789"),localStorage.removeItem("test123456789"),!0}catch(t){return!1}},t.prototype.put=function(t,e){this.cacheData[t]=e,this.available&&localStorage.setItem(this._id,JSON.stringify(this.cacheData))},t.prototype.get=function(t,e){if(this.available){var i=this.cacheData[t];return null==i?e:i}return e},t.prototype.remove=function(t){this.available&&(delete this.cacheData[t],0==Object.keys(this.cacheData).length?(localStorage.setItem(this._id,""),localStorage.removeItem(this._id)):localStorage.setItem(this._id,JSON.stringify(this.cacheData)))},t}();i.LocalStorage=t}(h5ge||(h5ge={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){!function(t){function e(t){return t*t}function i(t){return t*t*t}function n(t){return t*t*t*t}t.linear=function(t){return t},t.easeInQuad=e,t.easeInCubic=i,t.easeInQuint=n,t.easeOutQuad=function(t){return 1-e(1-t)},t.easeOutCubic=function(t){return 1-i(1-t)},t.easeOutQuint=function(t){return 1-n(1-t)},t.easeInOutQuad=function(t){return t<.5?e(2*t)/2:1-e(2*(1-t))/2},t.easeInOutCubic=function(t){return t<.5?i(2*t)/2:1-i(2*(1-t))/2},t.easeInOutQuint=function(t){return t<.5?n(2*t)/2:1-n(2*(1-t))/2},t.easeOutElastic=function(t){return Math.pow(2,-10*t)*Math.sin((t-.075)*(2*Math.PI)/.3)+1}}(t.easing||(t.easing={}))}(h5ge||(h5ge={})),function(e){var t=function(){function t(t){this._removeContainer=!0,this._particles=[],this._fired=!1,this.loop=0,null!=t?(this._ctn=t,this._removeContainer=!1):(this._ctn=new e.Container,this._removeContainer=!0)}return Object.defineProperty(t.prototype,"container",{get:function(){return this._ctn},enumerable:!0,configurable:!0}),t.prototype.start=function(){this.startTime=performance.now(),e.Game.get().addUpdatable(this)},t.prototype.update=function(t){this.deltaTime=t,this.ellapsedTime=performance.now()-this.startTime;var e=this.emit();if(null==e)this._updateParticules(t),this._particles.length<=0&&this.destroy();else{this._updateParticules(t);for(var i=0;i<e.length;i++){var n=e[i];n.start(),this._particles.push(n),this._ctn.addChild(n.object)}}this.loop++},t.prototype._updateParticules=function(t){for(var e=this._particles.length-1;0<=e;e--){var i=this._particles[e];i.terminated?this._particles.splice(e,1):i.update(t)}},t.prototype.destroy=function(){e.Game.get().removeUpdatable(this),this._removeContainer&&this._ctn.removeSelf()},t}();e.Emitter=t}(h5ge||(h5ge={})),function(c){var t=function(){function t(t,e){this.object=t,this._easing=e,this.terminated=!1,this.angle=0,this.startScale=1,this.endScale=1,this.startSpeed=0,this.endSpeed=0,this.lifetime=1e3}return t.prototype.start=function(){this.object.scaleXY=this.startScale,this._startTime=c.Time.now(),0<this.lifetime&&(this._endTime=c.Time.now()+this.lifetime);var t=this.angle*c.Maths.DEG_TO_RADIAN;this._angleCos=Math.cos(t),this._angleSin=Math.sin(t)},t.prototype.update=function(t){if(!this.terminated){var e=c.Time.now(),i=1;if(0<this.lifetime){if(e>this._endTime)return this.terminated=!0,void(this.object.visible=!1);var n=e-this._startTime,o=Math.min(n,this.lifetime)/this.lifetime;i=this._easing(o)}var r=this.startScale+(this.endScale-this.startScale)*i;this.object.scaleXY=r;var s=this.startSpeed+(this.endSpeed-this.startSpeed)*i,a=t*(s*this._angleCos),h=t*(s*this._angleSin);this.object.x+=a,this.object.y+=h}},t.prototype.reset=function(){this.terminated=!1,this.object.visible=!0},t.prototype.destroy=function(){this.object.visible=!1},t}();c.SimpleParticle=t}(h5ge||(h5ge={})),function(o){var t=function(){function t(t,e){this.id="DefaultId",this._repeatCount=1,this._currentStepIndex=-1,this._steps=[],this._state=0,this._savedValues={},this._object=t,this._tweenManager=e}return t.prototype.getObject=function(){return this._object},t.prototype.delay=function(t){var e=new o.DelayTweenStep(t);return this._steps.push(e),this},t.prototype.repeat=function(t){this._repeatCount=t},t.prototype.to=function(t,e,i){void 0===e&&(e=1e3),void 0===i&&(i=o.easing.linear);var n=new o.PropertiesTweenStep(this._object,t,e,i,!1);return this._steps.push(n),this},t.prototype.from=function(t,e,i){void 0===e&&(e=1e3),void 0===i&&(i=o.easing.linear);var n=new o.PropertiesTweenStep(this._object,t,e,i,!0);return this._steps.push(n),this},t.prototype.start=function(){1!=this._state?0!=this._steps.length?(this._state=1,this.nextStep(),this.onStart&&this.onStart()):o.logger.warn("No step defined in Tween"):o.logger.warn("Tween already started")},t.prototype.stop=function(){2!=this._state&&(this._state=2,this.onComplete&&this.onComplete(this),this._tweenManager.remove(this))},t.prototype.update=function(t){1==this._state&&(null!=this._currentStep?(this._currentStep.update(t),this._currentStep.isComplete()&&(this.render(1),this.nextStep())):this.stop())},t.prototype.render=function(t){1==this._state&&null!=this._currentStep&&this._currentStep.render(t)},t.prototype.nextStep=function(){this._currentStepIndex++,this._currentStepIndex<this._steps.length?(this._currentStep=this._steps[this._currentStepIndex],this._currentStep.start()):(this._repeatCount-=1,0==this._repeatCount?this._currentStep=null:(this._currentStepIndex=-1,this.nextStep()))},t}();o.Tween=t}(h5ge||(h5ge={})),function(n){var t=function(){function t(){this._tweens=[],(t._instance=this)._game=n.Game.get(),this._game.addUpdatable(this),this._game.addRenderable(this)}return t.get=function(){return null==t._instance&&(t._instance=new t),t._instance},t.prototype.create=function(t,e){var i=new n.Tween(t,this);return null!=e&&(i.id=e),this._tweens.push(i),i},t.prototype.remove=function(t){var e=this._tweens.indexOf(t);-1<e&&(this._tweens.splice(e,1),t.stop())},t.prototype.removeAll=function(){this.cancelAll(),this._tweens=[]},t.prototype.cancelAll=function(){for(var t=0;t<this._tweens.length;t++)this._tweens[t].stop()},t.prototype.update=function(t){for(var e=0;e<this._tweens.length;e++)this._tweens[e].update(t)},t.prototype.render=function(t){for(var e=0;e<this._tweens.length;e++)this._tweens[e].render(t)},Object.defineProperty(t.prototype,"activeTweensCount",{get:function(){return this._tweens.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activeTweens",{get:function(){return this._tweens.map(function(t){return t.id}).join()},enumerable:!0,configurable:!0}),t}();n.TweenManager=t}(h5ge||(h5ge={})),function(i){var t=function(){function t(t){this.complete=!1,this.elapsedTime=null,this.startTime=null,this.duration=t}return t.prototype.start=function(){this.startTime=i.Time.now(),this.elapsedTime=0,this.complete=!1},t.prototype.update=function(t){var e=i.Time.now();this.elapsedTime=e-this.startTime,this.elapsedTime>=this.duration&&(this.complete=!0)},t.prototype.render=function(t){},t.prototype.isComplete=function(){return this.complete},t}(),e=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t}(i.TweenStep=t);i.DelayTweenStep=e;var n=function(s){function t(t,e,i,n,o){var r=s.call(this,i)||this;return r._startValues={},r._endValues={},r._previousValues={},r._computedValues={},r._properties=e,r._easing=n,r._from=o,r._object=t,r}return __extends(t,s),t.prototype.start=function(){for(var t in s.prototype.start.call(this),this._properties)this._from?(this._startValues[t]=this._properties[t],this._endValues[t]=this._object[t]):(this._startValues[t]=this._object[t],this._endValues[t]=this._properties[t]),this._previousValues[t]=this._startValues[t],this._computedValues[t]=this._startValues[t]},t.prototype.update=function(t){s.prototype.update.call(this,t);var e=Math.min(this.elapsedTime,this.duration)/this.duration,i=this._easing(e);for(var n in this._properties){this._previousValues[n]=this._computedValues[n];var o=this._startValues[n],r=o+(this._endValues[n]-o)*i;this._computedValues[n]=r}},t.prototype.render=function(t){for(var e in s.prototype.render.call(this,t),this._computedValues){var i=this._previousValues[e],n=this._computedValues[e];this._object[e]=i+(n-i)*t}},t}(t);i.PropertiesTweenStep=n}(h5ge||(h5ge={})),function(t){var e=function(){function t(t,e){void 0===e&&(e=!0),this.roundValue=e,this._value=e?Math.round(t):t}return t.prototype.notify=function(t){var e=this._value;e!=t&&(e<t?(null!=this.onValueUp&&this.onValueUp(t),null!=this.onValueChange&&this.onValueChange(t)):t<e&&(null!=this.onValueDown&&this.onValueDown(t),null!=this.onValueChange&&this.onValueChange(t)))},Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(t){this.roundValue&&(t=Math.round(t)),this.notify(t),this._value=t},enumerable:!0,configurable:!0}),t}();t.TweenValueListener=e}(h5ge||(h5ge={})),function(i){var t=function(){function t(t,e){void 0===e&&(e=0),this._background=t,this._progress=e,this._lastProgress=-1,this._startTime=0,this._duration=0,this._expired=!1,this._started=!1,this._autoUpdate()}return t.prototype.startTimeLimited=function(t,e){void 0===e&&(e=0),this._progress=e/t,this._duration=t,this._startTime=performance.now()-e,this._started=!0},t.prototype.setProgress=function(t){t<0?t=0:1<t&&(t=1),this._progress=t},t.prototype.update=function(t){if(!this._expired&&this._started&&0!=this._startTime){var e=performance.now();this._progress=(e-this._startTime)/this._duration,this._progress=Math.min(this._progress,1),1==this._progress&&this._onExpired()}},t.prototype.render=function(t){},t.prototype.getProgress=function(){return this._progress},t.prototype._onExpired=function(){this._expired=!0,this._started=!1,null!=this.onProgressExpired&&this.onProgressExpired()},t.prototype._autoUpdate=function(){var t=this,e=i.Game.get();e.addRenderable(this),e.addUpdatable(this),this._background.detachListener.once(function(){e.removeRenderable(t),e.removeUpdatable(t)})},t}();i.AbstractProgressBar=t}(h5ge||(h5ge={})),function(h){var t=function(a){function t(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);var n=a.call(this,t,i)||this;return n._way=e,n.bgwidth=0,n.bgheight=0,n._inverted=!1,n.bgwidth=t.width,n.bgheight=t.height,n}return __extends(t,a),t.prototype.updateProgress=function(t){t<0?t=0:1<t&&(t=1),this._progress=t},t.prototype.update=function(t){a.prototype.update.call(this,t)},t.prototype.render=function(t){if(a.prototype.render.call(this,t),this._progress!=this._lastProgress){var e,i,n,o;if(this._background.mask=new h.Mask,0==this._way)i=e=0,n=this.bgwidth*this._progress,o=this.bgheight,this._inverted&&(e=n,n=this.bgwidth-n);else if(1==this._way){var r=this._background.width*this._progress;e=this.bgwidth-r,i=0,n=r,o=this.bgheight,this._inverted&&(n=e,e=0)}else if(2==this._way)i=e=0,n=this.bgwidth,o=this.bgheight*this._progress,this._inverted&&(i=o,o=this.bgheight-o);else if(3==this._way){var s=this.bgheight*this._progress;e=0,i=this.bgheight-s,n=this.bgwidth,o=s,this._inverted&&(o=i,i=0)}this._background.mask.rectangle(e,i,n,o),this._lastProgress=this._progress}},t.prototype.setInverted=function(t){this._inverted=!0},t}(h.AbstractProgressBar);h.ProgressBar=t}(h5ge||(h5ge={})),function(i){var t=function(n){function t(t,e){void 0===e&&(e=0);var i=n.call(this,t,e)||this;return i.start=-Math.PI/2,i._inverted=!1,i.radius=t.width/2,i.centerX=i.radius,i.centerY=i.radius,i}return __extends(t,n),t.prototype.setInverted=function(t){this._inverted=t},t.prototype.updateProgress=function(t){t<0?t=0:1<t&&(t=1),this._progress=t},t.prototype.update=function(t){n.prototype.update.call(this,t)},t.prototype.render=function(t){if(n.prototype.render.call(this,t),this._progress!=this._lastProgress){if(this._background.mask=new i.Mask,0<this._progress)if(this._background.visible=!0,this._inverted){e=2*this._progress*Math.PI;this._background.mask.moveTo(this.centerX,this.centerY),this._background.mask.lineTo(this.radius+this.radius*Math.cos(this.start+e),this.radius+this.radius*Math.sin(this.start+e)),this._background.mask.arc(this.centerX,this.centerY,this.radius,this.start+e,3*Math.PI/2),this._background.mask.lineTo(this.centerX,this.centerY)}else{var e=2*this._progress*Math.PI;this._background.mask.moveTo(this.centerX,this.centerY),this._background.mask.lineTo(this.radius,0),this._background.mask.arc(this.centerX,this.centerY,this.radius,this.start,this.start+e),this._background.mask.lineTo(this.centerX,this.centerY)}else this._background.visible=!1;this._lastProgress=this._progress}},t}(i.AbstractProgressBar);i.RoundProgressBar=t}(h5ge||(h5ge={}));var h5ge,gs;__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e=function(e){function s(){var t=e.call(this)||this;return t._pressed=!1,t}return __extends(s,e),s.from=function(t,e,i,n,o){var r=new s;return null!=o&&(r.stateDown=o),null!=n&&(r.stateOver=n),null!=i&&(r.stateUp=i),r.press=e,r.normal=t,r.initialise(),r},s.prototype.initialise=function(){var t=this;this.setSizeFromChildren(!1),this.setStateTexture(),this.onClick(function(){t.toggle()}),this.pressed=!1},s.prototype.setStateTexture=function(){null!=this._stateUp&&(this._stateUp.visible=!1),null!=this._stateOver&&(this._stateOver.visible=!1),null!=this._stateDown&&(this._stateDown.visible=!1),this._down?null!=this._stateDown?this._stateDown.visible=!0:null!=this._stateUp&&(this._stateUp.visible=!0):this._over&&null!=this._stateOver?this._stateOver.visible=!0:null!=this._stateUp&&(this._stateUp.visible=!0)},s.prototype.onStateDown=function(){e.prototype.onStateDown.call(this),this.setStateTexture()},s.prototype.onStateUp=function(){e.prototype.onStateUp.call(this),this.setStateTexture()},s.prototype.onStateOver=function(){e.prototype.onStateOver.call(this),this.setStateTexture()},s.prototype.onStateOut=function(){e.prototype.onStateOut.call(this),this.setStateTexture()},s.prototype.toggle=function(){this.pressed=!this.pressed},Object.defineProperty(s.prototype,"pressed",{get:function(){return this._pressed},set:function(t){this._pressed=t,this._pressed?(this._press.visible=!0,this._normal.visible=!1):(this._press.visible=!1,this._normal.visible=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"stateUp",{get:function(){return this._stateUp},set:function(t){this._stateUp=t,this.addChild(t)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"stateDown",{get:function(){return this._stateDown},set:function(t){this._stateDown=t,this.addChild(t)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"stateOver",{get:function(){return this._stateOver},set:function(t){this._stateOver=t,this.addChild(t)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"normal",{get:function(){return this._normal},set:function(t){this._normal=t,this.addChild(t)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"press",{get:function(){return this._press},set:function(t){this._press=t,this.addChild(t)},enumerable:!0,configurable:!0}),s}(t.Button);t.ToggleImageButton=e}(h5ge||(h5ge={})),function(a){var h,t;(t=h=a.HamburgerMenuOrientation||(a.HamburgerMenuOrientation={}))[t.Left=0]="Left",t[t.Right=1]="Right",t[t.Bottom=2]="Bottom",t[t.Top=3]="Top";var e=function(){function o(){}return o.from=function(t,e,i){var n=new o;return n.up=t,n.down=e,n.hover=i,n},o}();a.HamburgerMenuStyle=e;var i=function(r){function s(t,e){var i=r.call(this)||this;i.duration=250,i.spaceBetweenButton=10,i.buttons=[],i._open=!1,i._buttonPositions=[],i.openTime=0;var n=i,o=s.count++;return i._debugId="HamburgerMenu-"+o,i.game=a.Game.get(),i.style=e,i._onToggleCloseFct=null,i._onToggleOpenFct=null,i.orientation=h.Right,i.mainButton=new a.ImageButton(a.ImageButtonStyle.fromFrames(i.style.up,i.style.down,i.style.hover)),i.mainButton.setIcon(t),i.mainButton.onClick(i.toggle,i),i.addChild(i.mainButton),i._bWidth=i.mainButton.style._stateUp.width,i._bHeight=i.mainButton.style._stateUp.height,i.openHandler=new a.HandlerCollection,i.timer=i.game.timeManager.createTimer(1e3,i.tick,i),i.timer.id="HamburgerMenu-"+o,i.timer.setRepeat(-1),i.timer.start(),i.refreshButtonPosition(),i.detachListener.once(function(){n.destroy()}),i.setSizeFromChildren(),i}return __extends(s,r),s.prototype.onOpenMenu=function(t,e){this._onToggleOpenFct=null==t?null:new a.ContextualCallback(t,e)},s.prototype.onCloseMenu=function(t,e){this._onToggleCloseFct=null==t?null:new a.ContextualCallback(t,e)},s.prototype.open=function(){this._open=!1,this.toggle()},s.prototype.close=function(){this._open=!0,this.toggle()},s.prototype.toggle=function(){this._open=!this._open;for(var t=a.TweenManager.get(),e=0;e<this.buttons.length;e++){var i=this.buttons[e],n=this._buttonPositions[e],o=t.create(i),r={};this._open?this.orientation==h.Right||this.orientation==h.Left?r.x=n.x:r.y=n.y:this.orientation==h.Right||this.orientation==h.Left?r.x=0:r.y=0,o.to(r,this.duration,a.easing.easeInOutCubic),o.start(),this._open?i.visible=!0:o.onComplete=this.onHideTweenComplete}this._open?null!=this._onToggleOpenFct&&this._onToggleOpenFct.execute():null!=this._onToggleCloseFct&&this._onToggleCloseFct.execute(),this.openHandler.fire(this._open),this.onStateChange()},s.prototype.onHideTweenComplete=function(t){t.getObject().visible=!1},s.prototype.addButton=function(t,e,i){var n=new a.ImageButton(a.ImageButtonStyle.fromFrames(this.style.up,this.style.down,this.style.hover));return n.setIcon(t),n.visible=!1,null!=e&&n.onClick(e,i),this.buttons.push(n),this.addChildAt(n,0),this.refreshButtonPosition(),n},s.prototype.addToggleButton=function(t,e,i,n){var o=a.ToggleImageButton.from(a.Sprite.fromFrame(t),a.Sprite.fromFrame(e),a.Sprite.fromFrame(this.style.up),a.Sprite.fromFrame(this.style.down),a.Sprite.fromFrame(this.style.hover));return o.visible=!1,null!=i&&o.clickHandler.add(i,n),this.buttons.push(o),this.addChildAt(o,0),this.refreshButtonPosition(),o},s.prototype.refreshButtonPosition=function(){this._buttonPositions=[];for(var t=0,e=0,i=0,n=0,o=this.width,r=this.height,s=0;s<this.buttons.length;s++){switch(this.orientation){case h.Right:t+=this._bWidth+this.spaceBetweenButton;break;case h.Left:t-=this._bWidth+this.spaceBetweenButton;break;case h.Bottom:e+=this._bHeight+this.spaceBetweenButton;break;case h.Top:e-=this._bHeight+this.spaceBetweenButton}this._buttonPositions.push(new a.Point(t,e)),t<i&&(i=t),e<n&&(n=e),o<t&&(o=t),r<e&&(r=e)}this.interactive=!0,this.hitArea=new a.Rectangle(i,n,o-i+this._bWidth,r-n+this._bHeight)},s.prototype.onStateChange=function(){this._open&&(this.openTime=a.Time.now())},s.prototype.destroy=function(){this.openHandler.clear(),this.timer.cancel()},s.prototype.tick=function(){if(this._open)if(this.openTime+5e3<a.Time.now())this.close();else{var t=this.game.inputManager.mouse.pointer.downPosition;this.hitPoint(t)||this.close()}},s.count=0,s}(a.Container);a.HamburgerMenu=i}(h5ge||(h5ge={})),function(r){var t=function(o){function t(t,e){var i=o.call(this,t,e)||this;i.finishing=!1,i.lastProgress=-1,i.optFillColor=8400785;var n=i;i.optProgressAlgo=3,i.optDelayBeforeCompleteFire=300,i.optEstimateLoadingTime=2e4,i.optOnProgress=function(t){n._onProgress(t)};r.Resources.addImage("catb64.png","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAATgAAAEICAMAAAD82xj1AAAA6lBMVEUAAAD////////////////////////+/v7////+/v7////+/v7////+/v7+/v7////////////+/v7+/v7////+/v7+/v7+/v7////+/v7+/v7+/v7+/v7+/v7////+/v7////+/v7////+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7////+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7////+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7///+iekI1AAAATXRSTlMABAgMEBQYHCAkKCwwNDg8QERITFBUWFxgZGhscHR4fICEiIuMj5CTlJeYnJ+go6SnqKusr7CztLe4u7y/wMPHy8/T19vf4+fr7/P3+z+XTDIAABVvSURBVHgB7d17V9ra1gbwJwmEcEECggZFDb6WzZGdbbXaWgsqQsCQzO//dV6suYAQhLUCpsXff2eMnrHhMcm6MNcM4kba0eoXnf6QXjlm92fruJIV8CmUkK9969N8drepKZj1KVW9GdE7zPOyhE8TUrV7Wo59vS9iu/nE/TatYmQU8AnpM4tW9nQo4W8mK4oiYJH8tUNMrFMZiySVsQT+LEKuenbTHZBrZN5/axyWFMxQ28TObsiYoezWGjcPpuPn2/91XiuI+AMkq99HNJd1d1ZOIJB7NzbLfie6JAKJ8umdRXM57WMF8Za7tGmh7mkBvylfaT6naxzv7SiCTqQDqdxurdm2wpI9EfHbTv2RFrtVEV+pr7SEQSMLsT43YPv2eEfEq9fgXBnNMGkeswxk6gNaQjuDmNq1aEkPJs0lwucH5wu7lO5oSfYBYqnmELsBvcC7wd06xOELYqhMzJzvu8KSwSGlD4jdCWJHGRGjUUMBsGxwgFB5IFbODuLmimaYv1m0kKUngJWCG1NvaTHL/M2htx4RMwpNcB7O9nIJeOR8+ej8YRQa28rBhU8CRw/nR+W8DE8iV6m3bZqgIl5OyPd0kMQ82YOLIU1xGgmALThA7dK04cVBFvNIWpd8LcTLgx/GoYBw+bpJvts0wBCcr/pMPrOexwLaiFx9xItNrgO8o3RNvw3KAF9wSJzTq+8lvGOXPAnESYpcloBF/OeT05DAHpyv0COi+zze1ydXDnGSJ1cHy6hcZoEogoNw3K1gGd/iOTqo5PoGRiYRmeHB+f+ClRHz4DpgVOhTvxAenP8v/rLgsuR6ALMEMD84XwLsfsUzuBS5nhEFP7jo9MiVRqw45ErGMziRPCJi5Ylcu/EMrkCuAeLFH+1P4xncMbl+IF6OyPUQz+BuyVVHvPi3gpOMY3CiTa4S4iX4ZFp01/BR9NvTjoSY8e+F74hG8tu3JKJyQa57xM3h5L0aN9KIXMeImxR5aogdjTxpxM49uZ4QOw/k6iJ+DshTRMzkKIZ3qi9pk+saMWOQy0khhi7j+iCR7WDEj6MCeQzESoM8u4ilLrmcdDwvuD7iaZ88V4iRJnkOEU+CSZ4dxEbaIddQREzVyPMQw7Ug6YgrcUieavyqz6wEYksjjyUjFiQzzktBn9CP2/jQJM9ARIztkk/DfFK+omlaOSciApmSpmn7hSRClMi3j1i7I4+Vwqz8aZdc9v2Jwnmi4nZELrNVFDArMZgcrmLthBY8U8rd6A4fpA2bpgxq4oIblfYQaxmbPI8CpuUeaNZVCizEM4dmmLt4I2uTpysgxoQgm1F6uWr+5xJWl3miuf4nhO51kY4YOwp/Fn+hEM4hVlUYUYh7CdOuyePk/ogb9er93HwH/LmFJpcc/gk3a5s8g8TMYiycU8QqUkNa4L/wCdIx4qI8sE8RqFLYxlfOoUUGCYY/TxgN0/5HHjsNX6Fnnwv4IKI1dTwqaZHnX0y7p4Bzf3ag1ZpPNKG54uaVb2AcadXTW5sCz4nQRdfd9N1exQeRpw+W/Rd6BZXJZzdSeJX9j3xOmmVVR/dFL5zac/jwWSTfnp/bxx7sak8mVyDfbujN1csiUAy+7RmWtRekXUMgeUseS8S0f8kzTEzk5mTxUaT7IDkhuPe+hh5X6suYlBn595eAJd2FTHiE76GLhMSQPGcTuVWAOCRXC99ROgydSgWXTwHLkRxynWOaNCDXxYKrNBN9bnzJJa3wadlN+K9f3VUPkpbINUqEbgYOF+wC38YjtyC58wXbECa58nirSq4bLOc4/DCbOAqtQ07b5NHjkZufnM+ZSUdYUJEur1pw0iJXGTNuwu/7Ovn83GKW3Hn4UdZfmPXs317L+bmgWqAevoUkmjO5xSw5KxkenAGE38ZYTmdB1f3Bgs3nykxuMUvuEOHBtTDrkV7ZqwaHWdqC4NCOX26Tf86+gPCH9iFmGfNKTBPq4ZnReXHZPCqnMOFswTMxT64sZuVi9wPc1Ny3jDlOFyzlsw79VoEnW585M27sCnClR/7sN3RyfLu41osa8fs1tT8/2P9+55bHPJXR1Oope0fz9P2gyhYROXXMIz/Q2IP8zm1hy7H7MTWslczOiV4VMZ98qB+l4dp3KMRXIfj3x1nMJ5R1fVd4d/ezgVjQomvCozoUqgl2fm5xuuSEPkWW3D2Fc2Tu3HyNeA2pNndyJi2g8ubmWLG65LrB3sc9b3JtWkDmza1Sow85CpeUFleLGJB4k6tTuAF3bhCHC0u+JDWDNfiX7FZ6wUXipMGdXI7CnXPnBtQW1GfIdWstP4SVaMy5zoV+1UuAP7knCrXDnxtEi1wDAVPSTZvGRojcHr1qF0MON+QQQXIahXnkz21Mn7+/nrt0IuvFEF4x1a0I8MjO9NkLP7lDzrnNjDKYJK3J3JCw5+y3Bt3onANEL6Fb5OofiDNPcxVTyV3yXdgz7sFG9XN71aC329HlR3LZzTTWQqoNyTU8TkxXSz++2WU6iXZG4uTYT4dM5gbFmfpJR6z6l7hVl7E2gtYjl3UmT14fewhIrfszAYwyI5rjDKxKd3eluS0p7SQSR8GVUEtgvcr35LJb6QdyDQVE5YB86yg02iHP6Wnw7NFErJ96TS5nLW1i/6W3nhVE55HeeixjQ3KGQ77I137CPU0bFRAh7UOboCsNmyZcRvwbxhpzg/hMAecyhw1L6hb5ioiU9J0CwwIiJXwj/vkHF/GJPMOTBKIknAQT6xSi4s8/PvgYZtKhgNWQEaX06yLooYwI+fMPV/sjW7T47AoilSSiU0RK7NG01Ec2GvENEK3ozyZU6I2jj21tc/w6O7FiH1zRnX9ckKv7ocehR+Lr7OQ49sHh39f5R/lDG33cT62Wk3t5xD84yAmMSfYHHv5Nzqzv4x+c7+4Du6JV19PKTlR8RNRQPDKidEyeJDbtmlx3WJakKDlV3dU07UTXT42xztij/56RpQzMF52xn4ZhtHRdP9I0TVXVjKIIq2+RaNgwcfTOkJ5UcuOMqrp+bnzrdPrmkDbCNJ86nQujoZ9oWnEcpoR5hBH7KptTkTwZvEooO6p2oJ8ZN50nc0Sx8Ww+di6Nuq7tqTlFfFuGbgnYrFNyjWr6+JLqDejP4JjdzsW5/v0DevJIilo50E36S7T1g4qqSFgnQdV/9Gz6K9m9G10VsA47LYv+cs+tHUSt3KWt0C0jSjuPtH6WGehMMAMWrd/jDqIiNSOaYvU6nV+GYei6XtM0bVdV1R1lLIUVpZSxHfV1Ml3Tdd0wjF8vk0WTotCUEIm8yTh7ujHOdV3TSi/xiNgQ8SXSkqa9zLxvOo/mM63OzCMCmrP0BOnS0I+1ippTJMSIpOTUinasG5edrmnTMhwN3OoUzup3vrX0Q20clYA/hDCOUTvUW986fYvC1cHpy7y0LhonWimv4I+n5EvaSeNiXoZfIs2tp6sS/kqSWu9FmNwhTWqr+KsV2zTpEMyKDgV6Rfz1ij3GzkWzDZ18DRFbQGxSYJjkfy30aB9bYn9EvA1SS7MFQ9ugMCJfCQyE3tblNpNcT+Bq+e6UsFVKDnn2uUo+dWwZnedYSo48DwK2zESP1BzHGjWPrZPnWLM+kesaW+ia+V1ZMnmK2EJF5uPFGrmesZWeWWskjKBGYCtdsr7xaRAkvpU0cplYSYY8CraSwli0WSVXD1uqx3bLGeQ6x5Y6Z3vImUGd6pbaI5fJNouTsaXYIjgg13MSWyr5TK7qSu/Q8Q1uDtLYMumDmwEFRrfVJN6Tu7BpRvckhY0TMqqawualTro0w77IYZFky6G5nGt1s6lV7mwasy4K2Cj1OiyBVhKhys8Urr3B6PJd8l0nNxhbm8I97yKETou1s9iMikMTBhlsRrZNi+mLyx3COQ0JG7Dr0JShgg2QGg6958uquflMFWuXsuiNB6yfahIRS3JHtBTnVMCaGTRDw5oJpw4t5QhvFByaMLo5rWpaVb/sOvTWnYy1Sjk0o4v1ku/oLad7ob9kcHozoglOYfZVQr5uRYRH2m090zQzs8mj/ps4kJsxZ+r2SxI8YqVLAVPCpAb5Roczc6o2c+cZBt9oDm0DP9372hUB0w7Dui9nHPIM85iVu51ObndDPRJ8OtZndzq32xxm5YfkcTJzX21oZZaoHCMnuuRSMqb1lwlOSUQ/+VlYBZixyHMNX3aJYjpBd9Zwt5b7RL2TNCZ03g2u0Hwmukuv4T51dAEhiuTLwtNaqsFdvk8BKxNJbv4uQn7yw8yqwCUWmwP6bZgCH/9K8vXzCHdGnhZmOm4OpKV7RZlJ8OuTb3hRzYQ3Zv0dkpA/mtzxaoJf0qTA98XffkAuOzHTI1DDQsL/UeBOAC+Vplm3Z3s52aIZd2Ju/+x+RFMsEbyEOwr8n7Bs47mDt+OY+W4WtUhHuhYtyaJ5yuClU6D2bsrmm6Ybcuh6YnFyToG/BR6XK3AqOItzC12Vym86iCRXe020KYJLkfiMRHARTfIdrdT3rTpdJnGHZfyPfKf8dyqXMricku8fLONuuqBm6Oe46gPVyYDHgDi1wCPjrDrQVadeC5lZ9QfE5IA8t+CQJV4D8LglzyC56m+tmclRtscwi1DB7oi4ZcCO5Vv0JqvRG6uXiTQj6TJ5S9wOwK7NMJM+n9wiaS9+xC2eRFMBzCzidglmBQpfLoWqTl4wzwyV6fsRzKWyxG8AZlcs/e9yEwW+SXI5AtOrkWQwqlIEkmAkOyzb8oIT/Id3mArTy+Q5BqMmRWCXv/VemekQw05QB3bD9jauLv9OL4djsGD//Df+/R1E32B860Kaf2zY/OiQZhyYG8ESrcHWoFQacTYhTlIUHnnv1JHENvds4IKxaPWCc/VQoChYvHPIC8YC1wt0GBcBZXKNBPaJOzcHTIIemWXGT93BI+PyRXKC+R8LyaIIXIFJjrUXbyZ4RpisJ0EeghUHk50u3VczkHZOV46wW81AzJ2Y9pXMOYd8YD03YmJALgGrOYvsLa+Jr7SKURW8GqyvrRKCNQt5mM/s/wC3L7RI9AUYP5iPcZAHzI/ZfLDk4NempVXB74lcef7gTOaJ2BD80rSsLiIwZF7rmvzBTYQfgTv+C479o284uGGUwZ3QkjJRBjf8kODMKIPTaElilMGZWxSc/OcHN4oyuDNakhplcBY+cnBwEIEnWlIDEXAiHByGYF998CvSsqwk+AXrTPYRkTzM3/UB3CSTlnYNfg/MNz55YLMGdxhdZxLpnlbwjxBdV5FD1uDs4KqVWA/A6GCT2U25165JK2nn8FuunAQbnbUdS4JcJvvt3iNXhfnDO3fHmnb2RCu7P3n9/1kFzpcQ9tgf7B3G9a7C2dIlTVHogQX7h8+Tq4OfjF27apxrfJUiwbvKrzGOiD+DR5XG/upBFjmKwhBsLvybnnGBY6BOrhPGi30fTCSKQhts9hnv1RNy1YNZRYttieQk2Ceh/Jpgk3DYNs9bwTxml1y/2H6j+s69fc3jEIy+k8uSsIJfQdFKlulxUeN/SWidIlDgbp1ENaZBJQuRPAksLWGR61kEozLxcyT+MxZWgmH+SyJgMvz1TiOo2JeJXxfMmL5CgVzmZOVSjaHQ3ZbBzPyIscEn2wyHDmqTNXF1/38wNGZugJ1B3PbArsHQWvtmsq9yeeXGtScUxQUHjbglwX/JrTKFfZ6s1Umu2ptbdaJ5CZMcfXUc47DuqFhKfvov1lst+NRwttCdzSNxqoOdf+hghdPW+vTeQnOlMUp6Il8FXHTilAeXCvmeJCzhaXpQKq3yQaT76M6L5ojPAJyuyHcvrXKnlt68gPx8pdyGSXDqE5cGOCWHKyV3/vag7EUwSK6Qm1MEL51m2I+XFs14+jWkWTnwKjorJCfbb3fSSsv+DZUeBU7ATaFJTrexnwWy8zd6E4XapTmdZsQlKz1l2YlfCa+EwXKT6OIzBb5GW6PUb5Qkv5J+VtZNWrt4nlyd8/tKgeficsulgTB7PudBWLLF2r2ICChDt19LGr6bxecrhUJjQC++C4iAeB/WHC98uXQ8Z7OD6gtqnSf0JEQiWe/80tPvz+50TCq0Oj8PBEQi0aMJ3Z1FmwKz2yk6vXMDyC1nKjcZa9PbcDcvuUcTnJaMeWrzP0tiuPAzyg2bJnVlrE+H/bAbG/mJJtkNeeH4P0xgwj4F2hlMEkqXDk1pS1ijJnujDEZSm6Y4lyUBkzJtCuzP7MH7nKuyF002GMZ8/wpYpzLNchJYJ+FfeuP5Qst6sZavHAp8n98Tw9fvjPVsmuEcgh1r46ArrNmhQzPsXmesT775nTbyI1pGP491O6a3nBzWLd+nZYzyoS0PF2tKWDvhkd44xfpJTQq3uMVleUTv6O5gE+QhTbkSsAk7T/SOURlz5Qe0yLAqYDNSXYbBiJ9QHdIigzxCJK8WxFYTsTHCiUWufgWbI9YWRHeVRLhSl+Zq7wnYKKl6+WSaj+e7AjZK2GvTXN0SFtu9deiNx5M0tkj65JHecG538b6kZvTJ5bQbFRlbR6402g65TENLrlwuaWFrWeRSGTsVbCnGfgcPwS7TlqqxnX9pBAUlW+qG7be08tY/5Cy2Ha0EefLYSnnyJBjbhB1jKx2Tq8tasNjGVmqz7syUyGVL2ELBfKyE1Yg2uQ6whQ7IZYvMP7I/Cdg6Qp9cd+wTQKpi61TJU+Po9/osY8sEbz90kjxVd3cCtopwx9W8NEe+f7BV/iFfjrPQ8xhbROf9PVexyfcFW+ML+WyF/4ULVxK2gnRNgaMo3lpl7mAL7JgUuAMreUATWjL+cnKLJgxkMMuNaIJ9nsNfLNe0acIoF+U7W/vnB8WcjL+MnCseNPuhzV/5k/MNuj+N0yNNzSn4Yyk5VTs6NX51B+tpmlsY0kKW2bkx6sfarqrIiDlZUXe147px0zEtWmhYADelS0t7Nh86Rks/1vbUHSWFD5dSdtQ97URvGZ0HP6sldBVEQGwSK3Mc5A/D0PWaphVVVVFS6wxJUdWiptV03TB+jIMyiVVTRDTUPkXINM1up9O5NAzjTB870F6UVFdamSOtukraiwN97MwwjMtOp9M1zQFFqK8iMuKRRVvCOhIRpcTRgLbA4CiBqAnF1pD+asNWUcB6ZPZ042d3QH8Pf1pa38tg/eTs78njz0fToT+UYz6+TuKzMj6EqOyUtCPd+NZ5inuKjvnU+WboR1ppR5EQK4KSVcvjGJvGj3GOFn0wa5zUD6M5jqqsZhUBfw7xZVJa0aq63jCMX52Oaa7rqnRM0+x0fhlGQ9erWuVlsi3ib5NUXvJUi9rYkT52avx22XnHpfHbqT52pI0V1ZeElCQ+ffr06dOnT58+ffq0Vv8Pd1tQ/byTTDgAAAAASUVORK5CYII=");return r.Resources.addImage("brandb64.png","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAATgAAAAwCAMAAACyhZaBAAAA51BMVEUAAAD////////////////////////+/v7////+/v7////+/v7////+/v7+/v7////////////+/v7+/v7////+/v7+/v7+/v7////+/v7+/v7+/v7+/v7+/v7////+/v7////+/v7+/v7////+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7////+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7////+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7////lHQ1rAAAATHRSTlMABAgMEBQYHCAkKCwwNDg8QERITFBUWFxgZGhscHR4fICEh4iLjI+QlJeYm5ygo6SnqKuvsLO0t7i7vL/Aw8fLz9PX29/j5+vv8/f7XUAsSgAABmRJREFUeAHswYEAAAAAgKD9qRepAgAAuDqzb0sb6eLwSQiYCEqsKAiKsT48urbpVltlK+8vIgnz/T/PbsMM+c0wSRuW64K9/2nJGcnkZl7OmWwF57Tmed5FzbVJj2UfUAK5pJBp24Qczdk606hNqY/XgqFfzRGSt21D8/Um9E+614HSp68smY+0KeXPM+h0p+mQSvNng0Xb0f3x+J9Q+GD8RqDHdNwT0XHAVOYtizg5PwqPTiWVkep+PvpQXfbP4u2fwp+3fordH7M0DmgjjjpMRdxScCNGR55UjLdl6A9ScLiLS1qxYDr6RDTRBd6OacmlcElAk0U0ow8hi7jC9njrOkvjA21CU/c4nwn5wATPpFISoYoidMCv/6AVTMs0MRKUKcJjHOLARQ+/2ZPbe9g4hRptwP+ZjgkB1lvKPRoi8g6jEbsabCAOvnNfxXlJDwN8xpUH9CjBrwQU43Fc/IW4PkRUHrYkLn2qnlJm3AXT8oJroH4Sc4Zx6IS0+0D1F+IeUsSFue2IK295czDGq5F0W7aIDtzLdrTONihG3jsWRUJMMD82SFBlMXfp4t5sjKhUtiBu2+kIPt+zRQKr3mdPBgxK3mTE//1GpB+OoNucwdXOmjhaAwOm7VT+FL/H9ZbEkb4TmzIQ3gzSAgMudJ554xIBFwyYWbqVc55JHKeGw3XvxDni0SzSgqljixw+CnwC7hjCe2rJFUJhA3EGzwJv904cJopNSuYxdvvAV7kChP9iEQPRCjvegfwyqziaQkq7d+K+/3pXKSx4H+D/1xCf8dXtG+TqfMAtimO4mFFcnl9x900cPvWQtGBhE0ajzOf7INT3IhPh83hmENGVmNIvmIxlEmd84kPY3EdxFlTZSYxxXSsJTWub6oGQer6qXkNHLICdbOJydqk+hL1h/8QVMYuQTmssVUwZdmFMgs/5skdi6+gTna1cN5QRqintbF0Etum9FOfqynOrHc3ekrRpTuTdJDCJc81TXyJ6EgVWe+nSITplS0xK1NPSRLDI30txZ7gAc8QCNaCIiUgKlhzAXMVK9TUenHc2z5NhSB8mi/PTaooy7ae4mk5cg1+0cDKXidNXlvvX+PF57N2Lv9TCfCS7uFnD+A+JO8KLfE8NDKW3U+JMoIc13nhZoEVhnsXWM4kDOoW9FHeuE2fyi3Uot9pry+KhfKZ7Ef0l1gtX6PUmWVxVEwHGuX3eHE4JmcU3NUM14zUX0hjK4zfgud0iH13pykWaiHorqhgRgTv/Zc44XyRxJsW0diMOZ+UFISP+sGD2ZO347VFOaMrqodcPqV57zZ4An83EdEBxNsX4uxOXx5RAgKOkyTRgaubKD/Qmwvy3ENXtaINa9ZAPuqc9FEe8b+0kcd9TD01he8mBJ5ip5KHmbOLoRuSM8AMerx8vNHchrof5rDIZfRhBGirS8Yr6NqxHpMYzizuJj//OdW9VprzG24W4W13pEKwK2DxL5hp7OBNbR4hRHJHZxWFdU8LXE5yC8LoLca5yuI0r/KX4rwruDvdKWtdWplQF1qYs4lB6DX6QmaEm6qG5C3HGbH0KPMe72QVLZogL9FApXQNDTfuyizNGUHZ0mJoAmBOxfe9AXDxXgxO14grMOGpq3qPOMd3oKutSTx3SbmZxxZUrB3rFgiLX+sQvNHYjrhCIbfDeiYr4B1xNfLGCIR4uW11FnLWQzgSoqBfnIc28mgDf+o9jfoHf3QpX5rxDIqvSFx8tvTgdo/z2xGGmNu12J0ywcGItI0LquGyp4qg6Zmz+LU8cW86gmZa2PsJp8amh55b04rR4WxRn9FK6O0Qt6qtYV8n5tNjyGsr05FLEBcsyPzfVRqe5LOK+b1EcFcZMQ8+ATEkW525fnJ0Qwd3gKNBZPaIs4rrbFEeFgeY0J0cgzt+huP+RoLxubl6mHYoj4yZkEqFnSC9qHghxsK5/xRYp1fBZqriCKP5UghreuK9OCycOyi8ur9KmKm+6oH9P4RZqq/eWQ5x6dI95iSS+LAdlJPd82eKIkvi03F5MrOZU3omostBouyuQROVH3GrRrhDwcVkT867nZymbgyc+bIXSRct/efXvGpKDg9Nazc2RwqHrukJm3q2eKy2Uxie1ypEhalndQhVGw8odyDIH9+ear7Uq1/5j99G/rlgk45zUzsrm6q695HSECm616hboN/gbveDbb/g5gkYAAAAASUVORK5CYII=").onSuccess(function(){n._onImageLoaded()}),i}return __extends(t,o),t.prototype._onImageLoaded=function(){var t=r.Sprite.fromFrame("catb64.png"),e=r.Sprite.fromFrame("catb64.png");e.tint=this.optFillColor;var i=r.Sprite.fromFrame("brandb64.png"),n=new r.Container;this.addChild(n),n.addChild(t),n.addChild(e),n.addChild(i),i.y=e.height+50,i.x=(e.width-i.width)/2,n.setSizeFromChildren(!1),r.layout.centerOnXInParent(n),r.layout.centerOnYInParent(n),this.progressbar=new r.ProgressBar(e,3,0),this.progressbar.setProgress(0)},t.prototype._onProgress=function(t){t!=this.lastProgress&&(this.finishing||(this.lastProgress=t,null!=this.progressbar&&this.progressbar.setProgress(t)))},t.prototype.onLoadComplete=function(){if(o.prototype.onLoadComplete.call(this),!(1<=this.lastProgress)){this.finishing=!0;var t=this.optDelayBeforeCompleteFire-50,e=1-this.lastProgress,i=this.lastProgress*t/e;this.progressbar.startTimeLimited(i+t,i)}},t}(r.H5PreLoadingScene);r.GBPreLoadingScene=t}(h5ge||(h5ge={})),function(t){var r=(p=t||{}).__deffered||[];function c(t){return null==t?null:t.length<=1?t.toUpperCase():t.charAt(0).toUpperCase()+t.slice(1)}p.__deffered=r;var e=function(){};e.prototype.loadNConstant=function(t,e,i){var n=function(){};(p[t]=n).domainID=i.domainID,n.serializerID=e.serializerID,e.name=t,n.values=function(){return n._values},n.prototype.getValue=function(){return this._value},n.prototype.name=function(){return this._name},n.prototype.ordinal=function(){return this._value},n.prototype.init=function(t,e){return null==n._values&&(n._values=new Array),this._value=e,this._name=t,n._values.push(this),this},n.fromValue=function(t){for(var e=0;e<n._values.length;e++){var i=n._values[e];if(i.getValue()==t)return i}return null},n.valueOf=function(t){for(var e=0;e<n._values.length;e++){var i=n._values[e];if(t==i.name())return i}return null},n.prototype.getDomainID=function(){return n.domainID},n.prototype.getSerializerID=function(){return n.serializerID},n.prototype.toString=function(){return t+"."+this._name},n.prototype.clone=function(){return this};for(var o=0;o<e.values.length;o++){var r=e.values[o];n[r.text]=(new n).init(r.text,r.value)}},e.prototype.addField=function(t,e,i,n){i.name=e;var o=n.hierarchyDepth+i.propertyId;i.serializerID=o;var r,s=c(e),a="get";"Boolean"==(r=i).type&&1==r.primitive&&(a="is"),i.getter=a+s,i.setter="set"+s,t.prototype[a+s]=function(){return this["_"+e]},t.prototype["set"+s]=function(t){this["_"+e]=t,this["_"+e+"Set"]=!0},t.prototype["is"+e+"Set"]=function(){return this["_"+e+"Set"]},t.prototype["unSet"+e]=function(t){this["_"+e+"Set"]=!1}},e.prototype.loadNObject=function(n,o,t){var e={};p._serializer[n]=e,o.name=n;var i=function(){};if(p[n]=i,null!=o.extendss){var r=p[o.extendss.name];(i.prototype=new r).constructor=r}for(var s in i.prototype.init=function(){return this},i.domainID=t.domainID,i.serializerID=o.serializerID,i.prototype.getDomainID=function(){return i.domainID},i.prototype.getSerializerID=function(){return i.serializerID},o.fields){var a=o.fields[s];this.addField(i,s,a,o),e[a.serializerID]=a}for(var h=o.extendss;null!=h;){var c=p._specs[h.domainID];if(null==c)throw"Domain "+h.domainID+" not loaded";var l=c.nobjects[h.name];if(null==l)throw"NObject "+h.name+" not loaded";for(var s in l.fields){var u=l.fields[s];e[(o.fields[s]=u).serializerID]=u}h=h.extendss}i.prototype.toString=function(){var t="";for(var e in t+="["+n+" --\x3e ",o.fields){var i=this[o.fields[e].getter]();p.Utils.isNull(i)||(t+=e+"="+i+"| ")}return t+="]"},i.prototype.clone=function(){var t=new i;for(var e in this){"function"!=typeof this[e]&&(t[e]=this[e])}return t}},e.prototype.createSerializerFactory=function(t){var l=[];for(var e in t.nconstants){var i=t.nconstants[e];l[i.serializerID]=i}for(var e in t.nobjects){var n=t.nobjects[e];l[n.serializerID]=n}var o=function(){this.dynamicFieldResolver=(new p.DefaultDynamicFieldResolver).init()};(p["String"+t.domainName+"SerializerFactory"]=o).prototype.init=function(){return this},o.prototype.setDynamicFieldSerializerResolver=function(t){this.dynamicFieldResolver=t},o.prototype.writeField0=function(t,e,i,n){if(n.list){if(n.primitive){var o="write"+n.type+"ListProperty";return p.StringOutputStream[o](e,n.serializerID,i)}if(null==e)return!1;i.putShort(n.serializerID),i.put(p.SerializationTypes.LIST);var r=i.position();i.skip(4);var s=e.length;i.putShort(s);for(var a=0;a<s;a++){var h=e[a];null==h?i.put(p.SerializationTypes.NULL_TYPE):p.StringOutputStream.writeObject(t,h,i)}return i.putIntAt(r,i.position()-r),!0}if(n.primitive){o="write"+n.type+"Property";return p.StringOutputStream[o](e,n.serializerID,i)}return n.reference?p.StringOutputStream.writeObjectProperty(t,e,n.serializerID,i):n.structure&&"nmap"==n.type?p.StringOutputStream.writeNMapProperty(t,e,n.serializerID,i,this.dynamicFieldResolver):(console&&console.error("Field not supported!!"),!1)},o.prototype.write=function(t,e,i){var n=e.getSerializerID(),o=l[n];if(null==o)throw Error("No serializer found for "+e);if(null!=o.values)p.StringOutputStream.writeInteger(e.getValue(),i);else{var r=i.position();i.skip(2);var s=0;for(var a in o.fields){var h=o.fields[a];if(1==e["is"+a+"Set"]()){var c=e[h.getter]();this.writeField0(t,c,i,h)&&s++}}i.putShortAt(r,s)}},o.prototype.readField0=function(t,e,i,n){if(n.list){if(n.primitive){var o="read"+n.type+"List";return p.StringInputStream[o](i)}var r=new Array;if(i.get()!=p.SerializationTypes.NULL_TYPE){i.getInt();for(var s=i.getShort(),a=0;a<s;a++)r.push(p.StringInputStream.readObject(t,i))}return r}if(n.primitive){o="read"+n.type;return p.StringInputStream[o](i)}return n.reference?p.StringInputStream.readObject(t,i):n.structure&&"nmap"==n.type?p.StringInputStream.readNMap(t,i,this.dynamicFieldResolver):void 0},o.prototype.readSerializable=function(t,e,i){var n=l[i];if(null==n)throw Error("No serializer found for "+i);if(null!=n.values){var o=p.StringInputStream.readInteger(e);return p[n.name].fromValue(o)}o=new p[n.name];for(var r=p._serializer[n.name],s=p.StringInputStream.getShort(e),a=0;a<s;a++){var h=r[p.StringInputStream.getShort(e)];if(null!=h){var c=this.readField0(t,o,e,h);o[h.setter](c)}else p.StringInputStream.skipProperty(e)}return o}},e.prototype.createDispatcher=function(r){var s=function(){};function t(t,e){var i=e?t:c(t)+"Response",n=i+"Handler",o=r.nobjects[i];s.prototype["add"+n]=function(t){this.listenersBySerializerId[o.serializerID].push(t)},s.prototype["remove"+n]=function(t){var e=this.listenersBySerializerId[o.serializerID].indexOf(t);0<=e&&this.listenersBySerializerId[o.serializerID].splice(e,1)}}if((p[r.domainName+"Dispatcher"]=s).prototype.init=function(){return this.clear(),this},s.prototype.fireMessage=function(t){var e=t.getSerializerID(),i=this.listenersBySerializerId[e];if(null!=i){for(var n=0;n<this.globalListeners.length;n++){(0,this.globalListeners[n])(t)}for(n=0;n<i.length;n++){(0,i[n])(t)}}},s.prototype.clear=function(){if(this.globalListeners=new Array,this.listenersBySerializerId={},null!=r.methods)for(var t in r.methods){var e=c(t)+"Response",i=r.nobjects[e];this.listenersBySerializerId[i.serializerID]=new Array}if(null!=r.notifications)for(var n=0;n<r.notifications.length;n++){var o=r.notifications[n];i=r.nobjects[o];this.listenersBySerializerId[i.serializerID]=new Array}},s.prototype.addHipGsMessageListener=function(t){this.globalListeners.push(t)},s.prototype.removeHipGsMessageListener=function(t){var e=this.globalListeners.indexOf(t);0<=e&&this.globalListeners.splice(e,1)},null!=r.methods)for(var e in r.methods)t(e,!1);if(null!=r.notifications)for(var i=0;i<r.notifications.length;i++){t(r.notifications[i],!0)}},e.prototype.createAPI=function(t){null!=p.AbstractNuggetaApi&&this.createAPI0(t,!1),null!=p.AbstractDisconnectedApi&&this.createAPI0(t,!0)},e.prototype.createAPI0=function(n,t){if(0!=n.domainID){var h=function(){};for(var e in t?((p[n.domainName+"DisconnectedApi"]=h).prototype=new p.AbstractDisconnectedApi,(h.prototype.constructor=h).prototype.init=function(){return this.dispatcher=(new p[n.domainName+"Dispatcher"]).init(),this.domain=(new p[n.domainName+"Domain"]).init(),p.AbstractDisconnectedApi.prototype.init.call(this),this}):((p[n.domainName+"Api"]=h).prototype=new p.AbstractNuggetaApi,(h.prototype.constructor=h).prototype.init=function(){return this.dispatcher=(new p[n.domainName+"Dispatcher"]).init(),this.domain=(new p[n.domainName+"Domain"]).init(),p.AbstractNuggetaApi.prototype.init.call(this),this}),h.prototype.getDomain=function(){return this.domain},h.prototype.getDispatcher=function(){return this.dispatcher},n.methods)o(e);if(null!=n.methods)for(var e in n.methods){r(c(e)+"ResponseHandler")}if(null!=n.notifications)for(var i=0;i<n.notifications.length;i++){r(n.notifications[i]+"Handler")}h.prototype.callHandler=function(t,e){e(t)}}function o(t){for(var o=n.methods[t],r=c(t)+"Request",s=o.parameters.length,a=new Array,e=0;e<s;e++){var i=o.parameters[e];a.push("set"+c(i))}h.prototype[t]=function(){if(arguments.length!=s)throw"Invalid api call. Received "+arguments.length+" arguments, expected "+o.parameters;for(var t=new p[r],e=0;e<s;e++){var i=a[e],n=arguments[e];t[i](n)}return this.send(t)},h.prototype[t+"Request"]=function(){if(arguments.length!=s+1)throw"Invalid api call. Received "+arguments.length+" arguments, expected "+o.parameters+" and response handler.";for(var t=new p[r],e=0;e<s;e++){var i=a[e],n=arguments[e];t[i](n)}return this.request(t,arguments[arguments.length-1])}}function r(e){h.prototype["add"+e]=function(t){this.dispatcher["add"+e](t)},h.prototype["remove"+e]=function(t){this.dispatcher["remove"+e](t)}}},e.prototype.createDomain=function(t){var e=function(){};p[t.domainName+"Domain"]=e;var i="String"+t.domainName+"SerializerFactory";(e.prototype=new p.NDomain).constructor=p[t.domainName+"Domain"],e.prototype.init=function(){return p.NDomain.prototype.init.call(this),this.setDomainId(t.domainID),this.setStringSerializerFactory(new p[i]),this}},e.prototype.load=function(t){for(var e in console&&console.log("Loading "+t.domainID),p._specs=p._specs||{},p._specs[t.domainID]=t,p._serializer=p._serializer||{},t.nconstants){var i=t.nconstants[e];this.loadNConstant(e,i,t)}for(var e in t.nobjects){var n=t.nobjects[e];this.loadNObject(e,n,t)}this.createSerializerFactory(t),this.createDispatcher(t),this.createAPI(t);var o=this;void 0===p.NDomain?(console&&console.log("Deffer domain creation"),r.push(function(){console&&console.log("Executing deffered domain creation"),o.createDomain(t)})):this.createDomain(t)},e.loadDeffered=function(){for(var t=p.__deffered,e=0;e<t.length;e++)t[e]();t=[]},p.nruntime=e,console&&console.log("nruntime ready");(new(p=t||{}).nruntime).load({domainID:0,domainName:"NuggetaCore",nconstants:{DnsStatus:{serializerID:0,values:[{value:0,text:"SUCCESS"},{value:1,text:"WARNED"},{value:2,text:"REFUSED"},{value:3,text:"FAILED"},{value:4,text:"FAILED_TRY_LATER"}]},ErrorCode:{serializerID:1,values:[{value:0,text:"INVALID_MESSAGE"},{value:1,text:"INTERNAL_ERROR"}]},NMonitorType:{serializerID:2,values:[{value:0,text:"AVERAGE"},{value:1,text:"COUNT"}]}},nobjects:{Storable:{hierarchyDepth:0,serializerID:3e3,fields:{StoreId:{propertyId:0,primitive:!0,type:"String"},DF:{propertyId:1,structure:!0,type:"nmap"}}},Message:{hierarchyDepth:1e3,serializerID:3001,extendss:{domainID:"0",name:"Storable"},fields:{SenderId:{propertyId:0,primitive:!0,type:"String"},MessageId:{propertyId:1,primitive:!0,type:"String"},RequestId:{propertyId:2,primitive:!0,type:"String"}}},HeartBeatRequest:{hierarchyDepth:2e3,serializerID:3002,extendss:{domainID:"0",name:"Message"},fields:{Counter:{propertyId:0,primitive:!0,type:"Integer"}}},HeartBeatResponse:{hierarchyDepth:2e3,serializerID:3003,extendss:{domainID:"0",name:"Message"},fields:{Counter:{propertyId:0,primitive:!0,type:"Integer"}}},DnsRequest:{hierarchyDepth:2e3,serializerID:3004,extendss:{domainID:"0",name:"Message"},fields:{GameId:{propertyId:0,primitive:!0,type:"String"},GameVersion:{propertyId:1,primitive:!0,type:"Integer"},GameDeployedVersion:{propertyId:2,primitive:!0,type:"Integer"},Platform:{propertyId:3,primitive:!0,type:"String"}}},DnsResponse:{hierarchyDepth:2e3,serializerID:3005,extendss:{domainID:"0",name:"Message"},fields:{IpAddress:{propertyId:0,primitive:!0,type:"String"},TcpPort:{propertyId:1,primitive:!0,type:"Integer"},DnsStatus:{propertyId:2,reference:!0,type:"DnsStatus",domainId:"0"},StartDetails:{propertyId:3,reference:!0,type:"StartDetails",domainId:"0"}}},StartDetails:{hierarchyDepth:0,serializerID:3006,fields:{UseDefaultImpl:{propertyId:0,primitive:!0,type:"Boolean"},CurrentVersion:{propertyId:1,primitive:!0,type:"Integer"},NextVersion:{propertyId:2,primitive:!0,type:"Integer"},Title:{propertyId:3,primitive:!0,type:"String"},Text:{propertyId:4,primitive:!0,type:"String"},Url:{propertyId:5,primitive:!0,type:"String"}}},StopPlugConnectionRequest:{hierarchyDepth:2e3,serializerID:3007,extendss:{domainID:"0",name:"Message"},fields:{}},StopPlugConnectionResponse:{hierarchyDepth:2e3,serializerID:3008,extendss:{domainID:"0",name:"Message"},fields:{}},NuggetaExceptionMessage:{hierarchyDepth:2e3,serializerID:3009,extendss:{domainID:"0",name:"Message"},fields:{ErrorCode:{propertyId:0,reference:!0,type:"ErrorCode",domainId:"0"},Reason:{propertyId:1,primitive:!0,type:"String"}}},NuggetaQuery:{hierarchyDepth:0,serializerID:3010,fields:{domain:{propertyId:0,primitive:!0,type:"String"},start:{propertyId:1,primitive:!0,type:"Integer"},limit:{propertyId:2,primitive:!0,type:"Integer"},query:{propertyId:3,primitive:!0,type:"String"}}},NRawMessage:{hierarchyDepth:2e3,serializerID:3011,extendss:{domainID:"0",name:"Message"},fields:{content:{propertyId:0,primitive:!0,type:"String"}}},NStringPair:{hierarchyDepth:0,serializerID:3012,fields:{Key:{propertyId:0,primitive:!0,type:"String"},Value:{propertyId:1,primitive:!0,type:"String"}}},NMessagesList:{hierarchyDepth:2e3,serializerID:3013,extendss:{domainID:"0",name:"Message"},fields:{storables:{propertyId:0,list:!0,type:"Storable",domainID:"0",reference:!0}}},NMonitor:{hierarchyDepth:1e3,serializerID:3014,extendss:{domainID:"0",name:"Storable"},fields:{Type:{propertyId:0,reference:!0,type:"NMonitorType",domainId:"0"},Name:{propertyId:1,primitive:!0,type:"String"},Description:{propertyId:2,primitive:!0,type:"String"},Enabled:{propertyId:3,primitive:!0,type:"Boolean"}}}},notifications:["NRawMessage"]}),(p=t||{}).StringUtil=function(){},p.StringUtil.prototype.init=function(){return this},p.StringUtil.pad=function(t,e){for(var i=t.length;i<e;i++)t="0"+t;return t},p.ConnectionFail=function(){},p.ConnectionFail.prototype=new p.Message,p.ConnectionFail.prototype.constructor=p.ConnectionFail,p.ConnectionFail.prototype.init=function(){return this},p.ConnectionFail.prototype.getSerializerID=function(){return 0},p.ConnectionFail.prototype.getDomainID=function(){return 0},p.ConnectionFail.prototype.clone=function(){return null},p.StringStream=function(){},p.StringStream.prototype.init=function(t){return this._position=0,this.str=t,this},p.StringStream.prototype.getStringWithSize=function(t){var e=this.str.substring(this._position,this._position+t);return this._position=this._position+t,e},p.StringStream.prototype.append=function(t){this.str.appendString(t),this._position=this.str.length1()},p.StringStream.prototype.toString=function(){return this.str.toString()},p.StringStream.prototype.position=function(){return this._position},p.StringStream.prototype.limit=function(){return this.str.length1()},p.StringStream.prototype.skip=function(t){},p.StringStream.prototype.setPosition=function(t){this._position=t},p.StringStream.prototype.ignore=function(){var t=parseFloat(this.getStringWithSize(1)),e=parseFloat(this.getStringWithSize(t));this._position=this._position+e},p.StringStream.prototype.ignoreLength=function(t){this._position=this._position+t},p.StringStream.prototype.putShortAt=function(t,e){this.writeStringAt(t,""+e)},p.StringStream.prototype.writeStringAt=function(t,e){var i=(new p.StrBuilder).init("");i.appendString(this.str.substring(0,t));var n=""+e.length,o=n.length;i.appendString(""+o),i.appendString(n),i.appendString(e),i.appendString(this.str.substring(t,this.str.length1())),this.str=i,this._position=i.length1()},p.StringStream.prototype.writeString=function(t){this.writeLength(t.length),this.append(t)},p.StringStream.prototype.getShort=function(){return parseFloat(this.readString())},p.StringStream.prototype.getDouble=function(){return parseFloat(this.readString())},p.StringStream.prototype.getInt=function(){return parseFloat(this.readString())},p.StringStream.prototype.getLong=function(){return parseFloat(this.readString())},p.StringStream.prototype.getString=function(){return this.readString()},p.StringStream.prototype.get=function(){return parseFloat(this.readString())},p.StringStream.prototype.getFloat=function(){return parseFloat(this.readString())},p.StringStream.prototype.putShort=function(t){this.writeString(""+t)},p.StringStream.prototype.putString=function(t){this.writeString(t)},p.StringStream.prototype.put=function(t){this.writeString(""+t)},p.StringStream.prototype.putIntAt=function(t,e){this.writeStringAt(t,""+e)},p.StringStream.prototype.putDouble=function(t){this.writeString(""+t)},p.StringStream.prototype.putInt=function(t){this.writeString(""+t)},p.StringStream.prototype.putLong=function(t){this.writeString(""+t)},p.StringStream.prototype.putFloat=function(t){this.writeString(""+t)},p.StringStream.prototype.writeLength=function(t){var e=""+t,i=e.length;this.str.appendString(""+i),this.str.appendString(e)},p.StringStream.prototype.pad=function(t,e){for(var i=t.length;i<e;i++)t="0"+t;return t},p.StringStream.prototype.readString=function(){var t=parseFloat(this.getStringWithSize(1)),e=parseFloat(this.getStringWithSize(t));return this.getStringWithSize(e)},p.StringStream.prototype.getKeyShort=function(t){return 0},p.StringStream.prototype.getKeyDouble=function(t){return 0},p.StringStream.prototype.getKeyInt=function(t){return 0},p.StringStream.prototype.getKeyLong=function(t){return 0},p.StringStream.prototype.getKeyFloat=function(t){return 0},p.StringStream.prototype.getKeyString=function(t){return null},p.StringStream.prototype.putKeyShort=function(t,e){},p.StringStream.prototype.putKeyString=function(t,e){},p.StringStream.prototype.putKeyDouble=function(t,e){},p.StringStream.prototype.putKeyInt=function(t,e){},p.StringStream.prototype.putKeyLong=function(t,e){},p.StringStream.prototype.putKeyFloat=function(t,e){},p.SerializerFactoryType=function(){},p.SerializerFactoryType.prototype.init=function(){return this},p.SerializerFactoryType.BINARY=0,p.SerializerFactoryType.STRING=1,p.SerializerFactoryType.JSON=2,p.StringInputStream=function(){},p.StringInputStream.prototype.init=function(){return this},p.StringInputStream.readObject=function(t,e){var i=null;try{if(e.get()==p.SerializationTypes.NULL_TYPE)return null;e.getInt();var n=e.getInt(),o=t.getDomain(n);if(null==o)throw new Error("No domain available for domain id "+n,null);var r=o.getStringSerializerFactory();if(null==r)throw new Error("No string factory found in domain "+n,null);var s=e.getShort();i=r.readSerializable(t,e,s)}catch(t){throw new Error("Can't read Object",t)}return i},p.StringInputStream.readObjectList=function(t,e){var i=new Array;if(e.get()==p.SerializationTypes.NULL_TYPE)return i;e.getInt();for(var n=e.getShort(),o=0;o<n;o++){var r=p.StringInputStream.readObject(t,e);null!=r&&i.push(r)}return i},p.StringInputStream.readIntegerList=function(t){if(t.get()==p.SerializationTypes.NULL_TYPE)return null;t.getInt();for(var e=t.getShort(),i=new Array,n=0;n<e;n++){t.get()==p.SerializationTypes.NULL_TYPE?i.push(p.Utils.NULL_INTEGER):i.push(t.getInt())}return i},p.StringInputStream.readShortList=function(t){if(t.get()==p.SerializationTypes.NULL_TYPE)return null;t.getInt();for(var e=t.getShort(),i=new Array,n=0;n<e;n++){t.get()==p.SerializationTypes.NULL_TYPE?i.push(p.Utils.NULL_SHORT):i.push(t.getShort())}return i},p.StringInputStream.readLongList=function(t){if(t.get()==p.SerializationTypes.NULL_TYPE)return null;t.getInt();for(var e=t.getShort(),i=new Array,n=0;n<e;n++){t.get()==p.SerializationTypes.NULL_TYPE?i.push(p.Utils.NULL_LONG):i.push(t.getLong())}return i},p.StringInputStream.readFloatList=function(t){if(t.get()==p.SerializationTypes.NULL_TYPE)return null;t.getInt();for(var e=t.getShort(),i=new Array,n=0;n<e;n++){t.get()==p.SerializationTypes.NULL_TYPE?i.push(p.Utils.NULL_FLOAT):i.push(t.getFloat())}return i},p.StringInputStream.readDoubleList=function(t){if(t.get()==p.SerializationTypes.NULL_TYPE)return null;t.getInt();for(var e=t.getShort(),i=new Array,n=0;n<e;n++){t.get()==p.SerializationTypes.NULL_TYPE?i.push(p.Utils.NULL_DOUBLE):i.push(t.getDouble())}return i},p.StringInputStream.readStringList=function(t){if(t.get()==p.SerializationTypes.NULL_TYPE)return null;t.getInt();for(var e=t.getShort(),i=new Array,n=0;n<e;n++)i.push(p.StringInputStream.readString(t));return i},p.StringInputStream.readBooleanList=function(t){if(t.get()==p.SerializationTypes.NULL_TYPE)return null;t.getInt();for(var e=t.getShort(),i=new Array,n=0;n<e;n++){t.get()==p.SerializationTypes.NULL_TYPE?i.push(p.Utils.NULL_BOOLEAN):i.push(1==t.get())}return i},p.StringInputStream.readNMap=function(t,e,i){if(e.get()==p.SerializationTypes.NULL_TYPE)return null;e.getInt();for(var n=e.getShort(),o=(new p.NMap).init(),r=0;r<n;r++){var s=p.StringInputStream.readString(e),a=null,h=e.position(),c=e.get();if(e.setPosition(h),c==p.SerializationTypes.NULL_TYPE)e.get();else if(c==p.SerializationTypes.OBJECT)a=p.StringInputStream.readObject(t,e);else if(c==p.SerializationTypes.STRING)a=p.StringInputStream.readString(e);else if(c==p.SerializationTypes.SHORT)a=p.StringInputStream.readShort(e);else if(c==p.SerializationTypes.INTEGER)a=p.StringInputStream.readInteger(e);else if(c==p.SerializationTypes.LONG)a=p.StringInputStream.readLong(e);else if(c==p.SerializationTypes.FLOAT)a=p.StringInputStream.readFloat(e);else if(c==p.SerializationTypes.DOUBLE)a=p.StringInputStream.readDouble(e);else if(c==p.SerializationTypes.BOOLEAN)a=p.StringInputStream.readBoolean(e);else if(c==p.SerializationTypes.NMAP)a=p.StringInputStream.readNMap(t,e,i);else if(c==p.SerializationTypes.LIST){h=e.position(),c=e.get();var l=e.getInt();if(0<e.getShort()){var u=e.get();e.setPosition(h),u==p.SerializationTypes.OBJECT?a=p.StringInputStream.readObjectList(t,e):u==p.SerializationTypes.STRING?a=p.StringInputStream.readStringList(e):u==p.SerializationTypes.SHORT?a=p.StringInputStream.readShortList(e):u==p.SerializationTypes.INTEGER?a=p.StringInputStream.readIntegerList(e):u==p.SerializationTypes.LONG?a=p.StringInputStream.readLongList(e):u==p.SerializationTypes.FLOAT?a=p.StringInputStream.readFloatList(e):u==p.SerializationTypes.DOUBLE?a=p.StringInputStream.readDoubleList(e):u==p.SerializationTypes.BOOLEAN?a=p.StringInputStream.readBooleanList(e):e.setPosition(h+l)}}o.put(s,a)}return o},p.StringInputStream.readString=function(t){return t.get()==p.SerializationTypes.NULL_TYPE?null:t.getString()},p.StringInputStream.readDate=function(t){return t.get()==p.SerializationTypes.NULL_TYPE?p.Utils.NULL_DATE:new Date(t.getLong())},p.StringInputStream.readDouble=function(t){return t.get()==p.SerializationTypes.NULL_TYPE?p.Utils.NULL_DOUBLE:t.getDouble()},p.StringInputStream.readInteger=function(t){return t.get()==p.SerializationTypes.NULL_TYPE?p.Utils.NULL_INTEGER:t.getInt()},p.StringInputStream.readLong=function(t){return t.get()==p.SerializationTypes.NULL_TYPE?p.Utils.NULL_LONG:t.getLong()},p.StringInputStream.readByte=function(t){return t.get()==p.SerializationTypes.NULL_TYPE?p.Utils.NULL_BYTE:t.get()},p.StringInputStream.readShort=function(t){return t.get()==p.SerializationTypes.NULL_TYPE?p.Utils.NULL_SHORT:t.getShort()},p.StringInputStream.readFloat=function(t){return t.get()==p.SerializationTypes.NULL_TYPE?p.Utils.NULL_FLOAT:t.getFloat()},p.StringInputStream.readBoolean=function(t){return t.get()==p.SerializationTypes.NULL_TYPE?p.Utils.NULL_BOOLEAN:1==t.get()},p.StringInputStream.getInteger=function(t){return t.getInt()},p.StringInputStream.getLong=function(t){return t.getLong()},p.StringInputStream.getShort=function(t){return t.getShort()},p.StringInputStream.skipProperty=function(t){var e=t.get();if(e!=p.SerializationTypes.NULL_TYPE)if(e!=p.SerializationTypes.OBJECT&&e!=p.SerializationTypes.NMAP)t.ignore();else{var i=t.getInt();t.ignoreLength(i)}},p.NDomainList=function(){},p.NDomainList.prototype.init=function(){return this.nDomains=new Array,this},p.NDomainList.prototype.addDomain=function(t){this.nDomains.push(t)},p.NDomainList.prototype.getDomain=function(t){for(var e=0;e<this.nDomains.length;e++){var i=this.nDomains[e];if(i.getDomainId()==t)return i}return null},p.NDomainList.prototype.getDomains=function(){return this.nDomains},p.NDomainList.prototype.setDomainList=function(t){for(var e=0;e<t.length;e++){var i=t[e];this.nDomains.push(i)}},p.NDomainList.prototype.setDynamicFieldSerializerResolver=function(t){for(var e=0;e<this.nDomains.length;e++){this.nDomains[e].setDynamicFieldSerializerResolver(t)}},p.NDomain=function(){},p.NDomain.prototype.init=function(){return this},p.NDomain.prototype.getDomainId=function(){return this.domainId},p.NDomain.prototype.setDomainId=function(t){this.domainId=t},p.NDomain.prototype.getBinarySerializerFactory=function(){return this.binarySerializerFactory},p.NDomain.prototype.setBinarySerializerFactory=function(t){this.binarySerializerFactory=t},p.NDomain.prototype.getStringSerializerFactory=function(){return this.stringSerializerFactory},p.NDomain.prototype.setStringSerializerFactory=function(t){this.stringSerializerFactory=t},p.NDomain.prototype.getJsonSerializerFactory=function(){return this.jsonSerializerFactory},p.NDomain.prototype.setJsonSerializerFactory=function(t){this.jsonSerializerFactory=t},p.NDomain.prototype.setDynamicFieldSerializerResolver=function(t){null!=this.binarySerializerFactory&&this.binarySerializerFactory.setDynamicFieldSerializerResolver(t),null!=this.stringSerializerFactory&&this.stringSerializerFactory.setDynamicFieldSerializerResolver(t),null!=this.jsonSerializerFactory&&this.jsonSerializerFactory.setDynamicFieldSerializerResolver(t)},p.DomainMessageListener=function(){},p.DomainMessageListener.prototype.init=function(t,e){return this.domainId=t,this.messageListener=e,this},p.DomainMessageListener.prototype.getDomainId=function(){return this.domainId},p.DomainMessageListener.prototype.getMessageListener=function(){return this.messageListener},p.NuggetaException=function(){},p.NuggetaException.prototype=new Error,p.NuggetaException.prototype.constructor=p.NuggetaException,p.NuggetaException.prototype.init=function(t,e){return RuntimeException.prototype.init.call(this,t.getReason(),e),this.nuggetaExceptionMessage=t,this},p.NuggetaException.prototype.getNuggetaException=function(){return this.nuggetaExceptionMessage},p.StringOutputStream=function(){},p.StringOutputStream.prototype.init=function(){return this},p.StringOutputStream.writeObject=function(t,e,i){var n=e,o=n.getDomainID(),r=t.getDomain(o);if(null==r)throw new Error("No domain available for domain id "+o,null);var s=r.getStringSerializerFactory();if(null==s)throw new Error("No binary factory found in domain "+o,null);if(null==e)return!1;i.put(p.SerializationTypes.OBJECT);var a=i.position();i.skip(4);var h=i.position();i.putInt(o);var c=n.getSerializerID();return i.putShort(c),s.write(t,n,i),i.putIntAt(a,i.position()-h),!0},p.StringOutputStream.writeObjectProperty=function(t,e,i,n){return null!=e&&(n.putShort(i),p.StringOutputStream.writeObject(t,e,n),!0)},p.StringOutputStream.writeObjectListProperty=function(t,e,i,n){return null!=e&&(n.putShort(i),p.StringOutputStream.writeObjectList(t,e,n),!0)},p.StringOutputStream.writeObjectList=function(t,e,i){if(null==e)return!1;i.put(p.SerializationTypes.LIST);var n=i.position();i.skip(4);var o=e.length;i.putShort(o);for(var r=0;r<o;r++){var s=e[r];null==s?i.put(p.SerializationTypes.NULL_TYPE):p.StringOutputStream.writeObject(t,s,i)}return i.putIntAt(n,i.position()-n),!0},p.StringOutputStream.writeIntegerListProperty=function(t,e,i){return null!=t&&(i.putShort(e),p.StringOutputStream.writeIntegerList(t,i),!0)},p.StringOutputStream.writeIntegerList=function(t,e){if(null==t)return!1;e.put(p.SerializationTypes.LIST);var i=e.position();e.skip(4);var n=t.length;e.putShort(n);for(var o=0;o<n;o++){var r=t[o];p.Utils.isNullInteger(r)?e.put(p.SerializationTypes.NULL_TYPE):p.StringOutputStream.writeInteger(r,e)}return e.putIntAt(i,e.position()-i),!0},p.StringOutputStream.writeShortListProperty=function(t,e,i){return null!=t&&(i.putShort(e),p.StringOutputStream.writeShortList(t,i),!0)},p.StringOutputStream.writeShortList=function(t,e){if(null==t)return!1;e.put(p.SerializationTypes.LIST);var i=e.position();e.skip(4);var n=t.length;e.putShort(n);for(var o=0;o<n;o++){var r=t[o];p.Utils.isNullShort(r)?e.put(p.SerializationTypes.NULL_TYPE):p.StringOutputStream.writeShort(r,e)}return e.putIntAt(i,e.position()-i),!0},p.StringOutputStream.writeLongListProperty=function(t,e,i){return null!=t&&(i.putShort(e),p.StringOutputStream.writeLongList(t,i),!0)},p.StringOutputStream.writeLongList=function(t,e){if(null==t)return!1;e.put(p.SerializationTypes.LIST);var i=e.position();e.skip(4);var n=t.length;e.putShort(n);for(var o=0;o<n;o++){var r=t[o];p.Utils.isNullLong(r)?e.put(p.SerializationTypes.NULL_TYPE):p.StringOutputStream.writeLong(r,e)}return e.putIntAt(i,e.position()-i),!0},p.StringOutputStream.writeFloatListProperty=function(t,e,i){return null!=t&&(i.putShort(e),p.StringOutputStream.writeFloatList(t,i),!0)},p.StringOutputStream.writeFloatList=function(t,e){if(null==t)return!1;e.put(p.SerializationTypes.LIST);var i=e.position();e.skip(4);var n=t.length;e.putShort(n);for(var o=0;o<n;o++){var r=t[o];p.Utils.isNullFloat(r)?e.put(p.SerializationTypes.NULL_TYPE):p.StringOutputStream.writeFloat(r,e)}return e.putIntAt(i,e.position()-i),!0},p.StringOutputStream.writeDoubleListProperty=function(t,e,i){return null!=t&&(i.putShort(e),p.StringOutputStream.writeDoubleList(t,i),!0)},p.StringOutputStream.writeDoubleList=function(t,e){if(null==t)return!1;e.put(p.SerializationTypes.LIST);var i=e.position();e.skip(4);var n=t.length;e.putShort(n);for(var o=0;o<n;o++){var r=t[o];p.Utils.isNullDouble(r)?e.put(p.SerializationTypes.NULL_TYPE):p.StringOutputStream.writeDouble(r,e)}return e.putIntAt(i,e.position()-i),!0},p.StringOutputStream.writeBooleanListProperty=function(t,e,i){return null!=t&&(i.putShort(e),p.StringOutputStream.writeBooleanList(t,i),!0)},p.StringOutputStream.writeBooleanList=function(t,e){if(null==t)return!1;e.put(p.SerializationTypes.LIST);var i=e.position();e.skip(4);var n=t.length;e.putShort(n);for(var o=0;o<n;o++){var r=t[o];p.Utils.isNullBoolean(r)?e.put(p.SerializationTypes.NULL_TYPE):p.StringOutputStream.writeBoolean(r,e)}return e.putIntAt(i,e.position()-i),!0},p.StringOutputStream.writeStringListProperty=function(t,e,i){return null!=t&&(i.putShort(e),p.StringOutputStream.writeStringList(t,i),!0)},p.StringOutputStream.writeStringList=function(t,e){if(null==t)return!1;e.put(p.SerializationTypes.LIST);var i=e.position();e.skip(4);var n=t.length;e.putShort(n);for(var o=0;o<n;o++){var r=t[o];null==r?e.put(p.SerializationTypes.NULL_TYPE):p.StringOutputStream.writeString(r,e)}return e.putIntAt(i,e.position()-i),!0},p.StringOutputStream.writeStringProperty=function(t,e,i){return!p.Utils.isNull(t)&&(i.putShort(e),p.StringOutputStream.writeString(t,i),!0)},p.StringOutputStream.writeString=function(t,e){return!p.Utils.isNull(t)&&(e.put(p.SerializationTypes.STRING),e.putString(t),!0)},p.StringOutputStream.writeDoubleProperty=function(t,e,i){return!p.Utils.isNullDouble(t)&&(i.putShort(e),p.StringOutputStream.writeDouble(t,i),!0)},p.StringOutputStream.writeDouble=function(t,e){return!p.Utils.isNullDouble(t)&&(e.put(p.SerializationTypes.DOUBLE),e.putDouble(t),!0)},p.StringOutputStream.writeIntegerProperty=function(t,e,i){return!p.Utils.isNullInteger(t)&&(i.putShort(e),p.StringOutputStream.writeInteger(t,i),!0)},p.StringOutputStream.writeInteger=function(t,e){return!p.Utils.isNullInteger(t)&&(e.put(p.SerializationTypes.INTEGER),e.putInt(t),!0)},p.StringOutputStream.writeDateProperty=function(t,e,i){return!p.Utils.isNullDate(t)&&(p.StringOutputStream.writeLongProperty(t.getTime(),e,i),!0)},p.StringOutputStream.writeLongProperty=function(t,e,i){return!p.Utils.isNullLong(t)&&(i.putShort(e),p.StringOutputStream.writeLong(t,i),!0)},p.StringOutputStream.writeLong=function(t,e){return!p.Utils.isNullLong(t)&&(e.put(p.SerializationTypes.LONG),e.putLong(t),!0)},p.StringOutputStream.writeByte=function(t,e){return!p.Utils.isNullByte(t)&&(e.put(p.SerializationTypes.BYTE),e.put(t),!0)},p.StringOutputStream.writeShortProperty=function(t,e,i){return!p.Utils.isNullShort(t)&&(i.putShort(e),p.StringOutputStream.writeShort(t,i),!0)},p.StringOutputStream.writeShort=function(t,e){return!p.Utils.isNullShort(t)&&(e.put(p.SerializationTypes.SHORT),e.putShort(t),!0)},p.StringOutputStream.writeFloatProperty=function(t,e,i){return!p.Utils.isNullFloat(t)&&(i.putShort(e),p.StringOutputStream.writeFloat(t,i),!0)},p.StringOutputStream.writeFloat=function(t,e){return!p.Utils.isNullFloat(t)&&(e.put(p.SerializationTypes.FLOAT),e.putFloat(t),!0)},p.StringOutputStream.writeBooleanProperty=function(t,e,i){return!p.Utils.isNullBoolean(t)&&(i.putShort(e),p.StringOutputStream.writeBoolean(t,i),!0)},p.StringOutputStream.writeBoolean=function(t,e){return!p.Utils.isNullBoolean(t)&&(e.put(p.SerializationTypes.BOOLEAN),1==t?e.put(1):0==t&&e.put(0),!0)},p.StringOutputStream.writeNMapProperty=function(t,e,i,n,o){return!p.Utils.isNull(e)&&(n.putShort(i),p.StringOutputStream.writeNMap(t,e,n,o),!0)},p.StringOutputStream.writeNMap=function(t,e,i,n){if(p.Utils.isNull(e))return!1;i.put(p.SerializationTypes.NMAP);var o=i.position();i.skip(4),i.skip(2);for(var r=0,s=e.keys();s.hasNext();){var a=s.next(),h=e.get(a);if(null!=h){p.StringOutputStream.writeString(a,i);var c=n.getSerializationType(a,h);if(c==p.SerializationTypes.NULL_TYPE)i.put(p.SerializationTypes.NULL_TYPE);else if(c==p.SerializationTypes.OBJECT)p.StringOutputStream.writeObject(t,h,i);else if(c==p.SerializationTypes.STRING)p.StringOutputStream.writeString(h,i);else if(c==p.SerializationTypes.SHORT)p.StringOutputStream.writeShort(h,i);else if(c==p.SerializationTypes.INTEGER)p.StringOutputStream.writeInteger(h,i);else if(c==p.SerializationTypes.LONG)p.StringOutputStream.writeLong(h,i);else if(c==p.SerializationTypes.FLOAT)p.StringOutputStream.writeFloat(h,i);else if(c==p.SerializationTypes.DOUBLE)p.StringOutputStream.writeDouble(h,i);else if(c==p.SerializationTypes.BOOLEAN)p.StringOutputStream.writeBoolean(h,i);else if(c==p.SerializationTypes.NMAP)p.StringOutputStream.writeNMap(t,h,i,n);else if(c==p.SerializationTypes.LIST){var l=n.getListSerializationType(a,h);if(l==p.SerializationTypes.OBJECT){var u=h;p.StringOutputStream.writeObjectList(t,u,i)}else l==p.SerializationTypes.STRING?p.StringOutputStream.writeStringList(h,i):l==p.SerializationTypes.SHORT?p.StringOutputStream.writeShortList(h,i):l==p.SerializationTypes.INTEGER?p.StringOutputStream.writeIntegerList(h,i):l==p.SerializationTypes.LONG?p.StringOutputStream.writeLongList(h,i):l==p.SerializationTypes.FLOAT?p.StringOutputStream.writeFloatList(h,i):l==p.SerializationTypes.DOUBLE?p.StringOutputStream.writeDoubleList(h,i):l==p.SerializationTypes.BOOLEAN?p.StringOutputStream.writeBooleanList(h,i):l==p.SerializationTypes.NULL_TYPE&&i.put(p.SerializationTypes.NULL_TYPE)}r++}}return i.putShortAt(o,r),i.putIntAt(o,i.position()-o),!0},p.ConnectionStop=function(){},p.ConnectionStop.prototype=new p.Message,p.ConnectionStop.prototype.constructor=p.ConnectionStop,p.ConnectionStop.prototype.init=function(){return this},p.ConnectionStop.prototype.getSerializerID=function(){return 0},p.ConnectionStop.prototype.clone=function(){return(new p.ConnectionStop).init()},p.ConnectionStop.prototype.toString=function(){return""},p.ConnectionStop.prototype.equals=function(t){return!1},p.ConnectionStop.prototype.getDomainID=function(){return 0},p.ConnectionLost=function(){},p.ConnectionLost.prototype=new p.Message,p.ConnectionLost.prototype.constructor=p.ConnectionLost,p.ConnectionLost.prototype.init=function(){return this},p.ConnectionLost.prototype.getSerializerID=function(){return 0},p.ConnectionLost.prototype.clone=function(){return(new p.ConnectionLost).init()},p.ConnectionLost.prototype.toString=function(){return""},p.ConnectionLost.prototype.equals=function(t){return!1},p.ConnectionLost.prototype.getDomainID=function(){return 0},p.NError=function(){},p.NError.prototype.getMessage=function(){return this.errorMessage},p.NError.prototype.getCause=function(){return this.cause},p.NError.prototype.init=function(t,e){return this.errorMessage=t,this.cause=e,this},p.NError.prototype.toString=function(){var t="Error Message : "+this.errorMessage;return null!=this.cause&&(t+=" cause : "+this.cause.toString()),t},p.InvalidVersion=function(){},p.InvalidVersion.prototype=new p.Message,p.InvalidVersion.prototype.constructor=p.InvalidVersion,p.InvalidVersion.prototype.init=function(){return this},p.InvalidVersion.prototype.getSerializerID=function(){return 0},p.InvalidVersion.prototype.clone=function(){var t=(new p.InvalidVersion).init();return null!=this._MessageId&&t.setMessageId(this._MessageId),null!=this._RequestId&&t.setRequestId(this._RequestId),t},p.InvalidVersion.prototype.toString=function(){var t="";return t+="[InvalidVersion --\x3e ",null!=this._MessageId&&(t+="_MessageId="+this._MessageId+"| "),null!=this._RequestId&&(t+="_RequestId="+this._RequestId+"| "),t+="]"},p.InvalidVersion.prototype.equals=function(t){return!1},p.InvalidVersion.prototype.getDomainID=function(){return 0},p.ConnectionReady=function(){},p.ConnectionReady.prototype=new p.Message,p.ConnectionReady.prototype.constructor=p.ConnectionReady,p.ConnectionReady.prototype.init=function(){return this},p.ConnectionReady.prototype.getSerializerID=function(){return 0},p.ConnectionReady.prototype.clone=function(){return(new p.ConnectionReady).init()},p.ConnectionReady.prototype.toString=function(){return""},p.ConnectionReady.prototype.equals=function(t){return!1},p.ConnectionReady.prototype.getDomainID=function(){return 0},p.SerializationTypes=function(){},p.SerializationTypes.prototype.init=function(){return this},p.SerializationTypes.NULL_TYPE=0,p.SerializationTypes.OBJECT=1,p.SerializationTypes.LIST=2,p.SerializationTypes.BYTE=10,p.SerializationTypes.INTEGER=11,p.SerializationTypes.SHORT=12,p.SerializationTypes.LONG=13,p.SerializationTypes.FLOAT=14,p.SerializationTypes.DOUBLE=15,p.SerializationTypes.STRING=16,p.SerializationTypes.CHAR=17,p.SerializationTypes.BOOLEAN=18,p.SerializationTypes.NMAP=19,p.CompositeNDomainList=function(){},p.CompositeNDomainList.prototype=new p.NDomainList,p.CompositeNDomainList.prototype.constructor=p.CompositeNDomainList,p.CompositeNDomainList.prototype.init=function(){return this},p.CompositeNDomainList.prototype.setDomainLists=function(t){for(var e=0;e<t.length;e++){var i=t[e];this.setDomainList(i.getDomains())}};var i=p.MemoryManagement=function(){};i.prototype.init=function(){return this},i.free=function(){},i.dupString=function(t){return t},i._clone=function(t){return t},(p.ByteBuffer=function(){}).prototype.init=function(){return this};var n=p.ByteUtil=function(){};n.prototype.init=function(){return this},n.getBytes=function(t){t=t.replace(/\r\n/g,"\n");for(var e=[],i=0,n=0;n<t.length;n++){var o=t.charCodeAt(n);o<128?e[i++]=o:(o<2048?e[i++]=o>>6|192:(e[i++]=o>>12|224,e[i++]=o>>6&63|128),e[i++]=63&o|128)}return e},n.getString=function(t){for(var e=[],i=0,n=0;i<t.length;){var o=t[i++];if(o<128)e[n++]=String.fromCharCode(o);else if(191<o&&o<224){var r=t[i++];e[n++]=String.fromCharCode((31&o)<<6|63&r)}else{r=t[i++];var s=t[i++];e[n++]=String.fromCharCode((15&o)<<12|(63&r)<<6|63&s)}}return e.join("")};var o=p.DefaultDynamicFieldResolver=function(){};o.prototype.init=function(){return this},o.prototype.getSerializationType=function(t,e){return null==e?p.SerializationTypes.NULL_TYPE:e instanceof p.Storable?p.SerializationTypes.OBJECT:e instanceof p.NMap?p.SerializationTypes.NMAP:"string"==typeof e?p.SerializationTypes.STRING:"boolean"==typeof e?p.SerializationTypes.BOOLEAN:"number"==typeof e?e%1==0?2147483647<e?p.SerializationTypes.LONG:p.SerializationTypes.INTEGER:p.SerializationTypes.DOUBLE:Array.isArray(e)?e.length<=0?p.SerializationTypes.NULL_TYPE:p.SerializationTypes.LIST:p.SerializationTypes.NULL_TYPE},o.prototype.getListSerializationType=function(t,e){var i=e[0];return this.getSerializationType(t,i)};var s=p.NamedDynamicFieldResolver=function(){this.typeByName=[],this.listTypeByName=[]};s.prototype=new p.DefaultDynamicFieldResolver,s.constructor=p.NamedDynamicFieldResolver,s.prototype.init=function(){return this},s.prototype.registerField=function(t,e){this.typeByName[t]=e},s.prototype.registerListField=function(t,e){this.typeByName[t]=p.SerializationTypes.LIST,this.listTypeByName[t]=e},s.prototype.getSerializationType=function(t,e){var i=this.typeByName[t];return null!=i?i:p.DefaultDynamicFieldResolver.prototype.getSerializationType.call(this,t,e)},s.prototype.getListSerializationType=function(t,e){var i=this.listTypeByName[t];return null!=i?i:p.DefaultDynamicFieldResolver.prototype.getListSerializationType.call(this,t,e)};var a=p.StrBuilder=function(){};a.prototype.init=function(t){return this.builder=new String(t),this._position=0,this},a.prototype.substring=function(t,e){return this.builder.substring(t,e)},a.prototype.appendString=function(t){this.builder+=t},a.prototype.length1=function(){return this.builder.length},a.prototype.replace=function(t,e,i){this.builder=this.builder.substring(0,t)+i+this.builder.substring(e)},a.prototype.insert=function(t,e){this.builder=this.builder.substring(0,t)+e+this.builder.substring(t)},a.prototype.toString=function(){return this.builder};var h=p.NMap=function(){this.inner=[]};h.prototype.init=function(){return this},h.prototype.put=function(t,e){this.inner[t]=e},h.prototype.get=function(t){return this.inner[t]},h.prototype.keys=function(){var e=Object.keys(this.inner),i=0;return{hasNext:function(){return i<e.length},next:function(){var t=e[i];return i++,t}}},h.prototype.clear=function(){this.inner=[]},h.prototype.size=function(){return Object.keys(this.inner).length},h.prototype.clone=function(){return this},h.prototype.toString=function(){for(var t="[",e=this.keys();e.hasNext();){var i=e.next();t+=i+"="+this.get(i)+", "}return t+="]"};var p,l=p.Utils=function(){};l.prototype.init=function(){return this},l.NULL_INTEGER=null,l.NULL_SHORT=null,l.NULL_LONG=null,l.NULL_FLOAT=null,l.NULL_DOUBLE=null,l.NULL_BOOLEAN=null,l.NULL_BYTE=null,l.NULL_DATE=null,l.isNull=function(t){return null==t},l.isNullInteger=function(t){return null==t},l.isNullShort=function(t){return null==t},l.isNullLong=function(t){return null==t},l.isNullLong=function(t){return null==t},l.isNullDouble=function(t){return null==t},l.isNullFloat=function(t){return null==t},l.isNullBoolean=function(t){return null==t},l.isNullByte=function(t){return null==t},l.isNullDate=function(t){return null==t},p.nruntime.loadDeffered(),(p=t||{}).AbstractDisconnectedApi=function(){},p.AbstractDisconnectedApi.prototype.init=function(){return this},p.AbstractDisconnectedApi.prototype.fill=function(t){},p.AbstractDisconnectedApi.prototype.setDisconnectedPlug=function(t){(this.basicNuggetaPlug=t).addDomain(this.domain)},p.AbstractDisconnectedApi.prototype.request=function(t,e,i){this.fill(t),this.basicNuggetaPlug.request(t,e,i)},p.AbstractDisconnectedApi.prototype.send=function(t){this.fill(t),this.basicNuggetaPlug.sendMessage(t)},p.DisconnectedPlug=function(){this.domains=(new p.NDomainList).init(),this.endpoint="",this.requestId=0},p.DisconnectedPlug.prototype.init=function(){return this},p.DisconnectedPlug.prototype.encode=function(t){var e=(new p.StrBuilder).init(""),i=(new p.StringStream).init(e);return p.StringOutputStream.writeObject(this.domains,t,i),i.toString()},p.DisconnectedPlug.prototype.decode=function(t){var e=(new p.StrBuilder).init(t),i=(new p.StringStream).init(e);return p.StringInputStream.readObject(this.domains,i)},p.DisconnectedPlug.prototype.addDomain=function(t){return this.domains.addDomain(t),this},p.DisconnectedPlug.prototype.setEndpoint=function(t){return this.endpoint="//"+t+"/api",this},p.DisconnectedPlug.prototype.sendMessage=function(t){var e=this.encode(t);this.post(e,function(t){})},p.DisconnectedPlug.prototype.request=function(t,i,n){var o=this,e=this.encode(t);this.post(e,function(t){var e=o.decode(t);e instanceof p.NuggetaExceptionMessage?n?n(e):console.error("serror: "+e):i(e)},function(t){if(n){var e=(new p.NuggetaExceptionMessage).init();e.setReason(t),n(e)}else console.error(t)})},p.DisconnectedPlug.prototype.post=function(t,e,i){var n=new XMLHttpRequest;n.open("POST",this.endpoint),n.onreadystatechange=function(){4==n.readyState&&(200==n.status?(e(n.responseText),n.onreadystatechange=null):i("Invalid status: "+n.status+", text: "+n.responseText)),n.readyState<=0&&(i("Invalid ready state: "+n.readyState),n.onreadystatechange=null)},n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.send(t)},(p=t||{}).FoldingNetworkConnection=function(){},p.FoldingNetworkConnection.prototype.init=function(t){return this.connections=new Array,this.connection=null,this.connectionReadyListenerCollection=(new p.ConnectionReadyListenerCollection).init(),this.connectionLostListenerCollection=(new p.ConnectionLostListenerCollection).init(),this.connectionFailListenerCollection=(new p.ConnectionFailListenerCollection).init(),this.connectionInvalidVersionListenerCollection=(new p.ConnectionInvalidVersionDetectedListenerCollection).init(),this.log=p.NLoggerFactory.getLogger("FoldingNetworkConnection"),this.messageListener=t,this},p.FoldingNetworkConnection.prototype.start=function(){this.tryNextConnection()},p.FoldingNetworkConnection.prototype.tryNextConnection=function(){var t=this;0!=this.connections.length?(null!=this.connection&&(this.connection.removeConnectionReadyListener(this.connectionReadyListener),this.connection.removeConnectionFailListener(this.connectionFailListener),this.connection.removeConnectionLostListener(this.connectionLostListener),this.connection.removeConnectionInvalidVersionDetectedListener(this.connectionInvalidVersionDetectedListener),p.MemoryManagement.free(this.connectionReadyListener),p.MemoryManagement.free(this.connectionFailListener),p.MemoryManagement.free(this.connectionLostListener),p.MemoryManagement.free(this.connectionInvalidVersionDetectedListener)),this.connection=this.connections[0],this.connections.splice(0,1),this.connectionReadyListener=function(){t.connection.removeConnectionReadyListener(t.connectionReadyListener),t.connectionReadyListenerCollection.fireConnectionReady()},t.connection.addConnectionReadyListener(t.connectionReadyListener),t.connectionLostListener=function(){t.connection.removeConnectionLostListener(t.connectionLostListener),t.connectionLostListenerCollection.fireConnectionLost()},t.connection.addConnectionLostListener(t.connectionLostListener),t.connectionFailListener=function(){t.connection.removeConnectionFailListener(t.connectionFailListener),t.tryNextConnection()},t.connection.addConnectionFailListener(t.connectionFailListener),t.connectionInvalidVersionDetectedListener=function(){t.connection.removeConnectionInvalidVersionDetectedListener(t.connectionInvalidVersionDetectedListener),t.connectionInvalidVersionListenerCollection.fireInvalidVersionDetected()},t.connection.addConnectionInvalidVersionDetectedListener(t.connectionInvalidVersionDetectedListener),t.connection.start()):t.connectionFailListenerCollection.fireConnectionFail()},p.FoldingNetworkConnection.prototype.stop=function(){null!=this.connection&&this.connection.stop()},p.FoldingNetworkConnection.prototype.sendMessage=function(t){this.connection.sendMessage(t)},p.FoldingNetworkConnection.prototype.addConnection=function(t){this.connections.push(t)},p.FoldingNetworkConnection.prototype.addConnectionReadyListener=function(t){this.connectionReadyListenerCollection.add(t)},p.FoldingNetworkConnection.prototype.addConnectionLostListener=function(t){this.connectionLostListenerCollection.add(t)},p.FoldingNetworkConnection.prototype.addConnectionFailListener=function(t){this.connectionFailListenerCollection.add(t)},p.FoldingNetworkConnection.prototype.addConnectionInvalidVersionDetectedListener=function(t){this.connectionInvalidVersionListenerCollection.add(t)},p.FoldingNetworkConnection.prototype.removeConnectionInvalidVersionDetectedListener=function(t){this.connectionInvalidVersionListenerCollection.remove(t)},p.FoldingNetworkConnection.prototype.removeConnectionReadyListener=function(t){this.connectionReadyListenerCollection.remove(t)},p.FoldingNetworkConnection.prototype.removeConnectionLostListener=function(t){this.connectionLostListenerCollection.remove(t)},p.FoldingNetworkConnection.prototype.removeConnectionFailListener=function(t){this.connectionFailListenerCollection.remove(t)},p.FoldingNetworkConnection.prototype.sendStopMessage=function(t,e){this.connection.sendStopMessage(t,e)},p.FoldingNetworkConnection.prototype.onHeartBeat=function(){this.connection.onHeartBeat()},p.ConnectionLostListenerCollection=function(){},p.ConnectionLostListenerCollection.prototype.init=function(){return this.connectionLostListeners=new Array,this},p.ConnectionLostListenerCollection.prototype.fireConnectionLost=function(){for(var t=this.connectionLostListeners.length,e=0;e<t;e++){(0,this.connectionLostListeners[e])()}},p.ConnectionLostListenerCollection.prototype.getListeners=function(){return this.connectionLostListeners},p.ConnectionLostListenerCollection.prototype.add=function(t){this.connectionLostListeners.push(t)},p.ConnectionLostListenerCollection.prototype.remove=function(t){if(0<this.connectionLostListeners.length){var e=this.connectionLostListeners.indexOf(t);0<=e&&this.connectionLostListeners.splice(this.connectionLostListeners.indexOf(e),1)}},p.AbstractConnectionManager=function(){},p.AbstractConnectionManager.prototype.init=function(t){return this.connectionReadyListenerCollection=(new p.ConnectionReadyListenerCollection).init(),this.connectionLostListenerCollection=(new p.ConnectionLostListenerCollection).init(),this.connectionFailListenerCollection=(new p.ConnectionFailListenerCollection).init(),this.connectionInvalidVersionListenerCollection=(new p.ConnectionInvalidVersionDetectedListenerCollection).init(),this.name="",this.forceStop=!1,this.name=t,this},p.AbstractConnectionManager.prototype.start=function(t){this.connection=t,this.forceStop=!1},p.AbstractConnectionManager.prototype.sendMessage=function(t){null!=this.connection?this.connection.sendMessage(t):this.log.error("**************************** No connection available to sendMessage , did you wait for StartResponse before sending any message ? ")},p.AbstractConnectionManager.prototype.addConnectionReady=function(t){this.connectionReadyListenerCollection.add(t)},p.AbstractConnectionManager.prototype.removeConnectionReadyListener=function(t){this.connectionReadyListenerCollection.remove(t)},p.AbstractConnectionManager.prototype.addConnectionLost=function(t){this.connectionLostListenerCollection.add(t)},p.AbstractConnectionManager.prototype.removeConnectionLostListener=function(t){this.connectionLostListenerCollection.remove(t)},p.AbstractConnectionManager.prototype.addConnectionFail=function(t){this.connectionFailListenerCollection.add(t)},p.AbstractConnectionManager.prototype.removeConnectionFailListener=function(t){this.connectionFailListenerCollection.remove(t)},p.AbstractConnectionManager.prototype.addConnectionInvalidVersionDetected=function(t){this.connectionInvalidVersionListenerCollection.add(t)},p.AbstractConnectionManager.prototype.removeConnectionInvalidVersionDetected=function(t){this.connectionInvalidVersionListenerCollection.remove(t)},p.AbstractConnectionManager.prototype.stop=function(){this.forceStop=!0,null!=this.connection&&(this.connection.stop(),this.connection=null)},p.AbstractConnectionManager.prototype.isForceStopped=function(){return this.forceStop},p.AbstractConnectionManager.prototype.getConnection=function(){return this.connection},p.AbstractConnectionManager.prototype.sendStopMessage=function(){null!=this.connection&&this.connection.sendStopMessage((new p.StopPlugConnectionRequest).init(),(new p.StopPlugConnectionResponse).init())},p.ConnectionManager=function(){},p.ConnectionManager.prototype=new p.AbstractConnectionManager,p.ConnectionManager.prototype.constructor=p.ConnectionManager,p.ConnectionManager.prototype.init=function(t){return this.started=!1,p.AbstractConnectionManager.prototype.init.call(this,t),this.log=p.NLoggerFactory.getLogger("ConnectionManager"),this},p.ConnectionManager.prototype.start=function(t){p.AbstractConnectionManager.prototype.start.call(this,t),this.installConnectionListeners(this.connection),this.connection.start()},p.ConnectionManager.prototype.installConnectionListeners=function(t){var e=this;t.addConnectionReadyListener(function(){e.started=!0,e.connectionReadyListenerCollection.fireConnectionReady()}),t.addConnectionLostListener(function(){e.started=!1,e.connectionLostListenerCollection.fireConnectionLost()}),t.addConnectionFailListener(function(){e.started=!1,e.connectionFailListenerCollection.fireConnectionFail()}),t.addConnectionInvalidVersionDetectedListener(function(){e.connectionInvalidVersionListenerCollection.fireInvalidVersionDetected()})},p.ConnectionManager.prototype.stop=function(){p.AbstractConnectionManager.prototype.stop.call(this),this.started=!1},p.ConnectionManager.prototype.isStarted=function(){return this.started},p.ConnectionManager.prototype.onHeartBeat=function(){null!=this.connection&&this.connection.onHeartBeat()},p.AbstractNetworkConnection=function(){},p.AbstractNetworkConnection.prototype.init=function(t,e,i){var n=this;return this.connectionReadyListenerCollection=(new p.ConnectionReadyListenerCollection).init(),this.connectionFailListenerCollection=(new p.ConnectionFailListenerCollection).init(),this.connectionLostListenerCollection=(new p.ConnectionLostListenerCollection).init(),this.connectionInvalidVersionDetectedListenerCollection=(new p.ConnectionInvalidVersionDetectedListenerCollection).init(),this.connectionState=p.ConnectionState.INITIAL,this.domainList=e,this.messageListener=i,this.name=t,this.connectionLostHandler=function(){n.connectionState==p.ConnectionState.STARTED&&n.connectionLostListenerCollection.fireConnectionLost(),n.connectionState==p.ConnectionState.STOPPING&&n.tryStop()},n.connectionSendFailHandler=function(){n.connectionState==p.ConnectionState.STARTED&&n.connectionLostListenerCollection.fireConnectionLost(),n.connectionState==p.ConnectionState.STOPPING&&n.tryStop()},this},p.AbstractNetworkConnection.prototype.tryStop=function(){},p.AbstractNetworkConnection.prototype.addConnectionReadyListener=function(t){this.connectionReadyListenerCollection.add(t)},p.AbstractNetworkConnection.prototype.removeConnectionReadyListener=function(t){this.connectionReadyListenerCollection.remove(t)},p.AbstractNetworkConnection.prototype.addConnectionLostListener=function(t){this.connectionLostListenerCollection.add(t)},p.AbstractNetworkConnection.prototype.removeConnectionLostListener=function(t){this.connectionLostListenerCollection.remove(t)},p.AbstractNetworkConnection.prototype.addConnectionFailListener=function(t){this.connectionFailListenerCollection.add(t)},p.AbstractNetworkConnection.prototype.removeConnectionFailListener=function(t){this.connectionFailListenerCollection.remove(t)},p.AbstractNetworkConnection.prototype.addConnectionInvalidVersionDetectedListener=function(t){this.connectionInvalidVersionDetectedListenerCollection.add(t)},p.AbstractNetworkConnection.prototype.removeConnectionInvalidVersionDetectedListener=function(t){this.connectionInvalidVersionDetectedListenerCollection.remove(t)},p.AbstractNetworkConnection.prototype.start=function(){},p.AbstractNetworkConnection.prototype.stop=function(){},p.AbstractNetworkConnection.prototype.sendMessage=function(t){},p.AbstractNetworkConnection.prototype.sendStopMessage=function(t,e){},p.AbstractNetworkConnection.prototype.onHeartBeat=function(){},p.HttpConnection=function(){},p.HttpConnection.prototype=new p.AbstractNetworkConnection,p.HttpConnection.prototype.constructor=p.HttpConnection,p.HttpConnection.prototype.init=function(t,e,i,n,o,r,s){null==p.HttpConnection.PROTOCOL&&(p.HttpConnection.PROTOCOL="x");return this.log=p.NLoggerFactory.getLogger("HttpConnection"),p.AbstractNetworkConnection.prototype.init.call(this,t,e,i),this.log=p.NLoggerFactory.getLogger("HttpConnection"),p.NHttpRequestImpl.isSecured()?this.url="https://"+n+":"+r+s:this.url="http://"+n+":"+o+s,this},p.HttpConnection.prototype.start=function(){var e=this;if(this.connectionState==p.ConnectionState.INITIAL){this.connectionState=p.ConnectionState.STARTING,this.network=(new p.Network).init(this.domainList,this.messageListener,this.connectionInvalidVersionDetectedListenerCollection,this.connectionLostListenerCollection);var t=(new p.NHttpRequestImpl).init(),i=p.NSystem.currentTimeMillis();t.setWithCredentials(!0),t.get(e.name,e.url+"?init=init&p="+p.HttpConnection.PROTOCOL+"&id="+i,function(t){e.connectionState==p.ConnectionState.STARTING?(e.sessionId=t,e.connectionState=p.ConnectionState.STARTED,e.connectionReadyListenerCollection.fireConnectionReady(),e.poll()):e.log.error("invalid connection status")},function(){e.connectionState==p.ConnectionState.STARTING?e.connectionFailListenerCollection.fireConnectionFail():e.log.error("invalid connection status")})}},p.HttpConnection.prototype.poll=function(){var i=this;if(this.connectionState==p.ConnectionState.STARTED){var t=(new p.NHttpRequestImpl).init(),e=p.NSystem.currentTimeMillis();t.get(i.name,i.url+"?session_id="+i.sessionId+"&id="+e+"&p="+p.HttpConnection.PROTOCOL+"&send=p",function(t){try{if(i.connectionState!=p.ConnectionState.STARTED)return;var e=t;if(null!=e&&0<e.length&&"INVALID_SESSION_ID"==e)return void i.connectionLostListenerCollection.fireConnectionLost();i.network.onStrData(e),i.poll()}catch(t){i.dead||(i.dead=!0,i.log.debugCause("can't poll: ",t),i.connectionLostListenerCollection.fireConnectionLost())}},function(){i.connectionState==p.ConnectionState.STARTED&&i.connectionLostListenerCollection.fireConnectionLost()})}},p.HttpConnection.prototype.stop=function(){this.connectionState!=p.ConnectionState.STARTED?(this.connectionState=p.ConnectionState.STOPPED,this.tryStop()):this.connectionState!=p.ConnectionState.STARTING?(this.connectionState=p.ConnectionState.STOPPED,this.tryStop()):this.log.error("invalid status "+this.connectionState)},p.HttpConnection.prototype.tryStop=function(){},p.HttpConnection.prototype.sendMessage=function(t){this.connectionState==p.ConnectionState.STARTED&&this._sendMessage(t)},p.HttpConnection.prototype.sendStopMessage=function(t,e){this.connectionState=p.ConnectionState.STOPPING,this._sendMessage(t);try{this.messageListener(e)}catch(t){this.log.errorCause("Error occured while processing message : ",t)}},p.HttpConnection.prototype._sendMessage=function(t){var e=this,i=(new p.NHttpRequestImpl).init(),n=e.network.prepareStrPacket(t),o=p.NSystem.currentTimeMillis();i.post(e.name,e.url+"?session_id="+e.sessionId+"&id="+o+"&p="+p.HttpConnection.PROTOCOL+"&send=send",n,function(t){},function(){e.connectionState==p.ConnectionState.STARTED&&e.connectionLostListenerCollection.fireConnectionLost()})},p.BasicNuggetaPlug=function(){},p.BasicNuggetaPlug.prototype.init=function(){null==p.BasicNuggetaPlug.logger&&(p.BasicNuggetaPlug.logger=p.NLoggerFactory.getLogger("BasicNuggetaPlug"));return this.connectionManager=(new p.ConnectionManager).init("basic-plug"),this.messagesListeners=new Array,this.domainMessageListeners=new Array,this.messageCounter=0,this.lastHeartBeatTime=0,this.connectionFactory=(new p.ConnectionFactoryImpl).init(p.NConnectionConf.getLayers()),this},p.BasicNuggetaPlug.prototype.start=function(){var r=this;if(this.isStarted())p.BasicNuggetaPlug.logger.error("Error Cannot start ! Plug already started");else{this.lastHeartBeatTime=p.NSystem.currentTimeMillis();r.connectionManager.start(r.connectionFactory.newConnection("basic-plug",function(t){if(r.connectionManager.onHeartBeat(),r.lastHeartBeatTime=p.NSystem.currentTimeMillis(),t instanceof p.HeartBeatRequest){var e=(new p.HeartBeatResponse).init();return r.connectionManager.sendMessage(e),p.MemoryManagement.free(t),void p.MemoryManagement.free(e)}var i=t.getDomainID()+"",n=r.getDomainMessageListener(i);p.MemoryManagement.free(i),null!=n&&n(p.MemoryManagement._clone(t));for(var o=0;o<r.messagesListeners.length;o++)(0,r.messagesListeners[o])(p.MemoryManagement._clone(t));p.MemoryManagement.free(t)},r.url))}},p.BasicNuggetaPlug.prototype.getDomainMessageListener=function(t){for(var e=0;e<this.domainMessageListeners.length;e++){var i=this.domainMessageListeners[e];if(t==i.getDomainId()+"")return i.getMessageListener()}return null},p.BasicNuggetaPlug.prototype.sendMessage=function(t){var e=this.nextMessageId();return t.setMessageId(e),this.connectionManager.sendMessage(t),e},p.BasicNuggetaPlug.prototype.addMessageListener=function(t){this.messagesListeners.push(t)},p.BasicNuggetaPlug.prototype.removeMessageListener=function(t){this.messagesListeners.splice(this.messagesListeners.indexOf(t),1)},p.BasicNuggetaPlug.prototype.addDomainMessageListener=function(t){this.domainMessageListeners.push(t)},p.BasicNuggetaPlug.prototype.removeDomainMessageListener=function(t){this.domainMessageListeners.splice(this.domainMessageListeners.indexOf(t),1)},p.BasicNuggetaPlug.prototype.addDomain=function(t){this.connectionFactory.addDomain(t)},p.BasicNuggetaPlug.prototype.stop=function(){this.connectionManager.stop()},p.BasicNuggetaPlug.prototype.nextMessageId=function(){if(null!=this.prefixMessageId){var t=this.prefixMessageId+"_",e=t+this.messageCounter++;return p.MemoryManagement.free(t),e}return""+this.messageCounter++},p.BasicNuggetaPlug.prototype.setConnectionReadyListener=function(t){this.connectionManager.addConnectionReady(t)},p.BasicNuggetaPlug.prototype.setConnectionLostListener=function(t){this.connectionManager.addConnectionLost(t)},p.BasicNuggetaPlug.prototype.setConnectionFailListener=function(t){this.connectionManager.addConnectionFail(t)},p.BasicNuggetaPlug.prototype.setConnectionInvalidVersionDetectedListener=function(t){this.connectionManager.addConnectionInvalidVersionDetected(t)},p.BasicNuggetaPlug.prototype.sendStopMessage=function(){this.connectionManager.sendStopMessage()},p.BasicNuggetaPlug.prototype.setPrefixMessageId=function(t){this.prefixMessageId=t},p.BasicNuggetaPlug.prototype.getUrl=function(){return this.url},p.BasicNuggetaPlug.prototype.setUrl=function(t){this.url=t},p.BasicNuggetaPlug.prototype.isStarted=function(){return this.connectionManager.isStarted()},p.BasicNuggetaPlug.prototype.isConnectionUp=function(){var t=p.NSystem.currentTimeMillis(),e=3*p.BasicNuggetaPlug.HEATBEAT_TIMEOUT;return!(this.lastHeartBeatTime+e<=t)},p.BasicNuggetaPlug.HEATBEAT_TIMEOUT=8e3,p.ConnectionListenerCollection=function(){},p.ConnectionListenerCollection.prototype.init=function(){return this.listeners=new Array,this},p.ConnectionListenerCollection.prototype.fireConnectionReady=function(){for(var t=this.listeners.length,e=0;e<t;e++){(0,this.listeners[e])(null)}},p.ConnectionListenerCollection.prototype.fireConnectionFail=function(){for(var t=this.listeners.length,e=0;e<t;e++){(0,this.listeners[e])(null)}},p.ConnectionListenerCollection.prototype.fireConnectionLost=function(){for(var t=this.listeners.length,e=0;e<t;e++){(0,this.listeners[e])(null)}},p.ConnectionListenerCollection.prototype.fireInvalidVersionDetected=function(){for(var t=this.listeners.length,e=0;e<t;e++){(0,this.listeners[e])(null)}},p.ConnectionListenerCollection.prototype.add=function(t){this.listeners.push(t)},p.ConnectionListenerCollection.prototype.remove=function(t){if(0<this.listeners.length){var e=this.listeners.indexOf(t);0<=e&&this.listeners.splice(this.listeners.indexOf(e),1)}},p.ConnectionListenerCollection.prototype.getListeners=function(){return this.listeners},p.Pump=function(){},p.Pump.prototype.init=function(t){return this.activePumpableMessages=new Array,this.times=new Array,this.timeOut=t,this},p.Pump.prototype.pump=function(){var t=new Array;this.checkCache(p.NSystem.currentTimeMillis());for(var e=0;e<this.activePumpableMessages.length;e++){var i=this.activePumpableMessages[e];t.push(i)}return this.activePumpableMessages.splice(0,this.activePumpableMessages.length),this.times.splice(0,this.times.length),t},p.Pump.prototype.add=function(t){var e=p.NSystem.currentTimeMillis();this.checkCache(e),this.activePumpableMessages.push(t),this.times.push(e)},p.Pump.prototype.checkCache=function(t){},p.ConnectionReadyListenerCollection=function(){},p.ConnectionReadyListenerCollection.prototype.init=function(){return this.connectionReadyListeners=new Array,this},p.ConnectionReadyListenerCollection.prototype.fireConnectionReady=function(){for(var t=this.connectionReadyListeners.length,e=0;e<t;e++){(0,this.connectionReadyListeners[e])()}},p.ConnectionReadyListenerCollection.prototype.getListeners=function(){return this.connectionReadyListeners},p.ConnectionReadyListenerCollection.prototype.add=function(t){this.connectionReadyListeners.push(t)},p.ConnectionReadyListenerCollection.prototype.remove=function(t){if(0<this.connectionReadyListeners.length){var e=this.connectionReadyListeners.indexOf(t);0<=e&&this.connectionReadyListeners.splice(this.connectionReadyListeners.indexOf(e),1)}},p.ConnectionInvalidVersionDetectedListenerCollection=function(){},p.ConnectionInvalidVersionDetectedListenerCollection.prototype.init=function(){return this.connectionInvalidVersionDetectedListeners=new Array,this},p.ConnectionInvalidVersionDetectedListenerCollection.prototype.fireInvalidVersionDetected=function(){for(var t=this.connectionInvalidVersionDetectedListeners.length,e=0;e<t;e++){(0,this.connectionInvalidVersionDetectedListeners[e])()}},p.ConnectionInvalidVersionDetectedListenerCollection.prototype.getListeners=function(){return this.connectionInvalidVersionDetectedListeners},p.ConnectionInvalidVersionDetectedListenerCollection.prototype.add=function(t){this.connectionInvalidVersionDetectedListeners.push(t)},p.ConnectionInvalidVersionDetectedListenerCollection.prototype.remove=function(t){if(0<this.connectionInvalidVersionDetectedListeners.length){var e=this.connectionInvalidVersionDetectedListeners.indexOf(t);0<=e&&this.connectionInvalidVersionDetectedListeners.splice(this.connectionInvalidVersionDetectedListeners.indexOf(e),1)}},p.WebSocketConnection=function(){},p.WebSocketConnection.prototype=new p.AbstractNetworkConnection,p.WebSocketConnection.prototype.constructor=p.WebSocketConnection,p.WebSocketConnection.prototype.init=function(t,e,i,n,o,r,s){return this.log=p.NLoggerFactory.getLogger("WebSocketConnection"),p.AbstractNetworkConnection.prototype.init.call(this,t,e,i),p.NWebSocketImpl.isSecured()?this.wsUrl="wss://"+n+":"+r+s:this.wsUrl="ws://"+n+":"+o+s,this},p.WebSocketConnection.prototype.start=function(){var e=this;if(this.connectionState==p.ConnectionState.INITIAL){this.connectionState=p.ConnectionState.STARTING;try{this.network=(new p.Network).init(this.domainList,this.messageListener,this.connectionInvalidVersionDetectedListenerCollection,this.connectionLostListenerCollection),this.connectionReceivedHandler=function(t){e.connectionState!=p.ConnectionState.STARTING&&e.connectionState!=p.ConnectionState.STARTED||e.network.onStrData(t)};e.webSocket=(new p.NWebSocketImpl).init(),e.webSocket.openConnection(e.name,e.wsUrl,function(){e.connectionState=p.ConnectionState.STARTED,e.connectionReadyListenerCollection.fireConnectionReady()},e.connectionLostHandler,function(){e.connectionState==p.ConnectionState.STARTING?e.connectionFailListenerCollection.fireConnectionFail():e.log.error("invalid connection status")},e.connectionReceivedHandler)}catch(t){e.log.errorCause("Can't connect to server  url: "+e.wsUrl,t),e.connectionFailListenerCollection.fireConnectionFail()}}},p.WebSocketConnection.prototype.sendMessage=function(t){this.connectionState==p.ConnectionState.STARTED?this._sendMessage(t):this.log.error("Connection not started "+t)},p.WebSocketConnection.prototype._sendMessage=function(t){var e=this.network.prepareStrPacket(t);this.webSocket.sendString(e,null,this.connectionSendFailHandler)},p.WebSocketConnection.prototype.sendStopMessage=function(t,e){var i=this;this._response=e,this.connectionState=p.ConnectionState.STOPPING,this._sendMessage(t),this.webSocket.drain(function(){try{i.messageListener(i._response)}catch(t){i.log.errorCause("Error occured while processing message : ",t)}})},p.WebSocketConnection.prototype.stop=function(){this.tryStop()},p.WebSocketConnection.prototype.tryStop=function(){try{this.webSocket.close()}catch(t){}},p.NArrays=function(){},p.NArrays.prototype.init=function(){return this},p.AbstractNuggetaApi=function(){},p.AbstractNuggetaApi.prototype.init=function(){var e=this;return this.callbacks=new Array,this.requestCounter=0,this._pump=(new p.Pump).init(1e4),this.messageListener=function(t){t.getDomainID()==e.getDomain().getDomainId()?e.pumpEnabled?e._pump.add(t):e.fireMessage(t):p.MemoryManagement.free(t)},this},p.AbstractNuggetaApi.prototype.getDomain=function(){return null},p.AbstractNuggetaApi.prototype.getDispatcher=function(){return null},p.AbstractNuggetaApi.prototype.request=function(t,e){return this.stackCallback(t,e),this.fill(t),this.basicNuggetaPlug.sendMessage(t)},p.AbstractNuggetaApi.prototype.send=function(t){return this.fill(t),this.basicNuggetaPlug.sendMessage(t)},p.AbstractNuggetaApi.prototype.fill=function(t){},p.AbstractNuggetaApi.prototype.stackCallback=function(t,e){var i=this.nextRequestId();return t.setRequestId(i),this.callbacks[i]=e,t},p.AbstractNuggetaApi.prototype.executeCallback=function(t){var e=t.getRequestId();if(null!=e){var i=this.callbacks[e];null!=i&&(delete this.callbacks[e],this.callHandler(t,i))}return t},p.AbstractNuggetaApi.prototype.callHandler=function(t,e){},p.AbstractNuggetaApi.prototype.nextRequestId=function(){return""+this.requestCounter++},p.AbstractNuggetaApi.prototype.setBasicNuggetaPlug=function(t){this.basicNuggetaPlug=t},p.AbstractNuggetaApi.prototype.getDomainMessageListener=function(){if(null==this.domainMessageListener){var t=this.getDomain().getDomainId()+"";this.domainMessageListener=(new p.DomainMessageListener).init(t,this.messageListener)}return this.domainMessageListener},p.AbstractNuggetaApi.prototype.enablePump=function(t){this.pumpEnabled=t},p.AbstractNuggetaApi.prototype.pump=function(){for(var t=this.pumpAndGet(),e=0;e<t.length;e++){var i=t[e];p.MemoryManagement.free(i)}p.MemoryManagement.free(t)},p.AbstractNuggetaApi.prototype.pumpAndGet=function(){for(var t=this._pump.pump(),e=0;e<t.length;e++){var i=t[e],n=p.MemoryManagement._clone(i);this.fireMessage(n)}return t},p.AbstractNuggetaApi.prototype.fireMessage=function(t){null!=t.getRequestId()?this.executeCallback(t):this.getDispatcher().fireMessage(t)},p.ConnectionState=function(){},p.ConnectionState.prototype.init=function(){return this},p.ConnectionState.INITIAL=0,p.ConnectionState.STARTING=1,p.ConnectionState.STARTED=2,p.ConnectionState.STOPPING=3,p.ConnectionState.STOPPED=4,p.Byte2DArray=function(){},p.Byte2DArray.prototype.init=function(){return this},p.ConnectionFailListenerCollection=function(){},p.ConnectionFailListenerCollection.prototype.init=function(){return this.connectionFailListeners=new Array,this},p.ConnectionFailListenerCollection.prototype.fireConnectionFail=function(){for(var t=this.connectionFailListeners.length,e=0;e<t;e++){(0,this.connectionFailListeners[e])()}},p.ConnectionFailListenerCollection.prototype.getListeners=function(){return this.connectionFailListeners},p.ConnectionFailListenerCollection.prototype.add=function(t){this.connectionFailListeners.push(t)},p.ConnectionFailListenerCollection.prototype.remove=function(t){if(0<this.connectionFailListeners.length){var e=this.connectionFailListeners.indexOf(t);0<=e&&this.connectionFailListeners.splice(this.connectionFailListeners.indexOf(e),1)}},p.AES=function(){},p.AES.prototype.init=function(){return this},p.NSystem=function(){},p.NSystem.prototype.init=function(){return this},p.NSystem.currentTimeMillis=function(){return 0},p.NLoggerFactory=function(){},p.NLoggerFactory.prototype.init=function(){return this},p.NLoggerFactory.getLogger=function(t){return(new p.NLoggerImpl).init(t)},p.SocketConnection=function(){},p.SocketConnection.prototype=new p.AbstractNetworkConnection,p.SocketConnection.prototype.constructor=p.SocketConnection,p.SocketConnection.prototype.init=function(t,e,i,n,o){return this.log=p.NLoggerFactory.getLogger("SocketConnection"),p.AbstractNetworkConnection.prototype.init.call(this,t,e,i),this.server=n,this.port=o,this},p.SocketConnection.prototype.start=function(){var e=this;if(this.connectionState==p.ConnectionState.INITIAL){this.connectionState=p.ConnectionState.STARTING;try{this.network=(new p.Network).init(this.domainList,this.messageListener,this.connectionInvalidVersionDetectedListenerCollection,this.connectionLostListenerCollection),this.connectionReceivedHandler=function(t){e.connectionState!=p.ConnectionState.STARTING&&e.connectionState!=p.ConnectionState.STARTED||(null!=e.wsUrl?e.network.onStrData(t):e.network.onSingleData(t))};e.socket=(new p.NSocketImpl).init(),e.socket.openConnection(e.name,e.server,e.port,function(){e.connectionState=p.ConnectionState.STARTED,e.connectionReadyListenerCollection.fireConnectionReady()},e.connectionLostHandler,function(){e.connectionState==p.ConnectionState.STARTING?e.connectionFailListenerCollection.fireConnectionFail():e.log.error("invalid connection status")},e.connectionReceivedHandler)}catch(t){e.log.errorCause("Can't connect to server  url "+e.server+":"+e.port,t),e.connectionFailListenerCollection.fireConnectionFail()}}},p.SocketConnection.prototype.sendMessage=function(t){this.connectionState==p.ConnectionState.STARTED?this._sendMessage(t):this.log.error("Connection not started "+t)},p.SocketConnection.prototype._sendMessage=function(t){if(null!=this.wsUrl){var e=this.network.prepareStrPacket(t);this.socket.sendString(e,null,this.connectionSendFailHandler)}else{var i=this.network.prepareBinPacket(t);this.socket.sendBytes(i.getByteBuffer(),null,this.connectionSendFailHandler),p.MemoryManagement.free(i)}},p.SocketConnection.prototype.sendStopMessage=function(t,e){var i=this;this._response=e,this.connectionState!=p.ConnectionState.STARTED&&(this.log.error("Connection not started "+t),i.messageListener(this._response)),this.connectionState=p.ConnectionState.STOPPING,this._sendMessage(t),this.socket.drain(function(){try{i.messageListener(i._response)}catch(t){i.log.errorCause("Error occured while processing message : ",t)}})},p.SocketConnection.prototype.stop=function(){this.tryStop()},p.SocketConnection.prototype.tryStop=function(){try{this.socket.close()}catch(t){}},p.SocketConnection.prototype.onHeartBeat=function(){this.socket.onHeartBeat()},p.Network=function(){},p.Network.prototype.init=function(t,e,i,n){return this.log=p.NLoggerFactory.getLogger("Network"),this._in=new Array,this._length=-1,this.HEADER_LENGTH=10,this.domainList=t,this.messageListener=e,this.connectionInvalidVersionDetectedListenerCollection=i,this.connectionLostListenerCollection=n,this},p.Network.prototype.prepareBinPacket=function(t){var e=p.ByteBuffer.allocate(),i=(new p.BinaryStream).init(e);i.skip(4),p.BinaryOutputStream.writeObject(this.domainList,t,i);var n=i.position()-4;return i.putIntAt(0,n),e.flip(),i},p.Network.prototype.prepareStrPacket=function(t){var e=(new p.StringStream).init((new p.StrBuilder).init(""));p.StringOutputStream.writeObject(this.domainList,t,e);var i=e.toString(),n=i.length;return p.Network.pad(n+"",this.HEADER_LENGTH)+i},p.Network.prototype.onData=function(t){for(var e=0;e<t.length;e++)this.onSingleData(t[e])},p.Network.prototype.onSingleData=function(t){if(this._in.push(t),-1==this._length){if(4==this._in.length){for(var e=p.ByteBuffer.allocate(),i=0;i<4;i++)e.put(this._in[i]);e.flip(),this._in.splice(0,this._in.length),this._length=e.getInt(),p.MemoryManagement.free(e)}}else if(this._in.length==this._length){var n=p.ByteBuffer.allocate();for(i=0;i<this._length;i++)n.put(this._in[i]);n.flip();var o=null;try{var r=(new p.BinaryStream).init(n);o=p.BinaryInputStream.readObject(this.domainList,r),p.MemoryManagement.free(r),this._in.splice(0,this._in.length),this._length=-1;try{this.messageListener(o)}catch(t){this.log.errorCause("Error occured while processing message : "+o,t)}}catch(t){this.log.errorCause("Can't read command ",t),this.connectionInvalidVersionDetectedListenerCollection.fireInvalidVersionDetected()}}},p.Network.pad=function(t,e){for(var i=t.length;i<e;i++)t="0"+t;return t},p.Network.prototype.onStrData=function(t){for(var e=null;0<t.length;){var i=t.substring(0,this.HEADER_LENGTH),n=parseFloat(i);t=t.substring(this.HEADER_LENGTH),e=(new p.StringStream).init((new p.StrBuilder).init(t.substring(0,n)));var o=null;try{o=p.StringInputStream.readObject(this.domainList,e),t=t.substring(n);try{this.messageListener(o)}catch(t){this.log.errorCause("Error occured while processing message : "+o,t)}}catch(t){return this.log.errorCause("Can't read command ",t),void this.connectionInvalidVersionDetectedListenerCollection.fireInvalidVersionDetected()}}},p.ConnectionFactoryImpl=function(){},p.ConnectionFactoryImpl.prototype.init=function(t){return this.logger=p.NLoggerFactory.getLogger("ConnectionFactoryImpl"),this.domainList=(new p.NDomainList).init(),this.layers=t,this},p.ConnectionFactoryImpl.prototype.newConnection=function(t,e,i){var n=i.split(":"),o=n[0],r=parseFloat(n[1]),s=r+1,a=s+1,h=(new p.FoldingNetworkConnection).init(e);if(null!=this.layers)for(var c=this.layers.split("/"),l=0;l<c.length;l++){var u=c[l];"sock"==u?h.addConnection((new p.SocketConnection).init(t,this.domainList,e,o,r)):"wsock"==u?p.NWebSocketImpl.isSupported()&&h.addConnection((new p.WebSocketConnection).init(t,this.domainList,e,o,s,a,"/nuggeta/")):"http"==u?h.addConnection((new p.HttpConnection).init(t,this.domainList,e,o,s,a,"/httpstream/")):"greenlight"==u?h.addConnection((new p.HttpConnection).init(t,this.domainList,e,o,80,443,"/"+s+"/httpstream/")):this.logger.error("Unsupported network "+u)}else this.logger.error("No Layer defined ! using fallback http");return h},p.ConnectionFactoryImpl.prototype.addDomain=function(t){this.domainList.addDomain(t)};var u=p.NSystem=function(){};u.prototype.init=function(){return this},u.currentTimeMillis=function(){return(new Date).getTime()};var d=p.NStorage=function(){};d.prototype.init=function(){this.lsSupport=!1;try{localStorage&&(localStorage.setItem("testKey","1"),localStorage.removeItem("testKey"),this.lsSupport=!0)}catch(t){}return this},d.getItem=function(t){return this.lsSupport?localStorage[t]:this.readCookie(t)},d.setItem=function(t,e){this.lsSupport?localStorage[t]=e:this.createCookie(t,e,30)},d.createCookie=function(t,e,i){var n=new Date;n.setTime(n.getTime()+24*i*60*60*1e3);var o="; expires="+n.toGMTString();document.cookie=t+"="+e+o+"; path=/"},d.readCookie=function(t){for(var e=t+"=",i=document.cookie.split(";"),n=0,o=i.length;n<o;n++){for(var r=i[n];" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(e))return r.substring(e.length,r.length)}return null};var f=p.NAlert=function(){};f.prototype.init=function(){return this},f.prototype.show=function(t){console.log(t)};var y=p.NLoggerImpl=function(){};y.prototype.init=function(){return this},y.prototype.errorCause=function(t,e){var i=e.stack||e.stacktrace||e;console.log("[ERROR] "+t+", "+i)},y.prototype.error=function(t){console.log("[ERROR] "+t)},y.prototype.info=function(t){console.log("[INFO] "+t)},y.prototype.infoCause=function(t,e){var i=e.stack||e.stacktrace||e;console.log("[INFO] "+t+", "+i)},y.prototype.debug=function(t){console.log("[DEBUG] "+t)},y.prototype.debugCause=function(t,e){var i=e.stack||e.stacktrace||e;console.log("[DEBUG] "+t+", "+i)},y.prototype.warn=function(t){console.log("[WARM] "+t)},y.prototype.warnCause=function(t,e){var i=e.stack||e.stacktrace||e;console.log("[WARM] "+t+", "+i)},y.prototype.isDebug=function(){return y.DEBUG},y.DEBUG=!1;var g=p.NConnectionConf=function(){};p.NConnectionConf.layers="wsock/http",g.prototype.init=function(){return this},g.getLayers=function(){return p.NConnectionConf.layers},g.setLayers=function(t){p.NConnectionConf.layers=t};var m=p.NHttpRequestImpl=function(){};p.NHttpRequestImpl.secured="https:"==document.location.protocol,m.prototype.init=function(){return this.withCredentials=!1,this},m.isSecured=function(){return p.NHttpRequestImpl.secured},m.setSecured=function(t){p.NHttpRequestImpl.secured=t},m.prototype.setWithCredentials=function(t){this.withCredentials=t},m.prototype.get=function(t,e,i,n){var o=this;this.id=t,this.initHTTPRequest(n),this.xhr_object&&(o.xhr_object.open("GET",e,!0),o.xhr_object.onreadystatechange=function(){4==o.xhr_object.readyState&&(200==o.xhr_object.status?i(o.xhr_object.responseText):n()),o.xhr_object.readyState<=0&&n()},this.xhr_object.send(null))},m.prototype.post=function(t,e,i,n,o){var r=this;this.id=t,this.initHTTPRequest(o),this.xhr_object&&(r.xhr_object.open("POST",e,!0),r.xhr_object.onreadystatechange=function(){4==r.xhr_object.readyState&&(200==r.xhr_object.status?n(r.xhr_object.responseText):o()),r.xhr_object.readyState<=0&&o()},this.xhr_object.setRequestHeader("Content-type","application/x-www-form-urlencoded"),this.xhr_object.send(i))},m.prototype.initHTTPRequest=function(t){if(window.XMLHttpRequest)this.xhr_object=new XMLHttpRequest,this.withCredentials&&(this.xhr_object.withCredentials=!0);else{if(!window.ActiveXObject)return void t();this.xhr_object=new ActiveXObject("Microsoft.XMLHTTP")}};var v=p.NUrlEncoder=function(){};v.prototype.init=function(){return this},v.encode=function(t,e){return encodeURIComponent(t)},v.decode=function(t,e){return decodeURIComponent(t)};var S=p.NWebSocketImpl=function(){};p.NWebSocketImpl.secured="https:"==document.location.protocol,S.isSecured=function(){return p.NWebSocketImpl.secured},S.setSecured=function(t){p.NWebSocketImpl.secured=t},p.NWebSocketImpl.connectTimeoutInMillis=5e3,p.NWebSocketImpl.count=0,S.getConnectTimeoutInMillis=function(){return p.NWebSocketImpl.connectTimeoutInMillis},S.setConnectTimeoutInMillis=function(t){p.NWebSocketImpl.connectTimeoutInMillis=t},S.isSupported=function(){return"WebSocket"in window},S.prototype.init=function(){return this},S.prototype.openConnection=function(t,e,i,n,o,r){var s=this;this.wsId=p.NWebSocketImpl.count++,this.connectionOpenedHandler=i,this.connectionLostHandler=n,this.connectionFailHandler=o,this.connectionReceivedHandler=r,this.log=p.NLoggerFactory.getLogger("WebSocket["+t+"]"),s.log.debug("opening ws "+this.wsId+" : "+e);try{this.started=!1,this.closed=!1,this.wasClean=!1,this.receiveResponse=!1,this.connection=new WebSocket(e,"plug"),this.connection.onopen=function(){s.log.debug("onopen"),1!=s.closed?(s.started=!0,s.receiveResponse=!0,s.wasClean=!1,i()):s.log.debug("ws closed, will not open it. state: "+s.getDebugState())},this.connection.onerror=function(t){1!=s.closed&&(s.receiveResponse=!0,s.started?(s.started=!1,n()):o())},this.connection.onmessage=function(t){t.data&&r(t.data)},this.connection.onclose=function(t){s.log.debug("ws onclose, state: "+s.getDebugState()),s.receiveResponse=!0,1!=s.closed&&(1!=s.wasClean?1!=t.wasClean&&(s.started?(s.started=!1,n()):o()):s.wasClean=!1)},setTimeout(function(){s.receiveResponse||(s.log.error("ws connection timeout. state: "+s.getDebugState()),s.close(),o())},S.connectTimeoutInMillis)}catch(t){s.receiveResponse?s.log.errorCause("fatal error in ws connection, state: "+s.getDebugState(),t):(s.log.errorCause("failed to open ws connection, state: "+s.getDebugState(),t),s.closed=!0,o())}return this},S.prototype.getDebugState=function(){return"ws="+this.wsId+", readyState="+(null==this.connection?"null":this.connection.readyState)+", started="+this.started+", receiveResponse="+this.receiveResponse+", closed="+this.closed+", wasClean="+this.wasClean},S.prototype.close=function(){this.closed=!0,this.wasClean=!0;try{this.connection.close()}catch(t){this.log.errorCause("Fail to close ws, state: "+this.getDebugState(),t)}},S.prototype.sendString=function(t){var e=this;try{e.connection.readyState==WebSocket.OPEN?e.connection.send(t):(e.log.error("error sending on closed websocket. state="+e.getDebugState()+", data="+t),e.connectionLostHandler())}catch(t){e.log.error("sendMessage error "+t.message),e.connectionLostHandler()}},S.prototype.drain=function(t){t()};var _=p.Net=function(){},b=null;_.prototype.init=function(){return this},_.openURL=function(t){var e=200,i=200;screen&&(e=screen.width/2-600,i=screen.height/2-400);var n=window.open(t,"_blank","height=400,width=600,left="+e+",top="+i);null==n||void 0===n?alert("Turn off your pop-up blocker!\n\nWe try to open the following url:\n"+t):n.focus()},_.openWebView=function(t){var e=parseInt(document.width)/2-250,i=parseInt(screen.height)/2-300;null==(b=window.open(t,"_blank","left="+e+",top="+i+"scrollbars=no,toolbar=no,menubar=no,location=no,height=300,width=500"))||void 0===b?alert("Turn off your pop-up blocker!\n\nWe try to open the following url:\n"+t):b.focus()},_.closeWebView=function(){null!=b&&b.close()};var I=p.Platform=function(){};I.prototype.init=function(){return this},I.get=function(){return"HTML5:"+navigator.userAgent},I.isHTMLPlatform=function(){return!1};var w=p.SecurityUtils=function(){};w.prototype.init=function(){return this},w.SHA1=function(t){return""}}(gs=window.gs||{}),window.gs=gs,(new((gs=window.gs||{})||{}).nruntime).load({domainID:400,domainName:"ShipGs",nconstants:{AuthenticateStatus:{serializerID:10002,values:[{value:-2,text:"INVALID_PARAMETERS"},{value:-1,text:"INTERNAL_ERROR"},{value:0,text:"SUCCESS"},{value:1,text:"FAILED"},{value:2,text:"UNSUPPORTED_GAME_VERSION"}]},SaveAchievementStatus:{serializerID:10005,values:[{value:-2,text:"INVALID_PARAMETERS"},{value:-1,text:"INTERNAL_ERROR"},{value:0,text:"SUCCESS"},{value:1,text:"FAILED"}]},SaveIAPStatus:{serializerID:10008,values:[{value:-2,text:"INVALID_PARAMETERS"},{value:-1,text:"INTERNAL_ERROR"},{value:0,text:"SUCCESS"},{value:1,text:"FAILED"}]},GetPlayerByIdStatus:{serializerID:10011,values:[{value:-2,text:"INVALID_PARAMETERS"},{value:-1,text:"INTERNAL_ERROR"},{value:0,text:"SUCCESS"},{value:1,text:"FAILED"}]},GetPlayerByThirdPartyIdStatus:{serializerID:10014,values:[{value:-2,text:"INVALID_PARAMETERS"},{value:-1,text:"INTERNAL_ERROR"},{value:0,text:"SUCCESS"},{value:1,text:"FAILED"}]},FindScoresStatus:{serializerID:10017,values:[{value:-2,text:"INVALID_PARAMETERS"},{value:-1,text:"INTERNAL_ERROR"},{value:0,text:"SUCCESS"},{value:1,text:"FAILED"}]},GetBestScoresStatus:{serializerID:10020,values:[{value:-2,text:"INVALID_PARAMETERS"},{value:-1,text:"INTERNAL_ERROR"},{value:0,text:"SUCCESS"},{value:1,text:"FAILED"}]},SubmitScoreStatus:{serializerID:10023,values:[{value:-2,text:"INVALID_PARAMETERS"},{value:-1,text:"INTERNAL_ERROR"},{value:0,text:"SUCCESS"},{value:1,text:"FAILED"}]},GetAchievementsStatus:{serializerID:10026,values:[{value:-2,text:"INVALID_PARAMETERS"},{value:-1,text:"INTERNAL_ERROR"},{value:0,text:"SUCCESS"},{value:1,text:"FAILED"}]},SaveNotificationStatus:{serializerID:10029,values:[{value:-2,text:"INVALID_PARAMETERS"},{value:-1,text:"INTERNAL_ERROR"},{value:0,text:"SUCCESS"},{value:1,text:"FAILED"}]},FindNotificationsStatus:{serializerID:10032,values:[{value:-2,text:"INVALID_PARAMETERS"},{value:-1,text:"INTERNAL_ERROR"},{value:0,text:"SUCCESS"},{value:1,text:"FAILED"}]},TrackPlayerStatus:{serializerID:10035,values:[{value:-2,text:"INVALID_PARAMETERS"},{value:-1,text:"INTERNAL_ERROR"},{value:0,text:"SUCCESS"}]},CreatePlayerStatus:{serializerID:10038,values:[{value:-2,text:"INVALID_PARAMETERS"},{value:-1,text:"INTERNAL_ERROR"},{value:0,text:"SUCCESS"},{value:1,text:"FAILED"}]},SetFriendsStatus:{serializerID:10041,values:[{value:-2,text:"INVALID_PARAMETERS"},{value:-1,text:"INTERNAL_ERROR"},{value:0,text:"SUCCESS"}]},GetFriendsStatus:{serializerID:10044,values:[{value:-2,text:"INVALID_PARAMETERS"},{value:-1,text:"INTERNAL_ERROR"},{value:0,text:"SUCCESS"}]},GetStateStatus:{serializerID:10047,values:[{value:-2,text:"INVALID_PARAMETERS"},{value:-1,text:"INTERNAL_ERROR"},{value:0,text:"SUCCESS"}]},SubmitAdvProgressStatus:{serializerID:10062,values:[{value:-2,text:"INVALID_PARAMETERS"},{value:-1,text:"INTERNAL_ERROR"},{value:0,text:"SUCCESS"}]},GetAdvProgressStatus:{serializerID:10065,values:[{value:-2,text:"INVALID_PARAMETERS"},{value:-1,text:"INTERNAL_ERROR"},{value:0,text:"SUCCESS"}]},GetAdvFriendsProgressStatus:{serializerID:10068,values:[{value:-2,text:"INVALID_PARAMETERS"},{value:-1,text:"INTERNAL_ERROR"},{value:0,text:"SUCCESS"}]},GetAdvScoresStatus:{serializerID:10071,values:[{value:-2,text:"INVALID_PARAMETERS"},{value:-1,text:"INTERNAL_ERROR"},{value:0,text:"SUCCESS"}]},GetAdvFriendsScoresStatus:{serializerID:10074,values:[{value:-2,text:"INVALID_PARAMETERS"},{value:-1,text:"INTERNAL_ERROR"},{value:0,text:"SUCCESS"}]},SaveAdvProgressStatus:{serializerID:10077,values:[{value:-2,text:"INVALID_PARAMETERS"},{value:-1,text:"INTERNAL_ERROR"},{value:0,text:"SUCCESS"}]},FindStorablesStatus:{serializerID:10092,values:[{value:-2,text:"INVALID_PARAMETERS"},{value:-1,text:"INTERNAL_ERROR"},{value:0,text:"SUCCESS"},{value:1,text:"INVALID_QUERY"}]},SaveStorableStatus:{serializerID:10095,values:[{value:-2,text:"INVALID_PARAMETERS"},{value:-1,text:"INTERNAL_ERROR"},{value:0,text:"SUCCESS"}]},SaveStorableDiffStatus:{serializerID:10098,values:[{value:-2,text:"INVALID_PARAMETERS"},{value:-1,text:"INTERNAL_ERROR"},{value:0,text:"SUCCESS"}]},RemoveStorableStatus:{serializerID:10101,values:[{value:-2,text:"INVALID_PARAMETERS"},{value:-1,text:"INTERNAL_ERROR"},{value:0,text:"SUCCESS"}]},SaveStorablesStatus:{serializerID:10104,values:[{value:-2,text:"INVALID_PARAMETERS"},{value:-1,text:"INTERNAL_ERROR"},{value:0,text:"SUCCESS"}]},FindAndModifyStorablesStatus:{serializerID:10107,values:[{value:-2,text:"INVALID_PARAMETERS"},{value:-1,text:"INTERNAL_ERROR"},{value:0,text:"SUCCESS"}]},GetDuelChampionshipStatus:{serializerID:10122,values:[{value:-2,text:"INVALID_PARAMETERS"},{value:-1,text:"INTERNAL_ERROR"},{value:0,text:"SUCCESS"}]},SubmitDuelChampionshipScoreStatus:{serializerID:10125,values:[{value:-2,text:"INVALID_PARAMETERS"},{value:-1,text:"INTERNAL_ERROR"},{value:0,text:"SUCCESS"}]},GetBestServersStatus:{serializerID:10152,values:[{value:-2,text:"INVALID_PARAMETERS"},{value:-1,text:"INTERNAL_ERROR"},{value:0,text:"SUCCESS"}]},CreateRoomStatus:{serializerID:10155,values:[{value:-2,text:"INVALID_PARAMETERS"},{value:-1,text:"INTERNAL_ERROR"},{value:0,text:"SUCCESS"}]},SubscribeStatus:{serializerID:10158,values:[{value:-2,text:"INVALID_PARAMETERS"},{value:-1,text:"INTERNAL_ERROR"},{value:0,text:"SUCCESS"}]},PublishStatus:{serializerID:10161,values:[{value:-2,text:"INVALID_PARAMETERS"},{value:-1,text:"INTERNAL_ERROR"},{value:0,text:"SUCCESS"}]},UnsubscribeStatus:{serializerID:10164,values:[{value:-2,text:"INVALID_PARAMETERS"},{value:-1,text:"INTERNAL_ERROR"},{value:0,text:"SUCCESS"}]},PullStatus:{serializerID:10167,values:[{value:-2,text:"INVALID_PARAMETERS"},{value:-1,text:"INTERNAL_ERROR"},{value:0,text:"SUCCESS"}]},GetPublicRoomStatus:{serializerID:10170,values:[{value:-2,text:"INVALID_PARAMETERS"},{value:-1,text:"INTERNAL_ERROR"},{value:0,text:"SUCCESS"}]}},nobjects:{SStorable:{hierarchyDepth:1e3,serializerID:100,extendss:{domainID:"0",name:"Storable"},fields:{CreationDate:{propertyId:0,primitive:!0,type:"Long"},UpdateDate:{propertyId:1,primitive:!0,type:"Long"}}},SRequest:{hierarchyDepth:2e3,serializerID:101,extendss:{domainID:"0",name:"Message"},fields:{GameId:{propertyId:0,primitive:!0,type:"String"},GameVersion:{propertyId:1,primitive:!0,type:"Long"},PlayerId:{propertyId:2,primitive:!0,type:"String"},ShipVersion:{propertyId:3,primitive:!0,type:"Long"}}},SResponse:{hierarchyDepth:2e3,serializerID:102,extendss:{domainID:"0",name:"Message"},fields:{PendingMessages:{propertyId:0,list:!0,type:"Message",domainID:"0",reference:!0}}},SPlayer:{hierarchyDepth:2e3,serializerID:103,extendss:{domainID:"400",name:"SStorable"},fields:{Id:{propertyId:0,primitive:!0,type:"String"},PublisherId:{propertyId:1,primitive:!0,type:"String"},ThirdPartyId:{propertyId:2,primitive:!0,type:"String"},AccessToken:{propertyId:3,primitive:!0,type:"String"},Anonymous:{propertyId:4,primitive:!0,type:"Boolean"},Source:{propertyId:5,primitive:!0,type:"String"},Name:{propertyId:6,primitive:!0,type:"String"},Avatar:{propertyId:7,primitive:!0,type:"String"},Lang:{propertyId:8,primitive:!0,type:"String"},Email:{propertyId:9,primitive:!0,type:"String"},Country:{propertyId:10,primitive:!0,type:"String"},Birthday:{propertyId:11,primitive:!0,type:"Long"},Age:{propertyId:12,primitive:!0,type:"Integer"},Gender:{propertyId:13,primitive:!0,type:"String"},CustomData:{propertyId:14,primitive:!0,type:"String"},LastConnection:{propertyId:15,primitive:!0,type:"Long"},LastGift:{propertyId:16,primitive:!0,type:"Long"},ConsecutiveDays:{propertyId:17,primitive:!0,type:"Integer"},TotalDays:{propertyId:18,primitive:!0,type:"Integer"},Sounds:{propertyId:19,primitive:!0,type:"Long"},Tutorial:{propertyId:20,primitive:!0,type:"Long"},LastShare:{propertyId:21,primitive:!0,type:"Long"},LastInvite:{propertyId:22,primitive:!0,type:"Long"},LastDiscount:{propertyId:23,primitive:!0,type:"Long"},Wallet:{propertyId:24,primitive:!0,type:"Integer"},FortuneWheels:{propertyId:25,primitive:!0,type:"Integer"},Lifes:{propertyId:26,primitive:!0,type:"Integer"},LifeLastRecharge:{propertyId:27,primitive:!0,type:"Long"},VersionCreation:{propertyId:30,primitive:!0,type:"Long"},VersionLast:{propertyId:31,primitive:!0,type:"Long"}}},SPlayerAchievement:{hierarchyDepth:2e3,serializerID:104,extendss:{domainID:"400",name:"SStorable"},fields:{PlayerId:{propertyId:0,primitive:!0,type:"String"},AchievementId:{propertyId:1,primitive:!0,type:"String"},Progress:{propertyId:2,primitive:!0,type:"Integer"},Achieved:{propertyId:3,primitive:!0,type:"Boolean"},Collected:{propertyId:4,primitive:!0,type:"Boolean"}}},SScore:{hierarchyDepth:2e3,serializerID:105,extendss:{domainID:"400",name:"SStorable"},fields:{PlayerId:{propertyId:0,primitive:!0,type:"String"},PlayerName:{propertyId:1,primitive:!0,type:"String"},PlayerAvatar:{propertyId:2,primitive:!0,type:"String"},Value:{propertyId:3,primitive:!0,type:"Double"}}},SIAPTransaction:{hierarchyDepth:2e3,serializerID:106,extendss:{domainID:"400",name:"SStorable"},fields:{Id:{propertyId:0,primitive:!0,type:"String"},PlayerId:{propertyId:1,primitive:!0,type:"String"},PublisherId:{propertyId:2,primitive:!0,type:"String"},Source:{propertyId:3,primitive:!0,type:"String"},Status:{propertyId:4,primitive:!0,type:"Integer"},ItemId:{propertyId:5,primitive:!0,type:"String"},ItemType:{propertyId:6,primitive:!0,type:"String"},Price:{propertyId:7,primitive:!0,type:"Double"},Quantity:{propertyId:8,primitive:!0,type:"Integer"},TransactionInfo:{propertyId:9,primitive:!0,type:"String"},ExternalTransactionId:{propertyId:10,primitive:!0,type:"String"},ExternalCustomData:{propertyId:11,primitive:!0,type:"String"},ExternalItemId:{propertyId:12,primitive:!0,type:"String"},DiscountId:{propertyId:13,primitive:!0,type:"String"},InventoryQuantity:{propertyId:14,primitive:!0,type:"Integer"},CustomData:{propertyId:15,primitive:!0,type:"String"}}},SNotification:{hierarchyDepth:2e3,serializerID:107,extendss:{domainID:"400",name:"SStorable"},fields:{Id:{propertyId:0,primitive:!0,type:"String"},Kind:{propertyId:1,primitive:!0,type:"Integer"},TargetPlayerId:{propertyId:2,primitive:!0,type:"String"},TargetPublisherId:{propertyId:3,primitive:!0,type:"String"},TargetThirdPartyId:{propertyId:4,primitive:!0,type:"String"},SourcePlayerId:{propertyId:5,primitive:!0,type:"String"},SourcePlayerName:{propertyId:6,primitive:!0,type:"String"},SourcePlayerAvatar:{propertyId:7,primitive:!0,type:"String"},Text:{propertyId:8,primitive:!0,type:"String"},Image:{propertyId:9,primitive:!0,type:"String"},Tracked:{propertyId:10,primitive:!0,type:"Boolean"},Readed:{propertyId:11,primitive:!0,type:"Boolean"},RefId:{propertyId:12,primitive:!0,type:"String"},ScheduledDate:{propertyId:13,primitive:!0,type:"Long"},SendStatus:{propertyId:14,primitive:!0,type:"Integer"},SendDate:{propertyId:15,primitive:!0,type:"Long"},SendStatusText:{propertyId:16,primitive:!0,type:"String"},ExpirationDate:{propertyId:17,primitive:!0,type:"Long"},CustomData:{propertyId:18,primitive:!0,type:"String"}}},SPlayerActivityLog:{hierarchyDepth:2e3,serializerID:108,extendss:{domainID:"400",name:"SStorable"},fields:{PlayerId:{propertyId:0,primitive:!0,type:"String"},ThirdPartyId:{propertyId:1,primitive:!0,type:"String"},PublisherId:{propertyId:2,primitive:!0,type:"String"},Category:{propertyId:3,primitive:!0,type:"String"},Action:{propertyId:4,primitive:!0,type:"String"},Label:{propertyId:5,primitive:!0,type:"String"},Value:{propertyId:6,primitive:!0,type:"Double"},ClientId:{propertyId:7,primitive:!0,type:"String"},Source:{propertyId:8,primitive:!0,type:"String"},Version:{propertyId:9,primitive:!0,type:"Long"},Verbosity:{propertyId:10,primitive:!0,type:"Integer"}}},SPlayerOffer:{hierarchyDepth:2e3,serializerID:109,extendss:{domainID:"400",name:"SStorable"},fields:{PlayerId:{propertyId:0,primitive:!0,type:"String"},OfferId:{propertyId:1,primitive:!0,type:"String"},Status:{propertyId:3,primitive:!0,type:"Integer"},ExpirationDate:{propertyId:4,primitive:!0,type:"Long"},ItemId:{propertyId:5,primitive:!0,type:"String"},ItemQuantity:{propertyId:6,primitive:!0,type:"Integer"}}},SDiscount:{hierarchyDepth:2e3,serializerID:110,extendss:{domainID:"400",name:"SStorable"},fields:{Id:{propertyId:0,primitive:!0,type:"String"},StartDate:{propertyId:1,primitive:!0,type:"Long"},EndDate:{propertyId:2,primitive:!0,type:"Long"},ItemId:{propertyId:3,primitive:!0,type:"String"},Discount:{propertyId:4,primitive:!0,type:"Integer"},Promotion:{propertyId:5,primitive:!0,type:"String"}}},SCommunityMessage:{hierarchyDepth:2e3,serializerID:111,extendss:{domainID:"400",name:"SStorable"},fields:{Id:{propertyId:0,primitive:!0,type:"String"},PublisherId:{propertyId:1,primitive:!0,type:"String"},Lang:{propertyId:2,primitive:!0,type:"String"},Title:{propertyId:3,primitive:!0,type:"String"},Message:{propertyId:4,primitive:!0,type:"String"},ButtonTitle:{propertyId:5,primitive:!0,type:"String"},ExternalLink:{propertyId:6,primitive:!0,type:"String"},Image:{propertyId:7,primitive:!0,type:"String"},StartDate:{propertyId:8,primitive:!0,type:"Long"},EndDate:{propertyId:9,primitive:!0,type:"Long"}}},SAdvScore:{hierarchyDepth:2e3,serializerID:112,extendss:{domainID:"400",name:"SStorable"},fields:{PlayerId:{propertyId:1,primitive:!0,type:"String"},PlayerName:{propertyId:2,primitive:!0,type:"String"},PlayerAvatar:{propertyId:3,primitive:!0,type:"String"},Level:{propertyId:4,primitive:!0,type:"Integer"},Score:{propertyId:5,primitive:!0,type:"Double"},Stars:{propertyId:6,primitive:!0,type:"Integer"},TimeEllapsed:{propertyId:7,primitive:!0,type:"Long"},CompleteCount:{propertyId:8,primitive:!0,type:"Integer"},FailureCount:{propertyId:9,primitive:!0,type:"Integer"},CustomData:{propertyId:10,primitive:!0,type:"String"}}},SAdvProgress:{hierarchyDepth:2e3,serializerID:113,extendss:{domainID:"400",name:"SStorable"},fields:{PlayerId:{propertyId:1,primitive:!0,type:"String"},PlayerName:{propertyId:2,primitive:!0,type:"String"},PlayerAvatar:{propertyId:3,primitive:!0,type:"String"},Level:{propertyId:4,primitive:!0,type:"Integer"},Score:{propertyId:5,primitive:!0,type:"Integer"},Stars:{propertyId:6,primitive:!0,type:"Integer"},Mode:{propertyId:11,primitive:!0,type:"String"},CustomData:{propertyId:12,primitive:!0,type:"String"}}},SFriendList:{hierarchyDepth:2e3,serializerID:114,extendss:{domainID:"400",name:"SStorable"},fields:{PlayerId:{propertyId:0,primitive:!0,type:"String"},FriendIds:{propertyId:1,list:!0,type:"String",primitive:!0}}},SDuelChampionship:{hierarchyDepth:2e3,serializerID:115,extendss:{domainID:"400",name:"SStorable"},fields:{Start:{propertyId:1,primitive:!0,type:"Long"},End:{propertyId:2,primitive:!0,type:"Long"},Open:{propertyId:3,primitive:!0,type:"Boolean"},Player1:{propertyId:4,primitive:!0,type:"String"},Player2:{propertyId:5,primitive:!0,type:"String"},P1Best:{propertyId:6,primitive:!0,type:"Double"},P2Best:{propertyId:7,primitive:!0,type:"Double"},CustomData:{propertyId:8,primitive:!0,type:"String"}}},SPlayerDuelStats:{hierarchyDepth:2e3,serializerID:116,extendss:{domainID:"400",name:"SStorable"},fields:{Id:{propertyId:0,primitive:!0,type:"String"},Player1:{propertyId:1,primitive:!0,type:"String"},Player2:{propertyId:2,primitive:!0,type:"String"},P1Victories:{propertyId:3,primitive:!0,type:"Integer"},P2Victories:{propertyId:4,primitive:!0,type:"Integer"},CustomData:{propertyId:5,primitive:!0,type:"String"}}},SPlayerProperty:{hierarchyDepth:2e3,serializerID:117,extendss:{domainID:"400",name:"SStorable"},fields:{PlayerId:{propertyId:0,primitive:!0,type:"String"},Key:{propertyId:1,primitive:!0,type:"String"},Value:{propertyId:3,primitive:!0,type:"Double"}}},SMessage:{hierarchyDepth:2e3,serializerID:120,extendss:{domainID:"0",name:"Message"},fields:{}},STextMessage:{hierarchyDepth:3e3,serializerID:121,extendss:{domainID:"400",name:"SMessage"},fields:{From:{propertyId:0,primitive:!0,type:"String"},Text:{propertyId:1,primitive:!0,type:"String"},Kind:{propertyId:2,primitive:!0,type:"Integer"},Topic:{propertyId:3,primitive:!0,type:"String"},TopicMessageId:{propertyId:4,primitive:!0,type:"Long"}}},SRoomParameters:{hierarchyDepth:2e3,serializerID:122,extendss:{domainID:"400",name:"SStorable"},fields:{HasMaster:{propertyId:0,primitive:!0,type:"Boolean"},Expiration:{propertyId:1,primitive:!0,type:"Long"},RoomId:{propertyId:2,primitive:!0,type:"String"},Public:{propertyId:3,primitive:!0,type:"Boolean"},Custom:{propertyId:4,primitive:!0,type:"String"}}},SPublishParameters:{hierarchyDepth:2e3,serializerID:123,extendss:{domainID:"400",name:"SStorable"},fields:{PersistState:{propertyId:0,primitive:!0,type:"Boolean"}}},SPullParameters:{hierarchyDepth:2e3,serializerID:124,extendss:{domainID:"400",name:"SStorable"},fields:{State:{propertyId:0,primitive:!0,type:"Boolean"}}},SRoomState:{hierarchyDepth:2e3,serializerID:125,extendss:{domainID:"400",name:"SStorable"},fields:{Players:{propertyId:0,list:!0,type:"SPlayerRoomState",domainID:"400",reference:!0},MasterId:{propertyId:1,primitive:!0,type:"String"}}},SPlayerRoomState:{hierarchyDepth:2e3,serializerID:126,extendss:{domainID:"400",name:"SStorable"},fields:{PlayerId:{propertyId:0,primitive:!0,type:"String"},Text:{propertyId:1,primitive:!0,type:"String"}}},AuthenticateRequest:{hierarchyDepth:3e3,serializerID:1e4,extendss:{domainID:"400",name:"SRequest"},fields:{context:{propertyId:0,structure:!0,type:"nmap"}}},AuthenticateResponse:{hierarchyDepth:3e3,serializerID:10001,extendss:{domainID:"400",name:"SResponse"},fields:{AuthenticateStatus:{propertyId:-1,reference:!0,type:"AuthenticateStatus",domainId:"400"},player:{propertyId:0,reference:!0,type:"SPlayer",domainId:"400"},serverTime:{propertyId:1,primitive:!0,type:"Long"}}},SaveAchievementRequest:{hierarchyDepth:3e3,serializerID:10003,extendss:{domainID:"400",name:"SRequest"},fields:{achievement:{propertyId:0,reference:!0,type:"SPlayerAchievement",domainId:"400"}}},SaveAchievementResponse:{hierarchyDepth:3e3,serializerID:10004,extendss:{domainID:"400",name:"SResponse"},fields:{SaveAchievementStatus:{propertyId:-1,reference:!0,type:"SaveAchievementStatus",domainId:"400"},achievement:{propertyId:0,reference:!0,type:"SPlayerAchievement",domainId:"400"}}},SaveIAPRequest:{hierarchyDepth:3e3,serializerID:10006,extendss:{domainID:"400",name:"SRequest"},fields:{iap:{propertyId:0,reference:!0,type:"SIAPTransaction",domainId:"400"}}},SaveIAPResponse:{hierarchyDepth:3e3,serializerID:10007,extendss:{domainID:"400",name:"SResponse"},fields:{SaveIAPStatus:{propertyId:-1,reference:!0,type:"SaveIAPStatus",domainId:"400"},iap:{propertyId:0,reference:!0,type:"SIAPTransaction",domainId:"400"},message:{propertyId:1,primitive:!0,type:"String"}}},GetPlayerByIdRequest:{hierarchyDepth:3e3,serializerID:10009,extendss:{domainID:"400",name:"SRequest"},fields:{searchedPlayerId:{propertyId:0,primitive:!0,type:"String"}}},GetPlayerByIdResponse:{hierarchyDepth:3e3,serializerID:10010,extendss:{domainID:"400",name:"SResponse"},fields:{GetPlayerByIdStatus:{propertyId:-1,reference:!0,type:"GetPlayerByIdStatus",domainId:"400"},player:{propertyId:1,reference:!0,type:"SPlayer",domainId:"400"}}},GetPlayerByThirdPartyIdRequest:{hierarchyDepth:3e3,serializerID:10012,extendss:{domainID:"400",name:"SRequest"},fields:{publisherId:{propertyId:0,primitive:!0,type:"String"},thirdPartyId:{propertyId:1,primitive:!0,type:"String"}}},GetPlayerByThirdPartyIdResponse:{hierarchyDepth:3e3,serializerID:10013,extendss:{domainID:"400",name:"SResponse"},fields:{GetPlayerByThirdPartyIdStatus:{propertyId:-1,reference:!0,type:"GetPlayerByThirdPartyIdStatus",domainId:"400"},player:{propertyId:1,reference:!0,type:"SPlayer",domainId:"400"}}},FindScoresRequest:{hierarchyDepth:3e3,serializerID:10015,extendss:{domainID:"400",name:"SRequest"},fields:{leaderboardId:{propertyId:0,primitive:!0,type:"String"},query:{propertyId:1,reference:!0,type:"NuggetaQuery",domainId:"0"}}},FindScoresResponse:{hierarchyDepth:3e3,serializerID:10016,extendss:{domainID:"400",name:"SResponse"},fields:{FindScoresStatus:{propertyId:-1,reference:!0,type:"FindScoresStatus",domainId:"400"},scores:{propertyId:2,list:!0,type:"SScore",domainID:"400",reference:!0}}},GetBestScoresRequest:{hierarchyDepth:3e3,serializerID:10018,extendss:{domainID:"400",name:"SRequest"},fields:{leaderboardId:{propertyId:0,primitive:!0,type:"String"},start:{propertyId:1,primitive:!0,type:"Integer"},limit:{propertyId:2,primitive:!0,type:"Integer"},includeRank:{propertyId:3,primitive:!0,type:"Boolean"},limitToFriends:{propertyId:4,primitive:!0,type:"Boolean"}}},GetBestScoresResponse:{hierarchyDepth:3e3,serializerID:10019,extendss:{domainID:"400",name:"SResponse"},fields:{GetBestScoresStatus:{propertyId:-1,reference:!0,type:"GetBestScoresStatus",domainId:"400"},scores:{propertyId:0,list:!0,type:"SScore",domainID:"400",reference:!0},myBest:{propertyId:1,reference:!0,type:"SScore",domainId:"400"},myRank:{propertyId:2,primitive:!0,type:"Integer"}}},SubmitScoreRequest:{hierarchyDepth:3e3,serializerID:10021,extendss:{domainID:"400",name:"SRequest"},fields:{leaderboardId:{propertyId:0,primitive:!0,type:"String"},score:{propertyId:1,reference:!0,type:"SScore",domainId:"400"}}},SubmitScoreResponse:{hierarchyDepth:3e3,serializerID:10022,extendss:{domainID:"400",name:"SResponse"},fields:{SubmitScoreStatus:{propertyId:-1,reference:!0,type:"SubmitScoreStatus",domainId:"400"},previousScore:{propertyId:0,reference:!0,type:"SScore",domainId:"400"}}},GetAchievementsRequest:{hierarchyDepth:3e3,serializerID:10024,extendss:{domainID:"400",name:"SRequest"},fields:{}},GetAchievementsResponse:{hierarchyDepth:3e3,serializerID:10025,extendss:{domainID:"400",name:"SResponse"},fields:{GetAchievementsStatus:{propertyId:-1,reference:!0,type:"GetAchievementsStatus",domainId:"400"},achievements:{propertyId:0,list:!0,type:"SPlayerAchievement",domainID:"400",reference:!0}}},SaveNotificationRequest:{hierarchyDepth:3e3,serializerID:10027,extendss:{domainID:"400",name:"SRequest"},fields:{notification:{propertyId:0,reference:!0,type:"SNotification",domainId:"400"}}},SaveNotificationResponse:{hierarchyDepth:3e3,serializerID:10028,extendss:{domainID:"400",name:"SResponse"},fields:{SaveNotificationStatus:{propertyId:-1,reference:!0,type:"SaveNotificationStatus",domainId:"400"},notification:{propertyId:0,reference:!0,type:"SNotification",domainId:"400"}}},FindNotificationsRequest:{hierarchyDepth:3e3,serializerID:10030,extendss:{domainID:"400",name:"SRequest"},fields:{query:{propertyId:0,reference:!0,type:"NuggetaQuery",domainId:"0"}}},FindNotificationsResponse:{hierarchyDepth:3e3,serializerID:10031,extendss:{domainID:"400",name:"SResponse"},fields:{FindNotificationsStatus:{propertyId:-1,reference:!0,type:"FindNotificationsStatus",domainId:"400"},notifications:{propertyId:0,list:!0,type:"SNotification",domainID:"400",reference:!0}}},TrackPlayerRequest:{hierarchyDepth:3e3,serializerID:10033,extendss:{domainID:"400",name:"SRequest"},fields:{Activity:{propertyId:0,reference:!0,type:"SPlayerActivityLog",domainId:"400"}}},TrackPlayerResponse:{hierarchyDepth:3e3,serializerID:10034,extendss:{domainID:"400",name:"SResponse"},fields:{TrackPlayerStatus:{propertyId:-1,reference:!0,type:"TrackPlayerStatus",domainId:"400"}}},CreatePlayerRequest:{hierarchyDepth:3e3,serializerID:10036,extendss:{domainID:"400",name:"SRequest"},fields:{context:{propertyId:1,structure:!0,type:"nmap"}}},CreatePlayerResponse:{hierarchyDepth:3e3,serializerID:10037,extendss:{domainID:"400",name:"SResponse"},fields:{CreatePlayerStatus:{propertyId:-1,reference:!0,type:"CreatePlayerStatus",domainId:"400"},player:{propertyId:1,reference:!0,type:"SPlayer",domainId:"400"}}},SetFriendsRequest:{hierarchyDepth:3e3,serializerID:10039,extendss:{domainID:"400",name:"SRequest"},fields:{friends:{propertyId:2,list:!0,type:"SPlayer",domainID:"400",reference:!0}}},SetFriendsResponse:{hierarchyDepth:3e3,serializerID:10040,extendss:{domainID:"400",name:"SResponse"},fields:{SetFriendsStatus:{propertyId:-1,reference:!0,type:"SetFriendsStatus",domainId:"400"}}},GetFriendsRequest:{hierarchyDepth:3e3,serializerID:10042,extendss:{domainID:"400",name:"SRequest"},fields:{searchedPlayerId:{propertyId:0,primitive:!0,type:"String"},start:{propertyId:1,primitive:!0,type:"Integer"},limit:{propertyId:2,primitive:!0,type:"Integer"}}},GetFriendsResponse:{hierarchyDepth:3e3,serializerID:10043,extendss:{domainID:"400",name:"SResponse"},fields:{GetFriendsStatus:{propertyId:-1,reference:!0,type:"GetFriendsStatus",domainId:"400"},friends:{propertyId:0,list:!0,type:"SPlayer",domainID:"400",reference:!0}}},GetStateRequest:{hierarchyDepth:3e3,serializerID:10045,extendss:{domainID:"400",name:"SRequest"},fields:{context:{propertyId:0,structure:!0,type:"nmap"},filter:{propertyId:1,primitive:!0,type:"Long"}}},GetStateResponse:{hierarchyDepth:3e3,serializerID:10046,extendss:{domainID:"400",name:"SResponse"},fields:{GetStateStatus:{propertyId:-1,reference:!0,type:"GetStateStatus",domainId:"400"},Storables:{propertyId:0,list:!0,type:"Storable",domainID:"0",reference:!0}}},SubmitAdvProgressRequest:{hierarchyDepth:3e3,serializerID:10060,extendss:{domainID:"400",name:"SRequest"},fields:{level:{propertyId:2,primitive:!0,type:"Integer"},score:{propertyId:3,primitive:!0,type:"Double"},stars:{propertyId:4,primitive:!0,type:"Integer"},timeEllapsed:{propertyId:5,primitive:!0,type:"Long"},completed:{propertyId:6,primitive:!0,type:"Boolean"},mode:{propertyId:7,primitive:!0,type:"String"},scoreCustomData:{propertyId:8,reference:!0,type:"SAdvScore",domainId:"400"},progressCustomData:{propertyId:9,reference:!0,type:"SAdvProgress",domainId:"400"}}},SubmitAdvProgressResponse:{hierarchyDepth:3e3,serializerID:10061,extendss:{domainID:"400",name:"SResponse"},fields:{SubmitAdvProgressStatus:{propertyId:-1,reference:!0,type:"SubmitAdvProgressStatus",domainId:"400"},myScore:{propertyId:1,reference:!0,type:"SAdvScore",domainId:"400"},bestScores:{propertyId:2,list:!0,type:"SAdvScore",domainID:"400",reference:!0},newProgress:{propertyId:3,reference:!0,type:"SAdvProgress",domainId:"400"}}},GetAdvProgressRequest:{hierarchyDepth:3e3,serializerID:10063,extendss:{domainID:"400",name:"SRequest"},fields:{mode:{propertyId:2,primitive:!0,type:"String"}}},GetAdvProgressResponse:{hierarchyDepth:3e3,serializerID:10064,extendss:{domainID:"400",name:"SResponse"},fields:{GetAdvProgressStatus:{propertyId:-1,reference:!0,type:"GetAdvProgressStatus",domainId:"400"},progress:{propertyId:1,reference:!0,type:"SAdvProgress",domainId:"400"},scores:{propertyId:2,list:!0,type:"SAdvScore",domainID:"400",reference:!0}}},GetAdvFriendsProgressRequest:{hierarchyDepth:3e3,serializerID:10066,extendss:{domainID:"400",name:"SRequest"},fields:{levelMin:{propertyId:2,primitive:!0,type:"Integer"},levelMax:{propertyId:3,primitive:!0,type:"Integer"},mode:{propertyId:4,primitive:!0,type:"String"}}},GetAdvFriendsProgressResponse:{hierarchyDepth:3e3,serializerID:10067,extendss:{domainID:"400",name:"SResponse"},fields:{GetAdvFriendsProgressStatus:{propertyId:-1,reference:!0,type:"GetAdvFriendsProgressStatus",domainId:"400"},friendsProgress:{propertyId:1,list:!0,type:"SAdvProgress",domainID:"400",reference:!0}}},GetAdvScoresRequest:{hierarchyDepth:3e3,serializerID:10069,extendss:{domainID:"400",name:"SRequest"},fields:{levelMin:{propertyId:2,primitive:!0,type:"Integer"},levelMax:{propertyId:3,primitive:!0,type:"Integer"},mode:{propertyId:4,primitive:!0,type:"String"}}},GetAdvScoresResponse:{hierarchyDepth:3e3,serializerID:10070,extendss:{domainID:"400",name:"SResponse"},fields:{GetAdvScoresStatus:{propertyId:-1,reference:!0,type:"GetAdvScoresStatus",domainId:"400"},scores:{propertyId:1,list:!0,type:"SAdvScore",domainID:"400",reference:!0}}},GetAdvFriendsScoresRequest:{hierarchyDepth:3e3,serializerID:10072,extendss:{domainID:"400",name:"SRequest"},fields:{level:{propertyId:2,primitive:!0,type:"Integer"},mode:{propertyId:3,primitive:!0,type:"String"}}},GetAdvFriendsScoresResponse:{hierarchyDepth:3e3,serializerID:10073,extendss:{domainID:"400",name:"SResponse"},fields:{GetAdvFriendsScoresStatus:{propertyId:-1,reference:!0,type:"GetAdvFriendsScoresStatus",domainId:"400"},scores:{propertyId:1,list:!0,type:"SAdvScore",domainID:"400",reference:!0}}},SaveAdvProgressRequest:{hierarchyDepth:3e3,serializerID:10075,extendss:{domainID:"400",name:"SRequest"},fields:{mode:{propertyId:2,primitive:!0,type:"String"},progress:{propertyId:3,reference:!0,type:"SAdvProgress",domainId:"400"}}},SaveAdvProgressResponse:{hierarchyDepth:3e3,serializerID:10076,extendss:{domainID:"400",name:"SResponse"},fields:{SaveAdvProgressStatus:{propertyId:-1,reference:!0,type:"SaveAdvProgressStatus",domainId:"400"},progress:{propertyId:1,reference:!0,type:"SAdvProgress",domainId:"400"}}},FindStorablesRequest:{hierarchyDepth:3e3,serializerID:10090,extendss:{domainID:"400",name:"SRequest"},fields:{namespace:{propertyId:0,primitive:!0,type:"String"},query:{propertyId:1,reference:!0,type:"NuggetaQuery",domainId:"0"}}},FindStorablesResponse:{hierarchyDepth:3e3,serializerID:10091,extendss:{domainID:"400",name:"SResponse"},fields:{FindStorablesStatus:{propertyId:-1,reference:!0,type:"FindStorablesStatus",domainId:"400"},storables:{propertyId:0,list:!0,type:"Storable",domainID:"0",reference:!0}}},SaveStorableRequest:{hierarchyDepth:3e3,serializerID:10093,extendss:{domainID:"400",name:"SRequest"},fields:{namespace:{propertyId:0,primitive:!0,type:"String"},storable:{propertyId:1,reference:!0,type:"Storable",domainId:"0"}}},SaveStorableResponse:{hierarchyDepth:3e3,serializerID:10094,extendss:{domainID:"400",name:"SResponse"},fields:{SaveStorableStatus:{propertyId:-1,reference:!0,type:"SaveStorableStatus",domainId:"400"},storable:{propertyId:0,reference:!0,type:"Storable",domainId:"0"}}},SaveStorableDiffRequest:{hierarchyDepth:3e3,serializerID:10096,extendss:{domainID:"400",name:"SRequest"},fields:{namespace:{propertyId:0,primitive:!0,type:"String"},storable:{propertyId:1,reference:!0,type:"Storable",domainId:"0"}}},SaveStorableDiffResponse:{hierarchyDepth:3e3,serializerID:10097,extendss:{domainID:"400",name:"SResponse"},fields:{SaveStorableDiffStatus:{propertyId:-1,reference:!0,type:"SaveStorableDiffStatus",domainId:"400"},storable:{propertyId:0,reference:!0,type:"Storable",domainId:"0"}}},RemoveStorableRequest:{hierarchyDepth:3e3,serializerID:10099,extendss:{domainID:"400",name:"SRequest"},fields:{namespace:{propertyId:0,primitive:!0,type:"String"},storableId:{propertyId:1,primitive:!0,type:"String"}}},RemoveStorableResponse:{hierarchyDepth:3e3,serializerID:10100,extendss:{domainID:"400",name:"SResponse"},fields:{RemoveStorableStatus:{propertyId:-1,reference:!0,type:"RemoveStorableStatus",domainId:"400"}}},SaveStorablesRequest:{hierarchyDepth:3e3,serializerID:10102,extendss:{domainID:"400",name:"SRequest"},fields:{namespace:{propertyId:0,primitive:!0,type:"String"},storables:{propertyId:1,list:!0,type:"Storable",domainID:"0",reference:!0}}},SaveStorablesResponse:{hierarchyDepth:3e3,serializerID:10103,extendss:{domainID:"400",name:"SResponse"},fields:{SaveStorablesStatus:{propertyId:-1,reference:!0,type:"SaveStorablesStatus",domainId:"400"},storables:{propertyId:0,list:!0,type:"Storable",domainID:"0",reference:!0}}},FindAndModifyStorablesRequest:{hierarchyDepth:3e3,serializerID:10105,extendss:{domainID:"400",name:"SRequest"},fields:{namespace:{propertyId:0,primitive:!0,type:"String"},filter:{propertyId:1,reference:!0,type:"NuggetaQuery",domainId:"0"},update:{propertyId:2,reference:!0,type:"Storable",domainId:"0"},upsert:{propertyId:3,primitive:!0,type:"Boolean"}}},FindAndModifyStorablesResponse:{hierarchyDepth:3e3,serializerID:10106,extendss:{domainID:"400",name:"SResponse"},fields:{FindAndModifyStorablesStatus:{propertyId:-1,reference:!0,type:"FindAndModifyStorablesStatus",domainId:"400"},storables:{propertyId:0,list:!0,type:"Storable",domainID:"0",reference:!0}}},GetDuelChampionshipRequest:{hierarchyDepth:3e3,serializerID:10120,extendss:{domainID:"400",name:"SRequest"},fields:{player1:{propertyId:1,primitive:!0,type:"String"},player2:{propertyId:2,primitive:!0,type:"String"}}},GetDuelChampionshipResponse:{hierarchyDepth:3e3,serializerID:10121,extendss:{domainID:"400",name:"SResponse"},fields:{GetDuelChampionshipStatus:{propertyId:-1,reference:!0,type:"GetDuelChampionshipStatus",domainId:"400"},current:{propertyId:1,reference:!0,type:"SDuelChampionship",domainId:"400"},stats:{propertyId:2,reference:!0,type:"SPlayerDuelStats",domainId:"400"}}},SubmitDuelChampionshipScoreRequest:{hierarchyDepth:3e3,serializerID:10123,extendss:{domainID:"400",name:"SRequest"},fields:{championshipId:{propertyId:1,primitive:!0,type:"String"},score:{propertyId:2,primitive:!0,type:"Double"}}},SubmitDuelChampionshipScoreResponse:{hierarchyDepth:3e3,serializerID:10124,extendss:{domainID:"400",name:"SResponse"},fields:{SubmitDuelChampionshipScoreStatus:{propertyId:-1,reference:!0,type:"SubmitDuelChampionshipScoreStatus",domainId:"400"},current:{propertyId:1,reference:!0,type:"SDuelChampionship",domainId:"400"},stats:{propertyId:2,reference:!0,type:"SPlayerDuelStats",domainId:"400"}}},GetBestServersRequest:{hierarchyDepth:3e3,serializerID:10150,extendss:{domainID:"400",name:"SRequest"},fields:{}},GetBestServersResponse:{hierarchyDepth:3e3,serializerID:10151,extendss:{domainID:"400",name:"SResponse"},fields:{GetBestServersStatus:{propertyId:-1,reference:!0,type:"GetBestServersStatus",domainId:"400"},servers:{propertyId:1,list:!0,type:"String",primitive:!0}}},CreateRoomRequest:{hierarchyDepth:3e3,serializerID:10153,extendss:{domainID:"400",name:"SRequest"},fields:{parameters:{propertyId:0,reference:!0,type:"SRoomParameters",domainId:"400"}}},CreateRoomResponse:{hierarchyDepth:3e3,serializerID:10154,extendss:{domainID:"400",name:"SResponse"},fields:{CreateRoomStatus:{propertyId:-1,reference:!0,type:"CreateRoomStatus",domainId:"400"},roomId:{propertyId:0,primitive:!0,type:"String"}}},SubscribeRequest:{hierarchyDepth:3e3,serializerID:10156,extendss:{domainID:"400",name:"SRequest"},fields:{topic:{propertyId:0,primitive:!0,type:"String"},parameters:{propertyId:1,reference:!0,type:"SRoomParameters",domainId:"400"}}},SubscribeResponse:{hierarchyDepth:3e3,serializerID:10157,extendss:{domainID:"400",name:"SResponse"},fields:{SubscribeStatus:{propertyId:-1,reference:!0,type:"SubscribeStatus",domainId:"400"},members:{propertyId:0,list:!0,type:"String",primitive:!0},totalMembers:{propertyId:1,primitive:!0,type:"Integer"}}},PublishRequest:{hierarchyDepth:3e3,serializerID:10159,extendss:{domainID:"400",name:"SRequest"},fields:{topic:{propertyId:0,primitive:!0,type:"String"},message:{propertyId:1,reference:!0,type:"STextMessage",domainId:"400"},parameters:{propertyId:2,reference:!0,type:"SPublishParameters",domainId:"400"}}},PublishResponse:{hierarchyDepth:3e3,serializerID:10160,extendss:{domainID:"400",name:"SResponse"},fields:{PublishStatus:{propertyId:-1,reference:!0,type:"PublishStatus",domainId:"400"}}},UnsubscribeRequest:{hierarchyDepth:3e3,serializerID:10162,extendss:{domainID:"400",name:"SRequest"},fields:{topic:{propertyId:0,primitive:!0,type:"String"}}},UnsubscribeResponse:{hierarchyDepth:3e3,serializerID:10163,extendss:{domainID:"400",name:"SResponse"},fields:{UnsubscribeStatus:{propertyId:-1,reference:!0,type:"UnsubscribeStatus",domainId:"400"}}},PullRequest:{hierarchyDepth:3e3,serializerID:10165,extendss:{domainID:"400",name:"SRequest"},fields:{topic:{propertyId:0,primitive:!0,type:"String"},parameters:{propertyId:1,reference:!0,type:"SPullParameters",domainId:"400"}}},PullResponse:{hierarchyDepth:3e3,serializerID:10166,extendss:{domainID:"400",name:"SResponse"},fields:{PullStatus:{propertyId:-1,reference:!0,type:"PullStatus",domainId:"400"},state:{propertyId:0,reference:!0,type:"SRoomState",domainId:"400"}}},GetPublicRoomRequest:{hierarchyDepth:3e3,serializerID:10168,extendss:{domainID:"400",name:"SRequest"},fields:{parameters:{propertyId:0,reference:!0,type:"SStorable",domainId:"400"}}},GetPublicRoomResponse:{hierarchyDepth:3e3,serializerID:10169,extendss:{domainID:"400",name:"SResponse"},fields:{GetPublicRoomStatus:{propertyId:-1,reference:!0,type:"GetPublicRoomStatus",domainId:"400"},topics:{propertyId:0,list:!0,type:"String",primitive:!0},membersCount:{propertyId:1,list:!0,type:"Integer",primitive:!0}}}},methods:{authenticate:{parameters:["context"]},saveAchievement:{parameters:["achievement"]},saveIAP:{parameters:["iap"]},getPlayerById:{parameters:["searchedPlayerId"]},getPlayerByThirdPartyId:{parameters:["publisherId","thirdPartyId"]},findScores:{parameters:["leaderboardId","query"]},getBestScores:{parameters:["leaderboardId","start","limit","includeRank","limitToFriends"]},submitScore:{parameters:["leaderboardId","score"]},getAchievements:{parameters:[]},saveNotification:{parameters:["notification"]},findNotifications:{parameters:["query"]},trackPlayer:{parameters:["Activity"]},createPlayer:{parameters:["context"]},setFriends:{parameters:["friends"]},getFriends:{parameters:["searchedPlayerId","start","limit"]},getState:{parameters:["context","filter"]},submitAdvProgress:{parameters:["level","score","stars","timeEllapsed","completed","mode","scoreCustomData","progressCustomData"]},getAdvProgress:{parameters:["mode"]},getAdvFriendsProgress:{parameters:["levelMin","levelMax","mode"]},getAdvScores:{parameters:["levelMin","levelMax","mode"]},getAdvFriendsScores:{parameters:["level","mode"]},saveAdvProgress:{parameters:["mode","progress"]},findStorables:{parameters:["namespace","query"]},saveStorable:{parameters:["namespace","storable"]},saveStorableDiff:{parameters:["namespace","storable"]},removeStorable:{parameters:["namespace","storableId"]},saveStorables:{parameters:["namespace","storables"]},findAndModifyStorables:{parameters:["namespace","filter","update","upsert"]},getDuelChampionship:{parameters:["player1","player2"]},submitDuelChampionshipScore:{parameters:["championshipId","score"]},getBestServers:{parameters:[]},createRoom:{parameters:["parameters"]},subscribe:{parameters:["topic","parameters"]},publish:{parameters:["topic","message","parameters"]},unsubscribe:{parameters:["topic"]},pull:{parameters:["topic","parameters"]},getPublicRoom:{parameters:["parameters"]}}}),window.gs=gs,function(r){var t=function(){function t(t,e){this.debug=t,this.channel=e,this.jsLoaded=!1,this.adsLoaded=!1,this.showingAds=!1;var i=this;i.ship=r.Ship.get(),r.util.getResizehandlers().add(function(t){i.onResize(t)})}return t.prototype.init=function(){var t=this;setTimeout(function(){t.init0()},0)},t.prototype.init0=function(){var t=this;r.util.loadJs("https://imasdk.googleapis.com/js/sdkloader/ima3.js",function(){r.logger.debug("ima sdk loaded"),t.jsLoaded=!0,t.preloadAds()})},t.prototype.preloadAds=function(){if(this.jsLoaded){this.adsLoaded=!1,this.destroy();var t=r.util.getWindowSize(),e=t.width,i=t.height;this.availableWidth=e,this.availableHeight=i;var n=document.createElement("div");n.style.zIndex="11",n.style.position="absolute",n.style.top="0",n.style.left="0",n.style.width=e+"px",n.style.height=i+"px",n.style.visibility="hidden",this.adsContainer=n,document.body.appendChild(n),this.adDisplayContainer=new google.ima.AdDisplayContainer(n),this.adsLoader=new google.ima.AdsLoader(this.adDisplayContainer),this.adsLoader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,this.onAdsManagerLoaded.bind(this),!1),this.adsLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this.onAdError.bind(this),!1);var o=new google.ima.AdsRequest;o.adTagUrl=this.getAdTagUrl(),o.linearAdSlotWidth=e,o.linearAdSlotHeight=i,o.nonLinearAdSlotWidth=e,o.nonLinearAdSlotHeight=i,o.forceNonLinearFullSlot=!0,this.adsLoader.requestAds(o)}},t.prototype.onResize=function(t){this.showingAds||this.preloadAds()},t.prototype.showAds=function(t){if(!this.adsLoaded)return r.logger.warn("No ads loaded"),void t(!1);this.afterDisplayCb=t,this.showingAds=!0,this.showAds0(!1)},t.prototype.onAdsManagerLoaded=function(t){var e={startTime:Date.now(),duration:3e5};Object.defineProperty(e,"currentTime",{get:function(){return Date.now()-e.startTime},set:function(t){}});var i=new google.ima.AdsRenderingSettings;i.autoAlign=!0,i.useStyledNonLinearAds=!0;var n=t.getAdsManager(e,i);n.addEventListener(google.ima.AdError.ErrorCode,this.onAdError.bind(this)),n.addEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,this.onContentPauseRequested.bind(this)),n.addEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,this.onContentResumeRequested.bind(this)),n.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this.onAdEvent.bind(this)),n.addEventListener(google.ima.AdEvent.Type.LOADED,this.onAdEvent.bind(this)),n.addEventListener(google.ima.AdEvent.Type.STARTED,this.onAdEvent.bind(this)),n.addEventListener(google.ima.AdEvent.Type.COMPLETE,this.onAdEvent.bind(this)),n.addEventListener(google.ima.AdEvent.Type.USER_CLOSE,this.onAdEvent.bind(this)),n.addEventListener(google.ima.AdEvent.Type.SKIPPED,this.onAdEvent.bind(this)),n.addEventListener(google.ima.AdEvent.Type.CLICK,this.onAdEvent.bind(this)),this.adsManager=n,this.adsLoaded=!0},t.prototype.showAds0=function(t){try{var e="async="+t+", size_available="+this.availableWidth+"x"+this.availableHeight;this.track("show",e),this.adsContainer.style.visibility="visible",this.ship._muteSound(!0),this.adDisplayContainer.initialize(),this.adsManager.init(this.availableWidth,this.availableHeight,google.ima.ViewMode.FULLSCREEN),this.adsManager.start()}catch(t){this.track("error","Failed to show ad: "+t.message),this.goToGame(!1)}},t.prototype.getAdTagUrl=function(){var t=[];t.push("ad_type=skippablevideo_image"),t.push("client=ca-games-pub-4433999935616724"),t.push("videoad_start_delay=0"),t.push("channel="+this.channel);var e=r.lang.resolveGameLang(),i="https://hip.snapgame.io/s/game/adtext/";i+="?gid="+this.ship.config.gameId,i+="&hl="+e,i=encodeURIComponent(i),t.push("description_url="+i);var n="";return this.debug?n="https://pubads.g.doubleclick.net/gampad/ads?sz=640x480&iu=/124319096/external/single_ad_samples&ciu_szs=300x250&impl=s&gdfp_req=1&env=vp&output=vast&unviewed_position_start=1&cust_params=deployment%3Ddevsite%26sample_ct%3Dskippablelinear&correlator=&adtest=on":n+="https://googleads.g.doubleclick.net/pagead/ads?"+t.join("&"),n},t.prototype.onAdEvent=function(t){switch(t.type){case google.ima.AdErrorEvent.Type.AD_ERROR:this.onAdError(t);break;case google.ima.AdEvent.Type.LOADED:this.onAddLoaded(t);break;case google.ima.AdEvent.Type.STARTED:this.onImaAddStarted(t);break;case google.ima.AdEvent.Type.COMPLETE:this.onAdsCompleted(t);break;case google.ima.AdEvent.Type.USER_CLOSE:case google.ima.AdEvent.Type.SKIPPED:this.onAdsSkipped(t);break;case google.ima.AdEvent.Type.CLICK:this.onAdsClicked(t)}},t.prototype.onAddLoaded=function(t){var e=t.getAd(),i="content="+e.getContentType()+", ";i+="size="+e.getWidth()+"x"+e.getHeight()+", ",i+="linear="+e.isLinear(),this.track("loaded",i)},t.prototype.onImaAddStarted=function(t){},t.prototype.onAdsCompleted=function(t){this.track("completed"),r.logger.debug("Ad completed"),this.goToGame(!0)},t.prototype.onAdsSkipped=function(t){this.track("skipped"),r.logger.debug("Ad skipped"),this.goToGame(!0)},t.prototype.onAdsClicked=function(t){this.track("clicked"),r.logger.debug("Ad clicked")},t.prototype.onAdError=function(t){this.goToGame(!1);var e=t.getError(),i=e.getInnerError(),n=["code: "+e.getErrorCode(),"type: "+e.getType(),"message: "+e.getMessage(),"vastErrorCode: "+e.getVastErrorCode()];null!=i&&n.push("InnerErrorMessage",i.message);var o="Ads Error Event: ["+n.join(", ")+"]";this.track("error",o),r.logger.debug(o)},t.prototype.onContentPauseRequested=function(){},t.prototype.onContentResumeRequested=function(){},t.prototype.destroy=function(){null!=this.adsManager&&(this.adsManager.destroy(),this.adsManager=null),null!=this.adsContainer&&(document.body.removeChild(this.adsContainer),this.adsContainer=null)},t.prototype.goToGame=function(t){this.destroy(),this.ship._muteSound(!1),null!=this.afterDisplayCb&&this.afterDisplayCb(t),this.showingAds=!1;var e=this;setTimeout(function(){e.preloadAds()},1e4)},t.prototype.track=function(t,e,i){r.ShipGs.get().trackPlayer(r.TrackingLevel.INFO,"ads",t,e,i)},t.prototype.adsPreloaded=function(){return this.adsLoaded},t}();r.IMA=t}(ship||(ship={})),function(o){var t=function(){function t(t,e,i){if(this.id=t,this.config=e,this._available=!1,this._available=this.isAvailable(),this.id=t+"-"+e.gameId+e.publisher,this._available){var n=localStorage.getItem(this.id);this._cacheData=o.json.parse(n,i)}else this._cacheData=i}return t.prototype.isAvailable=function(){try{return localStorage.setItem("test123456789","test123456789"),localStorage.removeItem("test123456789"),!0}catch(t){return!1}},t.prototype.get=function(){return this._cacheData},t.prototype.save=function(){this._available&&localStorage.setItem(this.id,JSON.stringify(this._cacheData))},t}();o.LocalCache=t}(ship||(ship={})),function(r){var t=function(){function t(){this.width=.95,this.height=.7,this.destroyed=!1}return t.prototype.onResize=function(){var t=r.util.getWindowSize(),e=t.width*this.width,i=t.height*this.height,n=(t.width-e)/2,o=(t.height-i)/2;this.main.style.width=e+"px",this.main.style.height=i+"px",this.main.style.left=n+"px",this.main.style.top=o+"px"},t.prototype.build=function(){r.util.getResizehandlers().add(this.onResizeBound),this.overlay=document.createElement("div"),this.overlay.style.position="absolute",this.overlay.style.zIndex="15",this.overlay.style.top="0",this.overlay.style.left="0",this.overlay.style.right="0",this.overlay.style.bottom="0",this.overlay.style.backgroundColor="rgba(0, 0, 0, 0.7)",this.main=document.createElement("div"),this.main.style.position="relative",this.main.style.backgroundColor="white",this.overlay.appendChild(this.main),document.body.appendChild(this.overlay)},t.prototype.afterBuild=function(){},t.prototype.use3RowLayout=function(){var t=new r.DOMVerticalLayout;t.getElement().style.width="100%",t.getElement().style.height="100%",this.main.appendChild(t.getElement());var e=document.createElement("div"),i=document.createElement("div"),n=document.createElement("div");t.add(e).style.textAlign="center";var o=t.add(i);return o.style.height="100%",o.style.textAlign="center",o.style.verticalAlign="middle",t.add(n).style.textAlign="center",{header:e,body:i,footer:n}},t.prototype.addCloseButton=function(){var t=this,e=document.createElement("div");return e.innerHTML="<b>X</b>",e.style.fontSize="35px",e.style.position="absolute",e.style.top="0px",e.style.right="10px",e.style.cursor="pointer",this.main.appendChild(e),e.onclick=function(){t.manualClose()},e},t.prototype.setAutoClose=function(){var t=this;this.overlay.onclick=function(){t.manualClose()},this.main.onclick=function(t){t.stopPropagation()}},t.prototype.setContent=function(t){this.main.appendChild(t)},t.prototype.show=function(){this.build(),this.onResize(),this.afterBuild()},t.prototype.close0=function(){this.destroyed=!0,this.overlay.parentElement.removeChild(this.overlay),r.util.getResizehandlers().remove(this.onResizeBound)},t.prototype.manualClose=function(){this.close0()},t.prototype.close=function(){this.close0()},t}();r.DOMPopup=t}(ship||(ship={})),function(t){var e=function(){function t(){this.table=document.createElement("table")}return t.prototype.getElement=function(){return this.table},t.prototype.add=function(t){var e=document.createElement("tr"),i=document.createElement("td");return this.table.appendChild(e),e.appendChild(i),null!=t&&i.appendChild(t),i},t}();t.DOMVerticalLayout=e}(ship||(ship={})),function(o){var t=function(){function t(t){this.gs=t,this._authCompleteHandler=new o.Handlers,this._authComplete=!1,this._updates=[],this._saveScheduled=!1}return t.prototype._onAuthenticationComplete=function(t){this._player=t,this._authComplete=!0,this._saveToCache(),this._authCompleteHandler.fire()},t.prototype.onAuthenticationComplete=function(t){this._authComplete?t():this._authCompleteHandler.once(t)},t.prototype.getPlayer=function(e){if(this._authComplete)e(this._player);else{var i=this,n=!1;setTimeout(function(){if(!n){n=!0,o.logger.warn("No player data loaded after 1000ms.");var t=i._getPlayer();e(t)}},1e3),this._authCompleteHandler.once(function(){if(!n){n=!0;var t=i._getPlayer();e(t)}})}},t.prototype.savePlayerDiff=function(t){if(null==this._player&&this._getPlayer(),o.json.merge(t,this._player),this._updates.push(t),!this._saveScheduled){var e=this;this._saveScheduled=!0,setTimeout(function(){e._saveScheduled=!1,e._doSaveDiff()},50)}},t.prototype._doSaveDiff=function(){var t=this,e=!0;if(this.gs.isPlayerAuthenticated()?null==this._player.getStoreId()&&(e=!1):e=!1,this._saveToCache(),e){var i=this._getAllPendingUpdates();this._updates=[];var n=new gs.SaveStorableDiffRequest;n.setNamespace("players"),n.setStorable(i),this.gs.sendRequest(n,function(){},function(){t._updates.splice(0,0,i),t._rescheduleSave()})}else this._rescheduleSave()},t.prototype._rescheduleSave=function(){var t=this;setTimeout(function(){t.savePlayerDiff(new gs.SPlayer)},5e3)},t.prototype._getAllPendingUpdates=function(){var t=new gs.SPlayer;null!=this._player.getStoreId()&&t.setStoreId(this._player.getStoreId());for(var e=0;e<this._updates.length;e++)o.json.merge(this._updates[e],t);return t},t.prototype.savePlayerDiffAndFlush=function(t,e){var i=!0;if(this.gs.isPlayerAuthenticated()?null==this._player.getStoreId()&&(i=!1):i=!1,!i)return o.logger.error("Unable to flush un-identified player"),void e(null);o.json.merge(t,this._player),this._saveToCache(),t.setStoreId(this._player.getStoreId()),this.gs.shipapi.saveStorableDiffRequest("players",t,function(t){e(t.getStorable())})},t.prototype._getPlayer=function(){if(null==this._player){var t=this.gs.getCache().get();if(null==t.player)this._player=this._newPlayer();else try{this._player=this.gs.decode(t.player)}catch(t){o.logger.error("Failed to read player data",t),this._player=this._newPlayer()}}return this._player},t.prototype._newPlayer=function(){var t=new gs.SPlayer;return t.setId("na"),t.setThirdPartyId("na"),t.setPublisherId(o.Ship.get().config.publisher),t},t.prototype._saveToCache=function(){var t=this.gs.encode(this._player),e=this.gs.getCache().get();if(e.player=t,0<this._updates.length){var i=this._getAllPendingUpdates(),n=this.gs.encode(i);e.player0=n}else e.player0=null;this.gs.getCache().save()},t}();o.PlayerManager=t}(ship||(ship={})),function(t){var e=function(){function t(t){this.gs=t}return t.prototype._onAuthenticationComplete=function(t){},t.prototype.submitScore=function(t,e){var i=this.getBestScore(t);if(!(null!=i&&e<=i)&&(this._cacheNewBest(t,e),this.gs.isPlayerAuthenticated())){var n=new gs.SScore;n.setValue(e),this.gs.shipapi.submitScoreRequest(t,n,function(t){})}},t.prototype.getBestScore=function(t){var e=this.gs.getCache().get();return null==e.scores||null==e.scores[t]?0:e.scores[t]},t.prototype.getScores=function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=20),this.gs.shipapi.getBestScoresRequest(t,i,n,!0,!1,function(t){e(t)})},t.prototype._cacheNewBest=function(t,e){var i=this.gs.getCache().get();null==i.scores&&(i.scores={}),i.scores[t]=e,this.gs.getCache().save()},t}();t.ScoreManager=e}(ship||(ship={})),function(l){function r(t){if(null==t)return null;for(var e=0,i=t.split("."),n=2;0<=n;n--)if(i.length>n){var o=parseInt(i[n]);0==n?o*=1e4:1==n&&(o*=100),e+=o}return e}l.getVersionAsLong=r;var t=function(){function o(){this._authenticated=!1;var e=o._INSTANCE=this,t=l.Ship.get().config,i=r(t.gameVersion);this._versionId=i,this._gameId=t.gameId,this._cache=new l.LocalCache("gs",t,{}),this._plug=(new gs.DisconnectedPlug).init(),this._plug.setEndpoint(t.gsUrl),this._plug.addDomain((new gs.NuggetaCoreDomain).init()),this.shipapi=(new gs.ShipGsDisconnectedApi).init(),this.shipapi.fill=function(t){t instanceof gs.SRequest&&(t.setGameId(e._gameId),t.setGameVersion(e._versionId),t.setPlayerId(e._playerId))},this.shipapi.setDisconnectedPlug(this._plug),this._scoreManager=new l.ScoreManager(this),this._playerManager=new l.PlayerManager(this);var n=this.getCachedPlayerId();null!=n&&(this._playerId=n),l.util.patchGs(),this._plug.addDomain((new gs.ShipGsServerDomain).init())}return o.prototype.onAuthenticationComplete=function(t){this._playerId=t.getId(),this._player=t,this._authenticated=!0,this._scoreManager._onAuthenticationComplete(t),this._playerManager._onAuthenticationComplete(t)},o.prototype.sendRequest=function(t,e,i){t.setGameId(this._gameId),t.setGameVersion(this._versionId),t.setPlayerId(this._playerId),this._plug.request(t,e,i)},o.prototype.trackPlayer=function(t,e,i,n,o){var r=l.Ship.get().config,s=this.getCachedThirdPartyId(),a=this.getCachedPlayerId(),h=null!=this._player?this._player.getSource():null,c=new gs.SPlayerActivityLog;c.setAction(i),c.setCategory(e),c.setLabel(n),c.setPlayerId(a),c.setPublisherId(r.publisher),c.setSource(h),c.setThirdPartyId(s),c.setValue(o),c.setVerbosity(t),c.setVersion(this._versionId),this.shipapi.trackPlayerRequest(c,function(t){})},o.get=function(){return this._INSTANCE},o.prototype.encode=function(t){return this._plug.encode(t)},o.prototype.decode=function(t){return this._plug.decode(t)},o.prototype.isPlayerAuthenticated=function(){return this._authenticated},o.prototype.isReady=function(){return null!=this._playerId},o.prototype.getCache=function(){return this._cache},o.prototype.getCachedThirdPartyId=function(){if(null!=this._player&&null!=this._player.getThirdPartyId()&&"na"!=this._player.getThirdPartyId())return this._player.getThirdPartyId();var t=this._readPlayerCache();return null!=t&&"na"!=t.getThirdPartyId()?t.getThirdPartyId():null},o.prototype.getCachedPlayerId=function(){if(null!=this._player&&null!=this._player.getId()&&"na"!=this._player.getId())return this._player.getId();var t=this._readPlayerCache();return null!=t&&"na"!=t.getId()?t.getId():null},o.prototype._readPlayerCache=function(){var t=this._cache.get();return null==t.player?null:this.decode(t.player)},Object.defineProperty(o.prototype,"playerManager",{get:function(){return this._playerManager},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"scoreManager",{get:function(){return this._scoreManager},enumerable:!0,configurable:!0}),o.prototype.safeInt=function(t){return null==t?0:t},o.prototype.getBooster=function(t){var e=this.playerManager._getPlayer();return t==l.ItemType.Coin?this.safeInt(e.getWallet()):t==l.ItemType.FortuneWheel?this.safeInt(e.getFortuneWheels()):t==l.ItemType.Life?this.safeInt(e.getLifes()):(t==l.ItemType.Premium||l.logger.error("No mapping found for item type: "+t.name),0)},o}();l.ShipGs=t}(ship||(ship={})),function(t){var e=function(){function i(t,e){this.name=t,this.id=e,i.valuesById[e+""]=this,i.valuesByName[t]=this,i.all.push(this)}return i.fromValue=function(t){return i.valuesById[t+""]},i.fromName=function(t){return i.valuesByName[t]},i.valuesById={},i.valuesByName={},i.all=[],i.Coin=new i("Coin",-1),i.FortuneWheel=new i("FortuneWheel",-2),i.Life=new i("Life",-3),i.Premium=new i("Premium",-4),i}();t.ItemType=e}(ship||(ship={})),function(t){var e=function(){function t(){}return t.PENDING=1,t.STARTED=2,t.ABORTED=3,t.FAILED=4,t.VALIDATED=5,t.COMPLETE=6,t}();t.SIAPTransactionStatus=e}(ship||(ship={})),function(e){var t=function(){function t(){this.gs=e.ShipGs.get(),this.ship=e.Ship.get()}return t.prototype.canShowInterstitial=function(){return!1},t.prototype.showInterstitial=function(t){t(!1)},t.prototype.canShowRewardedVideo=function(){return!1},t.prototype.showRewardedVideo=function(t){t(!1)},t}();e.DefaultAdsManager=t}(ship||(ship={})),function(i){var t=function(){function t(){this.gs=i.ShipGs.get(),this.ship=i.Ship.get()}return t.prototype.authenticate=function(t){t(null)},t.prototype.saveServerTime=function(t){if(null!=t.getServerTime()){var e=Date.now()-t.getServerTime();i.util.serverTimeDiff=e}},t}();i.DefaultAuthenticationManager=t}(ship||(ship={})),function(e){var t=function(){function t(){this.gs=e.ShipGs.get(),this.ship=e.Ship.get()}return t.prototype.startGame=function(t){e.logger.debug("Start game"),t()},t.prototype.endGame=function(t){e.logger.debug("End game"),t()},t}();e.DefaultGameActionManager=t}(ship||(ship={})),function(r){var t=function(){function t(){this.packageById={},this.gs=r.ShipGs.get(),this.ship=r.Ship.get(),this._loadPackages()}return t.prototype.buildItemPurchase=function(t){var e=this.packageById[t];return{itemId:t,price:e.price,quantity:e.quantity,name:null,customData:null,discountId:null,externalProductId:null}},t.prototype.startIAP=function(t,e){var i=this.packageById[t.itemId],n=this.gs.getBooster(i.type),o=new gs.SIAPTransaction;o.setDiscountId(t.discountId),o.setExternalItemId(t.externalProductId),o.setItemId(t.itemId),o.setItemType(i.type.name),o.setPrice(t.price),o.setQuantity(t.quantity),o.setInventoryQuantity(n),o.setStatus(r.SIAPTransactionStatus.PENDING),this.gs.shipapi.saveIAPRequest(o,function(t){t.getSaveIAPStatus()==gs.SaveIAPStatus.SUCCESS&&e(t.getIap())})},t.prototype.getDiscountPrice=function(t,e){return e<=0||100<=e?t:t-t*e/100},t.prototype.getPackageById=function(t){return this.packageById[t]},t.prototype._loadPackages=function(){if(null==this.ship.config.packages||this.ship.config.packages.length<=0)r.logger.debug("No item packages.");else for(var t=0;t<this.ship.config.packages.length;t++){var e=this.ship.config.packages[t];this.packageById[e.id]=e}},t.prototype.continueIAP=function(t){var e=new gs.SIAPTransaction;e.setId(t.getId()),e.setStatus(r.SIAPTransactionStatus.STARTED),this.gs.shipapi.saveIAPRequest(e,function(t){})},t}();r.DefaultIAPManager=t}(ship||(ship={})),function(e){var t=function(){function t(){this._readyFired=!1,(t.INSTANCE=this).ship=e.Ship.get()}return t.get=function(){return this.INSTANCE},t.prototype.setReadyCallback=function(t){this._readyCb=t},t.prototype.fireReady=function(){null!=this._readyCb?null!=this._readyFired?this._readyCb():e.logger.error("PublisherService.readyCb already called"):e.logger.error("PublisherService.readyCb is null")},t.prototype.getAuthenticationManager=function(){return this.authenticationManager},t.prototype.getShareManager=function(){return this.shareManager},t.prototype.getIAPManager=function(){return this.iapManager},t.prototype.getGameActionManager=function(){return this.gameActionManager},t.prototype.getAdsManager=function(){return this.adsManager},t}();e.DefaultPublisherService=t}(ship||(ship={})),function(h){var t=function(){function t(){this.uploadedImages={},this.uploadingImages={},this.gs=h.ShipGs.get(),this.ship=h.Ship.get()}return t.prototype.share=function(t,e,i){h.logger.error("Share not implemented"),i({count:0,imageUrl:null})},t.prototype.isB64Image=function(t){return null!=t&&(0!=t.indexOf("http")&&0!=t.indexOf("//"))},t.prototype.uploadImage=function(t,e,i,n){var o=this.uploadedImages[t];if(null==o){var r=this.uploadingImages[t];if(null!=r&&1==r)return h.logger.error("Image "+t+" already uploading."),void n();this.doUploadImage(t,e,i,n)}else i(o)},t.prototype.doUploadImage=function(o,t,r,s){this.uploadingImages[o]=!0;try{var a=this,e="//"+this.ship.config.serverUrl+"/s/image/upload",i="img="+encodeURIComponent(t);h.XHR.post(e,i,function(t,e){if(a.uploadingImages[o]=null,200==e){var i=h.json.parse(t,null);if(null!=i&&"ok"==i.status){var n=i.url;a.uploadedImages[o]=n,r(n)}else s()}else s()})}catch(t){h.logger.error("Error occured while uploadind image id:"+o,t),s()}},t}();h.DefaultShareManager=t}(ship||(ship={})),function(t){var e=function(){};(ship||(ship={})).ItemPurchase=e}(),function(r){var t=function(){function n(t,e){this.config=t,this._loadingProgress=-1,this._readyCalled=!1,this._isReady=!1,this._lastStartTime=Date.now(),(n._INSTANCE=this).gs=null==e?new r.ShipGs:e,this._progressListener=new r.Handlers,this._service=this.createService(t.publisher);var i=this;this._service.setReadyCallback(function(){i._isReady=!0,null!=i._readyCallback&&(i._readyCalled=!0,i._readyCallback())}),this._apiReporter=new r.ApiReporter,this._activityTracker=new r.ActivityTracker,r.logger.debug("Start "+t.publisher+" authentication."),this._service.getAuthenticationManager().authenticate(function(t){r.logger.debug("Authentication complete. "+t.getId()),i.gs.onAuthenticationComplete(t),i._apiReporter._onAuthenticationComplete(t),i._activityTracker._onAuthenticationComplete(t),i._checkApiImplemented()}),r.initErrorTracker()}return n.get=function(){return this._INSTANCE},Object.defineProperty(n.prototype,"service",{get:function(){return this._service},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"shareManager",{get:function(){return this._service.getShareManager()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"iapManager",{get:function(){return this._service.getIAPManager()},enumerable:!0,configurable:!0}),n.prototype.createService=function(t){var e="DummyPublisherService";"okru"==t?e="OkRuPublisherService":"facebook"==t?e="FacebookPublisherService":"fbmessenger"==t?e="FBMessengerPublisherService":"external"==t?e="ExternalPublisherService":"vk"==t?e="VkPublisherService":"gd"==t&&(e="GdPublisherService");var i=Object.create(r[e].prototype);return i.constructor.apply(i),i},n.prototype._muteSound=function(t){null!=this._muteSoundCallback?this._muteSoundCallback(t):r.logger.error("No toggle sound callback. Check your api impl.")},n.prototype._checkApiImplemented=function(){null==this._muteSoundCallback&&this._apiReporter.reportListenerMissing("onMuteSound")},n.prototype.getRessourceUrl=function(t){var e=null==t?this.config.publisher:t;return"//"+this.config.resourcesUrl+"/"+this.config.gameId+"/"+e+"/resources"},n.prototype.onReady=function(t){this._isReady?(this._readyCalled=!0,t()):this._readyCallback=t},n.prototype.setLoadingProgress=function(t){this._progressListener.fire(t),this._loadingProgress=t},n.prototype.onMuteSound=function(t){this._muteSoundCallback=t},n.prototype.startGame=function(t){var e=this;this._readyCalled||this._apiReporter.reportListenerMissing("onReady"),this._loadingProgress<0&&this._apiReporter.reportAPICallMissing("setLoadingProgress"),this._activityTracker.onStartGame(),this._apiReporter.onStartGame(),this.service.getGameActionManager().startGame(function(){e.track(r.TrackingLevel.INFO,"game","started"),e._lastStartTime=Date.now(),t()})},n.prototype.endGame=function(e,i){var n=this;this._apiReporter.onEndGame(e),this.service.getGameActionManager().endGame(function(){var t=Math.round(Date.now()-n._lastStartTime)/1e3;n.track(r.TrackingLevel.INFO,"game","ended",null,t),e&&(n.track(r.TrackingLevel.INFO,"game","started"),n._lastStartTime=Date.now()),i()})},n.prototype.track=function(t,e,i,n,o){r.TRACKING_LEVEL<t||this.gs.trackPlayer(t,e,i,n,o)},n.prototype.getActivityTracker=function(){return this._activityTracker},n}();r.Ship=t}(ship||(ship={})),function(r){var s,t;function a(t,e){return null==e?t+":na":t+":"+e}(t=s=r.TrackingLevel||(r.TrackingLevel={}))[t.MANDATORY=0]="MANDATORY",t[t.INFO=1]="INFO",t[t.DEBUG=2]="DEBUG",r.UETRACKER_READY=!1,r.TRACKING_LEVEL=s.INFO,r.initErrorTracker=function(){window.addEventListener("error",function(t){var e="n/a";null!=t.error&&null!=t.error.message?e=t.error.message:null!=t.message&&(e=t.message),e+=", ",e+=a("filename",t.filename)+", ",e+=a("lineno",t.lineno)+", ";var i=(e+=a("colno",t.colno)+", ").toLowerCase(),n=(r.Ship.get().config,null),o=!0;return-1<i.indexOf("script error")?o=!(n="Script Error"):n=e,o&&r.Ship.get().track(s.MANDATORY,"error","uncaught error",n),!1}),r.UETRACKER_READY=!0,r.logger.addErrorListener(function(t,e){r.Ship.get().track(s.MANDATORY,"error","error",t)})}}(ship||(ship={})),function(s){var t=function(){function t(){this._gameStarted=0,this._retentionSended=!1,this._retentionMetric=null,this._startTime=Date.now()}return t.prototype._onAuthenticationComplete=function(t){this._player=t;var e=new Date(this._player.getCreationDate()),i=new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate())).getTime(),n=s.util.serverTime(),o=(n-i)/864e5;if((o=Math.floor(o))<0)s.logger.error("Negative day diff beetween creation and connection date for #"+this._player.getId()+", creationDate: "+i+", connectionTime: "+n);else{this._retentionMetric="d"+o;var r=this;0==o?setTimeout(function(){r._sendRetention()},6e4):r._sendRetention()}},t.prototype.onStartGame=function(){this._gameStarted++,5<=this._gameStarted&&null!=this._retentionMetric&&this._sendRetention()},t.prototype._sendRetention=function(){if(!this._retentionSended&&null!=this._retentionMetric){this._retentionSended=!0;var t=new gs.SPlayerProperty;t.setPlayerId(this._player.getId()),t.setKey(this._retentionMetric);var e=new gs.NuggetaQuery;e.setQuery("$WHERE PlayerId='"+this._player.getId()+"' $AND Key='"+this._retentionMetric+"'"),e.setLimit(1),s.ShipGs.get().shipapi.findAndModifyStorablesRequest("retentions",e,t,!0,function(t){})}},t}();s.ActivityTracker=t}(ship||(ship={})),function(i){var t=function(){function t(){this._dummy=!1,this._gameStarted=0,this._gameEnded=0,this._firstEnGameChecked=!1,this._lastStart=0,this._startTime=Date.now(),this._dummy="dummy"==i.Ship.get().config.publisher}return t.prototype._onAuthenticationComplete=function(t){var e=this;setTimeout(function(){e._checkGameStarted()},12e4),setTimeout(function(){e._checkGameEnded()},24e4)},t.prototype.reportListenerMissing=function(t){i.logger.warn("No ship listener provided: "+t)},t.prototype.reportAPICallMissing=function(t){i.logger.warn("Ship API not called: "+t)},t.prototype.onStartGame=function(){this._gameStarted++;var t=Date.now(),e=t-this._lastStart;e<5e3&&i.logger.warn("Game already started "+e+" ms ago."),this._lastStart=t},t.prototype.onEndGame=function(t){this._gameEnded++,t&&(this._gameStarted++,this._lastStart=Date.now()),this._firstEnGameChecked||this._checkFirstEndGame()},t.prototype._checkGameStarted=function(){if(!(0<this._gameStarted)){var t=(Date.now()-this._startTime)/1e3;i.logger.warn("No game started after "+t+" seconds.")}},t.prototype._checkGameEnded=function(){if(!(0<this._gameEnded)){var t=(Date.now()-this._startTime)/1e3;i.logger.warn("No game ended after "+t+" seconds.")}},t.prototype._checkFirstEndGame=function(){if(this._firstEnGameChecked=!0,"dummy"==i.Ship.get().config.publisher&&(null!=window.DUST||null!=window.h5ge))try{Error.stackTraceLimit=50;var t=new Error;t.stackTraceLimit=50,t.stack.indexOf("ImmediateClick")<0&&i.logger.error("endGame must be called by user-gesture (ie: onImmediateClick)")}catch(t){i.logger.error("Faild to do first error check",t)}},t}();i.ApiReporter=t}(ship||(ship={})),function(t){(t.util||(t.util={})).patchGs=function(){(new(window.gs||{}||{}).nruntime).load({domainID:401,domainName:"ShipGsServer",nobjects:{SResourceUrl:{hierarchyDepth:2e3,serializerID:201,extendss:{domainID:"400",name:"SStorable"},fields:{Id:{propertyId:0,primitive:!0,type:"String"},Name:{propertyId:1,primitive:!0,type:"String"},RelativePath:{propertyId:2,primitive:!0,type:"String"},MimeType:{propertyId:3,primitive:!0,type:"String"},Width:{propertyId:4,primitive:!0,type:"String"},Height:{propertyId:5,primitive:!0,type:"String"}}},SProduct:{hierarchyDepth:2e3,serializerID:203,extendss:{domainID:"400",name:"SStorable"},fields:{Id:{propertyId:0,primitive:!0,type:"String"},PublisherId:{propertyId:1,primitive:!0,type:"String"},Locale:{propertyId:2,primitive:!0,type:"String"},Title:{propertyId:3,primitive:!0,type:"String"},Description:{propertyId:4,primitive:!0,type:"String"},Image:{propertyId:5,reference:!0,type:"SResourceUrl",domainId:"401"},Price:{propertyId:6,primitive:!0,type:"Double"}}}}})}}(ship||(ship={})),function(t){var e=function(){function t(){this.handlers=[],this.onces=[]}return Object.defineProperty(t.prototype,"length",{get:function(){return this.handlers.length},enumerable:!0,configurable:!0}),t.prototype.once=function(t){return this.onces.push(t),t},t.prototype.add=function(t){return this.handlers.push(t),t},t.prototype.remove=function(t){for(var e=-1,i=0;i<this.handlers.length;i++)if(this.handlers[i]==t){e=i;break}-1<e&&this.handlers.splice(e,1)},t.prototype.clear=function(){0<this.handlers.length&&this.handlers.splice(0,this.handlers.length),0<this.onces.length&&this.onces.splice(0,this.onces.length)},t.prototype.fire=function(e){var i=this;this.handlers.forEach(function(t){t.apply(i,[e])}),0<this.onces.length&&(this.onces.forEach(function(t){t.apply(i,[e])}),this.onces.splice(0,this.onces.length))},t}();t.Handlers=e}(ship||(ship={})),function(n){var t;(t=n.json||(n.json={})).parse=function(e,i){if(null==e)return i;try{return JSON.parse(e)}catch(t){return n.logger.error("failed to decode: "+e),i}},t.merge=function t(e,i){for(var n in e){var o=e[n],r=typeof o;"function"!==r&&(n in i&&"object"===r?t(o,i[n]):i[n]=o)}}}(ship||(ship={})),function(n){!function(t){function i(){var t=window.navigator.languages,e=t?t[0]:null;return-1!==(e=e||window.navigator.language||window.navigator.browserLanguage||window.navigator.userLanguage).indexOf("-")&&(e=e.split("-")[0]),-1!==e.indexOf("_")&&(e=e.split("_")[0]),e=e.toLowerCase()}t.resolveGameLang=function(){var t=n.Ship.get().config.defaultLocale;if(null!=t&&"autodetect"!=t)return t;var e=i();return null!=e?e:"en"},t.detectBrowserLang=i}(n.lang||(n.lang={}))}(ship||(ship={})),function(n){(n.util||(n.util={})).loadJs=function(e,t){var i=document.createElement("script");i.type="text/javascript",i.readyState?i.onreadystatechange=function(){"loaded"!==i.readyState&&"complete"!==i.readyState||(i.onreadystatechange=null,t())}:i.onload=function(){t()},i.onerror=function(t){n.logger.error("Failed to load script "+e+"! "+t)},i.src=e,document.getElementsByTagName("head")[0].appendChild(i)}}(ship||(ship={})),function(t){var s,a=[],n=[];function o(t,e,i){var n=a[0],o=document.createElement("div");if(o.innerHTML="<b>"+t+"</b>: "+e+(null==i?"":", "+i),s.insertBefore(o,n),a.splice(0,0,o),n=o,8<a.length){var r=a[a.length-1];a.splice(a.length-1,1),s.removeChild(r)}}t.logger={debug:function(t){console&&console.debug(t),null!=s&&o("debug",t)},info:function(t){console&&console.info(t),null!=s&&o("info",t)},warn:function(t){console&&console.warn(t),null!=s&&o("warn",t)},error:function(t,e){console&&console.error(t,e),null!=s&&o("error",t,e);for(var i=0;i<n.length;i++){(0,n[i])(t,e)}},addErrorListener:function(t){n.push(t)}},t.enableDomConsole=function(){var t=document.createElement("div");t.style.background="white",t.style.fontSize="10px",t.style.fontFamily="Consolas, monaco, monospace",t.style.position="absolute",t.style.top="0",t.style.zIndex="11",document.body.appendChild(t);var e=document.createElement("div");t.appendChild(e),a.push(e),s=t}}(ship||(ship={})),function(r){!function(t){var e,i=!1;function n(){var t=o();e.fire(t)}function o(){return{width:window.innerWidth,height:window.innerHeight}}t.getResizehandlers=function(){return null==e&&null==e&&(e=new r.Handlers,window.addEventListener("resize",function(){i||(i=!0,setTimeout(function(){n()},250))}),window.addEventListener("deviceOrientation",function(){i||(i=!0,setTimeout(function(){n()},250))})),e},t.getWindowSize=o}(r.util||(r.util={}))}(ship||(ship={})),function(t){var e;(e=t.util||(t.util={})).serverTimeDiff=0,e.serverTime=function(){return Date.now()-e.serverTimeDiff}}(ship||(ship={})),function(t){!function(t){var s=null;function i(){s={};var t=window.location.search;if(t)for(var e=(t=t.substr(1)).split("&"),i=0;i<e.length;i++){var n=e[i].split("="),o=n[0],r=n[1];r=decodeURIComponent(r.replace(/\+/g," ")),s[o]=r}return s}t.getUrlParameters=function(t){return null==s&&i(),s[t]},t.addUrlParameters=function(t,e){null==s&&i(),s[t]=e},t.deserializeQuery=function(t){var e={};if(null==t||0==t.length)return e;for(var i=t.split("&"),n=0;n<i.length;n++){var o=i[n].split("=");if(2==o.length){var r=decodeURIComponent(o[0]),s=decodeURIComponent(o[1]);e[r]=s}}return e}}(t.util||(t.util={}))}(ship||(ship={})),function(o){var t=function(){function t(){}return t.get=function(t,e,i){var n=new XMLHttpRequest;n.open("get",t,!0);n.onerror=function(t){o.logger.warn("get error: "+n.statusText),i&&i(null,n.status)},n.onload=function(){i&&i(n.responseText,n.status)},n.send()},t.post=function(t,e,i){var n=new XMLHttpRequest;n.open("post",t,!0),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8");n.onerror=function(t){i&&i(null,n.status)},n.onload=function(){i&&i(n.responseText,n.status)},n.send(e)},t}();o.XHR=t}(ship||(ship={}));var ship;__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(e){var t=function(i){function t(){var t=i.call(this)||this;t._initDone=!1;var e=t;return setTimeout(function(){e._init()},0),t}return __extends(t,i),t.prototype._init=function(){this._initDone||(this._initDone=!0,0<window.location.host.indexOf(":")||(this._ima=new e.IMA(!0,"2326498490"),this._ima.init()))},t.prototype.canShowInterstitial=function(){return null!=this._ima&&1==this._ima.adsPreloaded()},t.prototype.showInterstitial=function(e){null!=this._ima&&this._ima.adsPreloaded()?this._ima.showAds(function(t){e(t)}):e(!1)},t}(e.DefaultAdsManager);e.DummyAdsManager=t}(ship||(ship={})),function(o){var t=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.authenticate=function(e){o.logger.info("Dummy auth");var i=this,t=this.gs.getCachedThirdPartyId();"na"==t&&(t=null);var n=new gs.NMap;n.put("publisherId","dummy"),n.put("thirdPartyId",t),n.put("gameLang",o.lang.resolveGameLang()),this.gs.shipapi.authenticateRequest(n,function(t){t.getAuthenticateStatus()==gs.AuthenticateStatus.SUCCESS&&(i.saveServerTime(t),e(t.getPlayer()))})},e}(o.DefaultAuthenticationManager);o.DummyAuthenticationManager=t}(ship||(ship={})),function(n){var t=function(e){function t(){var t=e.call(this)||this;return t._adsDelay=12e4,t._lastAds=Date.now(),t._adsDisplayed=0,t}return __extends(t,e),t.prototype.startGame=function(t){n.logger.debug("Start game"),t()},t.prototype.endGame=function(e){if(0<this._adsDisplayed)e();else{var i=this,t=this.ship.service.getAdsManager();Date.now()-this._lastAds>=this._adsDelay&&t.canShowInterstitial()?t.showInterstitial(function(t){n.logger.debug("End game. Ads displayed: "+t),t&&(i._lastAds=Date.now(),i._adsDisplayed++),e()}):(n.logger.debug("End game"),e())}},t}(n.DefaultGameActionManager);n.DummyGameActionManager=t}(ship||(ship={})),function(h){var t=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.formatPrice=function(t){return t+" DUM"},e.prototype.buyItem=function(t,i,e){this.closeIapCb=e,this.continueIAP(i);var n=this,o=new gs.NuggetaQuery;o.setQuery("$WHERE Id='"+t.itemId+"'"),o.setLimit(1),this.gs.shipapi.findStorablesRequest("products",o,function(t){var e=0<t.getStorables().length?t.getStorables()[0]:null;n.showPopupConfirmation(i,e)})},e.prototype.showPopupConfirmation=function(t,e){var i=this;if(null==e)return h.logger.error("No product found matching item "+t.getItemId()+". Transaction aborded."),void this.closeIapCb();this.ship.track(h.TrackingLevel.MANDATORY,"iap","openPublisherPopup");var n=document.createElement("div");n.style.zIndex="11",n.style.position="absolute",n.style.top="0",n.style.padding="20px",n.style.backgroundColor="white";var o=document.createElement("span");o.innerText="Confirm payment of "+e.getTitle()+" for "+t.getPrice();var r=document.createElement("img");r.src=this.ship.getRessourceUrl("facebook")+"/"+e.getImage().getRelativePath();var s=document.createElement("button");s.innerText="___OK___";var a=document.createElement("button");a.innerText="_Cancel_",n.appendChild(o),n.appendChild(r),n.appendChild(s),n.appendChild(a),s.onclick=function(){i.confirmTransaction(t),document.body.removeChild(n)},a.onclick=function(){document.body.removeChild(n),i.closeIapCb()},document.body.appendChild(n)},e.prototype.confirmTransaction=function(t){var e=this.ship.config,i=this,n="//"+e.serverUrl+"/s/payment?source="+e.publisher+"&gid="+e.gameId+"&tid="+t.getId();h.XHR.get(n,null,function(t,e){setTimeout(function(){i.closeIapCb()},5e3),console.log("Server get. Status="+e+", Data="+t)})},e}(h.DefaultIAPManager);h.DummyIAPManager=t}(ship||(ship={})),function(n){var t=function(i){function t(){var t=i.call(this)||this;t.authenticationManager=new n.DummyAuthenticationManager,t.shareManager=new n.DummyShareManager,t.iapManager=new n.DummyIAPManager,t.gameActionManager=new n.DummyGameActionManager,t.adsManager=new n.DummyAdsManager,n.Ship.get()._progressListener.add(function(t){n.logger.debug("Progress: "+t)});var e=t;return setTimeout(function(){e.fireReady()},0),t}return __extends(t,i),t}(n.DefaultPublisherService);n.DummyPublisherService=t}(ship||(ship={})),function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.DefaultShareManager);t.DummyShareManager=e}(ship||(ship={})),function(t){var e;"object"==typeof exports?module.exports=t():("undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.p2=t())}(function(){return function o(r,s,a){function h(i,t){if(!s[i]){if(!r[i]){var e="function"==typeof require&&require;if(!t&&e)return e(i,!0);if(c)return c(i,!0);throw new Error("Cannot find module '"+i+"'")}var n=s[i]={exports:{}};r[i][0].call(n.exports,function(t){var e=r[i][1][t];return h(e||t)},n,n.exports,o,r,s,a)}return s[i].exports}for(var c="function"==typeof require&&require,t=0;t<a.length;t++)h(a[t]);return h}({1:[function(t,e,i){var u=t("./Scalar");function n(){}(e.exports=n).lineInt=function(t,e,i){i=i||0;var n,o,r,s,a,h,c,l=[0,0];return n=t[1][1]-t[0][1],o=t[0][0]-t[1][0],r=n*t[0][0]+o*t[0][1],s=e[1][1]-e[0][1],a=e[0][0]-e[1][0],h=s*e[0][0]+a*e[0][1],c=n*a-s*o,u.eq(c,0,i)||(l[0]=(a*r-o*h)/c,l[1]=(n*h-s*r)/c),l},n.segmentsIntersect=function(t,e,i,n){var o=e[0]-t[0],r=e[1]-t[1],s=n[0]-i[0],a=n[1]-i[1];if(s*r-a*o==0)return!1;var h=(o*(i[1]-t[1])+r*(t[0]-i[0]))/(s*r-a*o),c=(s*(t[1]-i[1])+a*(i[0]-t[0]))/(a*o-s*r);return 0<=h&&h<=1&&0<=c&&c<=1}},{"./Scalar":4}],2:[function(t,e,i){function c(){}(e.exports=c).area=function(t,e,i){return(e[0]-t[0])*(i[1]-t[1])-(i[0]-t[0])*(e[1]-t[1])},c.left=function(t,e,i){return 0<c.area(t,e,i)},c.leftOn=function(t,e,i){return 0<=c.area(t,e,i)},c.right=function(t,e,i){return c.area(t,e,i)<0},c.rightOn=function(t,e,i){return c.area(t,e,i)<=0};var l=[],u=[];c.collinear=function(t,e,i,n){if(n){var o=l,r=u;o[0]=e[0]-t[0],o[1]=e[1]-t[1],r[0]=i[0]-e[0],r[1]=i[1]-e[1];var s=o[0]*r[0]+o[1]*r[1],a=Math.sqrt(o[0]*o[0]+o[1]*o[1]),h=Math.sqrt(r[0]*r[0]+r[1]*r[1]);return Math.acos(s/(a*h))<n}return 0==c.area(t,e,i)},c.sqdist=function(t,e){var i=e[0]-t[0],n=e[1]-t[1];return i*i+n*n}},{}],3:[function(t,e,i){var a=t("./Line"),I=t("./Point"),p=t("./Scalar");function w(){this.vertices=[]}(e.exports=w).prototype.at=function(t){var e=this.vertices,i=e.length;return e[t<0?t%i+i:t%i]},w.prototype.first=function(){return this.vertices[0]},w.prototype.last=function(){return this.vertices[this.vertices.length-1]},w.prototype.clear=function(){this.vertices.length=0},w.prototype.append=function(t,e,i){if(void 0===e)throw new Error("From is not given!");if(void 0===i)throw new Error("To is not given!");if(i-1<e)throw new Error("lol1");if(i>t.vertices.length)throw new Error("lol2");if(e<0)throw new Error("lol3");for(var n=e;n<i;n++)this.vertices.push(t.vertices[n])},w.prototype.makeCCW=function(){for(var t=0,e=this.vertices,i=1;i<this.vertices.length;++i)(e[i][1]<e[t][1]||e[i][1]==e[t][1]&&e[i][0]>e[t][0])&&(t=i);I.left(this.at(t-1),this.at(t),this.at(t+1))||this.reverse()},w.prototype.reverse=function(){for(var t=[],e=0,i=this.vertices.length;e!==i;e++)t.push(this.vertices.pop());this.vertices=t},w.prototype.isReflex=function(t){return I.right(this.at(t-1),this.at(t),this.at(t+1))};var h=[],c=[];function x(t,e,i,n,o){o=o||0;var r=e[1]-t[1],s=t[0]-e[0],a=r*t[0]+s*t[1],h=n[1]-i[1],c=i[0]-n[0],l=h*i[0]+c*i[1],u=r*c-h*s;return p.eq(u,0,o)?[0,0]:[(c*a-s*l)/u,(r*l-h*a)/u]}w.prototype.canSee=function(t,e){var i,n,o=h,r=c;if(I.leftOn(this.at(t+1),this.at(t),this.at(e))&&I.rightOn(this.at(t-1),this.at(t),this.at(e)))return!1;n=I.sqdist(this.at(t),this.at(e));for(var s=0;s!==this.vertices.length;++s)if((s+1)%this.vertices.length!==t&&s!==t&&I.leftOn(this.at(t),this.at(e),this.at(s+1))&&I.rightOn(this.at(t),this.at(e),this.at(s))&&(o[0]=this.at(t),o[1]=this.at(e),r[0]=this.at(s),r[1]=this.at(s+1),i=a.lineInt(o,r),I.sqdist(this.at(t),i)<n))return!1;return!0},w.prototype.copy=function(t,e,i){var n=i||new w;if(n.clear(),t<e)for(var o=t;o<=e;o++)n.vertices.push(this.vertices[o]);else{for(o=0;o<=e;o++)n.vertices.push(this.vertices[o]);for(o=t;o<this.vertices.length;o++)n.vertices.push(this.vertices[o])}return n},w.prototype.getCutEdges=function(){for(var t=[],e=[],i=[],n=new w,o=Number.MAX_VALUE,r=0;r<this.vertices.length;++r)if(this.isReflex(r))for(var s=0;s<this.vertices.length;++s)if(this.canSee(r,s)){e=this.copy(r,s,n).getCutEdges(),i=this.copy(s,r,n).getCutEdges();for(var a=0;a<i.length;a++)e.push(i[a]);e.length<o&&(o=(t=e).length,t.push([this.at(r),this.at(s)]))}return t},w.prototype.decomp=function(){var t=this.getCutEdges();return 0<t.length?this.slice(t):[this]},w.prototype.slice=function(t){if(0==t.length)return[this];if(t instanceof Array&&t.length&&t[0]instanceof Array&&2==t[0].length&&t[0][0]instanceof Array){for(var e=[this],i=0;i<t.length;i++)for(var n=t[i],o=0;o<e.length;o++){var r=e[o].slice(n);if(r){e.splice(o,1),e.push(r[0],r[1]);break}}return e}n=t,i=this.vertices.indexOf(n[0]),o=this.vertices.indexOf(n[1]);return-1!=i&&-1!=o&&[this.copy(i,o),this.copy(o,i)]},w.prototype.isSimple=function(){for(var t=this.vertices,e=0;e<t.length-1;e++)for(var i=0;i<e-1;i++)if(a.segmentsIntersect(t[e],t[e+1],t[i],t[i+1]))return!1;for(e=1;e<t.length-2;e++)if(a.segmentsIntersect(t[0],t[t.length-1],t[e],t[e+1]))return!1;return!0},w.prototype.quickDecomp=function(t,e,i,n,o,r){o=o||100,r=r||0,n=n||25,t=void 0!==t?t:[],e=e||[],i=i||[];var s=[0,0],a=[0,0],h=[0,0],c=0,l=0,u=0,p=0,d=0,f=0,y=0,g=new w,m=new w,v=this,S=this.vertices;if(S.length<3)return t;if(o<++r)return console.warn("quickDecomp: max level ("+o+") reached."),t;for(var _=0;_<this.vertices.length;++_)if(v.isReflex(_)){e.push(v.vertices[_]),c=l=Number.MAX_VALUE;for(var b=0;b<this.vertices.length;++b)I.left(v.at(_-1),v.at(_),v.at(b))&&I.rightOn(v.at(_-1),v.at(_),v.at(b-1))&&(h=x(v.at(_-1),v.at(_),v.at(b),v.at(b-1)),I.right(v.at(_+1),v.at(_),h)&&(u=I.sqdist(v.vertices[_],h))<l&&(l=u,a=h,f=b)),I.left(v.at(_+1),v.at(_),v.at(b+1))&&I.rightOn(v.at(_+1),v.at(_),v.at(b))&&(h=x(v.at(_+1),v.at(_),v.at(b),v.at(b+1)),I.left(v.at(_-1),v.at(_),h)&&(u=I.sqdist(v.vertices[_],h))<c&&(c=u,s=h,d=b));if(f==(d+1)%this.vertices.length)h[0]=(a[0]+s[0])/2,h[1]=(a[1]+s[1])/2,i.push(h),_<d?(g.append(v,_,d+1),g.vertices.push(h),m.vertices.push(h),0!=f&&m.append(v,f,v.vertices.length),m.append(v,0,_+1)):(0!=_&&g.append(v,_,v.vertices.length),g.append(v,0,d+1),g.vertices.push(h),m.vertices.push(h),m.append(v,f,_+1));else{if(d<f&&(d+=this.vertices.length),p=Number.MAX_VALUE,d<f)return t;for(b=f;b<=d;++b)I.leftOn(v.at(_-1),v.at(_),v.at(b))&&I.rightOn(v.at(_+1),v.at(_),v.at(b))&&(u=I.sqdist(v.at(_),v.at(b)))<p&&(p=u,y=b%this.vertices.length);_<y?(g.append(v,_,y+1),0!=y&&m.append(v,y,S.length),m.append(v,0,_+1)):(0!=_&&g.append(v,_,S.length),g.append(v,0,y+1),m.append(v,y,_+1))}return g.vertices.length<m.vertices.length?(g.quickDecomp(t,e,i,n,o,r),m.quickDecomp(t,e,i,n,o,r)):(m.quickDecomp(t,e,i,n,o,r),g.quickDecomp(t,e,i,n,o,r)),t}return t.push(this),t},w.prototype.removeCollinearPoints=function(t){for(var e=0,i=this.vertices.length-1;3<this.vertices.length&&0<=i;--i)I.collinear(this.at(i-1),this.at(i),this.at(i+1),t)&&(this.vertices.splice(i%this.vertices.length,1),i--,e++);return e}},{"./Line":1,"./Point":2,"./Scalar":4}],4:[function(t,e,i){function n(){}(e.exports=n).eq=function(t,e,i){return i=i||0,Math.abs(t-e)<i}},{}],5:[function(t,e,i){e.exports={Polygon:t("./Polygon"),Point:t("./Point")}},{"./Point":2,"./Polygon":3}],6:[function(t,e,i){e.exports={name:"p2",version:"0.7.1",description:"A JavaScript 2D physics engine.",author:"Stefan Hedman <schteppe@gmail.com> (http://steffe.se)",keywords:["p2.js","p2","physics","engine","2d"],main:"./src/p2.js",engines:{node:"*"},repository:{type:"git",url:"https://github.com/schteppe/p2.js.git"},bugs:{url:"https://github.com/schteppe/p2.js/issues"},licenses:[{type:"MIT"}],devDependencies:{grunt:"^0.4.5","grunt-contrib-jshint":"^0.11.2","grunt-contrib-nodeunit":"^0.4.1","grunt-contrib-uglify":"~0.4.0","grunt-contrib-watch":"~0.5.0","grunt-browserify":"~2.0.1","grunt-contrib-concat":"^0.4.0"},dependencies:{"poly-decomp":"0.1.1"}}},{}],7:[function(t,e,i){var d=t("../math/vec2");t("../utils/Utils");function n(t){this.lowerBound=d.create(),t&&t.lowerBound&&d.copy(this.lowerBound,t.lowerBound),this.upperBound=d.create(),t&&t.upperBound&&d.copy(this.upperBound,t.upperBound)}e.exports=n;var f=d.create();n.prototype.setFromPoints=function(t,e,i,n){var o=this.lowerBound,r=this.upperBound;"number"!=typeof i&&(i=0),0!==i?d.rotate(o,t[0],i):d.copy(o,t[0]),d.copy(r,o);for(var s=Math.cos(i),a=Math.sin(i),h=1;h<t.length;h++){var c=t[h];if(0!==i){var l=c[0],u=c[1];f[0]=s*l-a*u,f[1]=a*l+s*u,c=f}for(var p=0;p<2;p++)c[p]>r[p]&&(r[p]=c[p]),c[p]<o[p]&&(o[p]=c[p])}e&&(d.add(this.lowerBound,this.lowerBound,e),d.add(this.upperBound,this.upperBound,e)),n&&(this.lowerBound[0]-=n,this.lowerBound[1]-=n,this.upperBound[0]+=n,this.upperBound[1]+=n)},n.prototype.copy=function(t){d.copy(this.lowerBound,t.lowerBound),d.copy(this.upperBound,t.upperBound)},n.prototype.extend=function(t){for(var e=2;e--;){var i=t.lowerBound[e];this.lowerBound[e]>i&&(this.lowerBound[e]=i);var n=t.upperBound[e];this.upperBound[e]<n&&(this.upperBound[e]=n)}},n.prototype.overlaps=function(t){var e=this.lowerBound,i=this.upperBound,n=t.lowerBound,o=t.upperBound;return(n[0]<=i[0]&&i[0]<=o[0]||e[0]<=o[0]&&o[0]<=i[0])&&(n[1]<=i[1]&&i[1]<=o[1]||e[1]<=o[1]&&o[1]<=i[1])},n.prototype.containsPoint=function(t){var e=this.lowerBound,i=this.upperBound;return e[0]<=t[0]&&t[0]<=i[0]&&e[1]<=t[1]&&t[1]<=i[1]},n.prototype.overlapsRay=function(t){var e=1/t.direction[0],i=1/t.direction[1],n=(this.lowerBound[0]-t.from[0])*e,o=(this.upperBound[0]-t.from[0])*e,r=(this.lowerBound[1]-t.from[1])*i,s=(this.upperBound[1]-t.from[1])*i,a=Math.max(Math.max(Math.min(n,o),Math.min(r,s))),h=Math.min(Math.min(Math.max(n,o),Math.max(r,s)));return h<0?-1:h<a?-1:a}},{"../math/vec2":30,"../utils/Utils":57}],8:[function(t,e,i){var o=t("../math/vec2"),r=t("../objects/Body");function n(t){this.type=t,this.result=[],this.world=null,this.boundingVolumeType=n.AABB}(e.exports=n).AABB=1,n.BOUNDING_CIRCLE=2,n.prototype.setWorld=function(t){this.world=t},n.prototype.getCollisionPairs=function(t){};var s=o.create();n.boundingRadiusCheck=function(t,e){o.sub(s,t.position,e.position);var i=o.squaredLength(s),n=t.boundingRadius+e.boundingRadius;return i<=n*n},n.aabbCheck=function(t,e){return t.getAABB().overlaps(e.getAABB())},n.prototype.boundingVolumeCheck=function(t,e){var i;switch(this.boundingVolumeType){case n.BOUNDING_CIRCLE:i=n.boundingRadiusCheck(t,e);break;case n.AABB:i=n.aabbCheck(t,e);break;default:throw new Error("Bounding volume type not recognized: "+this.boundingVolumeType)}return i},n.canCollide=function(t,e){var i=r.KINEMATIC,n=r.STATIC;return(t.type!==n||e.type!==n)&&(!(t.type===i&&e.type===n||t.type===n&&e.type===i)&&((t.type!==i||e.type!==i)&&((t.sleepState!==r.SLEEPING||e.sleepState!==r.SLEEPING)&&!(t.sleepState===r.SLEEPING&&e.type===n||e.sleepState===r.SLEEPING&&t.type===n))))},n.NAIVE=1,n.SAP=2},{"../math/vec2":30,"../objects/Body":31}],9:[function(t,e,i){t("../shapes/Circle"),t("../shapes/Plane"),t("../shapes/Shape"),t("../shapes/Particle");var h=t("../collision/Broadphase");t("../math/vec2");function n(){h.call(this,h.NAIVE)}(((e.exports=n).prototype=new h).constructor=n).prototype.getCollisionPairs=function(t){for(var e=t.bodies,i=this.result,n=i.length=0,o=e.length;n!==o;n++)for(var r=e[n],s=0;s<n;s++){var a=e[s];h.canCollide(r,a)&&this.boundingVolumeCheck(r,a)&&i.push(r,a)}return i},n.prototype.aabbQuery=function(t,e,i){i=i||[];for(var n=t.bodies,o=0;o<n.length;o++){var r=n[o];r.aabbNeedsUpdate&&r.updateAABB(),r.aabb.overlaps(e)&&i.push(r)}return i}},{"../collision/Broadphase":8,"../math/vec2":30,"../shapes/Circle":39,"../shapes/Particle":43,"../shapes/Plane":44,"../shapes/Shape":45}],10:[function(t,e,i){var q=t("../math/vec2"),U=q.sub,z=q.add,V=q.dot,n=(t("../utils/Utils"),t("../utils/ContactEquationPool")),o=t("../utils/FrictionEquationPool"),r=t("../utils/TupleDictionary"),s=t("../equations/Equation"),a=(t("../equations/ContactEquation"),t("../equations/FrictionEquation"),t("../shapes/Circle")),h=t("../shapes/Convex"),c=t("../shapes/Shape"),w=(t("../objects/Body"),t("../shapes/Box"));e.exports=$;var x=q.fromValues(0,1),j=q.fromValues(0,0),Y=q.fromValues(0,0),W=q.fromValues(0,0),X=q.fromValues(0,0),K=q.fromValues(0,0),O=q.fromValues(0,0),J=q.fromValues(0,0),Q=q.fromValues(0,0),Z=q.fromValues(0,0),N=q.fromValues(0,0),B=q.fromValues(0,0),F=q.fromValues(0,0),k=q.fromValues(0,0),G=q.fromValues(0,0),P=q.fromValues(0,0),D=q.fromValues(0,0),T=q.fromValues(0,0),L=q.fromValues(0,0),H=[];function $(){this.contactEquations=[],this.frictionEquations=[],this.enableFriction=!0,this.enabledEquations=!0,this.slipForce=10,this.frictionCoefficient=.3,this.surfaceVelocity=0,this.contactEquationPool=new n({size:32}),this.frictionEquationPool=new o({size:64}),this.restitution=0,this.stiffness=s.DEFAULT_STIFFNESS,this.relaxation=s.DEFAULT_RELAXATION,this.frictionStiffness=s.DEFAULT_STIFFNESS,this.frictionRelaxation=s.DEFAULT_RELAXATION,this.enableFrictionReduction=!0,this.collidingBodiesLastStep=new r,this.contactSkinSize=.01}var l=q.create(),u=q.create();function S(t,e){q.set(t.vertices[0],.5*-e.length,-e.radius),q.set(t.vertices[1],.5*e.length,-e.radius),q.set(t.vertices[2],.5*e.length,e.radius),q.set(t.vertices[3],.5*-e.length,e.radius)}$.prototype.bodiesOverlap=function(t,e){for(var i=l,n=u,o=0,r=t.shapes.length;o!==r;o++){var s=t.shapes[o];t.toWorldFrame(i,s.position);for(var a=0,h=e.shapes.length;a!==h;a++){var c=e.shapes[a];if(e.toWorldFrame(n,c.position),this[s.type|c.type](t,s,i,s.angle+t.angle,e,c,n,c.angle+e.angle,!0))return!0}}return!1},$.prototype.collidedLastStep=function(t,e){var i=0|t.id,n=0|e.id;return!!this.collidingBodiesLastStep.get(i,n)},$.prototype.reset=function(){this.collidingBodiesLastStep.reset();for(var t=this.contactEquations,e=t.length;e--;){var i=t[e],n=i.bodyA.id,o=i.bodyB.id;this.collidingBodiesLastStep.set(n,o,!0)}for(var r=this.contactEquations,s=this.frictionEquations,a=0;a<r.length;a++)this.contactEquationPool.release(r[a]);for(a=0;a<s.length;a++)this.frictionEquationPool.release(s[a]);this.contactEquations.length=this.frictionEquations.length=0},$.prototype.createContactEquation=function(t,e,i,n){var o=this.contactEquationPool.get();return o.bodyA=t,o.bodyB=e,o.shapeA=i,o.shapeB=n,o.restitution=this.restitution,o.firstImpact=!this.collidedLastStep(t,e),o.stiffness=this.stiffness,o.relaxation=this.relaxation,o.needsUpdate=!0,o.enabled=this.enabledEquations,o.offset=this.contactSkinSize,o},$.prototype.createFrictionEquation=function(t,e,i,n){var o=this.frictionEquationPool.get();return o.bodyA=t,o.bodyB=e,o.shapeA=i,o.shapeB=n,o.setSlipForce(this.slipForce),o.frictionCoefficient=this.frictionCoefficient,o.relativeVelocity=this.surfaceVelocity,o.enabled=this.enabledEquations,o.needsUpdate=!0,o.stiffness=this.frictionStiffness,o.relaxation=this.frictionRelaxation,o.contactEquations.length=0,o},$.prototype.createFrictionFromContact=function(t){var e=this.createFrictionEquation(t.bodyA,t.bodyB,t.shapeA,t.shapeB);return q.copy(e.contactPointA,t.contactPointA),q.copy(e.contactPointB,t.contactPointB),q.rotate90cw(e.t,t.normalA),e.contactEquations.push(t),e},$.prototype.createFrictionFromAverage=function(t){var e=this.contactEquations[this.contactEquations.length-1],i=this.createFrictionEquation(e.bodyA,e.bodyB,e.shapeA,e.shapeB),n=e.bodyA;e.bodyB;q.set(i.contactPointA,0,0),q.set(i.contactPointB,0,0),q.set(i.t,0,0);for(var o=0;o!==t;o++)(e=this.contactEquations[this.contactEquations.length-1-o]).bodyA===n?(q.add(i.t,i.t,e.normalA),q.add(i.contactPointA,i.contactPointA,e.contactPointA),q.add(i.contactPointB,i.contactPointB,e.contactPointB)):(q.sub(i.t,i.t,e.normalA),q.add(i.contactPointA,i.contactPointA,e.contactPointB),q.add(i.contactPointB,i.contactPointB,e.contactPointA)),i.contactEquations.push(e);var r=1/t;return q.scale(i.contactPointA,i.contactPointA,r),q.scale(i.contactPointB,i.contactPointB,r),q.normalize(i.t,i.t),q.rotate90cw(i.t,i.t),i},$.prototype[c.LINE|c.CONVEX]=$.prototype.convexLine=function(t,e,i,n,o,r,s,a,h){return!h&&0},$.prototype[c.LINE|c.BOX]=$.prototype.lineBox=function(t,e,i,n,o,r,s,a,h){return!h&&0};var d=new w({width:1,height:1}),f=q.create();$.prototype[c.CAPSULE|c.CONVEX]=$.prototype[c.CAPSULE|c.BOX]=$.prototype.convexCapsule=function(t,e,i,n,o,r,s,a,h){var c=f;q.set(c,r.length/2,0),q.rotate(c,c,a),q.add(c,c,s);var l=this.circleConvex(o,r,c,a,t,e,i,n,h,r.radius);q.set(c,-r.length/2,0),q.rotate(c,c,a),q.add(c,c,s);var u=this.circleConvex(o,r,c,a,t,e,i,n,h,r.radius);if(h&&(l||u))return!0;var p=d;return S(p,r),this.convexConvex(t,e,i,n,o,p,s,a,h)+l+u},$.prototype[c.CAPSULE|c.LINE]=$.prototype.lineCapsule=function(t,e,i,n,o,r,s,a,h){return!h&&0};var _=q.create(),b=q.create(),I=new w({width:1,height:1});$.prototype[c.CAPSULE|c.CAPSULE]=$.prototype.capsuleCapsule=function(t,e,i,n,o,r,s,a,h){for(var c=_,l=b,u=0,p=0;p<2;p++){q.set(c,(0===p?-1:1)*e.length/2,0),q.rotate(c,c,n),q.add(c,c,i);for(var d=0;d<2;d++){q.set(l,(0===d?-1:1)*r.length/2,0),q.rotate(l,l,a),q.add(l,l,s),this.enableFrictionReduction&&(m=this.enableFriction,this.enableFriction=!1);var f=this.circleCircle(t,e,c,n,o,r,l,a,h,e.radius,r.radius);if(this.enableFrictionReduction&&(this.enableFriction=m),h&&f)return!0;u+=f}}this.enableFrictionReduction&&(m=this.enableFriction,this.enableFriction=!1);var y=I;S(y,e);var g=this.convexCapsule(t,y,i,n,o,r,s,a,h);if(this.enableFrictionReduction&&(this.enableFriction=m),h&&g)return!0;if(u+=g,this.enableFrictionReduction){var m=this.enableFriction;this.enableFriction=!1}S(y,r);var v=this.convexCapsule(o,y,s,a,t,e,i,n,h);return this.enableFrictionReduction&&(this.enableFriction=m),!(!h||!v)||(u+=v,this.enableFrictionReduction&&u&&this.enableFriction&&this.frictionEquations.push(this.createFrictionFromAverage(u)),u)},$.prototype[c.LINE|c.LINE]=$.prototype.lineLine=function(t,e,i,n,o,r,s,a,h){return!h&&0},$.prototype[c.PLANE|c.LINE]=$.prototype.planeLine=function(t,e,i,n,o,r,s,a,h){var c=j,l=Y,u=W,p=X,d=K,f=O,y=J,g=Q,m=Z,v=H,S=0;q.set(c,-r.length/2,0),q.set(l,r.length/2,0),q.rotate(u,c,a),q.rotate(p,l,a),z(u,u,s),z(p,p,s),q.copy(c,u),q.copy(l,p),U(d,l,c),q.normalize(f,d),q.rotate90cw(m,f),q.rotate(g,x,n),v[0]=c,v[1]=l;for(var _=0;_<v.length;_++){var b=v[_];U(y,b,i);var I=V(y,g);if(I<0){if(h)return!0;var w=this.createContactEquation(t,o,e,r);S++,q.copy(w.normalA,g),q.normalize(w.normalA,w.normalA),q.scale(y,g,I),U(w.contactPointA,b,y),U(w.contactPointA,w.contactPointA,t.position),U(w.contactPointB,b,s),z(w.contactPointB,w.contactPointB,s),U(w.contactPointB,w.contactPointB,o.position),this.contactEquations.push(w),this.enableFrictionReduction||this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(w))}}return!h&&(this.enableFrictionReduction||S&&this.enableFriction&&this.frictionEquations.push(this.createFrictionFromAverage(S)),S)},$.prototype[c.PARTICLE|c.CAPSULE]=$.prototype.particleCapsule=function(t,e,i,n,o,r,s,a,h){return this.circleLine(t,e,i,n,o,r,s,a,h,r.radius,0)},$.prototype[c.CIRCLE|c.LINE]=$.prototype.circleLine=function(t,e,i,n,o,r,s,a,h,c,l){c=c||0,l=void 0!==l?l:e.radius;var u=j,p=Y,d=W,f=X,y=K,g=O,m=J,v=Q,S=Z,_=N,b=B,I=F,w=k,x=G,C=H;q.set(v,-r.length/2,0),q.set(S,r.length/2,0),q.rotate(_,v,a),q.rotate(b,S,a),z(_,_,s),z(b,b,s),q.copy(v,_),q.copy(S,b),U(g,S,v),q.normalize(m,g),q.rotate90cw(y,m),U(I,i,v);var A=V(I,y);U(f,v,s),U(w,i,s);var E=l+c;if(Math.abs(A)<E){q.scale(u,y,A),U(d,i,u),q.scale(p,y,V(y,w)),q.normalize(p,p),q.scale(p,p,c),z(d,d,p);var T=V(m,d),L=V(m,v),P=V(m,S);if(L<T&&T<P){if(h)return!0;var D=this.createContactEquation(t,o,e,r);return q.scale(D.normalA,u,-1),q.normalize(D.normalA,D.normalA),q.scale(D.contactPointA,D.normalA,l),z(D.contactPointA,D.contactPointA,i),U(D.contactPointA,D.contactPointA,t.position),U(D.contactPointB,d,s),z(D.contactPointB,D.contactPointB,s),U(D.contactPointB,D.contactPointB,o.position),this.contactEquations.push(D),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(D)),1}}C[0]=v,C[1]=S;for(var M=0;M<C.length;M++){var R=C[M];if(U(I,R,i),q.squaredLength(I)<Math.pow(E,2)){if(h)return!0;D=this.createContactEquation(t,o,e,r);return q.copy(D.normalA,I),q.normalize(D.normalA,D.normalA),q.scale(D.contactPointA,D.normalA,l),z(D.contactPointA,D.contactPointA,i),U(D.contactPointA,D.contactPointA,t.position),U(D.contactPointB,R,s),q.scale(x,D.normalA,-c),z(D.contactPointB,D.contactPointB,x),z(D.contactPointB,D.contactPointB,s),U(D.contactPointB,D.contactPointB,o.position),this.contactEquations.push(D),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(D)),1}}return 0},$.prototype[c.CIRCLE|c.CAPSULE]=$.prototype.circleCapsule=function(t,e,i,n,o,r,s,a,h){return this.circleLine(t,e,i,n,o,r,s,a,h,r.radius)},$.prototype[c.CIRCLE|c.CONVEX]=$.prototype[c.CIRCLE|c.BOX]=$.prototype.circleConvex=function(t,e,i,n,o,r,s,a,h,c){c="number"==typeof c?c:e.radius;for(var l=j,u=Y,p=W,d=X,f=K,y=N,g=B,m=k,v=G,S=P,_=D,b=!1,I=Number.MAX_VALUE,w=r.vertices,x=0;x!==w.length+1;x++){var C=w[x%w.length],A=w[(x+1)%w.length];if(q.rotate(l,C,a),q.rotate(u,A,a),z(l,l,s),z(u,u,s),U(p,u,l),q.normalize(d,p),q.rotate90cw(f,d),q.scale(v,f,-e.radius),z(v,v,i),M(v,r,s,a)){q.sub(S,l,v);var E=Math.abs(q.dot(S,f));E<I&&(q.copy(_,v),I=E,q.scale(m,f,E),q.add(m,m,v),b=!0)}}if(b){if(h)return!0;var T=this.createContactEquation(t,o,e,r);return q.sub(T.normalA,_,i),q.normalize(T.normalA,T.normalA),q.scale(T.contactPointA,T.normalA,c),z(T.contactPointA,T.contactPointA,i),U(T.contactPointA,T.contactPointA,t.position),U(T.contactPointB,m,s),z(T.contactPointB,T.contactPointB,s),U(T.contactPointB,T.contactPointB,o.position),this.contactEquations.push(T),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(T)),1}if(0<c)for(x=0;x<w.length;x++){var L=w[x];if(q.rotate(g,L,a),z(g,g,s),U(y,g,i),q.squaredLength(y)<Math.pow(c,2)){if(h)return!0;T=this.createContactEquation(t,o,e,r);return q.copy(T.normalA,y),q.normalize(T.normalA,T.normalA),q.scale(T.contactPointA,T.normalA,c),z(T.contactPointA,T.contactPointA,i),U(T.contactPointA,T.contactPointA,t.position),U(T.contactPointB,g,s),z(T.contactPointB,T.contactPointB,s),U(T.contactPointB,T.contactPointB,o.position),this.contactEquations.push(T),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(T)),1}}return 0};var y=q.create(),g=q.create(),m=q.create(),v=q.create();function M(t,e,i,n){for(var o=y,r=g,s=m,a=v,h=t,c=e.vertices,l=null,u=0;u!==c.length+1;u++){var p=c[u%c.length],d=c[(u+1)%c.length];q.rotate(o,p,n),q.rotate(r,d,n),z(o,o,i),z(r,r,i),U(s,o,h),U(a,r,h);var f=q.crossLength(s,a);if(null===l&&(l=f),f*l<=0)return!1;l=f}return!0}$.prototype[c.PARTICLE|c.CONVEX]=$.prototype[c.PARTICLE|c.BOX]=$.prototype.particleConvex=function(t,e,i,n,o,r,s,a,h){var c=j,l=Y,u=W,p=X,d=K,f=O,y=J,g=N,m=k,v=T,S=L,_=Number.MAX_VALUE,b=!1,I=r.vertices;if(!M(i,r,s,a))return 0;if(h)return!0;for(var w=0;w!==I.length+1;w++){var x=I[w%I.length],C=I[(w+1)%I.length];q.rotate(c,x,a),q.rotate(l,C,a),z(c,c,s),z(l,l,s),U(u,l,c),q.normalize(p,u),q.rotate90cw(d,p),U(g,i,c);V(g,d);U(f,c,s),U(y,i,s),q.sub(v,c,i);var A=Math.abs(q.dot(v,d));A<_&&(_=A,q.scale(m,d,A),q.add(m,m,i),q.copy(S,d),b=!0)}if(b){var E=this.createContactEquation(t,o,e,r);return q.scale(E.normalA,S,-1),q.normalize(E.normalA,E.normalA),q.set(E.contactPointA,0,0),z(E.contactPointA,E.contactPointA,i),U(E.contactPointA,E.contactPointA,t.position),U(E.contactPointB,m,s),z(E.contactPointB,E.contactPointB,s),U(E.contactPointB,E.contactPointB,o.position),this.contactEquations.push(E),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(E)),1}return 0},$.prototype[c.CIRCLE]=$.prototype.circleCircle=function(t,e,i,n,o,r,s,a,h,c,l){var u=j;c=c||e.radius,l=l||r.radius;U(u,i,s);var p=c+l;if(q.squaredLength(u)>Math.pow(p,2))return 0;if(h)return!0;var d=this.createContactEquation(t,o,e,r);return U(d.normalA,s,i),q.normalize(d.normalA,d.normalA),q.scale(d.contactPointA,d.normalA,c),q.scale(d.contactPointB,d.normalA,-l),z(d.contactPointA,d.contactPointA,i),U(d.contactPointA,d.contactPointA,t.position),z(d.contactPointB,d.contactPointB,s),U(d.contactPointB,d.contactPointB,o.position),this.contactEquations.push(d),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(d)),1},$.prototype[c.PLANE|c.CONVEX]=$.prototype[c.PLANE|c.BOX]=$.prototype.planeConvex=function(t,e,i,n,o,r,s,a,h){var c=j,l=Y,u=W,p=0;q.rotate(l,x,n);for(var d=0;d!==r.vertices.length;d++){var f=r.vertices[d];if(q.rotate(c,f,a),z(c,c,s),U(u,c,i),V(u,l)<=0){if(h)return!0;p++;var y=this.createContactEquation(t,o,e,r);U(u,c,i),q.copy(y.normalA,l);var g=V(u,y.normalA);q.scale(u,y.normalA,g),U(y.contactPointB,c,o.position),U(y.contactPointA,c,u),U(y.contactPointA,y.contactPointA,t.position),this.contactEquations.push(y),this.enableFrictionReduction||this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(y))}}return this.enableFrictionReduction&&this.enableFriction&&p&&this.frictionEquations.push(this.createFrictionFromAverage(p)),p},$.prototype[c.PARTICLE|c.PLANE]=$.prototype.particlePlane=function(t,e,i,n,o,r,s,a,h){var c=j,l=Y;a=a||0,U(c,i,s),q.rotate(l,x,a);var u=V(c,l);if(0<u)return 0;if(h)return!0;var p=this.createContactEquation(o,t,r,e);return q.copy(p.normalA,l),q.scale(c,p.normalA,u),U(p.contactPointA,i,c),U(p.contactPointA,p.contactPointA,o.position),U(p.contactPointB,i,t.position),this.contactEquations.push(p),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(p)),1},$.prototype[c.CIRCLE|c.PARTICLE]=$.prototype.circleParticle=function(t,e,i,n,o,r,s,a,h){var c=j;if(U(c,s,i),q.squaredLength(c)>Math.pow(e.radius,2))return 0;if(h)return!0;var l=this.createContactEquation(t,o,e,r);return q.copy(l.normalA,c),q.normalize(l.normalA,l.normalA),q.scale(l.contactPointA,l.normalA,e.radius),z(l.contactPointA,l.contactPointA,i),U(l.contactPointA,l.contactPointA,t.position),U(l.contactPointB,s,o.position),this.contactEquations.push(l),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(l)),1};var C=new a({radius:1}),A=q.create(),E=q.create();q.create();$.prototype[c.PLANE|c.CAPSULE]=$.prototype.planeCapsule=function(t,e,i,n,o,r,s,a,h){var c,l=A,u=E,p=C;q.set(l,-r.length/2,0),q.rotate(l,l,a),z(l,l,s),q.set(u,r.length/2,0),q.rotate(u,u,a),z(u,u,s),p.radius=r.radius,this.enableFrictionReduction&&(c=this.enableFriction,this.enableFriction=!1);var d=this.circlePlane(o,p,l,0,t,e,i,n,h),f=this.circlePlane(o,p,u,0,t,e,i,n,h);if(this.enableFrictionReduction&&(this.enableFriction=c),h)return d||f;var y=d+f;return this.enableFrictionReduction&&y&&this.frictionEquations.push(this.createFrictionFromAverage(y)),y},$.prototype[c.CIRCLE|c.PLANE]=$.prototype.circlePlane=function(t,e,i,n,o,r,s,a,h){var c=t,l=e,u=i,p=o,d=s,f=a;f=f||0;var y=j,g=Y,m=W;U(y,u,d),q.rotate(g,x,f);var v=V(g,y);if(v>l.radius)return 0;if(h)return!0;var S=this.createContactEquation(p,c,r,e);return q.copy(S.normalA,g),q.scale(S.contactPointB,S.normalA,-l.radius),z(S.contactPointB,S.contactPointB,u),U(S.contactPointB,S.contactPointB,c.position),q.scale(m,S.normalA,v),U(S.contactPointA,y,m),z(S.contactPointA,S.contactPointA,d),U(S.contactPointA,S.contactPointA,p.position),this.contactEquations.push(S),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(S)),1},$.prototype[c.CONVEX]=$.prototype[c.CONVEX|c.BOX]=$.prototype[c.BOX]=$.prototype.convexConvex=function(t,e,i,n,o,r,s,a,h,c){var l=j,u=Y,p=W,d=X,f=K,y=J,g=Q,m=Z,v=0;c="number"==typeof c?c:0;if(!$.findSeparatingAxis(e,i,n,r,s,a,l))return 0;U(g,s,i),0<V(l,g)&&q.scale(l,l,-1);var S=$.getClosestEdge(e,n,l,!0),_=$.getClosestEdge(r,a,l);if(-1===S||-1===_)return 0;for(var b=0;b<2;b++){var I,w=S,x=_,C=e,A=r,E=i,T=s,L=n,P=a,D=t,M=o;if(0===b)I=w,w=x,x=I,I=C,C=A,A=I,I=E,E=T,T=I,I=L,L=P,P=I,I=D,D=M,M=I;for(var R=x;R<x+2;R++){var O=A.vertices[(R+A.vertices.length)%A.vertices.length];q.rotate(u,O,P),z(u,u,T);for(var N=0,B=w-1;B<w+2;B++){var F=C.vertices[(B+C.vertices.length)%C.vertices.length],k=C.vertices[(B+1+C.vertices.length)%C.vertices.length];q.rotate(p,F,L),q.rotate(d,k,L),z(p,p,E),z(d,d,E),U(f,d,p),q.rotate90cw(m,f),q.normalize(m,m),U(g,u,p);var G=V(m,g);(B===w&&G<=c||B!==w&&G<=0)&&N++}if(3<=N){if(h)return!0;var H=this.createContactEquation(D,M,C,A);v++;F=C.vertices[w%C.vertices.length],k=C.vertices[(w+1)%C.vertices.length];q.rotate(p,F,L),q.rotate(d,k,L),z(p,p,E),z(d,d,E),U(f,d,p),q.rotate90cw(H.normalA,f),q.normalize(H.normalA,H.normalA),U(g,u,p);G=V(H.normalA,g);q.scale(y,H.normalA,G),U(H.contactPointA,u,E),U(H.contactPointA,H.contactPointA,y),z(H.contactPointA,H.contactPointA,E),U(H.contactPointA,H.contactPointA,D.position),U(H.contactPointB,u,T),z(H.contactPointB,H.contactPointB,T),U(H.contactPointB,H.contactPointB,M.position),this.contactEquations.push(H),this.enableFrictionReduction||this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(H))}}}return this.enableFrictionReduction&&this.enableFriction&&v&&this.frictionEquations.push(this.createFrictionFromAverage(v)),v};var R=q.fromValues(0,0);$.projectConvexOntoAxis=function(t,e,i,n,o){var r,s,a=null,h=null,c=R;q.rotate(c,n,-i);for(var l=0;l<t.vertices.length;l++)r=t.vertices[l],s=V(r,c),(null===a||a<s)&&(a=s),(null===h||s<h)&&(h=s);if(a<h){var u=h;h=a,a=u}var p=V(e,n);q.set(o,h+p,a+p)};var tt=q.fromValues(0,0),et=q.fromValues(0,0),it=q.fromValues(0,0),nt=q.fromValues(0,0),ot=q.fromValues(0,0),rt=q.fromValues(0,0);$.findSeparatingAxis=function(t,e,i,n,o,r,s){var a=null,h=!1,c=!1,l=tt,u=et,p=it,d=nt,f=ot,y=rt;if(t instanceof w&&n instanceof w)for(var g=0;2!==g;g++){var m=t,v=i;1===g&&(m=n,v=r);for(var S=0;2!==S;S++){0===S?q.set(d,0,1):1===S&&q.set(d,1,0),0!==v&&q.rotate(d,d,v),$.projectConvexOntoAxis(t,e,i,d,f),$.projectConvexOntoAxis(n,o,r,d,y);var _=f,b=y;f[0]>y[0]&&(b=f,_=y,!0),h=(I=b[0]-_[1])<=0,(null===a||a<I)&&(q.copy(s,d),a=I,c=h)}}else for(g=0;2!==g;g++){m=t,v=i;1===g&&(m=n,v=r);for(S=0;S!==m.vertices.length;S++){q.rotate(u,m.vertices[S],v),q.rotate(p,m.vertices[(S+1)%m.vertices.length],v),U(l,p,u),q.rotate90cw(d,l),q.normalize(d,d),$.projectConvexOntoAxis(t,e,i,d,f),$.projectConvexOntoAxis(n,o,r,d,y);var I;_=f,b=y;f[0]>y[0]&&(b=f,_=y,!0),h=(I=b[0]-_[1])<=0,(null===a||a<I)&&(q.copy(s,d),a=I,c=h)}}return c};var p=q.fromValues(0,0),st=q.fromValues(0,0),at=q.fromValues(0,0);$.getClosestEdge=function(t,e,i,n){var o=p,r=st,s=at;q.rotate(o,i,-e),n&&q.scale(o,o,-1);for(var a=-1,h=t.vertices.length,c=-1,l=0;l!==h;l++){U(r,t.vertices[(l+1)%h],t.vertices[l%h]),q.rotate90cw(s,r),q.normalize(s,s);var u=V(s,o);(-1===a||c<u)&&(a=l%h,c=u)}return a};var ht=q.create(),ct=q.create(),lt=q.create(),ut=q.create(),pt=q.create(),dt=q.create(),ft=q.create();$.prototype[c.CIRCLE|c.HEIGHTFIELD]=$.prototype.circleHeightfield=function(t,e,i,n,o,r,s,a,h,c){var l=r.heights,u=(c=c||e.radius,r.elementWidth),p=ct,d=ht,f=pt,y=ft,g=dt,m=lt,v=ut,S=Math.floor((i[0]-c-s[0])/u),_=Math.ceil((i[0]+c-s[0])/u);S<0&&(S=0),_>=l.length&&(_=l.length-1);for(var b=l[S],I=l[_],w=S;w<_;w++)l[w]<I&&(I=l[w]),l[w]>b&&(b=l[w]);if(i[1]-c>b)return!h&&0;var x=!1;for(w=S;w<_;w++){q.set(m,w*u,l[w]),q.set(v,(w+1)*u,l[w+1]),q.add(m,m,s),q.add(v,v,s),q.sub(g,v,m),q.rotate(g,g,Math.PI/2),q.normalize(g,g),q.scale(d,g,-c),q.add(d,d,i),q.sub(p,d,m);var C=q.dot(p,g);if(d[0]>=m[0]&&d[0]<v[0]&&C<=0){if(h)return!0;x=!0,q.scale(p,g,-C),q.add(f,d,p),q.copy(y,g);var A=this.createContactEquation(o,t,r,e);q.copy(A.normalA,y),q.scale(A.contactPointB,A.normalA,-c),z(A.contactPointB,A.contactPointB,i),U(A.contactPointB,A.contactPointB,t.position),q.copy(A.contactPointA,f),q.sub(A.contactPointA,A.contactPointA,o.position),this.contactEquations.push(A),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(A))}}if(x=!1,0<c)for(w=S;w<=_;w++)if(q.set(m,w*u,l[w]),q.add(m,m,s),q.sub(p,i,m),q.squaredLength(p)<Math.pow(c,2)){if(h)return!0;x=!0;A=this.createContactEquation(o,t,r,e);q.copy(A.normalA,p),q.normalize(A.normalA,A.normalA),q.scale(A.contactPointB,A.normalA,-c),z(A.contactPointB,A.contactPointB,i),U(A.contactPointB,A.contactPointB,t.position),U(A.contactPointA,m,s),z(A.contactPointA,A.contactPointA,s),U(A.contactPointA,A.contactPointA,o.position),this.contactEquations.push(A),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(A))}return x?1:0};var yt=q.create(),gt=q.create(),mt=q.create(),vt=new h({vertices:[q.create(),q.create(),q.create(),q.create()]});$.prototype[c.BOX|c.HEIGHTFIELD]=$.prototype[c.CONVEX|c.HEIGHTFIELD]=$.prototype.convexHeightfield=function(t,e,i,n,o,r,s,a,h){var c=r.heights,l=r.elementWidth,u=yt,p=gt,d=mt,f=vt,y=Math.floor((t.aabb.lowerBound[0]-s[0])/l),g=Math.ceil((t.aabb.upperBound[0]-s[0])/l);y<0&&(y=0),g>=c.length&&(g=c.length-1);for(var m=c[y],v=c[g],S=y;S<g;S++)c[S]<v&&(v=c[S]),c[S]>m&&(m=c[S]);if(t.aabb.lowerBound[1]>m)return!h&&0;var _=0;for(S=y;S<g;S++){q.set(u,S*l,c[S]),q.set(p,(S+1)*l,c[S+1]),q.add(u,u,s),q.add(p,p,s);q.set(d,.5*(p[0]+u[0]),.5*(p[1]+u[1]-100)),q.sub(f.vertices[0],p,d),q.sub(f.vertices[1],u,d),q.copy(f.vertices[2],f.vertices[1]),q.copy(f.vertices[3],f.vertices[0]),f.vertices[2][1]-=100,f.vertices[3][1]-=100,_+=this.convexConvex(t,e,i,n,o,f,d,0,h)}return _}},{"../equations/ContactEquation":21,"../equations/Equation":22,"../equations/FrictionEquation":23,"../math/vec2":30,"../objects/Body":31,"../shapes/Box":37,"../shapes/Circle":39,"../shapes/Convex":40,"../shapes/Shape":45,"../utils/ContactEquationPool":48,"../utils/FrictionEquationPool":49,"../utils/TupleDictionary":56,"../utils/Utils":57}],11:[function(t,e,i){e.exports=s;var h=t("../math/vec2");t("../collision/RaycastResult"),t("../shapes/Shape"),t("../collision/AABB");function s(t){t=t||{},this.from=t.from?h.fromValues(t.from[0],t.from[1]):h.create(),this.to=t.to?h.fromValues(t.to[0],t.to[1]):h.create(),this.checkCollisionResponse=void 0===t.checkCollisionResponse||t.checkCollisionResponse,this.skipBackfaces=!!t.skipBackfaces,this.collisionMask=void 0!==t.collisionMask?t.collisionMask:-1,this.collisionGroup=void 0!==t.collisionGroup?t.collisionGroup:-1,this.mode=void 0!==t.mode?t.mode:s.ANY,this.callback=t.callback||function(t){},this.direction=h.create(),this.length=1,this.update()}(s.prototype.constructor=s).CLOSEST=1,s.ANY=2,s.ALL=4,s.prototype.update=function(){var t=this.direction;h.sub(t,this.to,this.from),this.length=h.length(t),h.normalize(t,t)},s.prototype.intersectBodies=function(t,e){for(var i=0,n=e.length;!t.shouldStop(this)&&i<n;i++){var o=e[i],r=o.getAABB();(0<=r.overlapsRay(this)||r.containsPoint(this.from))&&this.intersectBody(t,o)}};var c=h.create();s.prototype.intersectBody=function(t,e){var i=this.checkCollisionResponse;if(!i||e.collisionResponse)for(var n=c,o=0,r=e.shapes.length;o<r;o++){var s=e.shapes[o];if((!i||s.collisionResponse)&&(0!=(this.collisionGroup&s.collisionMask)&&0!=(s.collisionGroup&this.collisionMask))){h.rotate(n,s.position,e.angle),h.add(n,n,e.position);var a=s.angle+e.angle;if(this.intersectShape(t,s,a,n,e),t.shouldStop(this))break}}},s.prototype.intersectShape=function(t,e,i,n,o){(function(t,e,i){h.sub(r,i,t);var n=h.dot(r,e);return h.scale(a,e,n),h.add(a,a,t),h.squaredDistance(i,a)})(this.from,this.direction,n)>e.boundingRadius*e.boundingRadius||(this._currentBody=o,(this._currentShape=e).raycast(t,this,n,i),this._currentBody=this._currentShape=null)},s.prototype.getAABB=function(t){var e=this.to,i=this.from;h.set(t.lowerBound,Math.min(e[0],i[0]),Math.min(e[1],i[1])),h.set(t.upperBound,Math.max(e[0],i[0]),Math.max(e[1],i[1]))};h.create();s.prototype.reportIntersection=function(t,e,i,n){this.from,this.to;var o=this._currentShape,r=this._currentBody;if(!(this.skipBackfaces&&0<h.dot(i,this.direction)))switch(this.mode){case s.ALL:t.set(i,o,r,e,n),this.callback(t);break;case s.CLOSEST:(e<t.fraction||!t.hasHit())&&t.set(i,o,r,e,n);break;case s.ANY:t.set(i,o,r,e,n)}};var r=h.create(),a=h.create()},{"../collision/AABB":7,"../collision/RaycastResult":12,"../math/vec2":30,"../shapes/Shape":45}],12:[function(t,e,i){var r=t("../math/vec2"),n=t("../collision/Ray");function o(){this.normal=r.create(),this.shape=null,this.body=null,this.faceIndex=-1,this.fraction=-1,this.isStopped=!1}(e.exports=o).prototype.reset=function(){r.set(this.normal,0,0),this.shape=null,this.body=null,this.faceIndex=-1,this.fraction=-1,this.isStopped=!1},o.prototype.getHitDistance=function(t){return r.distance(t.from,t.to)*this.fraction},o.prototype.hasHit=function(){return-1!==this.fraction},o.prototype.getHitPoint=function(t,e){r.lerp(t,e.from,e.to,this.fraction)},o.prototype.stop=function(){this.isStopped=!0},o.prototype.shouldStop=function(t){return this.isStopped||-1!==this.fraction&&t.mode===n.ANY},o.prototype.set=function(t,e,i,n,o){r.copy(this.normal,t),this.shape=e,this.body=i,this.fraction=n,this.faceIndex=o}},{"../collision/Ray":11,"../math/vec2":30}],13:[function(t,e,i){var n=t("../utils/Utils"),u=t("../collision/Broadphase");function o(){u.call(this,u.SAP),this.axisList=[],this.axisIndex=0;var i=this;this._addBodyHandler=function(t){i.axisList.push(t.body)},this._removeBodyHandler=function(t){var e=i.axisList.indexOf(t.body);-1!==e&&i.axisList.splice(e,1)}}(((e.exports=o).prototype=new u).constructor=o).prototype.setWorld=function(t){this.axisList.length=0,n.appendArray(this.axisList,t.bodies),t.off("addBody",this._addBodyHandler).off("removeBody",this._removeBodyHandler),t.on("addBody",this._addBodyHandler).on("removeBody",this._removeBodyHandler),this.world=t},o.sortAxisList=function(t,e){e|=0;for(var i=1,n=t.length;i<n;i++){for(var o=t[i],r=i-1;0<=r&&!(t[r].aabb.lowerBound[e]<=o.aabb.lowerBound[e]);r--)t[r+1]=t[r];t[r+1]=o}return t},o.prototype.sortList=function(){var t=this.axisList,e=this.axisIndex;o.sortAxisList(t,e)},o.prototype.getCollisionPairs=function(t){var e=this.axisList,i=this.result,n=this.axisIndex;i.length=0;for(var o=e.length;o--;){var r=e[o];r.aabbNeedsUpdate&&r.updateAABB()}this.sortList();for(var s=0,a=0|e.length;s!==a;s++)for(var h=e[s],c=s+1;c<a;c++){var l=e[c];if(!(l.aabb.lowerBound[n]<=h.aabb.upperBound[n]))break;u.canCollide(h,l)&&this.boundingVolumeCheck(h,l)&&i.push(h,l)}return i},o.prototype.aabbQuery=function(t,e,i){i=i||[],this.sortList();var n=this.axisIndex,o="x";1===n&&(o="y"),2===n&&(o="z");for(var r=this.axisList,s=(e.lowerBound[o],e.upperBound[o],0);s<r.length;s++){var a=r[s];a.aabbNeedsUpdate&&a.updateAABB(),a.aabb.overlaps(e)&&i.push(a)}return i}},{"../collision/Broadphase":8,"../utils/Utils":57}],14:[function(t,e,i){e.exports=n;var o=t("../utils/Utils");function n(t,e,i,n){this.type=i,n=o.defaults(n,{collideConnected:!0,wakeUpBodies:!0}),this.equations=[],this.bodyA=t,this.bodyB=e,this.collideConnected=n.collideConnected,n.wakeUpBodies&&(t&&t.wakeUp(),e&&e.wakeUp())}n.prototype.update=function(){throw new Error("method update() not implmemented in this Constraint subclass!")},n.DISTANCE=1,n.GEAR=2,n.LOCK=3,n.PRISMATIC=4,n.REVOLUTE=5,n.prototype.setStiffness=function(t){for(var e=this.equations,i=0;i!==e.length;i++){var n=e[i];n.stiffness=t,n.needsUpdate=!0}},n.prototype.setRelaxation=function(t){for(var e=this.equations,i=0;i!==e.length;i++){var n=e[i];n.relaxation=t,n.needsUpdate=!0}}},{"../utils/Utils":57}],15:[function(t,e,i){var d=t("./Constraint"),f=t("../equations/Equation"),y=t("../math/vec2"),g=t("../utils/Utils");function n(t,e,i){i=g.defaults(i,{localAnchorA:[0,0],localAnchorB:[0,0]}),d.call(this,t,e,d.DISTANCE,i),this.localAnchorA=y.fromValues(i.localAnchorA[0],i.localAnchorA[1]),this.localAnchorB=y.fromValues(i.localAnchorB[0],i.localAnchorB[1]);var n,o=this.localAnchorA,r=this.localAnchorB;if(this.distance=0,"number"==typeof i.distance)this.distance=i.distance;else{var s=y.create(),a=y.create(),h=y.create();y.rotate(s,o,t.angle),y.rotate(a,r,e.angle),y.add(h,e.position,a),y.sub(h,h,s),y.sub(h,h,t.position),this.distance=y.length(h)}n=void 0===i.maxForce?Number.MAX_VALUE:i.maxForce;var c=new f(t,e,-n,n);this.equations=[c],this.maxForce=n;h=y.create();var l=y.create(),u=y.create(),p=this;c.computeGq=function(){var t=this.bodyA,e=this.bodyB,i=t.position,n=e.position;return y.rotate(l,o,t.angle),y.rotate(u,r,e.angle),y.add(h,n,u),y.sub(h,h,l),y.sub(h,h,i),y.length(h)-p.distance},this.setMaxForce(n),this.upperLimitEnabled=!1,this.upperLimit=1,this.lowerLimitEnabled=!1,this.lowerLimit=0,this.position=0}((e.exports=n).prototype=new d).constructor=n;var l=y.create(),u=y.create(),p=y.create();n.prototype.update=function(){var t=this.equations[0],e=this.bodyA,i=this.bodyB,n=(this.distance,e.position),o=i.position,r=this.equations[0],s=t.G;y.rotate(u,this.localAnchorA,e.angle),y.rotate(p,this.localAnchorB,i.angle),y.add(l,o,p),y.sub(l,l,u),y.sub(l,l,n),this.position=y.length(l);var a=!1;if(this.upperLimitEnabled&&this.position>this.upperLimit&&(r.maxForce=0,r.minForce=-this.maxForce,this.distance=this.upperLimit,a=!0),this.lowerLimitEnabled&&this.position<this.lowerLimit&&(r.maxForce=this.maxForce,r.minForce=0,this.distance=this.lowerLimit,a=!0),!this.lowerLimitEnabled&&!this.upperLimitEnabled||a){r.enabled=!0,y.normalize(l,l);var h=y.crossLength(u,l),c=y.crossLength(p,l);s[0]=-l[0],s[1]=-l[1],s[2]=-h,s[3]=l[0],s[4]=l[1],s[5]=c}else r.enabled=!1},n.prototype.setMaxForce=function(t){var e=this.equations[0];e.minForce=-t,e.maxForce=t},n.prototype.getMaxForce=function(){return this.equations[0].maxForce}},{"../equations/Equation":22,"../math/vec2":30,"../utils/Utils":57,"./Constraint":14}],16:[function(t,e,i){var n=t("./Constraint"),o=(t("../equations/Equation"),t("../equations/AngleLockEquation"));t("../math/vec2");function r(t,e,i){i=i||{},n.call(this,t,e,n.GEAR,i),this.ratio=void 0!==i.ratio?i.ratio:1,this.angle=void 0!==i.angle?i.angle:e.angle-this.ratio*t.angle,i.angle=this.angle,i.ratio=this.ratio,this.equations=[new o(t,e,i)],void 0!==i.maxTorque&&this.setMaxTorque(i.maxTorque)}(((e.exports=r).prototype=new n).constructor=r).prototype.update=function(){var t=this.equations[0];t.ratio!==this.ratio&&t.setRatio(this.ratio),t.angle=this.angle},r.prototype.setMaxTorque=function(t){this.equations[0].setMaxTorque(t)},r.prototype.getMaxTorque=function(t){return this.equations[0].maxForce}},{"../equations/AngleLockEquation":20,"../equations/Equation":22,"../math/vec2":30,"./Constraint":14}],17:[function(t,e,i){var p=t("./Constraint"),d=t("../math/vec2"),f=t("../equations/Equation");function n(t,e,i){i=i||{},p.call(this,t,e,p.LOCK,i);var n=void 0===i.maxForce?Number.MAX_VALUE:i.maxForce,o=(i.localAngleB,new f(t,e,-n,n)),r=new f(t,e,-n,n),s=new f(t,e,-n,n),a=d.create(),h=d.create(),c=this;o.computeGq=function(){return d.rotate(a,c.localOffsetB,t.angle),d.sub(h,e.position,t.position),d.sub(h,h,a),h[0]},r.computeGq=function(){return d.rotate(a,c.localOffsetB,t.angle),d.sub(h,e.position,t.position),d.sub(h,h,a),h[1]};var l=d.create(),u=d.create();s.computeGq=function(){return d.rotate(l,c.localOffsetB,e.angle-c.localAngleB),d.scale(l,l,-1),d.sub(h,t.position,e.position),d.add(h,h,l),d.rotate(u,l,-Math.PI/2),d.normalize(u,u),d.dot(h,u)},this.localOffsetB=d.create(),i.localOffsetB?d.copy(this.localOffsetB,i.localOffsetB):(d.sub(this.localOffsetB,e.position,t.position),d.rotate(this.localOffsetB,this.localOffsetB,-t.angle)),this.localAngleB=0,"number"==typeof i.localAngleB?this.localAngleB=i.localAngleB:this.localAngleB=e.angle-t.angle,this.equations.push(o,r,s),this.setMaxForce(n)}(((e.exports=n).prototype=new p).constructor=n).prototype.setMaxForce=function(t){for(var e=this.equations,i=0;i<this.equations.length;i++)e[i].maxForce=t,e[i].minForce=-t},n.prototype.getMaxForce=function(){return this.equations[0].maxForce};var r=d.create(),s=d.create(),a=d.create(),h=d.fromValues(1,0),c=d.fromValues(0,1);n.prototype.update=function(){var t=this.equations[0],e=this.equations[1],i=this.equations[2],n=this.bodyA,o=this.bodyB;d.rotate(r,this.localOffsetB,n.angle),d.rotate(s,this.localOffsetB,o.angle-this.localAngleB),d.scale(s,s,-1),d.rotate(a,s,Math.PI/2),d.normalize(a,a),t.G[0]=-1,t.G[1]=0,t.G[2]=-d.crossLength(r,h),t.G[3]=1,e.G[0]=0,e.G[1]=-1,e.G[2]=-d.crossLength(r,c),e.G[4]=1,i.G[0]=-a[0],i.G[1]=-a[1],i.G[3]=a[0],i.G[4]=a[1],i.G[5]=d.crossLength(s,a)}},{"../equations/Equation":22,"../math/vec2":30,"./Constraint":14}],18:[function(t,e,i){var y=t("./Constraint"),g=t("../equations/ContactEquation"),m=t("../equations/Equation"),v=t("../math/vec2"),S=t("../equations/RotationalLockEquation");function n(n,o,t){t=t||{},y.call(this,n,o,y.PRISMATIC,t);var r=v.fromValues(0,0),s=v.fromValues(1,0),a=v.fromValues(0,0);t.localAnchorA&&v.copy(r,t.localAnchorA),t.localAxisA&&v.copy(s,t.localAxisA),t.localAnchorB&&v.copy(a,t.localAnchorB),this.localAnchorA=r,this.localAnchorB=a,this.localAxisA=s;var e=this.maxForce=void 0!==t.maxForce?t.maxForce:Number.MAX_VALUE,i=new m(n,o,-e,e),h=new v.create,c=new v.create,l=new v.create,u=new v.create;if(i.computeGq=function(){return v.dot(l,u)},i.updateJacobian=function(){var t=this.G,e=n.position,i=o.position;v.rotate(h,r,n.angle),v.rotate(c,a,o.angle),v.add(l,i,c),v.sub(l,l,e),v.sub(l,l,h),v.rotate(u,s,n.angle+Math.PI/2),t[0]=-u[0],t[1]=-u[1],t[2]=-v.crossLength(h,u)+v.crossLength(u,l),t[3]=u[0],t[4]=u[1],t[5]=v.crossLength(c,u)},this.equations.push(i),!t.disableRotationalLock){var p=new S(n,o,-e,e);this.equations.push(p)}this.position=0,this.velocity=0,this.lowerLimitEnabled=void 0!==t.lowerLimit,this.upperLimitEnabled=void 0!==t.upperLimit,this.lowerLimit=void 0!==t.lowerLimit?t.lowerLimit:0,this.upperLimit=void 0!==t.upperLimit?t.upperLimit:1,this.upperLimitEquation=new g(n,o),this.lowerLimitEquation=new g(n,o),this.upperLimitEquation.minForce=this.lowerLimitEquation.minForce=0,this.upperLimitEquation.maxForce=this.lowerLimitEquation.maxForce=e,this.motorEquation=new m(n,o),this.motorEnabled=!1,this.motorSpeed=0;var d=this,f=this.motorEquation;f.computeGW;f.computeGq=function(){return 0},f.computeGW=function(){var t=this.G,e=this.bodyA,i=this.bodyB,n=e.velocity,o=i.velocity,r=e.angularVelocity,s=i.angularVelocity;return this.gmult(t,n,r,o,s)+d.motorSpeed}}((e.exports=n).prototype=new y).constructor=n;var f=v.create(),_=v.create(),b=v.create(),I=v.create(),w=v.create(),x=v.create();n.prototype.update=function(){var t=this.equations,e=t[0],i=this.upperLimit,n=this.lowerLimit,o=this.upperLimitEquation,r=this.lowerLimitEquation,s=this.bodyA,a=this.bodyB,h=this.localAxisA,c=this.localAnchorA,l=this.localAnchorB;e.updateJacobian(),v.rotate(f,h,s.angle),v.rotate(I,c,s.angle),v.add(_,I,s.position),v.rotate(w,l,a.angle),v.add(b,w,a.position);var u,p=this.position=v.dot(b,f)-v.dot(_,f);if(this.motorEnabled){var d=this.motorEquation.G;d[0]=f[0],d[1]=f[1],d[2]=v.crossLength(f,w),d[3]=-f[0],d[4]=-f[1],d[5]=-v.crossLength(f,I)}this.upperLimitEnabled&&i<p?(v.scale(o.normalA,f,-1),v.sub(o.contactPointA,_,s.position),v.sub(o.contactPointB,b,a.position),v.scale(x,f,i),v.add(o.contactPointA,o.contactPointA,x),-1===t.indexOf(o)&&t.push(o)):-1!==(u=t.indexOf(o))&&t.splice(u,1);this.lowerLimitEnabled&&p<n?(v.scale(r.normalA,f,1),v.sub(r.contactPointA,_,s.position),v.sub(r.contactPointB,b,a.position),v.scale(x,f,n),v.sub(r.contactPointB,r.contactPointB,x),-1===t.indexOf(r)&&t.push(r)):-1!==(u=t.indexOf(r))&&t.splice(u,1)},n.prototype.enableMotor=function(){this.motorEnabled||(this.equations.push(this.motorEquation),this.motorEnabled=!0)},n.prototype.disableMotor=function(){if(this.motorEnabled){var t=this.equations.indexOf(this.motorEquation);this.equations.splice(t,1),this.motorEnabled=!1}},n.prototype.setLimits=function(t,e){"number"==typeof t?(this.lowerLimit=t,this.lowerLimitEnabled=!0):(this.lowerLimit=t,this.lowerLimitEnabled=!1),"number"==typeof e?(this.upperLimit=e,this.upperLimitEnabled=!0):(this.upperLimit=e,this.upperLimitEnabled=!1)}},{"../equations/ContactEquation":21,"../equations/Equation":22,"../equations/RotationalLockEquation":24,"../math/vec2":30,"./Constraint":14}],19:[function(t,e,i){var h=t("./Constraint"),c=t("../equations/Equation"),l=t("../equations/RotationalVelocityEquation"),u=t("../equations/RotationalLockEquation"),d=t("../math/vec2");e.exports=n;var f=d.create(),y=d.create(),g=d.fromValues(1,0),m=d.fromValues(0,1),p=d.create();function n(t,e,i){i=i||{},h.call(this,t,e,h.REVOLUTE,i);var n=this.maxForce=void 0!==i.maxForce?i.maxForce:Number.MAX_VALUE;this.pivotA=d.create(),this.pivotB=d.create(),i.worldPivot?(d.sub(this.pivotA,i.worldPivot,t.position),d.sub(this.pivotB,i.worldPivot,e.position),d.rotate(this.pivotA,this.pivotA,-t.angle),d.rotate(this.pivotB,this.pivotB,-e.angle)):(d.copy(this.pivotA,i.localPivotA),d.copy(this.pivotB,i.localPivotB));var o=this.equations=[new c(t,e,-n,n),new c(t,e,-n,n)],r=o[0],s=o[1],a=this;r.computeGq=function(){return d.rotate(f,a.pivotA,t.angle),d.rotate(y,a.pivotB,e.angle),d.add(p,e.position,y),d.sub(p,p,t.position),d.sub(p,p,f),d.dot(p,g)},s.computeGq=function(){return d.rotate(f,a.pivotA,t.angle),d.rotate(y,a.pivotB,e.angle),d.add(p,e.position,y),d.sub(p,p,t.position),d.sub(p,p,f),d.dot(p,m)},s.minForce=r.minForce=-n,s.maxForce=r.maxForce=n,this.motorEquation=new l(t,e),this.motorEnabled=!1,this.angle=0,this.lowerLimitEnabled=!1,this.upperLimitEnabled=!1,this.lowerLimit=0,this.upperLimit=0,this.upperLimitEquation=new u(t,e),this.lowerLimitEquation=new u(t,e),this.upperLimitEquation.minForce=0,this.lowerLimitEquation.maxForce=0}((n.prototype=new h).constructor=n).prototype.setLimits=function(t,e){"number"==typeof t?(this.lowerLimit=t,this.lowerLimitEnabled=!0):(this.lowerLimit=t,this.lowerLimitEnabled=!1),"number"==typeof e?(this.upperLimit=e,this.upperLimitEnabled=!0):(this.upperLimit=e,this.upperLimitEnabled=!1)},n.prototype.update=function(){var t,e=this.bodyA,i=this.bodyB,n=this.pivotA,o=this.pivotB,r=this.equations,s=(r[0],r[1],r[0]),a=r[1],h=this.upperLimit,c=this.lowerLimit,l=this.upperLimitEquation,u=this.lowerLimitEquation,p=this.angle=i.angle-e.angle;this.upperLimitEnabled&&h<p?(l.angle=h,-1===r.indexOf(l)&&r.push(l)):-1!==(t=r.indexOf(l))&&r.splice(t,1);this.lowerLimitEnabled&&p<c?(u.angle=c,-1===r.indexOf(u)&&r.push(u)):-1!==(t=r.indexOf(u))&&r.splice(t,1);d.rotate(f,n,e.angle),d.rotate(y,o,i.angle),s.G[0]=-1,s.G[1]=0,s.G[2]=-d.crossLength(f,g),s.G[3]=1,s.G[4]=0,s.G[5]=d.crossLength(y,g),a.G[0]=0,a.G[1]=-1,a.G[2]=-d.crossLength(f,m),a.G[3]=0,a.G[4]=1,a.G[5]=d.crossLength(y,m)},n.prototype.enableMotor=function(){this.motorEnabled||(this.equations.push(this.motorEquation),this.motorEnabled=!0)},n.prototype.disableMotor=function(){if(this.motorEnabled){var t=this.equations.indexOf(this.motorEquation);this.equations.splice(t,1),this.motorEnabled=!1}},n.prototype.motorIsEnabled=function(){return!!this.motorEnabled},n.prototype.setMotorSpeed=function(t){if(this.motorEnabled){var e=this.equations.indexOf(this.motorEquation);this.equations[e].relativeVelocity=t}},n.prototype.getMotorSpeed=function(){return!!this.motorEnabled&&this.motorEquation.relativeVelocity}},{"../equations/Equation":22,"../equations/RotationalLockEquation":24,"../equations/RotationalVelocityEquation":25,"../math/vec2":30,"./Constraint":14}],20:[function(t,e,i){var n=t("./Equation");t("../math/vec2");function o(t,e,i){i=i||{},n.call(this,t,e,-Number.MAX_VALUE,Number.MAX_VALUE),this.angle=i.angle||0,this.ratio="number"==typeof i.ratio?i.ratio:1,this.setRatio(this.ratio)}(((e.exports=o).prototype=new n).constructor=o).prototype.computeGq=function(){return this.ratio*this.bodyA.angle-this.bodyB.angle+this.angle},o.prototype.setRatio=function(t){var e=this.G;e[2]=t,e[5]=-1,this.ratio=t},o.prototype.setMaxTorque=function(t){this.maxForce=t,this.minForce=-t}},{"../math/vec2":30,"./Equation":22}],21:[function(t,e,i){var n=t("./Equation"),g=t("../math/vec2");function o(t,e){n.call(this,t,e,0,Number.MAX_VALUE),this.contactPointA=g.create(),this.penetrationVec=g.create(),this.contactPointB=g.create(),this.normalA=g.create(),this.restitution=0,this.firstImpact=!1,this.shapeA=null,this.shapeB=null}(((e.exports=o).prototype=new n).constructor=o).prototype.computeB=function(t,e,i){var n,o,r=this.bodyA,s=this.bodyB,a=this.contactPointA,h=this.contactPointB,c=r.position,l=s.position,u=this.penetrationVec,p=this.normalA,d=this.G,f=g.crossLength(a,p),y=g.crossLength(h,p);return d[0]=-p[0],d[1]=-p[1],d[2]=-f,d[3]=p[0],d[4]=p[1],d[5]=y,g.add(u,l,h),g.sub(u,u,c),g.sub(u,u,a),this.firstImpact&&0!==this.restitution?(o=0,n=1/e*(1+this.restitution)*this.computeGW()):(o=g.dot(p,u)+this.offset,n=this.computeGW()),-o*t-n*e-i*this.computeGiMf()};var r=g.create(),s=g.create(),a=g.create();o.prototype.getVelocityAlongNormal=function(){return this.bodyA.getVelocityAtPoint(r,this.contactPointA),this.bodyB.getVelocityAtPoint(s,this.contactPointB),g.subtract(a,r,s),g.dot(this.normalA,a)}},{"../math/vec2":30,"./Equation":22}],22:[function(t,e,i){e.exports=s;var u=t("../math/vec2"),r=t("../utils/Utils");t("../objects/Body");function s(t,e,i,n){this.minForce=void 0===i?-Number.MAX_VALUE:i,this.maxForce=void 0===n?Number.MAX_VALUE:n,this.bodyA=t,this.bodyB=e,this.stiffness=s.DEFAULT_STIFFNESS,this.relaxation=s.DEFAULT_RELAXATION,this.G=new r.ARRAY_TYPE(6);for(var o=0;o<6;o++)this.G[o]=0;this.offset=0,this.a=0,this.b=0,this.epsilon=0,this.timeStep=1/60,this.needsUpdate=!0,this.multiplier=0,this.relativeVelocity=0,this.enabled=!0}(s.prototype.constructor=s).DEFAULT_STIFFNESS=1e6,s.DEFAULT_RELAXATION=4,s.prototype.update=function(){var t=this.stiffness,e=this.relaxation,i=this.timeStep;this.a=4/(i*(1+4*e)),this.b=4*e/(1+4*e),this.epsilon=4/(i*i*t*(1+4*e)),this.needsUpdate=!1},s.prototype.gmult=function(t,e,i,n,o){return t[0]*e[0]+t[1]*e[1]+t[2]*i+t[3]*n[0]+t[4]*n[1]+t[5]*o},s.prototype.computeB=function(t,e,i){var n=this.computeGW();return-this.computeGq()*t-n*e-this.computeGiMf()*i};var a=u.create(),h=u.create();s.prototype.computeGq=function(){var t=this.G,e=this.bodyA,i=this.bodyB,n=(e.position,i.position,e.angle),o=i.angle;return this.gmult(t,a,n,h,o)+this.offset},s.prototype.computeGW=function(){var t=this.G,e=this.bodyA,i=this.bodyB,n=e.velocity,o=i.velocity,r=e.angularVelocity,s=i.angularVelocity;return this.gmult(t,n,r,o,s)+this.relativeVelocity},s.prototype.computeGWlambda=function(){var t=this.G,e=this.bodyA,i=this.bodyB,n=e.vlambda,o=i.vlambda,r=e.wlambda,s=i.wlambda;return this.gmult(t,n,r,o,s)};var p=u.create(),d=u.create();s.prototype.computeGiMf=function(){var t=this.bodyA,e=this.bodyB,i=t.force,n=t.angularForce,o=e.force,r=e.angularForce,s=t.invMassSolve,a=e.invMassSolve,h=t.invInertiaSolve,c=e.invInertiaSolve,l=this.G;return u.scale(p,i,s),u.multiply(p,t.massMultiplier,p),u.scale(d,o,a),u.multiply(d,e.massMultiplier,d),this.gmult(l,p,n*h,d,r*c)},s.prototype.computeGiMGt=function(){var t=this.bodyA,e=this.bodyB,i=t.invMassSolve,n=e.invMassSolve,o=t.invInertiaSolve,r=e.invInertiaSolve,s=this.G;return s[0]*s[0]*i*t.massMultiplier[0]+s[1]*s[1]*i*t.massMultiplier[1]+s[2]*s[2]*o+s[3]*s[3]*n*e.massMultiplier[0]+s[4]*s[4]*n*e.massMultiplier[1]+s[5]*s[5]*r};var f=u.create(),y=u.create(),g=u.create();u.create(),u.create(),u.create();s.prototype.addToWlambda=function(t){var e=this.bodyA,i=this.bodyB,n=f,o=y,r=g,s=e.invMassSolve,a=i.invMassSolve,h=e.invInertiaSolve,c=i.invInertiaSolve,l=this.G;o[0]=l[0],o[1]=l[1],r[0]=l[3],r[1]=l[4],u.scale(n,o,s*t),u.multiply(n,n,e.massMultiplier),u.add(e.vlambda,e.vlambda,n),e.wlambda+=h*l[2]*t,u.scale(n,r,a*t),u.multiply(n,n,i.massMultiplier),u.add(i.vlambda,i.vlambda,n),i.wlambda+=c*l[5]*t},s.prototype.computeInvC=function(t){return 1/(this.computeGiMGt()+t)}},{"../math/vec2":30,"../objects/Body":31,"../utils/Utils":57}],23:[function(t,e,i){var a=t("../math/vec2"),n=t("./Equation");t("../utils/Utils");function o(t,e,i){n.call(this,t,e,-i,i),this.contactPointA=a.create(),this.contactPointB=a.create(),this.t=a.create(),this.contactEquations=[],this.shapeA=null,this.shapeB=null,this.frictionCoefficient=.3}(((e.exports=o).prototype=new n).constructor=o).prototype.setSlipForce=function(t){this.maxForce=t,this.minForce=-t},o.prototype.getSlipForce=function(){return this.maxForce},o.prototype.computeB=function(t,e,i){this.bodyA,this.bodyB;var n=this.contactPointA,o=this.contactPointB,r=this.t,s=this.G;return s[0]=-r[0],s[1]=-r[1],s[2]=-a.crossLength(n,r),s[3]=r[0],s[4]=r[1],s[5]=a.crossLength(o,r),-this.computeGW()*e-i*this.computeGiMf()}},{"../math/vec2":30,"../utils/Utils":57,"./Equation":22}],24:[function(t,e,i){var o=t("./Equation"),n=t("../math/vec2");function r(t,e,i){i=i||{},o.call(this,t,e,-Number.MAX_VALUE,Number.MAX_VALUE),this.angle=i.angle||0;var n=this.G;n[2]=1,n[5]=-1}((e.exports=r).prototype=new o).constructor=r;var s=n.create(),a=n.create(),h=n.fromValues(1,0),c=n.fromValues(0,1);r.prototype.computeGq=function(){return n.rotate(s,h,this.bodyA.angle+this.angle),n.rotate(a,c,this.bodyB.angle),n.dot(s,a)}},{"../math/vec2":30,"./Equation":22}],25:[function(t,e,i){var n=t("./Equation");t("../math/vec2");function o(t,e){n.call(this,t,e,-Number.MAX_VALUE,Number.MAX_VALUE),this.relativeVelocity=1,this.ratio=1}(((e.exports=o).prototype=new n).constructor=o).prototype.computeB=function(t,e,i){var n=this.G;n[2]=-1,n[5]=this.ratio;var o=this.computeGiMf();return-this.computeGW()*e-i*o}},{"../math/vec2":30,"./Equation":22}],26:[function(t,e,i){var n=function(){};(e.exports=n).prototype={constructor:n,on:function(t,e,i){e.context=i||this,void 0===this._listeners&&(this._listeners={});var n=this._listeners;return void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e),this},has:function(t,e){if(void 0===this._listeners)return!1;var i=this._listeners;if(e){if(void 0!==i[t]&&-1!==i[t].indexOf(e))return!0}else if(void 0!==i[t])return!0;return!1},off:function(t,e){if(void 0===this._listeners)return this;var i=this._listeners,n=i[t].indexOf(e);return-1!==n&&i[t].splice(n,1),this},emit:function(t){if(void 0===this._listeners)return this;var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var i=0,n=e.length;i<n;i++){var o=e[i];o.call(o.context,t)}}return this}}},{}],27:[function(t,e,i){var n=t("./Material"),o=t("../equations/Equation");function r(t,e,i){if(i=i||{},!(t instanceof n&&e instanceof n))throw new Error("First two arguments must be Material instances.");this.id=r.idCounter++,this.materialA=t,this.materialB=e,this.friction=void 0!==i.friction?Number(i.friction):.3,this.restitution=void 0!==i.restitution?Number(i.restitution):0,this.stiffness=void 0!==i.stiffness?Number(i.stiffness):o.DEFAULT_STIFFNESS,this.relaxation=void 0!==i.relaxation?Number(i.relaxation):o.DEFAULT_RELAXATION,this.frictionStiffness=void 0!==i.frictionStiffness?Number(i.frictionStiffness):o.DEFAULT_STIFFNESS,this.frictionRelaxation=void 0!==i.frictionRelaxation?Number(i.frictionRelaxation):o.DEFAULT_RELAXATION,this.surfaceVelocity=void 0!==i.surfaceVelocity?Number(i.surfaceVelocity):0,this.contactSkinSize=.005}(e.exports=r).idCounter=0},{"../equations/Equation":22,"./Material":28}],28:[function(t,e,i){function n(t){this.id=t||n.idCounter++}(e.exports=n).idCounter=0},{}],29:[function(t,e,i){var v={GetArea:function(t){if(t.length<6)return 0;for(var e=t.length-2,i=0,n=0;n<e;n+=2)i+=(t[n+2]-t[n])*(t[n+1]+t[n+3]);return.5*-(i+=(t[0]-t[e])*(t[e+1]+t[1]))},Triangulate:function(t){var e=t.length>>1;if(e<3)return[];for(var i=[],n=[],o=0;o<e;o++)n.push(o);o=0;for(var r=e;3<r;){var s=n[(o+0)%r],a=n[(o+1)%r],h=n[(o+2)%r],c=t[2*s],l=t[2*s+1],u=t[2*a],p=t[2*a+1],d=t[2*h],f=t[2*h+1],y=!1;if(v._convex(c,l,u,p,d,f)){y=!0;for(var g=0;g<r;g++){var m=n[g];if(m!=s&&m!=a&&m!=h&&v._PointInTriangle(t[2*m],t[2*m+1],c,l,u,p,d,f)){y=!1;break}}}if(y)i.push(s,a,h),n.splice((o+1)%r,1),r--,o=0;else if(o++>3*r)break}return i.push(n[0],n[1],n[2]),i},_PointInTriangle:function(t,e,i,n,o,r,s,a){var h=s-i,c=a-n,l=o-i,u=r-n,p=t-i,d=e-n,f=h*h+c*c,y=h*l+c*u,g=h*p+c*d,m=l*l+u*u,v=l*p+u*d,S=1/(f*m-y*y),_=(m*g-y*v)*S,b=(f*v-y*g)*S;return 0<=_&&0<=b&&_+b<1},_convex:function(t,e,i,n,o,r){return 0<=(e-n)*(o-i)+(i-t)*(r-n)}};e.exports=v},{}],30:[function(t,e,i){var s=e.exports={},n=t("../utils/Utils");s.crossLength=function(t,e){return t[0]*e[1]-t[1]*e[0]},s.crossVZ=function(t,e,i){return s.rotate(t,e,-Math.PI/2),s.scale(t,t,i),t},s.crossZV=function(t,e,i){return s.rotate(t,i,Math.PI/2),s.scale(t,t,e),t},s.rotate=function(t,e,i){if(0!==i){var n=Math.cos(i),o=Math.sin(i),r=e[0],s=e[1];t[0]=n*r-o*s,t[1]=o*r+n*s}else t[0]=e[0],t[1]=e[1]},s.rotate90cw=function(t,e){var i=e[0],n=e[1];t[0]=n,t[1]=-i},s.toLocalFrame=function(t,e,i,n){s.copy(t,e),s.sub(t,t,i),s.rotate(t,t,-n)},s.toGlobalFrame=function(t,e,i,n){s.copy(t,e),s.rotate(t,t,n),s.add(t,t,i)},s.vectorToLocalFrame=function(t,e,i){s.rotate(t,e,-i)},s.vectorToGlobalFrame=function(t,e,i){s.rotate(t,e,i)},s.centroid=function(t,e,i,n){return s.add(t,e,i),s.add(t,t,n),s.scale(t,t,1/3),t},s.create=function(){var t=new n.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},s.clone=function(t){var e=new n.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},s.fromValues=function(t,e){var i=new n.ARRAY_TYPE(2);return i[0]=t,i[1]=e,i},s.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},s.set=function(t,e,i){return t[0]=e,t[1]=i,t},s.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t},s.subtract=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t},s.sub=s.subtract,s.multiply=function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t},s.mul=s.multiply,s.divide=function(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t},s.div=s.divide,s.scale=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t},s.distance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(i*i+n*n)},s.dist=s.distance,s.squaredDistance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1];return i*i+n*n},s.sqrDist=s.squaredDistance,s.length=function(t){var e=t[0],i=t[1];return Math.sqrt(e*e+i*i)},s.len=s.length,s.squaredLength=function(t){var e=t[0],i=t[1];return e*e+i*i},s.sqrLen=s.squaredLength,s.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},s.normalize=function(t,e){var i=e[0],n=e[1],o=i*i+n*n;return 0<o&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o),t},s.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},s.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},s.lerp=function(t,e,i,n){var o=e[0],r=e[1];return t[0]=o+n*(i[0]-o),t[1]=r+n*(i[1]-r),t},s.reflect=function(t,e,i){var n=e[0]*i[0]+e[1]*i[1];t[0]=e[0]-2*i[0]*n,t[1]=e[1]-2*i[1]*n},s.getLineSegmentsIntersection=function(t,e,i,n,o){var r=s.getLineSegmentsIntersectionFraction(e,i,n,o);return!(r<0)&&(t[0]=e[0]+r*(i[0]-e[0]),t[1]=e[1]+r*(i[1]-e[1]),!0)},s.getLineSegmentsIntersectionFraction=function(t,e,i,n){var o,r,s=e[0]-t[0],a=e[1]-t[1],h=n[0]-i[0],c=n[1]-i[1];return o=(-a*(t[0]-i[0])+s*(t[1]-i[1]))/(-h*a+s*c),r=(h*(t[1]-i[1])-c*(t[0]-i[0]))/(-h*a+s*c),0<=o&&o<=1&&0<=r&&r<=1?r:-1}},{"../utils/Utils":57}],31:[function(t,e,i){var u=t("../math/vec2"),c=t("poly-decomp"),l=t("../shapes/Convex"),n=t("../collision/RaycastResult"),o=t("../collision/Ray"),r=t("../collision/AABB"),s=t("../events/EventEmitter");function a(t){t=t||{},s.call(this),this.id=t.id||++a._idCounter,this.world=null,this.shapes=[],this.mass=t.mass||0,this.invMass=0,this.inertia=0,this.invInertia=0,this.invMassSolve=0,this.invInertiaSolve=0,this.fixedRotation=!!t.fixedRotation,this.fixedX=!!t.fixedX,this.fixedY=!!t.fixedY,this.massMultiplier=u.create(),this.position=u.fromValues(0,0),t.position&&u.copy(this.position,t.position),this.interpolatedPosition=u.fromValues(0,0),this.interpolatedAngle=0,this.previousPosition=u.fromValues(0,0),this.previousAngle=0,this.velocity=u.fromValues(0,0),t.velocity&&u.copy(this.velocity,t.velocity),this.vlambda=u.fromValues(0,0),this.wlambda=0,this.angle=t.angle||0,this.angularVelocity=t.angularVelocity||0,this.force=u.create(),t.force&&u.copy(this.force,t.force),this.angularForce=t.angularForce||0,this.damping="number"==typeof t.damping?t.damping:.1,this.angularDamping="number"==typeof t.angularDamping?t.angularDamping:.1,this.type=a.STATIC,void 0!==t.type?this.type=t.type:t.mass?this.type=a.DYNAMIC:this.type=a.STATIC,this.boundingRadius=0,this.aabb=new r,this.aabbNeedsUpdate=!0,this.allowSleep=void 0===t.allowSleep||t.allowSleep,this.wantsToSleep=!1,this.sleepState=a.AWAKE,this.sleepSpeedLimit=void 0!==t.sleepSpeedLimit?t.sleepSpeedLimit:.2,this.sleepTimeLimit=void 0!==t.sleepTimeLimit?t.sleepTimeLimit:1,this.gravityScale=void 0!==t.gravityScale?t.gravityScale:1,this.collisionResponse=void 0===t.collisionResponse||t.collisionResponse,this.idleTime=0,this.timeLastSleepy=0,this.ccdSpeedThreshold=void 0!==t.ccdSpeedThreshold?t.ccdSpeedThreshold:-1,this.ccdIterations=void 0!==t.ccdIterations?t.ccdIterations:10,this.concavePath=null,this._wakeUpAfterNarrowphase=!1,this.updateMassProperties()}(((e.exports=a).prototype=new s).constructor=a)._idCounter=0,a.prototype.updateSolveMassProperties=function(){this.sleepState===a.SLEEPING||this.type===a.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve=0):(this.invMassSolve=this.invMass,this.invInertiaSolve=this.invInertia)},a.prototype.setDensity=function(t){var e=this.getArea();this.mass=e*t,this.updateMassProperties()},a.prototype.getArea=function(){for(var t=0,e=0;e<this.shapes.length;e++)t+=this.shapes[e].area;return t},a.prototype.getAABB=function(){return this.aabbNeedsUpdate&&this.updateAABB(),this.aabb};var h=new r,p=u.create();a.prototype.updateAABB=function(){for(var t=this.shapes,e=t.length,i=p,n=this.angle,o=0;o!==e;o++){var r=t[o],s=r.angle+n;u.rotate(i,r.position,n),u.add(i,i,this.position),r.computeAABB(h,i,s),0===o?this.aabb.copy(h):this.aabb.extend(h)}this.aabbNeedsUpdate=!1},a.prototype.updateBoundingRadius=function(){for(var t=this.shapes,e=t.length,i=0,n=0;n!==e;n++){var o=t[n],r=u.length(o.position),s=o.boundingRadius;i<r+s&&(i=r+s)}this.boundingRadius=i},a.prototype.addShape=function(t,e,i){if(t.body)throw new Error("A shape can only be added to one body.");t.body=this,e?u.copy(t.position,e):u.set(t.position,0,0),t.angle=i||0,this.shapes.push(t),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0},a.prototype.removeShape=function(t){var e=this.shapes.indexOf(t);return-1!==e&&(this.shapes.splice(e,1),this.aabbNeedsUpdate=!0,!(t.body=null))},a.prototype.updateMassProperties=function(){if(this.type===a.STATIC||this.type===a.KINEMATIC)this.mass=Number.MAX_VALUE,this.invMass=0,this.inertia=Number.MAX_VALUE,this.invInertia=0;else{var t=this.shapes,e=t.length,i=this.mass/e,n=0;if(this.fixedRotation)this.inertia=Number.MAX_VALUE,this.invInertia=0;else{for(var o=0;o<e;o++){var r=t[o],s=u.squaredLength(r.position);n+=r.computeMomentOfInertia(i)+i*s}this.inertia=n,this.invInertia=0<n?1/n:0}this.invMass=1/this.mass,u.set(this.massMultiplier,this.fixedX?0:1,this.fixedY?0:1)}};u.create();a.prototype.applyForce=function(t,e){if(u.add(this.force,this.force,t),e){var i=u.crossLength(e,t);this.angularForce+=i}};var d=u.create(),f=u.create(),y=u.create();a.prototype.applyForceLocal=function(t,e){e=e||y;var i=d,n=f;this.vectorToWorldFrame(i,t),this.vectorToWorldFrame(n,e),this.applyForce(i,n)};var g=u.create();a.prototype.applyImpulse=function(t,e){if(this.type===a.DYNAMIC){var i=g;if(u.scale(i,t,this.invMass),u.multiply(i,this.massMultiplier,i),u.add(this.velocity,i,this.velocity),e){var n=u.crossLength(e,t);n*=this.invInertia,this.angularVelocity+=n}}};var m=u.create(),v=u.create(),S=u.create();a.prototype.applyImpulseLocal=function(t,e){e=e||S;var i=m,n=v;this.vectorToWorldFrame(i,t),this.vectorToWorldFrame(n,e),this.applyImpulse(i,n)},a.prototype.toLocalFrame=function(t,e){u.toLocalFrame(t,e,this.position,this.angle)},a.prototype.toWorldFrame=function(t,e){u.toGlobalFrame(t,e,this.position,this.angle)},a.prototype.vectorToLocalFrame=function(t,e){u.vectorToLocalFrame(t,e,this.angle)},a.prototype.vectorToWorldFrame=function(t,e){u.vectorToGlobalFrame(t,e,this.angle)},a.prototype.fromPolygon=function(t,e){e=e||{};for(var i=this.shapes.length;0<=i;--i)this.removeShape(this.shapes[i]);var n,o=new c.Polygon;if(o.vertices=t,o.makeCCW(),"number"==typeof e.removeCollinearPoints&&o.removeCollinearPoints(e.removeCollinearPoints),void 0===e.skipSimpleCheck&&!o.isSimple())return!1;this.concavePath=o.vertices.slice(0);for(i=0;i<this.concavePath.length;i++){var r=[0,0];u.copy(r,this.concavePath[i]),this.concavePath[i]=r}n=e.optimalDecomp?o.decomp():o.quickDecomp();var s=u.create();for(i=0;i!==n.length;i++){for(var a=new l({vertices:n[i].vertices}),h=0;h!==a.vertices.length;h++){r=a.vertices[h];u.sub(r,r,a.centerOfMass)}u.scale(s,a.centerOfMass,1),a.updateTriangles(),a.updateCenterOfMass(),a.updateBoundingRadius(),this.addShape(a,s)}return this.adjustCenterOfMass(),this.aabbNeedsUpdate=!0};u.fromValues(0,0);var _=u.fromValues(0,0),b=u.fromValues(0,0),I=u.fromValues(0,0);a.prototype.adjustCenterOfMass=function(){var t=_,e=b,i=I,n=0;u.set(e,0,0);for(var o=0;o!==this.shapes.length;o++){var r=this.shapes[o];u.scale(t,r.position,r.area),u.add(e,e,t),n+=r.area}u.scale(i,e,1/n);for(o=0;o!==this.shapes.length;o++){r=this.shapes[o];u.sub(r.position,r.position,i)}u.add(this.position,this.position,i);for(o=0;this.concavePath&&o<this.concavePath.length;o++)u.sub(this.concavePath[o],this.concavePath[o],i);this.updateMassProperties(),this.updateBoundingRadius()},a.prototype.setZeroForce=function(){u.set(this.force,0,0),this.angularForce=0},a.prototype.resetConstraintVelocity=function(){var t=this.vlambda;u.set(t,0,0),this.wlambda=0},a.prototype.addConstraintVelocity=function(){var t=this.velocity;u.add(t,t,this.vlambda),this.angularVelocity+=this.wlambda},a.prototype.applyDamping=function(t){if(this.type===a.DYNAMIC){var e=this.velocity;u.scale(e,e,Math.pow(1-this.damping,t)),this.angularVelocity*=Math.pow(1-this.angularDamping,t)}},a.prototype.wakeUp=function(){var t=this.sleepState;this.sleepState=a.AWAKE,this.idleTime=0,t!==a.AWAKE&&this.emit(a.wakeUpEvent)},a.prototype.sleep=function(){this.sleepState=a.SLEEPING,this.angularVelocity=0,this.angularForce=0,u.set(this.velocity,0,0),u.set(this.force,0,0),this.emit(a.sleepEvent)},a.prototype.sleepTick=function(t,e,i){if(this.allowSleep&&this.type!==a.SLEEPING){this.wantsToSleep=!1;this.sleepState;var n=u.squaredLength(this.velocity)+Math.pow(this.angularVelocity,2);Math.pow(this.sleepSpeedLimit,2)<=n?(this.idleTime=0,this.sleepState=a.AWAKE):(this.idleTime+=i,this.sleepState=a.SLEEPY),this.idleTime>this.sleepTimeLimit&&(e?this.wantsToSleep=!0:this.sleep())}},a.prototype.overlaps=function(t){return this.world.overlapKeeper.bodiesAreOverlapping(this,t)};var w=u.create(),x=u.create();a.prototype.integrate=function(t){var e=this.invMass,i=this.force,n=this.position,o=this.velocity;u.copy(this.previousPosition,this.position),this.previousAngle=this.angle,this.fixedRotation||(this.angularVelocity+=this.angularForce*this.invInertia*t),u.scale(w,i,t*e),u.multiply(w,this.massMultiplier,w),u.add(o,w,o),this.integrateToTimeOfImpact(t)||(u.scale(x,o,t),u.add(n,n,x),this.fixedRotation||(this.angle+=this.angularVelocity*t)),this.aabbNeedsUpdate=!0};var C=new n,A=new o({mode:o.ALL}),E=u.create(),T=u.create(),L=u.create(),P=u.create();a.prototype.integrateToTimeOfImpact=function(t){if(this.ccdSpeedThreshold<0||u.squaredLength(this.velocity)<Math.pow(this.ccdSpeedThreshold,2))return!1;u.normalize(E,this.velocity),u.scale(T,this.velocity,t),u.add(T,T,this.position),u.sub(L,T,this.position);var e,i=this.angularVelocity*t,n=u.length(L),o=1,r=this;if(C.reset(),A.callback=function(t){t.body!==r&&(e=t.body,t.getHitPoint(T,A),u.sub(L,T,r.position),o=u.length(L)/n,t.stop())},u.copy(A.from,this.position),u.copy(A.to,T),A.update(),this.world.raycast(C,A),!e)return!1;var s=this.angle;u.copy(P,this.position);for(var a=0,h=0,c=0,l=o;h<=l&&a<this.ccdIterations;){a++,c=(l-h)/2,u.scale(x,L,o),u.add(this.position,P,x),this.angle=s+i*o,this.updateAABB(),this.aabb.overlaps(e.aabb)&&this.world.narrowphase.bodiesOverlap(this,e)?h=c:l=c}return o=c,u.copy(this.position,P),this.angle=s,u.scale(x,L,o),u.add(this.position,this.position,x),this.fixedRotation||(this.angle+=i*o),!0},a.prototype.getVelocityAtPoint=function(t,e){return u.crossVZ(t,e,this.angularVelocity),u.subtract(t,this.velocity,t),t},a.sleepyEvent={type:"sleepy"},a.sleepEvent={type:"sleep"},a.wakeUpEvent={type:"wakeup"},a.DYNAMIC=1,a.STATIC=2,a.KINEMATIC=4,a.AWAKE=0,a.SLEEPY=1,a.SLEEPING=2},{"../collision/AABB":7,"../collision/Ray":11,"../collision/RaycastResult":12,"../events/EventEmitter":26,"../math/vec2":30,"../shapes/Convex":40,"poly-decomp":5}],32:[function(t,e,i){var m=t("../math/vec2"),s=t("./Spring");t("../utils/Utils");function n(t,e,i){i=i||{},s.call(this,t,e,i),this.localAnchorA=m.fromValues(0,0),this.localAnchorB=m.fromValues(0,0),i.localAnchorA&&m.copy(this.localAnchorA,i.localAnchorA),i.localAnchorB&&m.copy(this.localAnchorB,i.localAnchorB),i.worldAnchorA&&this.setWorldAnchorA(i.worldAnchorA),i.worldAnchorB&&this.setWorldAnchorB(i.worldAnchorB);var n=m.create(),o=m.create();this.getWorldAnchorA(n),this.getWorldAnchorB(o);var r=m.distance(n,o);this.restLength="number"==typeof i.restLength?i.restLength:r}(((e.exports=n).prototype=new s).constructor=n).prototype.setWorldAnchorA=function(t){this.bodyA.toLocalFrame(this.localAnchorA,t)},n.prototype.setWorldAnchorB=function(t){this.bodyB.toLocalFrame(this.localAnchorB,t)},n.prototype.getWorldAnchorA=function(t){this.bodyA.toWorldFrame(t,this.localAnchorA)},n.prototype.getWorldAnchorB=function(t){this.bodyB.toWorldFrame(t,this.localAnchorB)};var v=m.create(),S=m.create(),_=m.create(),b=m.create(),I=m.create(),w=m.create(),x=m.create(),C=m.create(),A=m.create();n.prototype.applyForce=function(){var t=this.stiffness,e=this.damping,i=this.restLength,n=this.bodyA,o=this.bodyB,r=v,s=S,a=_,h=b,c=A,l=I,u=w,p=x,d=C;this.getWorldAnchorA(l),this.getWorldAnchorB(u),m.sub(p,l,n.position),m.sub(d,u,o.position),m.sub(r,u,l);var f=m.len(r);m.normalize(s,r),m.sub(a,o.velocity,n.velocity),m.crossZV(c,o.angularVelocity,d),m.add(a,a,c),m.crossZV(c,n.angularVelocity,p),m.sub(a,a,c),m.scale(h,s,-t*(f-i)-e*m.dot(a,s)),m.sub(n.force,n.force,h),m.add(o.force,o.force,h);var y=m.crossLength(p,h),g=m.crossLength(d,h);n.angularForce-=y,o.angularForce+=g}},{"../math/vec2":30,"../utils/Utils":57,"./Spring":34}],33:[function(t,e,i){t("../math/vec2");var n=t("./Spring");function o(t,e,i){i=i||{},n.call(this,t,e,i),this.restAngle="number"==typeof i.restAngle?i.restAngle:e.angle-t.angle}(((e.exports=o).prototype=new n).constructor=o).prototype.applyForce=function(){var t=this.stiffness,e=this.damping,i=this.restAngle,n=this.bodyA,o=this.bodyB,r=-t*(o.angle-n.angle-i)-e*(o.angularVelocity-n.angularVelocity)*0;n.angularForce-=r,o.angularForce+=r}},{"../math/vec2":30,"./Spring":34}],34:[function(t,e,i){t("../math/vec2");var n=t("../utils/Utils");function o(t,e,i){i=n.defaults(i,{stiffness:100,damping:1}),this.stiffness=i.stiffness,this.damping=i.damping,this.bodyA=t,this.bodyB=e}(e.exports=o).prototype.applyForce=function(){}},{"../math/vec2":30,"../utils/Utils":57}],35:[function(t,e,i){var n=t("../math/vec2"),o=(t("../utils/Utils"),t("../constraints/Constraint")),r=t("../equations/FrictionEquation"),s=t("../objects/Body");function a(t,e){e=e||{},this.chassisBody=t,this.wheels=[],this.groundBody=new s({mass:0}),this.world=null;var i=this;this.preStepCallback=function(){i.update()}}function h(t,e){e=e||{},this.vehicle=t,this.forwardEquation=new r(t.chassisBody,t.groundBody),this.sideEquation=new r(t.chassisBody,t.groundBody),this.steerValue=0,this.engineForce=0,this.setSideFriction(void 0!==e.sideFriction?e.sideFriction:5),this.localForwardVector=n.fromValues(0,1),e.localForwardVector&&n.copy(this.localForwardVector,e.localForwardVector),this.localPosition=n.fromValues(0,0),e.localPosition&&n.copy(this.localPosition,e.localPosition),o.apply(this,t.chassisBody,t.groundBody),this.equations.push(this.forwardEquation,this.sideEquation),this.setBrakeForce(0)}(e.exports=a).prototype.addToWorld=function(t){(this.world=t).addBody(this.groundBody),t.on("preStep",this.preStepCallback);for(var e=0;e<this.wheels.length;e++){var i=this.wheels[e];t.addConstraint(i)}},a.prototype.removeFromWorld=function(){var t=this.world;t.removeBody(this.groundBody),t.off("preStep",this.preStepCallback);for(var e=0;e<this.wheels.length;e++){var i=this.wheels[e];t.removeConstraint(i)}this.world=null},a.prototype.addWheel=function(t){var e=new h(this,t);return this.wheels.push(e),e},a.prototype.update=function(){for(var t=0;t<this.wheels.length;t++)this.wheels[t].update()},(h.prototype=new o).setBrakeForce=function(t){this.forwardEquation.setSlipForce(t)},h.prototype.setSideFriction=function(t){this.sideEquation.setSlipForce(t)};var c=n.create(),l=n.create();h.prototype.getSpeed=function(){return this.vehicle.chassisBody.vectorToWorldFrame(l,this.localForwardVector),this.vehicle.chassisBody.getVelocityAtPoint(c,l),n.dot(c,l)};var u=n.create();h.prototype.update=function(){this.vehicle.chassisBody.vectorToWorldFrame(this.forwardEquation.t,this.localForwardVector),n.rotate(this.sideEquation.t,this.localForwardVector,Math.PI/2),this.vehicle.chassisBody.vectorToWorldFrame(this.sideEquation.t,this.sideEquation.t),n.rotate(this.forwardEquation.t,this.forwardEquation.t,this.steerValue),n.rotate(this.sideEquation.t,this.sideEquation.t,this.steerValue),this.vehicle.chassisBody.toWorldFrame(this.forwardEquation.contactPointB,this.localPosition),n.copy(this.sideEquation.contactPointB,this.forwardEquation.contactPointB),this.vehicle.chassisBody.vectorToWorldFrame(this.forwardEquation.contactPointA,this.localPosition),n.copy(this.sideEquation.contactPointA,this.forwardEquation.contactPointA),n.normalize(u,this.forwardEquation.t),n.scale(u,u,this.engineForce),this.vehicle.chassisBody.applyForce(u,this.forwardEquation.contactPointA)}},{"../constraints/Constraint":14,"../equations/FrictionEquation":23,"../math/vec2":30,"../objects/Body":31,"../utils/Utils":57}],36:[function(t,e,i){var n=e.exports={AABB:t("./collision/AABB"),AngleLockEquation:t("./equations/AngleLockEquation"),Body:t("./objects/Body"),Broadphase:t("./collision/Broadphase"),Capsule:t("./shapes/Capsule"),Circle:t("./shapes/Circle"),Constraint:t("./constraints/Constraint"),ContactEquation:t("./equations/ContactEquation"),ContactEquationPool:t("./utils/ContactEquationPool"),ContactMaterial:t("./material/ContactMaterial"),Convex:t("./shapes/Convex"),DistanceConstraint:t("./constraints/DistanceConstraint"),Equation:t("./equations/Equation"),EventEmitter:t("./events/EventEmitter"),FrictionEquation:t("./equations/FrictionEquation"),FrictionEquationPool:t("./utils/FrictionEquationPool"),GearConstraint:t("./constraints/GearConstraint"),GSSolver:t("./solver/GSSolver"),Heightfield:t("./shapes/Heightfield"),Line:t("./shapes/Line"),LockConstraint:t("./constraints/LockConstraint"),Material:t("./material/Material"),Narrowphase:t("./collision/Narrowphase"),NaiveBroadphase:t("./collision/NaiveBroadphase"),Particle:t("./shapes/Particle"),Plane:t("./shapes/Plane"),Pool:t("./utils/Pool"),RevoluteConstraint:t("./constraints/RevoluteConstraint"),PrismaticConstraint:t("./constraints/PrismaticConstraint"),Ray:t("./collision/Ray"),RaycastResult:t("./collision/RaycastResult"),Box:t("./shapes/Box"),RotationalVelocityEquation:t("./equations/RotationalVelocityEquation"),SAPBroadphase:t("./collision/SAPBroadphase"),Shape:t("./shapes/Shape"),Solver:t("./solver/Solver"),Spring:t("./objects/Spring"),TopDownVehicle:t("./objects/TopDownVehicle"),LinearSpring:t("./objects/LinearSpring"),RotationalSpring:t("./objects/RotationalSpring"),Utils:t("./utils/Utils"),World:t("./world/World"),vec2:t("./math/vec2"),version:t("../package.json").version};Object.defineProperty(n,"Rectangle",{get:function(){return console.warn("The Rectangle class has been renamed to Box."),this.Box}})},{"../package.json":6,"./collision/AABB":7,"./collision/Broadphase":8,"./collision/NaiveBroadphase":9,"./collision/Narrowphase":10,"./collision/Ray":11,"./collision/RaycastResult":12,"./collision/SAPBroadphase":13,"./constraints/Constraint":14,"./constraints/DistanceConstraint":15,"./constraints/GearConstraint":16,"./constraints/LockConstraint":17,"./constraints/PrismaticConstraint":18,"./constraints/RevoluteConstraint":19,"./equations/AngleLockEquation":20,"./equations/ContactEquation":21,"./equations/Equation":22,"./equations/FrictionEquation":23,"./equations/RotationalVelocityEquation":25,"./events/EventEmitter":26,"./material/ContactMaterial":27,"./material/Material":28,"./math/vec2":30,"./objects/Body":31,"./objects/LinearSpring":32,"./objects/RotationalSpring":33,"./objects/Spring":34,"./objects/TopDownVehicle":35,"./shapes/Box":37,"./shapes/Capsule":38,"./shapes/Circle":39,"./shapes/Convex":40,"./shapes/Heightfield":41,"./shapes/Line":42,"./shapes/Particle":43,"./shapes/Plane":44,"./shapes/Shape":45,"./solver/GSSolver":46,"./solver/Solver":47,"./utils/ContactEquationPool":48,"./utils/FrictionEquationPool":49,"./utils/Pool":55,"./utils/Utils":57,"./world/World":61}],37:[function(t,e,i){var r=t("../math/vec2"),s=t("./Shape"),a=t("./Convex");function n(t){"number"==typeof t&&"number"==typeof arguments[1]&&(t={width:t,height:arguments[1]},console.warn("The Rectangle has been renamed to Box and its constructor signature has changed. Please use the following format: new Box({ width: 1, height: 1, ... })")),t=t||{};var e=this.width=t.width||1,i=this.height=t.height||1,n=[r.fromValues(-e/2,-i/2),r.fromValues(e/2,-i/2),r.fromValues(e/2,i/2),r.fromValues(-e/2,i/2)],o=[r.fromValues(1,0),r.fromValues(0,1)];t.vertices=n,t.axes=o,t.type=s.BOX,a.call(this,t)}(((e.exports=n).prototype=new a).constructor=n).prototype.computeMomentOfInertia=function(t){var e=this.width,i=this.height;return t*(i*i+e*e)/12},n.prototype.updateBoundingRadius=function(){var t=this.width,e=this.height;this.boundingRadius=Math.sqrt(t*t+e*e)/2};r.create(),r.create(),r.create(),r.create();n.prototype.computeAABB=function(t,e,i){t.setFromPoints(this.vertices,e,i,0)},n.prototype.updateArea=function(){this.area=this.width*this.height}},{"../math/vec2":30,"./Convex":40,"./Shape":45}],38:[function(t,e,i){var n=t("./Shape"),I=t("../math/vec2");function o(t){"number"==typeof t&&"number"==typeof arguments[1]&&(t={length:t,radius:arguments[1]},console.warn("The Capsule constructor signature has changed. Please use the following format: new Capsule({ radius: 1, length: 1 })")),t=t||{},this.length=t.length||1,this.radius=t.radius||1,t.type=n.CAPSULE,n.call(this,t)}(((e.exports=o).prototype=new n).constructor=o).prototype.computeMomentOfInertia=function(t){var e=this.radius,i=this.length+e,n=2*e;return t*(n*n+i*i)/12},o.prototype.updateBoundingRadius=function(){this.boundingRadius=this.radius+this.length/2},o.prototype.updateArea=function(){this.area=Math.PI*this.radius*this.radius+2*this.radius*this.length};var r=I.create();o.prototype.computeAABB=function(t,e,i){var n=this.radius;I.set(r,this.length/2,0),0!==i&&I.rotate(r,r,i),I.set(t.upperBound,Math.max(r[0]+n,-r[0]+n),Math.max(r[1]+n,-r[1]+n)),I.set(t.lowerBound,Math.min(r[0]-n,-r[0]-n),Math.min(r[1]-n,-r[1]-n)),I.add(t.lowerBound,t.lowerBound,e),I.add(t.upperBound,t.upperBound,e)};var w=I.create(),x=I.create(),C=I.create(),A=I.create(),E=I.fromValues(0,1);o.prototype.raycast=function(t,e,i,n){for(var o=e.from,r=e.to,s=(e.direction,w),a=x,h=C,c=A,l=this.length/2,u=0;u<2;u++){var p=this.radius*(2*u-1);if(I.set(h,-l,p),I.set(c,l,p),I.toGlobalFrame(h,h,i,n),I.toGlobalFrame(c,c,i,n),0<=(f=I.getLineSegmentsIntersectionFraction(o,r,h,c))&&(I.rotate(a,E,n),I.scale(a,a,2*u-1),e.reportIntersection(t,f,a,-1),t.shouldStop(e)))return}var d=Math.pow(this.radius,2)+Math.pow(l,2);for(u=0;u<2;u++){I.set(h,l*(2*u-1),0),I.toGlobalFrame(h,h,i,n);var f,y=Math.pow(r[0]-o[0],2)+Math.pow(r[1]-o[1],2),g=2*((r[0]-o[0])*(o[0]-h[0])+(r[1]-o[1])*(o[1]-h[1])),m=Math.pow(o[0]-h[0],2)+Math.pow(o[1]-h[1],2)-Math.pow(this.radius,2);if(!((f=Math.pow(g,2)-4*y*m)<0))if(0===f){if(I.lerp(s,o,r,f),I.squaredDistance(s,i)>d&&(I.sub(a,s,h),I.normalize(a,a),e.reportIntersection(t,f,a,-1),t.shouldStop(e)))return}else{var v=Math.sqrt(f),S=1/(2*y),_=(-g-v)*S,b=(-g+v)*S;if(0<=_&&_<=1&&(I.lerp(s,o,r,_),I.squaredDistance(s,i)>d&&(I.sub(a,s,h),I.normalize(a,a),e.reportIntersection(t,_,a,-1),t.shouldStop(e))))return;if(0<=b&&b<=1&&(I.lerp(s,o,r,b),I.squaredDistance(s,i)>d&&(I.sub(a,s,h),I.normalize(a,a),e.reportIntersection(t,b,a,-1),t.shouldStop(e))))return}}}},{"../math/vec2":30,"./Shape":45}],39:[function(t,e,i){var n=t("./Shape"),m=t("../math/vec2");function o(t){"number"==typeof t&&(t={radius:t},console.warn("The Circle constructor signature has changed. Please use the following format: new Circle({ radius: 1 })")),t=t||{},this.radius=t.radius||1,t.type=n.CIRCLE,n.call(this,t)}(((e.exports=o).prototype=new n).constructor=o).prototype.computeMomentOfInertia=function(t){var e=this.radius;return t*e*e/2},o.prototype.updateBoundingRadius=function(){this.boundingRadius=this.radius},o.prototype.updateArea=function(){this.area=Math.PI*this.radius*this.radius},o.prototype.computeAABB=function(t,e,i){var n=this.radius;m.set(t.upperBound,n,n),m.set(t.lowerBound,-n,-n),e&&(m.add(t.lowerBound,t.lowerBound,e),m.add(t.upperBound,t.upperBound,e))};var v=m.create(),S=m.create();o.prototype.raycast=function(t,e,i,n){var o=e.from,r=e.to,s=this.radius,a=Math.pow(r[0]-o[0],2)+Math.pow(r[1]-o[1],2),h=2*((r[0]-o[0])*(o[0]-i[0])+(r[1]-o[1])*(o[1]-i[1])),c=Math.pow(o[0]-i[0],2)+Math.pow(o[1]-i[1],2)-Math.pow(s,2),l=Math.pow(h,2)-4*a*c,u=v,p=S;if(!(l<0))if(0===l)m.lerp(u,o,r,l),m.sub(p,u,i),m.normalize(p,p),e.reportIntersection(t,l,p,-1);else{var d=Math.sqrt(l),f=1/(2*a),y=(-h-d)*f,g=(-h+d)*f;if(0<=y&&y<=1&&(m.lerp(u,o,r,y),m.sub(p,u,i),m.normalize(p,p),e.reportIntersection(t,y,p,-1),t.shouldStop(e)))return;0<=g&&g<=1&&(m.lerp(u,o,r,g),m.sub(p,u,i),m.normalize(p,p),e.reportIntersection(t,g,p,-1))}}},{"../math/vec2":30,"./Shape":45}],40:[function(t,e,i){var h=t("./Shape"),d=t("../math/vec2"),a=t("../math/polyk");t("poly-decomp");function p(t){Array.isArray(t)&&(t={vertices:t,axes:arguments[1]},console.warn("The Convex constructor signature has changed. Please use the following format: new Convex({ vertices: [...], ... })")),t=t||{},this.vertices=[];for(var e=void 0!==t.vertices?t.vertices:[],i=0;i<e.length;i++){var n=d.create();d.copy(n,e[i]),this.vertices.push(n)}if(this.axes=[],t.axes)for(i=0;i<t.axes.length;i++){var o=d.create();d.copy(o,t.axes[i]),this.axes.push(o)}else for(i=0;i<this.vertices.length;i++){var r=this.vertices[i],s=this.vertices[(i+1)%this.vertices.length],a=d.create();d.sub(a,s,r),d.rotate90cw(a,a),d.normalize(a,a),this.axes.push(a)}if(this.centerOfMass=d.fromValues(0,0),this.triangles=[],this.vertices.length&&(this.updateTriangles(),this.updateCenterOfMass()),this.boundingRadius=0,t.type=h.CONVEX,h.call(this,t),this.updateBoundingRadius(),this.updateArea(),this.area<0)throw new Error("Convex vertices must be given in conter-clockwise winding.")}((e.exports=p).prototype=new h).constructor=p;var c=d.create(),s=d.create();p.prototype.projectOntoLocalAxis=function(t,e){for(var i,n,o=null,r=null,s=(t=c,0);s<this.vertices.length;s++)i=this.vertices[s],n=d.dot(i,t),(null===o||o<n)&&(o=n),(null===r||n<r)&&(r=n);if(o<r){var a=r;r=o,o=a}d.set(e,r,o)},p.prototype.projectOntoWorldAxis=function(t,e,i,n){var o=s;this.projectOntoLocalAxis(t,n),0!==i?d.rotate(o,t,i):o=t;var r=d.dot(e,o);d.set(n,n[0]+r,n[1]+r)},p.prototype.updateTriangles=function(){for(var t=[],e=this.triangles.length=0;e<this.vertices.length;e++){var i=this.vertices[e];t.push(i[0],i[1])}var n=a.Triangulate(t);for(e=0;e<n.length;e+=3){var o=n[e],r=n[e+1],s=n[e+2];this.triangles.push([o,r,s])}};var f=d.create(),y=d.create(),g=d.create(),m=d.create(),v=d.create();d.create(),d.create(),d.create(),d.create();p.prototype.updateCenterOfMass=function(){var t=this.triangles,e=this.vertices,i=this.centerOfMass,n=f,o=g,r=m,s=v,a=y;d.set(i,0,0);for(var h=0,c=0;c!==t.length;c++){var l=t[c];o=e[l[0]],r=e[l[1]],s=e[l[2]];d.centroid(n,o,r,s);var u=p.triangleArea(o,r,s);h+=u,d.scale(a,n,u),d.add(i,i,a)}d.scale(i,i,1/h)},p.prototype.computeMomentOfInertia=function(t){for(var e=0,i=0,n=this.vertices.length,o=n-1,r=0;r<n;o=r,r++){var s=this.vertices[o],a=this.vertices[r],h=Math.abs(d.crossLength(s,a));e+=h*(d.dot(a,a)+d.dot(a,s)+d.dot(s,s)),i+=h}return t/6*(e/i)},p.prototype.updateBoundingRadius=function(){for(var t=this.vertices,e=0,i=0;i!==t.length;i++){var n=d.squaredLength(t[i]);e<n&&(e=n)}this.boundingRadius=Math.sqrt(e)},p.triangleArea=function(t,e,i){return.5*((e[0]-t[0])*(i[1]-t[1])-(i[0]-t[0])*(e[1]-t[1]))},p.prototype.updateArea=function(){this.updateTriangles(),this.area=0;for(var t=this.triangles,e=this.vertices,i=0;i!==t.length;i++){var n=t[i],o=e[n[0]],r=e[n[1]],s=e[n[2]],a=p.triangleArea(o,r,s);this.area+=a}},p.prototype.computeAABB=function(t,e,i){t.setFromPoints(this.vertices,e,i,0)};var S=d.create(),_=d.create(),b=d.create();p.prototype.raycast=function(t,e,i,n){var o=S,r=_,s=b,a=this.vertices;d.toLocalFrame(o,e.from,i,n),d.toLocalFrame(r,e.to,i,n);for(var h=a.length,c=0;c<h&&!t.shouldStop(e);c++){var l=a[c],u=a[(c+1)%h],p=d.getLineSegmentsIntersectionFraction(o,r,l,u);0<=p&&(d.sub(s,u,l),d.rotate(s,s,-Math.PI/2+n),d.normalize(s,s),e.reportIntersection(t,p,s,c))}}},{"../math/polyk":29,"../math/vec2":30,"./Shape":45,"poly-decomp":5}],41:[function(t,e,i){var n=t("./Shape"),g=t("../math/vec2");t("../utils/Utils");function o(t){if(Array.isArray(t)){if(t={heights:t},"object"==typeof arguments[1])for(var e in arguments[1])t[e]=arguments[1][e];console.warn("The Heightfield constructor signature has changed. Please use the following format: new Heightfield({ heights: [...], ... })")}t=t||{},this.heights=t.heights?t.heights.slice(0):[],this.maxValue=t.maxValue||null,this.minValue=t.minValue||null,this.elementWidth=t.elementWidth||.1,void 0!==t.maxValue&&void 0!==t.minValue||this.updateMaxMinValues(),t.type=n.HEIGHTFIELD,n.call(this,t)}(((e.exports=o).prototype=new n).constructor=o).prototype.updateMaxMinValues=function(){for(var t=this.heights,e=t[0],i=t[0],n=0;n!==t.length;n++){var o=t[n];e<o&&(e=o),o<i&&(i=o)}this.maxValue=e,this.minValue=i},o.prototype.computeMomentOfInertia=function(t){return Number.MAX_VALUE},o.prototype.updateBoundingRadius=function(){this.boundingRadius=Number.MAX_VALUE},o.prototype.updateArea=function(){for(var t=this.heights,e=0,i=0;i<t.length-1;i++)e+=(t[i]+t[i+1])/2*this.elementWidth;this.area=e};var r=[g.create(),g.create(),g.create(),g.create()];o.prototype.computeAABB=function(t,e,i){g.set(r[0],0,this.maxValue),g.set(r[1],this.elementWidth*this.heights.length,this.maxValue),g.set(r[2],this.elementWidth*this.heights.length,this.minValue),g.set(r[3],0,this.minValue),t.setFromPoints(r,e,i)},o.prototype.getLineSegment=function(t,e,i){var n=this.heights,o=this.elementWidth;g.set(t,i*o,n[i]),g.set(e,(i+1)*o,n[i+1])},o.prototype.getSegmentIndex=function(t){return Math.floor(t[0]/this.elementWidth)},o.prototype.getClampedSegmentIndex=function(t){var e=this.getSegmentIndex(t);return e=Math.min(this.heights.length,Math.max(e,0))};g.create();var m=g.create(),v=g.create(),S=g.create(),_=g.create(),b=g.create();g.fromValues(0,1);o.prototype.raycast=function(t,e,i,n){var o=e.from,r=e.to,s=(e.direction,m),a=v,h=S,c=_,l=b;g.toLocalFrame(c,o,i,n),g.toLocalFrame(l,r,i,n);var u=this.getClampedSegmentIndex(c),p=this.getClampedSegmentIndex(l);if(p<u){var d=u;u=p,p=d}for(var f=0;f<this.heights.length-1;f++){this.getLineSegment(a,h,f);var y=g.getLineSegmentsIntersectionFraction(c,l,a,h);if(0<=y&&(g.sub(s,h,a),g.rotate(s,s,n+Math.PI/2),g.normalize(s,s),e.reportIntersection(t,y,s,-1),t.shouldStop(e)))return}}},{"../math/vec2":30,"../utils/Utils":57,"./Shape":45}],42:[function(t,e,i){var n=t("./Shape"),u=t("../math/vec2");function o(t){"number"==typeof t&&(t={length:t},console.warn("The Line constructor signature has changed. Please use the following format: new Line({ length: 1, ... })")),t=t||{},this.length=t.length||1,t.type=n.LINE,n.call(this,t)}(((e.exports=o).prototype=new n).constructor=o).prototype.computeMomentOfInertia=function(t){return t*Math.pow(this.length,2)/12},o.prototype.updateBoundingRadius=function(){this.boundingRadius=this.length/2};var r=[u.create(),u.create()];o.prototype.computeAABB=function(t,e,i){var n=this.length/2;u.set(r[0],-n,0),u.set(r[1],n,0),t.setFromPoints(r,e,i,0)};u.create();var p=u.create(),d=u.create(),f=u.create(),y=u.fromValues(0,1);o.prototype.raycast=function(t,e,i,n){var o=e.from,r=e.to,s=d,a=f,h=this.length/2;u.set(s,-h,0),u.set(a,h,0),u.toGlobalFrame(s,s,i,n),u.toGlobalFrame(a,a,i,n);var c=u.getLineSegmentsIntersectionFraction(s,a,o,r);if(0<=c){var l=p;u.rotate(l,y,n),e.reportIntersection(t,c,l,-1)}}},{"../math/vec2":30,"./Shape":45}],43:[function(t,e,i){var n=t("./Shape"),o=t("../math/vec2");function r(t){(t=t||{}).type=n.PARTICLE,n.call(this,t)}(((e.exports=r).prototype=new n).constructor=r).prototype.computeMomentOfInertia=function(t){return 0},r.prototype.updateBoundingRadius=function(){this.boundingRadius=0},r.prototype.computeAABB=function(t,e,i){o.copy(t.lowerBound,e),o.copy(t.upperBound,e)}},{"../math/vec2":30,"./Shape":45}],44:[function(t,e,i){var n=t("./Shape"),d=t("../math/vec2");t("../utils/Utils");function o(t){(t=t||{}).type=n.PLANE,n.call(this,t)}(((e.exports=o).prototype=new n).constructor=o).prototype.computeMomentOfInertia=function(t){return 0},o.prototype.updateBoundingRadius=function(){this.boundingRadius=Number.MAX_VALUE},o.prototype.computeAABB=function(t,e,i){var n=i%(2*Math.PI),o=d.set,r=t.lowerBound,s=t.upperBound;o(r,-1e7,-1e7),o(s,1e7,1e7),0===n?s[1]=0:n===Math.PI/2?r[0]=0:n===Math.PI?r[1]=0:n===3*Math.PI/2&&(s[0]=0)},o.prototype.updateArea=function(){this.area=Number.MAX_VALUE};var f=d.create(),y=(d.create(),d.create(),d.create()),g=d.create();o.prototype.raycast=function(t,e,i,n){var o=e.from,r=e.to,s=e.direction,a=f,h=y,c=g;d.set(h,0,1),d.rotate(h,h,n),d.sub(c,o,i);var l=d.dot(c,h);if(d.sub(c,r,i),!(0<l*d.dot(c,h)||d.squaredDistance(o,r)<l*l)){var u=d.dot(h,s);d.sub(a,o,i);var p=-d.dot(h,a)/u/e.length;e.reportIntersection(t,p,h,-1)}}},{"../math/vec2":30,"../utils/Utils":57,"./Shape":45}],45:[function(t,e,i){e.exports=o;var n=t("../math/vec2");function o(t){t=t||{},this.body=null,this.position=n.fromValues(0,0),t.position&&n.copy(this.position,t.position),this.angle=t.angle||0,this.type=t.type||0,this.id=o.idCounter++,this.boundingRadius=0,this.collisionGroup=void 0!==t.collisionGroup?t.collisionGroup:1,this.collisionResponse=void 0===t.collisionResponse||t.collisionResponse,this.collisionMask=void 0!==t.collisionMask?t.collisionMask:1,this.material=t.material||null,this.area=0,this.sensor=void 0!==t.sensor&&t.sensor,this.type&&this.updateBoundingRadius(),this.updateArea()}o.idCounter=0,o.CIRCLE=1,o.PARTICLE=2,o.PLANE=4,o.CONVEX=8,o.LINE=16,o.BOX=32,Object.defineProperty(o,"RECTANGLE",{get:function(){return console.warn("Shape.RECTANGLE is deprecated, use Shape.BOX instead."),o.BOX}}),o.CAPSULE=64,o.HEIGHTFIELD=128,o.prototype.computeMomentOfInertia=function(t){},o.prototype.updateBoundingRadius=function(){},o.prototype.updateArea=function(){},o.prototype.computeAABB=function(t,e,i){},o.prototype.raycast=function(t,e,i,n){}},{"../math/vec2":30}],46:[function(t,e,i){var I=t("../math/vec2"),n=t("./Solver"),w=t("../utils/Utils"),x=t("../equations/FrictionEquation");function C(t){n.call(this,t,n.GS),t=t||{},this.iterations=t.iterations||10,this.tolerance=t.tolerance||1e-7,this.arrayStep=30,this.lambda=new w.ARRAY_TYPE(this.arrayStep),this.Bs=new w.ARRAY_TYPE(this.arrayStep),this.invCs=new w.ARRAY_TYPE(this.arrayStep),this.useZeroRHS=!1,this.frictionIterations=void 0!==t.frictionIterations?0:t.frictionIterations,this.usedIterations=0}(((e.exports=C).prototype=new n).constructor=C).prototype.solve=function(t,e){this.sortEquations();var i=0,n=this.iterations,o=this.frictionIterations,r=this.equations,s=r.length,a=Math.pow(this.tolerance*s,2),h=e.bodies,c=e.bodies.length,l=(I.add,I.set,this.useZeroRHS),u=this.lambda;if(this.usedIterations=0,s)for(var p=0;p!==c;p++){h[p].updateSolveMassProperties()}u.length<s&&(u=this.lambda=new w.ARRAY_TYPE(s+this.arrayStep),this.Bs=new w.ARRAY_TYPE(s+this.arrayStep),this.invCs=new w.ARRAY_TYPE(s+this.arrayStep)),function(t){for(var e=t.length;e--;)t[e]=0}(u);var d,f,y=this.invCs,g=this.Bs;for(u=this.lambda,p=0;p!==r.length;p++){var m;((m=r[p]).timeStep!==t||m.needsUpdate)&&(m.timeStep=t,m.update()),g[p]=m.computeB(m.a,m.b,t),y[p]=m.computeInvC(m.epsilon)}if(0!==s){for(p=0;p!==c;p++){h[p].resetConstraintVelocity()}if(o){for(i=0;i!==o;i++){for(f=d=0;f!==s;f++){m=r[f];var v=C.iterateEquation(f,m,m.epsilon,g,y,u,l,t,i);d+=Math.abs(v)}if(this.usedIterations++,d*d<=a)break}for(C.updateMultipliers(r,u,1/t),f=0;f!==s;f++){var S=r[f];if(S instanceof x){for(var _=0,b=0;b!==S.contactEquations.length;b++)_+=S.contactEquations[b].multiplier;_*=S.frictionCoefficient/S.contactEquations.length,S.maxForce=_,S.minForce=-_}}}for(i=0;i!==n;i++){for(f=d=0;f!==s;f++){m=r[f];v=C.iterateEquation(f,m,m.epsilon,g,y,u,l,t,i);d+=Math.abs(v)}if(this.usedIterations++,d*d<=a)break}for(p=0;p!==c;p++)h[p].addConstraintVelocity();C.updateMultipliers(r,u,1/t)}},C.updateMultipliers=function(t,e,i){for(var n=t.length;n--;)t[n].multiplier=e[n]*i},C.iterateEquation=function(t,e,i,n,o,r,s,a,h){var c=n[t],l=o[t],u=r[t],p=e.computeGWlambda(),d=e.maxForce,f=e.minForce;s&&(c=0);var y=l*(c-p-i*u),g=u+y;return g<f*a?y=f*a-u:d*a<g&&(y=d*a-u),r[t]+=y,e.addToWlambda(y),y}},{"../equations/FrictionEquation":23,"../math/vec2":30,"../utils/Utils":57,"./Solver":47}],47:[function(t,e,i){t("../utils/Utils");var n=t("../events/EventEmitter");function o(t,e){t=t||{},n.call(this),this.type=e,this.equations=[],this.equationSortFunction=t.equationSortFunction||!1}(((e.exports=o).prototype=new n).constructor=o).prototype.solve=function(t,e){throw new Error("Solver.solve should be implemented by subclasses!")};var r={bodies:[]};o.prototype.solveIsland=function(t,e){this.removeAllEquations(),e.equations.length&&(this.addEquations(e.equations),r.bodies.length=0,e.getBodies(r.bodies),r.bodies.length&&this.solve(t,r))},o.prototype.sortEquations=function(){this.equationSortFunction&&this.equations.sort(this.equationSortFunction)},o.prototype.addEquation=function(t){t.enabled&&this.equations.push(t)},o.prototype.addEquations=function(t){for(var e=0,i=t.length;e!==i;e++){var n=t[e];n.enabled&&this.equations.push(n)}},o.prototype.removeEquation=function(t){var e=this.equations.indexOf(t);-1!==e&&this.equations.splice(e,1)},o.prototype.removeAllEquations=function(){this.equations.length=0},o.GS=1,o.ISLAND=2},{"../events/EventEmitter":26,"../utils/Utils":57}],48:[function(t,e,i){var n=t("../equations/ContactEquation"),o=t("./Pool");function r(){o.apply(this,arguments)}(((e.exports=r).prototype=new o).constructor=r).prototype.create=function(){return new n},r.prototype.destroy=function(t){return t.bodyA=t.bodyB=null,this}},{"../equations/ContactEquation":21,"./Pool":55}],49:[function(t,e,i){var n=t("../equations/FrictionEquation"),o=t("./Pool");function r(){o.apply(this,arguments)}(((e.exports=r).prototype=new o).constructor=r).prototype.create=function(){return new n},r.prototype.destroy=function(t){return t.bodyA=t.bodyB=null,this}},{"../equations/FrictionEquation":23,"./Pool":55}],50:[function(t,e,i){var n=t("../world/IslandNode"),o=t("./Pool");function r(){o.apply(this,arguments)}(((e.exports=r).prototype=new o).constructor=r).prototype.create=function(){return new n},r.prototype.destroy=function(t){return t.reset(),this}},{"../world/IslandNode":60,"./Pool":55}],51:[function(t,e,i){var n=t("../world/Island"),o=t("./Pool");function r(){o.apply(this,arguments)}(((e.exports=r).prototype=new o).constructor=r).prototype.create=function(){return new n},r.prototype.destroy=function(t){return t.reset(),this}},{"../world/Island":58,"./Pool":55}],52:[function(t,e,i){var n=t("./TupleDictionary"),o=(t("./OverlapKeeperRecord"),t("./OverlapKeeperRecordPool"));t("./Utils");function r(){this.overlappingShapesLastState=new n,this.overlappingShapesCurrentState=new n,this.recordPool=new o({size:16}),this.tmpDict=new n,this.tmpArray1=[]}(e.exports=r).prototype.tick=function(){for(var t=this.overlappingShapesLastState,e=this.overlappingShapesCurrentState,i=t.keys.length;i--;){var n=t.keys[i],o=t.getByKey(n);e.getByKey(n);o&&this.recordPool.release(o)}t.reset(),t.copy(e),e.reset()},r.prototype.setOverlapping=function(t,e,i,n){this.overlappingShapesLastState;var o=this.overlappingShapesCurrentState;if(!o.get(e.id,n.id)){var r=this.recordPool.get();r.set(t,e,i,n),o.set(e.id,n.id,r)}},r.prototype.getNewOverlaps=function(t){return this.getDiff(this.overlappingShapesLastState,this.overlappingShapesCurrentState,t)},r.prototype.getEndOverlaps=function(t){return this.getDiff(this.overlappingShapesCurrentState,this.overlappingShapesLastState,t)},r.prototype.bodiesAreOverlapping=function(t,e){for(var i=this.overlappingShapesCurrentState,n=i.keys.length;n--;){var o=i.keys[n],r=i.data[o];if(r.bodyA===t&&r.bodyB===e||r.bodyA===e&&r.bodyB===t)return!0}return!1},r.prototype.getDiff=function(t,e,i){var n=t,o=e;(i=i||[]).length=0;for(var r=o.keys.length;r--;){var s=o.keys[r],a=o.data[s];if(!a)throw new Error("Key "+s+" had no data!");n.data[s]||i.push(a)}return i},r.prototype.isNewOverlap=function(t,e){var i=0|t.id,n=0|e.id,o=this.overlappingShapesLastState,r=this.overlappingShapesCurrentState;return!o.get(i,n)&&!!r.get(i,n)},r.prototype.getNewBodyOverlaps=function(t){this.tmpArray1.length=0;var e=this.getNewOverlaps(this.tmpArray1);return this.getBodyDiff(e,t)},r.prototype.getEndBodyOverlaps=function(t){this.tmpArray1.length=0;var e=this.getEndOverlaps(this.tmpArray1);return this.getBodyDiff(e,t)},r.prototype.getBodyDiff=function(t,e){e=e||[];for(var i=this.tmpDict,n=t.length;n--;){var o=t[n];i.set(0|o.bodyA.id,0|o.bodyB.id,o)}for(n=i.keys.length;n--;){(o=i.getByKey(i.keys[n]))&&e.push(o.bodyA,o.bodyB)}return i.reset(),e}},{"./OverlapKeeperRecord":53,"./OverlapKeeperRecordPool":54,"./TupleDictionary":56,"./Utils":57}],53:[function(t,e,i){function o(t,e,i,n){this.shapeA=e,this.shapeB=n,this.bodyA=t,this.bodyB=i}(e.exports=o).prototype.set=function(t,e,i,n){o.call(this,t,e,i,n)}},{}],54:[function(t,e,i){var n=t("./OverlapKeeperRecord"),o=t("./Pool");function r(){o.apply(this,arguments)}(((e.exports=r).prototype=new o).constructor=r).prototype.create=function(){return new n},r.prototype.destroy=function(t){return t.bodyA=t.bodyB=t.shapeA=t.shapeB=null,this}},{"./OverlapKeeperRecord":53,"./Pool":55}],55:[function(t,e,i){function n(t){t=t||{},this.objects=[],void 0!==t.size&&this.resize(t.size)}(e.exports=n).prototype.resize=function(t){for(var e=this.objects;e.length>t;)e.pop();for(;e.length<t;)e.push(this.create());return this},n.prototype.get=function(){var t=this.objects;return t.length?t.pop():this.create()},n.prototype.release=function(t){return this.destroy(t),this.objects.push(t),this}},{}],56:[function(t,e,i){var n=t("./Utils");function o(){this.data={},this.keys=[]}(e.exports=o).prototype.getKey=function(t,e){return(0|(t|=0))==(0|(e|=0))?-1:0|((0|e)<(0|t)?t<<16|65535&e:e<<16|65535&t)},o.prototype.getByKey=function(t){return t|=0,this.data[t]},o.prototype.get=function(t,e){return this.data[this.getKey(t,e)]},o.prototype.set=function(t,e,i){if(!i)throw new Error("No data!");var n=this.getKey(t,e);return this.data[n]||this.keys.push(n),this.data[n]=i,n},o.prototype.reset=function(){for(var t=this.data,e=this.keys,i=e.length;i--;)delete t[e[i]];e.length=0},o.prototype.copy=function(t){this.reset(),n.appendArray(this.keys,t.keys);for(var e=t.keys.length;e--;){var i=t.keys[e];this.data[i]=t.data[i]}}},{"./Utils":57}],57:[function(t,e,i){function n(){}(e.exports=n).appendArray=function(t,e){if(e.length<15e4)t.push.apply(t,e);else for(var i=0,n=e.length;i!==n;++i)t.push(e[i])},n.splice=function(t,e,i){i=i||1;for(var n=e,o=t.length-i;n<o;n++)t[n]=t[n+i];t.length=o},n.ARRAY_TYPE="undefined"!=typeof P2_ARRAY_TYPE?P2_ARRAY_TYPE:"undefined"!=typeof Float32Array?Float32Array:Array,n.extend=function(t,e){for(var i in e)t[i]=e[i]},n.defaults=function(t,e){for(var i in t=t||{},e)i in t||(t[i]=e[i]);return t}},{}],58:[function(t,e,i){var n=t("../objects/Body");function o(){this.equations=[],this.bodies=[]}(e.exports=o).prototype.reset=function(){this.equations.length=this.bodies.length=0};var r=[];o.prototype.getBodies=function(t){for(var e=t||[],i=this.equations,n=r.length=0;n!==i.length;n++){var o=i[n];-1===r.indexOf(o.bodyA.id)&&(e.push(o.bodyA),r.push(o.bodyA.id)),-1===r.indexOf(o.bodyB.id)&&(e.push(o.bodyB),r.push(o.bodyB.id))}return e},o.prototype.wantsToSleep=function(){for(var t=0;t<this.bodies.length;t++){var e=this.bodies[t];if(e.type===n.DYNAMIC&&!e.wantsToSleep)return!1}return!0},o.prototype.sleep=function(){for(var t=0;t<this.bodies.length;t++){this.bodies[t].sleep()}return!0}},{"../objects/Body":31}],59:[function(t,e,i){t("../math/vec2"),t("./Island"),t("./IslandNode");var n=t("./../utils/IslandNodePool"),o=t("./../utils/IslandPool"),s=t("../objects/Body");function f(t){this.nodePool=new n({size:16}),this.islandPool=new o({size:8}),this.equations=[],this.islands=[],this.nodes=[],this.queue=[]}(e.exports=f).getUnvisitedNode=function(t){for(var e=t.length,i=0;i!==e;i++){var n=t[i];if(!n.visited&&n.body.type===s.DYNAMIC)return n}return!1},f.prototype.visit=function(t,e,i){e.push(t.body);for(var n=t.equations.length,o=0;o!==n;o++){var r=t.equations[o];-1===i.indexOf(r)&&i.push(r)}},f.prototype.bfs=function(t,e,i){var n=this.queue;for(n.length=0,n.push(t),t.visited=!0,this.visit(t,e,i);n.length;)for(var o,r=n.pop();o=f.getUnvisitedNode(r.neighbors);)o.visited=!0,this.visit(o,e,i),o.body.type===s.DYNAMIC&&n.push(o)},f.prototype.split=function(t){for(var e=t.bodies,i=this.nodes,n=this.equations;i.length;)this.nodePool.release(i.pop());for(var o=0;o!==e.length;o++){var r=this.nodePool.get();r.body=e[o],i.push(r)}for(var s=0;s!==n.length;s++){var a=n[s],h=(o=e.indexOf(a.bodyA),e.indexOf(a.bodyB)),c=i[o],l=i[h];c.neighbors.push(l),l.neighbors.push(c),c.equations.push(a),l.equations.push(a)}var u,p=this.islands;for(o=0;o<p.length;o++)this.islandPool.release(p[o]);for(p.length=0;u=f.getUnvisitedNode(i);){var d=this.islandPool.get();this.bfs(u,d.bodies,d.equations),p.push(d)}return p}},{"../math/vec2":30,"../objects/Body":31,"./../utils/IslandNodePool":50,"./../utils/IslandPool":51,"./Island":58,"./IslandNode":60}],60:[function(t,e,i){function n(t){this.body=t,this.neighbors=[],this.equations=[],this.visited=!1}(e.exports=n).prototype.reset=function(){this.equations.length=0,this.neighbors.length=0,this.visited=!1,this.body=null}},{}],61:[function(t,e,i){var n=t("../solver/GSSolver"),j=(t("../solver/Solver"),t("../collision/Ray"),t("../math/vec2")),m=t("../shapes/Circle"),v=t("../shapes/Convex"),S=(t("../shapes/Line"),t("../shapes/Plane")),_=t("../shapes/Capsule"),b=t("../shapes/Particle"),o=t("../events/EventEmitter"),Y=t("../objects/Body"),r=(t("../shapes/Shape"),t("../objects/LinearSpring"),t("../material/Material")),s=t("../material/ContactMaterial"),a=(t("../constraints/DistanceConstraint"),t("../constraints/Constraint"),t("../constraints/LockConstraint"),t("../constraints/RevoluteConstraint"),t("../constraints/PrismaticConstraint"),t("../constraints/GearConstraint"),t("../../package.json"),t("../collision/Broadphase"),t("../collision/AABB")),h=t("../collision/SAPBroadphase"),c=t("../collision/Narrowphase"),W=t("../utils/Utils"),l=t("../utils/OverlapKeeper"),u=t("./IslandManager");t("../objects/RotationalSpring");function X(t){o.apply(this),t=t||{},this.springs=[],this.bodies=[],this.disabledBodyCollisionPairs=[],this.solver=t.solver||new n,this.narrowphase=new c(this),this.islandManager=new u,this.gravity=j.fromValues(0,-9.78),t.gravity&&j.copy(this.gravity,t.gravity),this.frictionGravity=j.length(this.gravity)||10,this.useWorldGravityAsFrictionGravity=!0,this.useFrictionGravityOnZeroGravity=!0,this.broadphase=t.broadphase||new h,this.broadphase.setWorld(this),this.constraints=[],this.defaultMaterial=new r,this.defaultContactMaterial=new s(this.defaultMaterial,this.defaultMaterial),this.lastTimeStep=1/60,this.applySpringForces=!0,this.applyDamping=!0,this.applyGravity=!0,this.solveConstraints=!0,this.contactMaterials=[],this.time=0,this.accumulator=0,this.stepping=!1,this.bodiesToBeRemoved=[],this.islandSplit=void 0===t.islandSplit||!!t.islandSplit,this.emitImpactEvent=!0,this._constraintIdCounter=0,this._bodyIdCounter=0,this.postStepEvent={type:"postStep"},this.addBodyEvent={type:"addBody",body:null},this.removeBodyEvent={type:"removeBody",body:null},this.addSpringEvent={type:"addSpring",spring:null},this.impactEvent={type:"impact",bodyA:null,bodyB:null,shapeA:null,shapeB:null,contactEquation:null},this.postBroadphaseEvent={type:"postBroadphase",pairs:null},this.sleepMode=X.NO_SLEEPING,this.beginContactEvent={type:"beginContact",shapeA:null,shapeB:null,bodyA:null,bodyB:null,contactEquations:[]},this.endContactEvent={type:"endContact",shapeA:null,shapeB:null,bodyA:null,bodyB:null},this.preSolveEvent={type:"preSolve",contactEquations:null,frictionEquations:null},this.overlappingShapesLastState={keys:[]},this.overlappingShapesCurrentState={keys:[]},this.overlapKeeper=new l}(((e.exports=X).prototype=new Object(o.prototype)).constructor=X).NO_SLEEPING=1,X.BODY_SLEEPING=2,X.ISLAND_SLEEPING=4,X.prototype.addConstraint=function(t){this.constraints.push(t)},X.prototype.addContactMaterial=function(t){this.contactMaterials.push(t)},X.prototype.removeContactMaterial=function(t){var e=this.contactMaterials.indexOf(t);-1!==e&&W.splice(this.contactMaterials,e,1)},X.prototype.getContactMaterial=function(t,e){for(var i=this.contactMaterials,n=0,o=i.length;n!==o;n++){var r=i[n];if(r.materialA.id===t.id&&r.materialB.id===e.id||r.materialA.id===e.id&&r.materialB.id===t.id)return r}return!1},X.prototype.removeConstraint=function(t){var e=this.constraints.indexOf(t);-1!==e&&W.splice(this.constraints,e,1)};j.create(),j.create(),j.create(),j.create(),j.create(),j.create();var K=j.create(),x=j.fromValues(0,0),C=j.fromValues(0,0);j.fromValues(0,0),j.fromValues(0,0);X.prototype.step=function(t,e,i){if(i=i||10,0===(e=e||0))this.internalStep(t),this.time+=t;else{this.accumulator+=e;for(var n=0;this.accumulator>=t&&n<i;)this.internalStep(t),this.time+=t,this.accumulator-=t,n++;for(var o=this.accumulator%t/t,r=0;r!==this.bodies.length;r++){var s=this.bodies[r];j.lerp(s.interpolatedPosition,s.previousPosition,s.position,o),s.interpolatedAngle=s.previousAngle+o*(s.angle-s.previousAngle)}}};var J=[];X.prototype.internalStep=function(t){this.stepping=!0;var e=this.springs.length,i=this.springs,n=this.bodies,o=this.gravity,r=this.solver,s=this.bodies.length,a=this.broadphase,h=this.narrowphase,c=this.constraints,l=K,u=(j.scale,j.add),p=(j.rotate,this.islandManager);if(this.overlapKeeper.tick(),this.lastTimeStep=t,this.useWorldGravityAsFrictionGravity){var d=j.length(this.gravity);0===d&&this.useFrictionGravityOnZeroGravity||(this.frictionGravity=d)}if(this.applyGravity)for(var f=0;f!==s;f++){var y=(g=n[f]).force;g.type===Y.DYNAMIC&&g.sleepState!==Y.SLEEPING&&(j.scale(l,o,g.mass*g.gravityScale),u(y,y,l))}if(this.applySpringForces)for(f=0;f!==e;f++){i[f].applyForce()}if(this.applyDamping)for(f=0;f!==s;f++){var g;(g=n[f]).type===Y.DYNAMIC&&g.applyDamping(t)}var m=a.getCollisionPairs(this),v=this.disabledBodyCollisionPairs;for(f=v.length-2;0<=f;f-=2)for(var S=m.length-2;0<=S;S-=2)(v[f]===m[S]&&v[f+1]===m[S+1]||v[f+1]===m[S]&&v[f]===m[S+1])&&m.splice(S,2);var _=c.length;for(f=0;f!==_;f++){var b=c[f];if(!b.collideConnected)for(S=m.length-2;0<=S;S-=2)(b.bodyA===m[S]&&b.bodyB===m[S+1]||b.bodyB===m[S]&&b.bodyA===m[S+1])&&m.splice(S,2)}this.postBroadphaseEvent.pairs=m,this.emit(this.postBroadphaseEvent),this.postBroadphaseEvent.pairs=null,h.reset(this);f=0;for(var I=m.length;f!==I;f+=2)for(var w=m[f],x=m[f+1],C=0,A=w.shapes.length;C!==A;C++)for(var E=w.shapes[C],T=E.position,L=E.angle,P=0,D=x.shapes.length;P!==D;P++){var M=x.shapes[P],R=M.position,O=M.angle,N=this.defaultContactMaterial;if(E.material&&M.material){var B=this.getContactMaterial(E.material,M.material);B&&(N=B)}this.runNarrowphase(h,w,E,T,L,x,M,R,O,N,this.frictionGravity)}for(f=0;f!==s;f++){(H=n[f])._wakeUpAfterNarrowphase&&(H.wakeUp(),H._wakeUpAfterNarrowphase=!1)}if(this.has("endContact")){this.overlapKeeper.getEndOverlaps(J);var F=this.endContactEvent;for(P=J.length;P--;){var k=J[P];F.shapeA=k.shapeA,F.shapeB=k.shapeB,F.bodyA=k.bodyA,F.bodyB=k.bodyB,this.emit(F)}J.length=0}var G=this.preSolveEvent;G.contactEquations=h.contactEquations,G.frictionEquations=h.frictionEquations,this.emit(G),G.contactEquations=G.frictionEquations=null;_=c.length;for(f=0;f!==_;f++)c[f].update();if(h.contactEquations.length||h.frictionEquations.length||_)if(this.islandSplit){for(p.equations.length=0,W.appendArray(p.equations,h.contactEquations),W.appendArray(p.equations,h.frictionEquations),f=0;f!==_;f++)W.appendArray(p.equations,c[f].equations);p.split(this);for(f=0;f!==p.islands.length;f++){(z=p.islands[f]).equations.length&&r.solveIsland(t,z)}}else{for(r.addEquations(h.contactEquations),r.addEquations(h.frictionEquations),f=0;f!==_;f++)r.addEquations(c[f].equations);this.solveConstraints&&r.solve(t,this),r.removeAllEquations()}for(f=0;f!==s;f++){var H;(H=n[f]).integrate(t)}for(f=0;f!==s;f++)n[f].setZeroForce();if(this.emitImpactEvent&&this.has("impact")){var q=this.impactEvent;for(f=0;f!==h.contactEquations.length;f++){var U=h.contactEquations[f];U.firstImpact&&(q.bodyA=U.bodyA,q.bodyB=U.bodyB,q.shapeA=U.shapeA,q.shapeB=U.shapeB,q.contactEquation=U,this.emit(q))}}if(this.sleepMode===X.BODY_SLEEPING)for(f=0;f!==s;f++)n[f].sleepTick(this.time,!1,t);else if(this.sleepMode===X.ISLAND_SLEEPING&&this.islandSplit){for(f=0;f!==s;f++)n[f].sleepTick(this.time,!0,t);for(f=0;f<this.islandManager.islands.length;f++){var z;(z=this.islandManager.islands[f]).wantsToSleep()&&z.sleep()}}this.stepping=!1;var V=this.bodiesToBeRemoved;for(f=0;f!==V.length;f++)this.removeBody(V[f]);V.length=0,this.emit(this.postStepEvent)},X.prototype.runNarrowphase=function(t,e,i,n,o,r,s,a,h,c,l){if(0!=(i.collisionGroup&s.collisionMask)&&0!=(s.collisionGroup&i.collisionMask)){j.rotate(x,n,e.angle),j.rotate(C,a,r.angle),j.add(x,x,e.position),j.add(C,C,r.position);var u,p=o+e.angle,d=h+r.angle;t.enableFriction=0<c.friction,t.frictionCoefficient=c.friction,u=e.type===Y.STATIC||e.type===Y.KINEMATIC?r.mass:r.type===Y.STATIC||r.type===Y.KINEMATIC?e.mass:e.mass*r.mass/(e.mass+r.mass),t.slipForce=c.friction*l*u,t.restitution=c.restitution,t.surfaceVelocity=c.surfaceVelocity,t.frictionStiffness=c.frictionStiffness,t.frictionRelaxation=c.frictionRelaxation,t.stiffness=c.stiffness,t.relaxation=c.relaxation,t.contactSkinSize=c.contactSkinSize,t.enabledEquations=e.collisionResponse&&r.collisionResponse&&i.collisionResponse&&s.collisionResponse;var f=t[i.type|s.type],y=0;if(f){var g=i.sensor||s.sensor,m=t.frictionEquations.length;y=i.type<s.type?f.call(t,e,i,x,p,r,s,C,d,g):f.call(t,r,s,C,d,e,i,x,p,g);var v=t.frictionEquations.length-m;if(y){if(e.allowSleep&&e.type===Y.DYNAMIC&&e.sleepState===Y.SLEEPING&&r.sleepState===Y.AWAKE&&r.type!==Y.STATIC){var S=j.squaredLength(r.velocity)+Math.pow(r.angularVelocity,2);2*Math.pow(r.sleepSpeedLimit,2)<=S&&(e._wakeUpAfterNarrowphase=!0)}if(r.allowSleep&&r.type===Y.DYNAMIC&&r.sleepState===Y.SLEEPING&&e.sleepState===Y.AWAKE&&e.type!==Y.STATIC){var _=j.squaredLength(e.velocity)+Math.pow(e.angularVelocity,2);2*Math.pow(e.sleepSpeedLimit,2)<=_&&(r._wakeUpAfterNarrowphase=!0)}if(this.overlapKeeper.setOverlapping(e,i,r,s),this.has("beginContact")&&this.overlapKeeper.isNewOverlap(i,s)){var b=this.beginContactEvent;if(b.shapeA=i,b.shapeB=s,b.bodyA=e,b.bodyB=r,b.contactEquations.length=0,"number"==typeof y)for(var I=t.contactEquations.length-y;I<t.contactEquations.length;I++)b.contactEquations.push(t.contactEquations[I]);this.emit(b)}if("number"==typeof y&&1<v)for(I=t.frictionEquations.length-v;I<t.frictionEquations.length;I++){var w=t.frictionEquations[I];w.setSlipForce(w.getSlipForce()/v)}}}}},X.prototype.addSpring=function(t){this.springs.push(t);var e=this.addSpringEvent;e.spring=t,this.emit(e),e.spring=null},X.prototype.removeSpring=function(t){var e=this.springs.indexOf(t);-1!==e&&W.splice(this.springs,e,1)},X.prototype.addBody=function(t){if(-1===this.bodies.indexOf(t)){this.bodies.push(t);var e=(t.world=this).addBodyEvent;e.body=t,this.emit(e),e.body=null}},X.prototype.removeBody=function(t){if(this.stepping)this.bodiesToBeRemoved.push(t);else{t.world=null;var e=this.bodies.indexOf(t);-1!==e&&(W.splice(this.bodies,e,1),(this.removeBodyEvent.body=t).resetConstraintVelocity(),this.emit(this.removeBodyEvent),this.removeBodyEvent.body=null)}},X.prototype.getBodyById=function(t){for(var e=this.bodies,i=0;i<e.length;i++){var n=e[i];if(n.id===t)return n}return!1},X.prototype.disableBodyCollision=function(t,e){this.disabledBodyCollisionPairs.push(t,e)},X.prototype.enableBodyCollision=function(t,e){for(var i=this.disabledBodyCollisionPairs,n=0;n<i.length;n+=2)if(i[n]===t&&i[n+1]===e||i[n+1]===t&&i[n]===e)return void i.splice(n,2)},X.prototype.clear=function(){this.time=0,this.solver&&this.solver.equations.length&&this.solver.removeAllEquations();for(var t=this.constraints,e=t.length-1;0<=e;e--)this.removeConstraint(t[e]);var i=this.bodies;for(e=i.length-1;0<=e;e--)this.removeBody(i[e]);var n=this.springs;for(e=n.length-1;0<=e;e--)this.removeSpring(n[e]);var o=this.contactMaterials;for(e=o.length-1;0<=e;e--)this.removeContactMaterial(o[e]);X.apply(this)};var I=j.create(),w=(j.fromValues(0,0),j.fromValues(0,0));X.prototype.hitTest=function(t,e,i){i=i||0;var n=new Y({position:t}),o=new b,r=t,s=I,a=w;n.addShape(o);for(var h=this.narrowphase,c=[],l=0,u=e.length;l!==u;l++)for(var p=e[l],d=0,f=p.shapes.length;d!==f;d++){var y=p.shapes[d];j.rotate(s,y.position,p.angle),j.add(s,s,p.position);var g=y.angle+p.angle;(y instanceof m&&h.circleParticle(p,y,s,g,n,o,r,0,!0)||y instanceof v&&h.particleConvex(n,o,r,0,p,y,s,g,!0)||y instanceof S&&h.particlePlane(n,o,r,0,p,y,s,g,!0)||y instanceof _&&h.particleCapsule(n,o,r,0,p,y,s,g,!0)||y instanceof b&&j.squaredLength(j.sub(a,s,t))<i*i)&&c.push(p)}return c},X.prototype.setGlobalStiffness=function(t){for(var e=this.constraints,i=0;i!==e.length;i++)for(var n=e[i],o=0;o!==n.equations.length;o++){var r=n.equations[o];r.stiffness=t,r.needsUpdate=!0}var s=this.contactMaterials;for(i=0;i!==s.length;i++){(n=s[i]).stiffness=n.frictionStiffness=t}(n=this.defaultContactMaterial).stiffness=n.frictionStiffness=t},X.prototype.setGlobalRelaxation=function(t){for(var e=0;e!==this.constraints.length;e++)for(var i=this.constraints[e],n=0;n!==i.equations.length;n++){var o=i.equations[n];o.relaxation=t,o.needsUpdate=!0}for(e=0;e!==this.contactMaterials.length;e++){(i=this.contactMaterials[e]).relaxation=i.frictionRelaxation=t}(i=this.defaultContactMaterial).relaxation=i.frictionRelaxation=t};var p=new a,d=[];X.prototype.raycast=function(t,e){return e.getAABB(p),this.broadphase.aabbQuery(this,p,d),e.intersectBodies(t,d),d.length=0,t.hasHit()}},{"../../package.json":6,"../collision/AABB":7,"../collision/Broadphase":8,"../collision/Narrowphase":10,"../collision/Ray":11,"../collision/SAPBroadphase":13,"../constraints/Constraint":14,"../constraints/DistanceConstraint":15,"../constraints/GearConstraint":16,"../constraints/LockConstraint":17,"../constraints/PrismaticConstraint":18,"../constraints/RevoluteConstraint":19,"../events/EventEmitter":26,"../material/ContactMaterial":27,"../material/Material":28,"../math/vec2":30,"../objects/Body":31,"../objects/LinearSpring":32,"../objects/RotationalSpring":33,"../shapes/Capsule":38,"../shapes/Circle":39,"../shapes/Convex":40,"../shapes/Line":42,"../shapes/Particle":43,"../shapes/Plane":44,"../shapes/Shape":45,"../solver/GSSolver":46,"../solver/Solver":47,"../utils/OverlapKeeper":52,"../utils/Utils":57,"./IslandManager":59}]},{},[36])(36)}),function(){var r="undefined"!=typeof window&&void 0!==window.document?window.document:{},t="undefined"!=typeof module&&module.exports,i="undefined"!=typeof Element&&"ALLOW_KEYBOARD_INPUT"in Element,n=function(){for(var t,e=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],i=0,n=e.length,o={};i<n;i++)if((t=e[i])&&t[1]in r){for(i=0;i<t.length;i++)o[e[0][i]]=t[i];return o}return!1}(),o={change:n.fullscreenchange,error:n.fullscreenerror},e={request:function(t){var e=n.requestFullscreen;t=t||r.documentElement,/ Version\/5\.1(?:\.\d+)? Safari\//.test(navigator.userAgent)?t[e]():t[e](i&&Element.ALLOW_KEYBOARD_INPUT)},exit:function(){r[n.exitFullscreen]()},toggle:function(t){this.isFullscreen?this.exit():this.request(t)},onchange:function(t){this.on("change",t)},onerror:function(t){this.on("error",t)},on:function(t,e){var i=o[t];i&&r.addEventListener(i,e,!1)},off:function(t,e){var i=o[t];i&&r.removeEventListener(i,e,!1)},raw:n};n?(Object.defineProperties(e,{isFullscreen:{get:function(){return Boolean(r[n.fullscreenElement])}},element:{enumerable:!0,get:function(){return r[n.fullscreenElement]}},enabled:{enumerable:!0,get:function(){return Boolean(r[n.fullscreenEnabled])}}}),t?module.exports=e:window.screenfull=e):t?module.exports=!1:window.screenfull=!1}();var GAME;__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(o){var t=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.loadSounds=function(t,e){new h5ge.Loader(t).load(function(t){e(t)})},t.prototype.registerSoundsheet=function(t,e){var i=h5ge.JSONS.safeJson(e);if(null!=i){i.src=i.urls;var n=new Howl(i);o.logger.debug("Registering sound: "+t),this.addSoundSprite(t,new h5ge.Sound(n))}},t.prototype.onVisibilityChange=function(t){t?(this._musicWasEnable&&o.SoundManager.unmuteMusics(),this._soundWasEnable&&o.SoundManager.unmuteSounds()):(this._musicWasEnable=o.Player.getMusicsEnable(),this._soundWasEnable=o.Player.getSoundsEnable(),this._musicWasEnable&&o.SoundManager.muteMusics(),this._soundWasEnable&&o.SoundManager.muteSounds())},t}(h5ge.AudioManager);o.AudioManager=t}(GAME||(GAME={})),function(n){var t=function(){function t(){}return t.load=function(e){var i=this;n.shipi.gs.playerManager.getPlayer(function(t){i.player=t,i._init(),i.loadHandler.fire(),e&&e()})},t.onLoaded=function(t){null==this.player?this.loadHandler.once(t):t()},t.get=function(){return this.player},t.getDF=function(t,e){if(null==this.player)return e;if(null==this.player.getDF())return e;var i=this.player.getDF().get(t);return null==i?e:i},t.setDF=function(t,e){null!=this.player&&(null==this.player.getDF()&&this.player.setDF(new gs.NMap),this.player.getDF().put(t,e))},t.getBestScore=function(){return n.shipi.gs.scoreManager.getBestScore("best")},t.setBestScore=function(t){n.shipi.gs.scoreManager.submitScore("best",t)},t.setSoundsEnable=function(t){this.setDF("SoundsEnabled",t)},t.getSoundsEnable=function(){return this.getDF("SoundsEnabled",!0)},t.setMusicsEnable=function(t){this.setDF("MusicsEnabled",t)},t.getMusicsEnable=function(){return this.getDF("MusicsEnabled",!0)},t.setStars=function(t){this.setDF("Stars",t)},t.getStars=function(){return this.getDF("Stars",0)},t.setShowTuto=function(t){this.setDF("ShowTuto",t)},t.getShowTuto=function(){return this.getDF("ShowTuto",!0)},t.save=function(){if(null!=this.player){var t=new gs.SPlayer;t.setDF(this.player.getDF()),n.shipi.gs.playerManager.savePlayerDiff(t)}},t.saveDiff=function(t){n.shipi.gs.playerManager.savePlayerDiff(t)},t._init=function(){if(null!=this.player)ship.util.serverTime()},t.firstRun=!1,t.loadHandler=new h5ge.HandlerCollection,t}();n.Player=t}(GAME||(GAME={})),function(s){var n={rendering:{backgroundColor:0}};s.logger=h5ge.logger,s.random=h5ge.Random,s.layout=h5ge.layout;var t=function(e){function i(){var t=e.call(this,624,1040,n)||this;return i._INSTANCE=t}return __extends(i,e),i.get=function(){return i._INSTANCE},i.prototype.newAudioManager=function(){return new s.AudioManager(this.deviceManager.visibilityManager)},i.prototype.onCreate=function(){var t=navigator.language;if(t){var e=t.split("-");if(e){var i=e[0];h5ge.I18N.setLocale(i)}}s.shipi=new ship.Ship(s.GAMECONFIG);var n=this,o=this.getImages(["game-0.json"]),r=this.newPreloader(o,function(){h5ge.FontLoader.loadAll(s.fonts.fonts),s.shipi.onReady(function(){s.Player.load(function(){s.Player.getSoundsEnable()&&s.SoundManager.loadSounds(function(){}),n.addBackground(),ship.ShipGs.get().playerManager.getPlayer(function(t){var e=t.getLang();e&&h5ge.I18N.setLocale(e),s.GameScene.launch(!0)})})})});r.addProgressListener(s.shipi.setLoadingProgress.bind(s.shipi)),this.switchScene(r),s.shipi.onMuteSound(function(t){t?h5ge.AudioManager.get().mute():h5ge.AudioManager.get().unmute()})},i.prototype.newPreloader=function(t,e){return new s.PreLoadingScene(t,e)},i.prototype.getImages=function(t){for(var e=[],i=this.deviceManager.os.desktop?"game/assets/images":"game/assets/images/mobile",n=0;n<t.length;n++){var o=t[n],r=o.split(".")[0];e.push({type:"spritesheet",name:o,file:i+"/"+r+".png",atlas:i+"/"+r+".json"})}return e},i.prototype.addBackground=function(){var t=new s.Background;this.layers.background.addChild(t),s.layout.centerOnX(t,i.get().bounds),s.layout.centerOnY(t,i.get().bounds)},i.PLAYABLE_AD=!1,i}(h5ge.Game);(new(s.Game=t)).start()}(GAME||(GAME={})),function(e){var t;(t=e.factory||(e.factory={})).newText=function(t,e,i){return void 0===e&&(e=36),void 0===i&&(i="text"),new h5ge.BitmapText(t,i,e)},t.newTextNumber=function(t,e,i,n){return void 0===e&&(e=70),void 0===i&&(i="numbers"),void 0===n&&(n="left"),new h5ge.BitmapText(t,i,e)},t.newHomeBtn=function(){var t=h5ge.ImageButton.fromFrames("buttons/large_circle_buttonv3.png","buttons/large_circle_buttonv3_hover.png","buttons/large_circle_buttonv3_pressed.png");return t.setIcon("buttons/icons/icon_home.png"),t},t.newBtn=function(t){var e=h5ge.ImageButton.fromFrames("buttons/large_circle_buttonv2.png","buttons/large_circle_buttonv2_hover.png","buttons/large_circle_buttonv2_pressed.png");return e.setIcon(t),e},t.newContainer=function(t){return void 0===t&&(t=!0),t?new h5ge.Container(e.Game.get().bounds.width,e.Game.get().bounds.height):new h5ge.Container},t.fadeIn=function(t,e,i,n){void 0===e&&(e=0),void 0===i&&(i=300),void 0===n&&(n=h5ge.easing.easeInQuad);var o=h5ge.TweenManager.get().create(t,"easein");return o.delay(e),o.to({alpha:1},i,n),o.start(),o},t.fadeOut=function(t,e,i,n){void 0===e&&(e=0),void 0===i&&(i=300),void 0===n&&(n=h5ge.easing.easeInQuad);var o=h5ge.TweenManager.get().create(t,"easeout");return o.delay(e),o.to({alpha:0},i,n),o.start(),o},t.blink=function(t){var e=h5ge.TweenManager.get().create(t,"blink");e.to({alpha:.2},750,h5ge.easing.easeInQuad),e.to({alpha:1},750,h5ge.easing.easeOutQuad),e.delay(450),e.repeat(-1),e.start(),t.detachListener.once(function(){e.stop()})},t.newSprite=function(t){return new e.Sprite(h5ge.Texture.fromFrame(t))},t.newRectangle=function(t,e,i){var n=new h5ge.Graphics(t,e);return n.beginFill(i),n.drawRect(0,0,t,e),n.endFill(),n},t.newRoundRect=function(t,e,i,n){var o=new h5ge.Graphics(t,e);return o.beginFill(n),o.drawRoundedRect(0,0,t,e,i),o.endFill(),o},t.newCircle=function(t,e){var i=new h5ge.Graphics(2*t,2*t);return i.beginFill(e),i.drawCircle(0,0,t),i.endFill(),i},t.newPolygon=function(n,t,e,o,r){var i=new h5ge.Graphics(t,e);return i.beginFill(255,.5),i.customDraw(function(t){t.moveTo(o,r);for(var e=0;e<n.length;e++){var i=n[e];t.lineTo(i[0],i[1])}t.closePath()}),i.endFill(),i},t.newBasketWall=function(t){var e=h5ge.Sprite.fromFrame("inner_wall/wall.png");return e.x=-e.width/2,e.y=-e.height/2,e}}(GAME||(GAME={})),function(i){var t=function(){function e(){e.INSTANCE=this,i.AudioManager.get()}return e.loadSounds=function(t){e.soundsReady?t():(this.soundsLoadedCallback=t,e.loading=!0,i.AudioManager.get().loadSounds([{type:"soundsheet",name:"sounds",file:"game/assets/sounds/sounds.json"}],function(){e.sound=i.AudioManager.get().getSoundSprite("sounds"),e.checkSoundsReallyLoaded()}))},e.checkSoundsReallyLoaded=function(){"loaded"===e.sound._howl.state()?(e.soundsReady=!0,e.soundsLoadedCallback()):i.Helper.delay(100,e.checkSoundsReallyLoaded)},e.startPlaying=function(){},e.get=function(){if(null==e.INSTANCE)new e;return e.INSTANCE},e.playMusic=function(t,e){return this.musicsReady?this.musics.play(t,function(){e&&e()}):-1},e.playNetSound=function(){this.netSoundId||(this.netSoundId=this.play(i.Sounds.SND_EV_COLLISION_NET_0,function(){e.netSoundId=null}))},e.playBorderSound=function(){this.borderSoundId||(this.borderSoundId=this.play(i.Sounds.SND_EV_BORDER_BALL_0,function(){e.borderSoundId=null}))},e.play=function(t,e){return this.soundsReady&&0!=i.Player.getSoundsEnable()?this.sound.play(t,function(){e&&e()}):-1},e.loopSound=function(t,e){this.soundsReady&&this.sound.loop(t,e)},e.stopSound=function(t){this.soundsReady&&this.sound.stop(t)},e.setSoundVolume=function(t,e){this.soundsReady&&this.sound.setVolume(t,e)},e.rateSound=function(t,e){this.soundsReady&&this.sound.rate(t,e)},e.playWind=function(){var t="wind_"+this.currentWind;this.windId&&e.stopSound(this.windId),this.windId=e.play(t,function(){5<++e.currentWind&&(e.currentWind=1),i.Helper.timer(50,function(){e.replayWind()}).start()}),this.setSoundVolume(.1,this.windId)},e.replayWind=function(){this.playWind()},e.muteSounds=function(){this.soundsReady&&this.sound.mute()},e.unmuteSounds=function(){this.soundsReady?(this.sound.unmute(),e.playWind()):e.get()},e.muteMusics=function(){this.musicsReady&&this.musics.mute()},e.unmuteMusics=function(){this.musicsReady?this.musics.unmute():e.get()},e.muteAll=function(){this.muteMusics(),this.muteSounds()},e.unmuteAll=function(){i.Player.getMusicsEnable()&&e.unmuteMusics(),i.Player.getSoundsEnable()&&e.unmuteSounds()},e.soundsReady=!1,e.musicsReady=!1,e.loading=!1,e.musicId=null,e.musicLoadedHandler=new h5ge.HandlerCollection,e.netSoundId=null,e.borderSoundId=null,e.windId=-1,e.currentWind=1,e}();i.SoundManager=t}(GAME||(GAME={})),function(t){var e=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){t!=this._x&&(this._x=t,this._transformDirty=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){t!=this._y&&(this._y=t,this._transformDirty=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){t!=this._rotation&&(this._rotation=t,this._transformDirty=!0)},enumerable:!0,configurable:!0}),t}(h5ge.Sprite);t.Sprite=e}(GAME||(GAME={})),function(t){var e=function(){function t(){}return t.SND_BURN_ON_BASKET_TOUCH="burn_on_basket_touch",t.SND_BURN_START="burn_start",t.SND_BUTTON_CLICK="button_click",t.SND_CONFETTI_BURST_1="confetti_burst_1",t.SND_CONFETTI_BURST_2="confetti_burst_2",t.SND_EV_BORDER_BALL_0="ev_border_ball_0",t.SND_EV_BOUNCE_CIRCLE_1="ev_bounce_circle_1",t.SND_EV_COIN="ev_coin",t.SND_EV_COLLISION_NET_0="ev_collision_net_0",t.SND_EV_CONFETTI_MELODY="ev_confetti_melody",t.SND_EV_FIREBALL_RELEASE_1="ev_fireball_release_1",t.SND_EV_GAMEOVER="ev_gameover",t.SND_EV_HOOP_BALL_0="ev_hoop_ball_0",t.SND_EV_RELEASE_HIGH="ev_release_high",t.SND_EV_RELEASE_LOW="ev_release_low",t.SND_EV_RELEASE_MID="ev_release_mid",t.SND_EV_SCORE_BOUNCE="ev_score_bounce",t.SND_EV_SCORE_PERFECT_1="ev_score_perfect_1",t.SND_EV_SCORE_PERFECT_10="ev_score_perfect_10",t.SND_EV_SCORE_PERFECT_2="ev_score_perfect_2",t.SND_EV_SCORE_PERFECT_3="ev_score_perfect_3",t.SND_EV_SCORE_PERFECT_4="ev_score_perfect_4",t.SND_EV_SCORE_PERFECT_5="ev_score_perfect_5",t.SND_EV_SCORE_PERFECT_6="ev_score_perfect_6",t.SND_EV_SCORE_PERFECT_7="ev_score_perfect_7",t.SND_EV_SCORE_PERFECT_8="ev_score_perfect_8",t.SND_EV_SCORE_PERFECT_9="ev_score_perfect_9",t.SND_EV_SCORE_SIMPLE="ev_score_simple",t.SND_EV_STAR_MULTIPLIER_2="ev_star_multiplier_2",t.SND_EV_WALL_OBSTACLE="ev_wall_obstacle",t.SND_OLD_BAD="old/bad",t.SND_OLD_CLICK1="old/click1",t.SND_OLD_GOOD="old/good",t.SND_OLD_SELECT="old/select",t.SND_OLD_WHOOSH1="old/whoosh1",t.SND_OLD_WIN="old/win",t.SND_TIMER_1="timer_1",t.SND_TIMER_2="timer_2",t.SND_TIMER_BUZZ="timer_buzz",t}();t.Sounds=e}(GAME||(GAME={})),function(t){!function(t){t.fonts=[];t.fonts.push({face:"text",size:40,lineHeight:45,chars:[{id:260,x:2,y:2,width:30,height:37,xoffset:0,yoffset:7,xadvance:31},{id:350,x:34,y:2,width:22,height:37,xoffset:1,yoffset:7,xadvance:25},{id:280,x:58,y:2,width:20,height:37,xoffset:3,yoffset:7,xadvance:24},{id:106,x:80,y:2,width:8,height:37,xoffset:0,yoffset:7,xadvance:10},{id:199,x:90,y:2,width:24,height:37,xoffset:2,yoffset:7,xadvance:27},{id:255,x:116,y:2,width:21,height:37,xoffset:0,yoffset:7,xadvance:21},{id:81,x:139,y:2,width:28,height:37,xoffset:2,yoffset:7,xadvance:32},{id:311,x:169,y:2,width:21,height:36,xoffset:2,yoffset:7,xadvance:24},{id:192,x:192,y:2,width:30,height:36,xoffset:0,yoffset:0,xadvance:31},{id:194,x:224,y:2,width:30,height:36,xoffset:0,yoffset:0,xadvance:31},{id:207,x:256,y:2,width:11,height:36,xoffset:0,yoffset:0,xadvance:11},{id:1025,x:269,y:2,width:20,height:36,xoffset:3,yoffset:0,xadvance:24},{id:352,x:291,y:2,width:22,height:36,xoffset:1,yoffset:0,xadvance:25},{id:287,x:315,y:2,width:20,height:36,xoffset:1,yoffset:7,xadvance:23},{id:200,x:337,y:2,width:20,height:36,xoffset:3,yoffset:0,xadvance:24},{id:291,x:359,y:2,width:20,height:36,xoffset:1,yoffset:7,xadvance:23},{id:40,x:381,y:2,width:9,height:36,xoffset:2,yoffset:7,xadvance:13},{id:41,x:392,y:2,width:9,height:36,xoffset:1,yoffset:7,xadvance:13},{id:1065,x:403,y:2,width:37,height:36,xoffset:3,yoffset:7,xadvance:41},{id:1062,x:442,y:2,width:27,height:36,xoffset:3,yoffset:7,xadvance:30},{id:209,x:471,y:2,width:25,height:36,xoffset:3,yoffset:0,xadvance:31},{id:211,x:498,y:2,width:28,height:36,xoffset:2,yoffset:0,xadvance:32},{id:362,x:528,y:2,width:24,height:36,xoffset:3,yoffset:0,xadvance:30},{id:256,x:554,y:2,width:30,height:36,xoffset:0,yoffset:0,xadvance:31},{id:201,x:586,y:2,width:20,height:36,xoffset:3,yoffset:0,xadvance:24},{id:124,x:608,y:2,width:6,height:36,xoffset:3,yoffset:7,xadvance:11},{id:202,x:616,y:2,width:20,height:36,xoffset:3,yoffset:0,xadvance:24},{id:1044,x:638,y:2,width:34,height:36,xoffset:0,yoffset:7,xadvance:35},{id:381,x:674,y:2,width:21,height:36,xoffset:2,yoffset:0,xadvance:24},{id:64,x:697,y:2,width:38,height:36,xoffset:2,yoffset:7,xadvance:42},{id:1092,x:737,y:2,width:30,height:36,xoffset:1,yoffset:7,xadvance:32},{id:203,x:769,y:2,width:20,height:36,xoffset:3,yoffset:0,xadvance:24},{id:379,x:791,y:2,width:21,height:36,xoffset:2,yoffset:0,xadvance:24},{id:205,x:814,y:2,width:9,height:36,xoffset:3,yoffset:0,xadvance:11},{id:123,x:825,y:2,width:12,height:36,xoffset:2,yoffset:7,xadvance:15},{id:125,x:839,y:2,width:12,height:36,xoffset:1,yoffset:7,xadvance:15},{id:91,x:853,y:2,width:11,height:36,xoffset:2,yoffset:7,xadvance:13},{id:93,x:866,y:2,width:11,height:36,xoffset:1,yoffset:7,xadvance:13},{id:377,x:879,y:2,width:21,height:36,xoffset:2,yoffset:0,xadvance:24},{id:206,x:902,y:2,width:10,height:36,xoffset:1,yoffset:0,xadvance:11},{id:290,x:914,y:2,width:24,height:36,xoffset:2,yoffset:7,xadvance:27},{id:196,x:940,y:2,width:30,height:36,xoffset:0,yoffset:0,xadvance:31},{id:316,x:972,y:2,width:9,height:36,xoffset:-1,yoffset:7,xadvance:10},{id:268,x:983,y:2,width:24,height:36,xoffset:2,yoffset:0,xadvance:27},{id:274,x:2,y:43,width:20,height:36,xoffset:3,yoffset:0,xadvance:24},{id:262,x:24,y:43,width:24,height:36,xoffset:2,yoffset:0,xadvance:27},{id:212,x:50,y:43,width:28,height:36,xoffset:2,yoffset:0,xadvance:32},{id:214,x:80,y:43,width:28,height:36,xoffset:2,yoffset:0,xadvance:32},{id:218,x:110,y:43,width:24,height:36,xoffset:3,yoffset:0,xadvance:30},{id:217,x:136,y:43,width:24,height:36,xoffset:3,yoffset:0,xadvance:30},{id:286,x:162,y:43,width:24,height:36,xoffset:2,yoffset:0,xadvance:27},{id:346,x:188,y:43,width:22,height:36,xoffset:1,yoffset:0,xadvance:25},{id:325,x:212,y:43,width:25,height:36,xoffset:3,yoffset:7,xadvance:31},{id:219,x:239,y:43,width:24,height:36,xoffset:3,yoffset:0,xadvance:30},{id:220,x:265,y:43,width:24,height:36,xoffset:3,yoffset:0,xadvance:30},{id:323,x:291,y:43,width:25,height:36,xoffset:3,yoffset:0,xadvance:31},{id:315,x:318,y:43,width:17,height:36,xoffset:3,yoffset:7,xadvance:21},{id:310,x:337,y:43,width:26,height:36,xoffset:3,yoffset:7,xadvance:28},{id:298,x:365,y:43,width:10,height:36,xoffset:1,yoffset:0,xadvance:11},{id:1049,x:377,y:43,width:23,height:35,xoffset:3,yoffset:1,xadvance:29},{id:376,x:402,y:43,width:27,height:35,xoffset:0,yoffset:0,xadvance:25},{id:1073,x:431,y:43,width:22,height:31,xoffset:1,yoffset:5,xadvance:25},{id:121,x:455,y:43,width:21,height:29,xoffset:0,yoffset:15,xadvance:21},{id:1069,x:478,y:43,width:23,height:29,xoffset:2,yoffset:7,xadvance:27},{id:1057,x:503,y:43,width:24,height:29,xoffset:2,yoffset:7,xadvance:27},{id:1047,x:529,y:43,width:19,height:29,xoffset:2,yoffset:7,xadvance:22},{id:67,x:550,y:43,width:24,height:29,xoffset:2,yoffset:7,xadvance:27},{id:49,x:576,y:43,width:8,height:29,xoffset:2,yoffset:7,xadvance:13},{id:1054,x:586,y:43,width:28,height:29,xoffset:2,yoffset:7,xadvance:32},{id:1070,x:616,y:43,width:35,height:29,xoffset:3,yoffset:7,xadvance:39},{id:71,x:653,y:43,width:24,height:29,xoffset:2,yoffset:7,xadvance:27},{id:37,x:679,y:43,width:26,height:29,xoffset:2,yoffset:7,xadvance:29},{id:102,x:707,y:43,width:14,height:29,xoffset:2,yoffset:6,xadvance:13},{id:57,x:723,y:43,width:22,height:29,xoffset:2,yoffset:7,xadvance:25},{id:281,x:747,y:43,width:19,height:29,xoffset:1,yoffset:15,xadvance:22},{id:231,x:768,y:43,width:17,height:29,xoffset:1,yoffset:15,xadvance:19},{id:1091,x:787,y:43,width:21,height:29,xoffset:0,yoffset:15,xadvance:21},{id:351,x:810,y:43,width:18,height:29,xoffset:1,yoffset:15,xadvance:20},{id:79,x:830,y:43,width:28,height:29,xoffset:2,yoffset:7,xadvance:32},{id:56,x:860,y:43,width:22,height:29,xoffset:2,yoffset:7,xadvance:25},{id:54,x:884,y:43,width:22,height:29,xoffset:2,yoffset:7,xadvance:24},{id:48,x:908,y:43,width:25,height:29,xoffset:2,yoffset:7,xadvance:28},{id:83,x:935,y:43,width:22,height:29,xoffset:1,yoffset:7,xadvance:25},{id:51,x:959,y:43,width:19,height:29,xoffset:2,yoffset:7,xadvance:22},{id:261,x:980,y:43,width:19,height:29,xoffset:1,yoffset:15,xadvance:22},{id:84,x:2,y:83,width:22,height:28,xoffset:0,yoffset:7,xadvance:21},{id:87,x:26,y:83,width:36,height:28,xoffset:1,yoffset:7,xadvance:37},{id:74,x:64,y:83,width:11,height:28,xoffset:0,yoffset:7,xadvance:14},{id:33,x:77,y:83,width:6,height:28,xoffset:3,yoffset:7,xadvance:11},{id:82,x:85,y:83,width:24,height:28,xoffset:3,yoffset:7,xadvance:26},{id:88,x:111,y:83,width:29,height:28,xoffset:0,yoffset:7,xadvance:29},{id:224,x:142,y:83,width:19,height:28,xoffset:1,yoffset:7,xadvance:22},{id:226,x:163,y:83,width:19,height:28,xoffset:1,yoffset:7,xadvance:22},{id:228,x:184,y:83,width:19,height:28,xoffset:1,yoffset:7,xadvance:22},{id:80,x:205,y:83,width:21,height:28,xoffset:3,yoffset:7,xadvance:24},{id:78,x:228,y:83,width:25,height:28,xoffset:3,yoffset:7,xadvance:31},{id:233,x:255,y:83,width:19,height:28,xoffset:1,yoffset:7,xadvance:22},{id:90,x:276,y:83,width:21,height:28,xoffset:2,yoffset:7,xadvance:24},{id:235,x:299,y:83,width:19,height:28,xoffset:1,yoffset:7,xadvance:22},{id:89,x:320,y:83,width:27,height:28,xoffset:0,yoffset:7,xadvance:25},{id:223,x:349,y:83,width:21,height:28,xoffset:2,yoffset:7,xadvance:24},{id:239,x:372,y:83,width:11,height:28,xoffset:0,yoffset:7,xadvance:10},{id:241,x:385,y:83,width:19,height:28,xoffset:2,yoffset:7,xadvance:24},{id:243,x:406,y:83,width:21,height:28,xoffset:1,yoffset:7,xadvance:23},{id:77,x:429,y:83,width:30,height:28,xoffset:3,yoffset:7,xadvance:35},{id:246,x:461,y:83,width:21,height:28,xoffset:1,yoffset:7,xadvance:23},{id:250,x:484,y:83,width:19,height:28,xoffset:2,yoffset:7,xadvance:23},{id:249,x:505,y:83,width:19,height:28,xoffset:2,yoffset:7,xadvance:23},{id:251,x:526,y:83,width:19,height:28,xoffset:2,yoffset:7,xadvance:23},{id:252,x:547,y:83,width:19,height:28,xoffset:2,yoffset:7,xadvance:23},{id:53,x:568,y:83,width:19,height:28,xoffset:2,yoffset:7,xadvance:23},{id:257,x:589,y:83,width:19,height:28,xoffset:1,yoffset:7,xadvance:22},{id:232,x:610,y:83,width:19,height:28,xoffset:1,yoffset:7,xadvance:22},{id:234,x:631,y:83,width:19,height:28,xoffset:1,yoffset:7,xadvance:22},{id:269,x:652,y:83,width:17,height:28,xoffset:1,yoffset:7,xadvance:19},{id:275,x:671,y:83,width:19,height:28,xoffset:1,yoffset:7,xadvance:22},{id:75,x:692,y:83,width:26,height:28,xoffset:3,yoffset:7,xadvance:28},{id:76,x:720,y:83,width:17,height:28,xoffset:3,yoffset:7,xadvance:21},{id:72,x:739,y:83,width:24,height:28,xoffset:3,yoffset:7,xadvance:30},{id:299,x:765,y:83,width:10,height:28,xoffset:0,yoffset:7,xadvance:10},{id:237,x:777,y:83,width:9,height:28,xoffset:2,yoffset:7,xadvance:10},{id:70,x:788,y:83,width:19,height:28,xoffset:3,yoffset:7,xadvance:23},{id:322,x:809,y:83,width:11,height:28,xoffset:0,yoffset:7,xadvance:11},{id:324,x:822,y:83,width:19,height:28,xoffset:2,yoffset:7,xadvance:24},{id:238,x:843,y:83,width:10,height:28,xoffset:0,yoffset:7,xadvance:10},{id:347,x:855,y:83,width:18,height:28,xoffset:1,yoffset:7,xadvance:20},{id:244,x:875,y:83,width:21,height:28,xoffset:1,yoffset:7,xadvance:23},{id:353,x:898,y:83,width:18,height:28,xoffset:1,yoffset:7,xadvance:20},{id:363,x:918,y:83,width:19,height:28,xoffset:2,yoffset:7,xadvance:23},{id:378,x:939,y:83,width:17,height:28,xoffset:2,yoffset:7,xadvance:19},{id:380,x:958,y:83,width:17,height:28,xoffset:2,yoffset:7,xadvance:19},{id:382,x:977,y:83,width:17,height:28,xoffset:2,yoffset:7,xadvance:19},{id:69,x:996,y:83,width:20,height:28,xoffset:3,yoffset:7,xadvance:24},{id:263,x:2,y:115,width:17,height:28,xoffset:1,yoffset:7,xadvance:19},{id:68,x:21,y:115,width:25,height:28,xoffset:3,yoffset:7,xadvance:29},{id:66,x:48,y:115,width:22,height:28,xoffset:3,yoffset:7,xadvance:26},{id:65,x:72,y:115,width:30,height:28,xoffset:0,yoffset:7,xadvance:31},{id:1076,x:104,y:115,width:28,height:28,xoffset:0,yoffset:15,xadvance:29},{id:113,x:134,y:115,width:20,height:28,xoffset:1,yoffset:15,xadvance:23},{id:112,x:156,y:115,width:19,height:28,xoffset:2,yoffset:15,xadvance:23},{id:108,x:177,y:115,width:6,height:28,xoffset:2,yoffset:7,xadvance:10},{id:107,x:185,y:115,width:21,height:28,xoffset:2,yoffset:7,xadvance:24},{id:1081,x:208,y:115,width:20,height:28,xoffset:2,yoffset:7,xadvance:25},{id:55,x:230,y:115,width:20,height:28,xoffset:2,yoffset:7,xadvance:23},{id:105,x:252,y:115,width:6,height:28,xoffset:2,yoffset:7,xadvance:10},{id:104,x:260,y:115,width:19,height:28,xoffset:2,yoffset:7,xadvance:24},{id:103,x:281,y:115,width:20,height:28,xoffset:1,yoffset:15,xadvance:23},{id:100,x:303,y:115,width:19,height:28,xoffset:1,yoffset:7,xadvance:23},{id:98,x:324,y:115,width:19,height:28,xoffset:2,yoffset:7,xadvance:23},{id:1088,x:345,y:115,width:20,height:28,xoffset:2,yoffset:15,xadvance:23},{id:38,x:367,y:115,width:24,height:28,xoffset:2,yoffset:7,xadvance:26},{id:36,x:393,y:115,width:18,height:28,xoffset:1,yoffset:7,xadvance:20},{id:73,x:413,y:115,width:6,height:28,xoffset:3,yoffset:7,xadvance:11},{id:35,x:421,y:115,width:33,height:28,xoffset:2,yoffset:7,xadvance:37},{id:92,x:456,y:115,width:20,height:28,xoffset:0,yoffset:7,xadvance:21},{id:1094,x:478,y:115,width:24,height:28,xoffset:2,yoffset:15,xadvance:27},{id:47,x:504,y:115,width:20,height:28,xoffset:0,yoffset:7,xadvance:21},{id:63,x:526,y:115,width:18,height:28,xoffset:2,yoffset:7,xadvance:22},{id:1097,x:546,y:115,width:33,height:28,xoffset:2,yoffset:15,xadvance:36},{id:86,x:581,y:115,width:30,height:28,xoffset:0,yoffset:7,xadvance:30},{id:85,x:613,y:115,width:24,height:28,xoffset:3,yoffset:7,xadvance:30},{id:326,x:639,y:115,width:19,height:28,xoffset:2,yoffset:15,xadvance:24},{id:1066,x:660,y:115,width:32,height:28,xoffset:0,yoffset:7,xadvance:33},{id:1060,x:694,y:115,width:30,height:28,xoffset:2,yoffset:7,xadvance:34},{id:1059,x:726,y:115,width:24,height:28,xoffset:1,yoffset:7,xadvance:26},{id:1105,x:752,y:115,width:19,height:28,xoffset:1,yoffset:7,xadvance:22},{id:1058,x:773,y:115,width:22,height:28,xoffset:0,yoffset:7,xadvance:21},{id:1063,x:797,y:115,width:24,height:28,xoffset:2,yoffset:7,xadvance:27},{id:1056,x:823,y:115,width:21,height:28,xoffset:3,yoffset:7,xadvance:24},{id:52,x:846,y:115,width:23,height:28,xoffset:1,yoffset:7,xadvance:24},{id:1055,x:871,y:115,width:25,height:28,xoffset:3,yoffset:7,xadvance:31},{id:1064,x:898,y:115,width:33,height:28,xoffset:3,yoffset:7,xadvance:39},{id:1053,x:933,y:115,width:25,height:28,xoffset:3,yoffset:7,xadvance:31},{id:1052,x:960,y:115,width:30,height:28,xoffset:3,yoffset:7,xadvance:35},{id:1051,x:992,y:115,width:27,height:28,xoffset:0,yoffset:7,xadvance:30},{id:1050,x:2,y:147,width:24,height:28,xoffset:3,yoffset:7,xadvance:27},{id:50,x:28,y:147,width:19,height:28,xoffset:2,yoffset:7,xadvance:23},{id:1048,x:49,y:147,width:23,height:28,xoffset:3,yoffset:7,xadvance:29},{id:1067,x:74,y:147,width:30,height:28,xoffset:3,yoffset:7,xadvance:33},{id:1046,x:106,y:147,width:43,height:28,xoffset:0,yoffset:7,xadvance:43},{id:1045,x:151,y:147,width:20,height:28,xoffset:3,yoffset:7,xadvance:24},{id:1068,x:173,y:147,width:22,height:28,xoffset:3,yoffset:7,xadvance:25},{id:1043,x:197,y:147,width:19,height:28,xoffset:3,yoffset:7,xadvance:21},{id:1042,x:218,y:147,width:22,height:28,xoffset:3,yoffset:7,xadvance:26},{id:1041,x:242,y:147,width:21,height:28,xoffset:3,yoffset:7,xadvance:25},{id:1040,x:265,y:147,width:30,height:28,xoffset:0,yoffset:7,xadvance:31},{id:1071,x:297,y:147,width:24,height:28,xoffset:0,yoffset:7,xadvance:27},{id:321,x:323,y:147,width:20,height:28,xoffset:3,yoffset:7,xadvance:24},{id:1061,x:345,y:147,width:29,height:28,xoffset:0,yoffset:7,xadvance:29},{id:59,x:376,y:147,width:8,height:26,xoffset:2,yoffset:15,xadvance:12},{id:775,x:386,y:147,width:20,height:25,xoffset:1,yoffset:10,xadvance:22},{id:116,x:408,y:147,width:10,height:24,xoffset:2,yoffset:12,xadvance:13},{id:1086,x:420,y:147,width:22,height:22,xoffset:1,yoffset:14,xadvance:24},{id:118,x:444,y:147,width:21,height:21,xoffset:0,yoffset:15,xadvance:21},{id:117,x:467,y:147,width:19,height:21,xoffset:2,yoffset:15,xadvance:23},{id:120,x:488,y:147,width:21,height:21,xoffset:0,yoffset:15,xadvance:21},{id:115,x:511,y:147,width:18,height:21,xoffset:1,yoffset:15,xadvance:20},{id:122,x:531,y:147,width:17,height:21,xoffset:2,yoffset:15,xadvance:19},{id:114,x:550,y:147,width:11,height:21,xoffset:2,yoffset:15,xadvance:13},{id:111,x:563,y:147,width:21,height:21,xoffset:1,yoffset:15,xadvance:23},{id:110,x:586,y:147,width:19,height:21,xoffset:2,yoffset:15,xadvance:24},{id:1101,x:607,y:147,width:17,height:21,xoffset:1,yoffset:15,xadvance:18},{id:101,x:626,y:147,width:19,height:21,xoffset:1,yoffset:15,xadvance:22},{id:99,x:647,y:147,width:17,height:21,xoffset:1,yoffset:15,xadvance:19},{id:97,x:666,y:147,width:19,height:21,xoffset:1,yoffset:15,xadvance:22},{id:1072,x:687,y:147,width:19,height:21,xoffset:1,yoffset:15,xadvance:22},{id:1074,x:708,y:147,width:19,height:21,xoffset:2,yoffset:15,xadvance:22},{id:1075,x:729,y:147,width:14,height:21,xoffset:2,yoffset:15,xadvance:16},{id:1077,x:745,y:147,width:19,height:21,xoffset:1,yoffset:15,xadvance:22},{id:1078,x:766,y:147,width:36,height:21,xoffset:0,yoffset:15,xadvance:37},{id:119,x:804,y:147,width:30,height:21,xoffset:1,yoffset:15,xadvance:31},{id:1080,x:836,y:147,width:20,height:21,xoffset:2,yoffset:15,xadvance:25},{id:1082,x:858,y:147,width:21,height:21,xoffset:2,yoffset:15,xadvance:23},{id:1083,x:881,y:147,width:22,height:21,xoffset:0,yoffset:15,xadvance:24},{id:1084,x:905,y:147,width:25,height:21,xoffset:2,yoffset:15,xadvance:29},{id:1085,x:932,y:147,width:20,height:21,xoffset:2,yoffset:15,xadvance:25},{id:1079,x:954,y:147,width:15,height:21,xoffset:1,yoffset:15,xadvance:17},{id:1087,x:971,y:147,width:20,height:21,xoffset:2,yoffset:15,xadvance:25},{id:1089,x:993,y:147,width:17,height:21,xoffset:1,yoffset:15,xadvance:19},{id:1090,x:2,y:179,width:18,height:21,xoffset:0,yoffset:15,xadvance:18},{id:1093,x:22,y:179,width:21,height:21,xoffset:0,yoffset:15,xadvance:21},{id:1095,x:45,y:179,width:20,height:21,xoffset:2,yoffset:15,xadvance:24},{id:1096,x:67,y:179,width:30,height:21,xoffset:2,yoffset:15,xadvance:34},{id:1098,x:99,y:179,width:25,height:21,xoffset:0,yoffset:15,xadvance:26},{id:1099,x:126,y:179,width:26,height:21,xoffset:2,yoffset:15,xadvance:30},{id:1100,x:154,y:179,width:19,height:21,xoffset:2,yoffset:15,xadvance:22},{id:1103,x:175,y:179,width:19,height:21,xoffset:0,yoffset:15,xadvance:22},{id:1102,x:196,y:179,width:29,height:21,xoffset:2,yoffset:15,xadvance:32},{id:109,x:227,y:179,width:31,height:21,xoffset:2,yoffset:15,xadvance:35},{id:58,x:260,y:179,width:6,height:21,xoffset:2,yoffset:15,xadvance:10},{id:94,x:268,y:179,width:19,height:15,xoffset:1,yoffset:7,xadvance:21},{id:43,x:289,y:179,width:15,height:15,xoffset:2,yoffset:18,xadvance:19},{id:42,x:306,y:179,width:12,height:12,xoffset:2,yoffset:7,xadvance:16},{id:61,x:320,y:179,width:15,height:11,xoffset:2,yoffset:20,xadvance:19},{id:44,x:337,y:179,width:8,height:9,xoffset:0,yoffset:32,xadvance:9},{id:34,x:347,y:179,width:12,height:9,xoffset:2,yoffset:7,xadvance:16},{id:39,x:361,y:179,width:5,height:9,xoffset:2,yoffset:7,xadvance:9},{id:46,x:368,y:179,width:6,height:5,xoffset:2,yoffset:31,xadvance:9},{id:95,x:376,y:179,width:20,height:4,xoffset:0,yoffset:35,xadvance:21},{id:45,x:398,y:179,width:10,height:4,xoffset:2,yoffset:23,xadvance:14},{id:32,x:0,y:0,width:0,height:0,xoffset:2,yoffset:23,xadvance:9}]});t.fonts.push({face:"numbers",size:100,lineHeight:112,chars:[{id:54,x:2,y:2,width:54,height:73,xoffset:5,yoffset:0,xadvance:61},{id:57,x:58,y:2,width:54,height:73,xoffset:5,yoffset:1,xadvance:62},{id:49,x:114,y:2,width:21,height:72,xoffset:5,yoffset:1,xadvance:34},{id:50,x:137,y:2,width:48,height:71,xoffset:5,yoffset:2,xadvance:58},{id:53,x:187,y:2,width:47,height:71,xoffset:6,yoffset:2,xadvance:57},{id:51,x:236,y:2,width:47,height:71,xoffset:5,yoffset:2,xadvance:54},{id:48,x:285,y:2,width:62,height:71,xoffset:4,yoffset:2,xadvance:71},{id:56,x:349,y:2,width:55,height:71,xoffset:4,yoffset:1,xadvance:63},{id:52,x:406,y:2,width:56,height:70,xoffset:3,yoffset:2,xadvance:60},{id:55,x:464,y:2,width:50,height:70,xoffset:5,yoffset:2,xadvance:57},{id:32,x:0,y:0,width:0,height:0,xoffset:5,yoffset:2,xadvance:22}]})}(t.fonts||(t.fonts={}))}(GAME||(GAME={})),(GAME||(GAME={})).GAMECONFIG={publisher:"dummy",gameId:"basketballrun",gameVersion:"0.1.4",defaultLocale:"autodetect",customData:{},gsUrl:"gs.dev-snapgame.com/ship-01",serverUrl:"hip.dev-snapgame.com",resourcesUrl:"games.dev-snapgame.com",packages:[{id:"premium",quantity:1,price:99,type:ship.ItemType.Premium,externalProductId:null}]},function(t){var e=function(i){function t(){return null!==i&&i.apply(this,arguments)||this}return __extends(t,i),t.get=function(t,e){return i.get.call(this,t,e)},t}(h5ge.I18N);t.I18N=e}(GAME||(GAME={})),function(t){h5ge.I18N.setAvailableLocales(["en","fr"]),h5ge.I18N.setDefaultLocale("en");var e=function(){function t(){}return t.TAP_TO_PLAY="TAP_TO_PLAY",t.TAP_TO_CONTINUE="TAP_TO_CONTINUE",t.CONGRATULATIONS="CONGRATULATIONS",t.PERFECT="PERFECT",t.PERFECT_N="PERFECT_N",t.BOUNCE="BOUNCE",t.BOUNCE_N="BOUNCE_N",t.DRAG_TO_START="DRAG_TO_START",t.CONTINUE="CONTINUE",t.NEW_BEST="NEW_BEST",t.GAME_OVER="GAME_OVER",t.KEY_TUTORIAL_TITLE="KEY_TUTORIAL_TITLE",t.GOAL="GOAL",t.CONTINUE_TO_PLAY="CONTINUE_TO_PLAY",t.GREAT_JOB="GREAT_JOB",t.INSTALL_NOW="INSTALL_NOW",t.TRY_IT="TRY_IT",t.GET_FULL_GAME="GET_FULL_GAME",t.LOADING="LOADING",t}();t.I18NK=e;h5ge.I18N.registerTranslation("fr",{TAP_TO_PLAY:"Cliquer pour Jouer",TAP_TO_CONTINUE:"Cliquer pour continuer",CONGRATULATIONS:"Félicitations !",PERFECT:"PARFAIT!",PERFECT_N:"PARFAIT x{n}",BOUNCE:"REBOND!",BOUNCE_N:"REBOND x{n}",DRAG_TO_START:"Glisser pour Jouer",CONTINUE:"Continuer ?",NEW_BEST:"Nouveau record !",GAME_OVER:"Perdu!",KEY_TUTORIAL_TITLE:"Tutoriel",GOAL:"Panier",CONTINUE_TO_PLAY:"Continue à Jouer",GREAT_JOB:"Bien Joué !",INSTALL_NOW:"Installer",TRY_IT:"Essayer Maintenant",GET_FULL_GAME:"Télécharge le jeu complet\nGratuitement!",LOADING:"Chargement..."});h5ge.I18N.registerTranslation("en",{TAP_TO_PLAY:"Tap to Play",TAP_TO_CONTINUE:"Tap to Continue",CONGRATULATIONS:"Congratulations!",PERFECT:"PERFECT!",PERFECT_N:"PERFECT x{n}",BOUNCE:"BOUNCE!",BOUNCE_N:"BOUNCE x{n}",DRAG_TO_START:"Drag to Play",CONTINUE:"Continue?",NEW_BEST:"New Best !",GAME_OVER:"Game Over!",KEY_TUTORIAL_TITLE:"Tutorial",GOAL:"Goal",CONTINUE_TO_PLAY:"Continue to Play",GREAT_JOB:"Great Job !",INSTALL_NOW:"Install Now",TRY_IT:"Try it now",GET_FULL_GAME:"Download the full game\nFor FREE!",LOADING:"Loading..."});h5ge.I18N.registerTranslation("ru",{TAP_TO_PLAY:"Нажмите, чтобы играть",TAP_TO_CONTINUE:"Нажмите, чтобы продолжить",CONGRATULATIONS:"Поздравляем!",GREAT_GAME_COMPLETED:"Вы прошли игру, ура!\n\nТеперь можно продолжать набирать очки!",PERFECT:"Perfect!",PERFECT_N:"Perfect x{n}",BOUNCE:"Bounce!",BOUNCE_N:"Bounce x{n}",DRAG_TO_START:"Drag to Play!",CONTINUE:"Продолжить?",NEW_BEST:"Новый рекорд",GAME_OVER:"Игра окончена!",KEY_TUTORIAL_TITLE:"Как играть?",GOAL:"GOAL",CONTINUE_TO_PLAY:"Continue to Play",GREAT_JOB:"Bien Joué !",INSTALL_NOW:"Install Now",TRY_IT:"Try it now",GET_FULL_GAME:"Download the full game\nFor FREE!",LOADING:"Loading..."})}(GAME||(GAME={})),function(t){var e=function(){function t(){}return t.LIGHT_GREY=8421504,t.BG_PURPLE=6696337,t.BG_PINK=16187460,t.BG_RED=16195840,t.BG_BLUE=16749,t.BG_TEAL=1005913,t.BG_GREEN=1205780,t.TXT_PERFECT=15308617,t.TXT_BOUNCE=5410242,t.TXT_SCORE=14444863,t.BASKET_EFFECT=14248253,t.GAMEOVER_SCORE=1795437,t}();t.Colors=e}(GAME||(GAME={})),function(t){var e=function(){function t(){}return t.getAnimFrames=function(t,e,i){void 0===i&&(i=4);for(var n=[],o=1;o<=e;o++)n.push(t+h5ge.Strings.pad(o,i)+".png");return n},t.radians=function(t){return t*h5ge.Maths.DEG_TO_RADIAN},t.degree=function(t){return t*h5ge.Maths.RADIAN_TO_DEG},t.normalize=function(t){return t-this.TWO_PI*Math.floor((t+this.PI)/this.TWO_PI)},t.isAngleBetween=function(t,e,i){return t=(360+t%360)%360,(e=(36e5+e)%360)<(i=(36e5+i)%360)?e<=t&&t<=i:e<=t||t<=i},t.rotateFromOrigin=function(t,e){var i=t.x*Math.cos(e)-t.y*Math.sin(e),n=t.x*Math.sin(e)+t.y*Math.cos(e);return new h5ge.Point(i,n)},t.rotate=function(t,e,i){var n=t.x-i.x,o=t.y-i.y,r=this.rotateFromOrigin(new h5ge.Point(n,o),e);return r.x+=i.x,r.y+=i.y,r},t.roundAngle=function(t){return t},t.tweenInfiniteRotation=function(t,e){var i=h5ge.TweenManager.get().create(t);t.detachListener.once(function(){i.stop()});var n=3600*h5ge.Maths.DEG_TO_RADIAN;return i.to({rotation:n},10*e),i.to({rotation:0},10*e),i.repeat(-1),i.start(),i},t.arc4random=function(){return 4294967296*Math.random()},t.tween=function(t,e){return h5ge.TweenManager.get().create(t,e)},t.timer=function(t,e,i){return h5ge.TimeManager.get().createTimer(t,e,i)},t.randomInt=function(t,e){return h5ge.Random.intInRange(t,e)},t.fitObjIn=function(t,e,i){void 0===i&&(i=0);var n=e.width/(t.width+2*i),o=e.height/(t.height+2*i),r=Math.min(n,o);t.scaleXY=r,t.x=e.x+(e.width/2-t.width/2),t.y=e.y+(e.height/2-t.height/2)},t.timeString=function(t){var e=t%60;return Math.floor(t/60)+":"+h5ge.Strings.pad2(e)},t.delay=function(t,e,i){this.timer(t,e,i).start()},t.PI=Math.PI,t.TWO_PI=2*Math.PI,t}();t.Helper=e}(GAME||(GAME={})),function(e){var t=function(){function t(){}return t.get=function(){return null==this.currentTint&&this.next(),this.currentTint},t.next=function(){0==this.tints.length&&(this.tints=this.AVAILABLE_BG_TINTS.slice(0));var t=e.Helper.randomInt(0,this.tints.length-1);return this.currentTint=this.tints.splice(t,1)[0],this.currentTint},t.AVAILABLE_BG_TINTS=[e.Colors.BG_PURPLE,e.Colors.BG_PINK,e.Colors.BG_RED,e.Colors.BG_BLUE,e.Colors.BG_TEAL,e.Colors.BG_GREEN],t.tints=[],t}();e.Tints=t}(GAME||(GAME={})),function(o){var t=function(i){function n(){var t=i.call(this)||this;(n.INSTANCE=t).sprite=h5ge.Sprite.fromFrame("bg.png"),t.addChild(t.sprite),t.setSizeFromChildren();var e=o.Tints.next();return t.sprite.tint=e,t}return __extends(n,i),n.get=function(){return this.INSTANCE},n.prototype.change=function(){var t=o.Tints.next();this.sprite.tint=t},n}(h5ge.Container);o.Background=t}(GAME||(GAME={})),function(s){var t=function(){function t(){}return t.next=function(t,e,i){this.ctx={previousBasket:t,count:e,score:i,pbX:t.bodyX,pbY:t.bodyY,x:0,y:0,minXSpace:200,maxXSpace:400,boundMinX:s.Params.BASKET_HALF_WIDTH,boundMaxX:s.Game.get().width-s.Params.BASKET_HALF_WIDTH,minY:200,maxY:350,minX:0,maxX:0,wallOrientation:.5<Math.random()?s.Orientation.VERTICAL:s.Orientation.HORIZONTAL,wallXSpace:0};var n=t.bodyX<s.Game.get().width/2;this.ctx.nextOnLeft=!n,this.ctx.multiplier=this.ctx.nextOnLeft?-1:1,this.ctx.angle=s.Helper.radians(s.Helper.randomInt(0,30))*this.ctx.multiplier,this.ctx.innerWallDesc=this.getWallDesc(),this.setPositions(),this.ctx.moveDesc=this.getMovingDesc();var o={x:this.ctx.x,y:this.ctx.y,angle:this.ctx.angle,innerWallDesc:this.ctx.innerWallDesc,moveDesc:this.ctx.moveDesc,star:null};Math.random();return o},t.setPositions=function(){this.ctx.count<5?(this.ctx.minXSpace=2*s.Params.BASKET_WIDTH,this.ctx.maxXSpace=400):(this.ctx.count<20?this.ctx.minXSpace=s.Params.BASKET_WIDTH+100:this.ctx.count<50?this.ctx.minXSpace=s.Params.BASKET_WIDTH+50:this.ctx.count<100?this.ctx.minXSpace=s.Params.BASKET_WIDTH:this.ctx.minXSpace=0,this.ctx.maxXSpace=624),this.ctx.nextOnLeft?(this.ctx.minX=Math.max(this.ctx.boundMinX+this.ctx.wallXSpace,this.ctx.pbX-this.ctx.maxXSpace),this.ctx.maxX=this.ctx.pbX-this.ctx.minXSpace,this.ctx.x=s.Helper.randomInt(this.ctx.minX,Math.max(this.ctx.minX,this.ctx.maxX))):(this.ctx.maxX=Math.min(this.ctx.boundMaxX-this.ctx.wallXSpace,this.ctx.pbX+this.ctx.maxXSpace),this.ctx.minX=this.ctx.pbX+this.ctx.minXSpace,this.ctx.x=s.Helper.randomInt(Math.min(this.ctx.minX,this.ctx.maxX),this.ctx.maxX)),this.ctx.y=s.Helper.randomInt(this.ctx.minY,this.ctx.maxY)},t.getWallDesc=function(){var t=null,e=this.hasWall(this.ctx.previousBasket,this.ctx.count,this.ctx.score),i=!0;i=this.ctx.count<8||(this.ctx.count<10?.7<Math.random():this.ctx.count<20?.8<Math.random():this.ctx.count<50&&.9<Math.random());var n=0,o=0;if(e){if(this.ctx.angle=0,this.ctx.wallOrientation==s.Orientation.HORIZONTAL){n=Math.PI/2;var r=s.Helper.randomInt(150,300);o=s.Helper.randomInt(-s.Params.WALL_HEIGHT,0),o*=this.ctx.multiplier}else{r=0;i?(this.ctx.wallXSpace=s.Helper.randomInt(10,30)+s.Params.WALL_WIDTH/2,o=s.Params.BASKET_HALF_WIDTH+this.ctx.wallXSpace,r=s.Helper.randomInt(100,200)):(o=-(s.Params.BASKET_HALF_WIDTH+s.Helper.randomInt(10,60)+s.Params.WALL_WIDTH/2),r=s.Helper.randomInt(0,200)),o*=this.ctx.multiplier}t={angle:n,x:o,y:r}}return t},t.hasWall=function(t,e,i){return!(e<3)&&(e<5?Math.random()<.4:e<15?Math.random()<.6:e<30?Math.random()<.8:!(e<50)||Math.random()<.9)},t.getMovingDesc=function(){var t=null,e=this.hasMoving(this.ctx.previousBasket,this.ctx.count,this.ctx.score),i=this.ctx.wallOrientation;if(e){var n=s.Helper.randomInt(-150,-300);i==s.Orientation.HORIZONTAL?(n*=this.ctx.multiplier,n=this.ctx.nextOnLeft?Math.min(n,s.Game.get().width-this.ctx.x-s.Params.BASKET_HALF_WIDTH):Math.max(n,-this.ctx.x+s.Params.BASKET_HALF_WIDTH)):.5<Math.random()&&0<(n*=-1)&&Math.abs(this.ctx.x-this.ctx.pbX)<s.Params.BASKET_WIDTH&&(this.ctx.y=Math.max(n+s.Params.BASKET_HEIGHT+100,this.ctx.y));t={moveDistance:n,moveSpeed:Math.abs(n/.1),orientation:i}}return t},t.hasMoving=function(t,e,i){return!(e<6)&&(e<15?Math.random()<.2:e<30?Math.random()<.4:e<50?Math.random()<.6:Math.random()<.8)},t}();s.BasketProvider=t}(GAME||(GAME={})),function(t){var e=function(){function t(t,e,i,n){this.world=t,this.ball=e,this.minHeigh=i,this.maxHeight=n}return t.prototype.render=function(t){var e=this.world.y,i=e-this.ball.body.position[1];if(i<this.minHeigh){var n=this.ball.body.position[1]+this.minHeigh;e=h5ge.Maths.lerp(e,n,1*t)}else if(i>this.maxHeight){n=this.ball.body.position[1]+this.maxHeight;e=h5ge.Maths.lerp(e,n,1*t)}this.world.moveToY(e)},t}();t.Camera2=e}(GAME||(GAME={})),function(t){var e=function(){function t(){}return t.COLLISION_GROUP_BALL=Math.pow(2,0),t.COLLISION_GROUP_NET=Math.pow(2,1),t.COLLISION_GROUP_WALL=Math.pow(2,2),t.COLLISION_GROUP_GROUND=Math.pow(2,3),t.COLLISION_MASK_BALL=-1,t.COLLISION_MASK_NET=t.COLLISION_GROUP_BALL|t.COLLISION_MASK_NET,t.COLLISION_MASK_WALL=t.COLLISION_GROUP_BALL|t.COLLISION_MASK_WALL,t.COLLISION_MASK_GROUND=t.COLLISION_GROUP_BALL|t.COLLISION_MASK_GROUND,t}();t.Collisions=e}(GAME||(GAME={})),function(p){var t=function(u){function t(t,e,i){var n=u.call(this,p.Game.get().width,p.Game.get().height)||this;n.continuePrice=t,n.onContinue=e,n.onExpired=i;var o=n,r=p.factory.newRectangle(934,1400,0);n.addChild(r),r.alpha=.4,p.layout.centerOnXYInParent(r),n.continueBg=h5ge.Sprite.fromFrame("continue_bg.png"),n.addChild(n.continueBg),p.layout.centerOnXYInParent(n.continueBg),n.continueBall=h5ge.Sprite.fromFrame("continue_ball.png"),n.continueBall.setPivotToCenter(),n.addChild(n.continueBall),p.layout.centerOnXYInParent(n.continueBall),n.continueCountDown=h5ge.Sprite.fromFrame("continue_countdown.png"),n.addChild(n.continueCountDown),p.layout.centerOnXYInParent(n.continueCountDown),n.progressBar=new h5ge.RoundProgressBar(n.continueCountDown),n.progressBar.setInverted(!0),n.progressBar.radius=n.continueCountDown.width/2,n.progressBar.centerX=n.continueCountDown.width/2,n.progressBar.centerY=n.continueCountDown.height/2,n.progressBar.startTimeLimited(5e3),n.progressBar.onProgressExpired=function(){o.onExpired()},n.btnContinue=h5ge.ImageButton.fromFrames("buttons/button_big.png","buttons/button_big_pressed.png","buttons/button_big_hover.png");var s=p.factory.newText(p.I18N.get(p.I18NK.CONTINUE),50);p.factory.blink(s),n.btnContinue.setContent(s),n.addChild(n.btnContinue),p.layout.centerOnXInParent(n.btnContinue),n.btnContinue.y=n.continueBg.bottom+100,n.btnContinue.onClick(function(){p.Player.setStars(p.Player.getStars()-t),p.Player.save(),n.onContinue()},n);var a=new h5ge.Container,h=h5ge.Sprite.fromFrame("star.png");a.addChild(h);var c=p.factory.newText(n.continuePrice.toString());p.layout.centerOnY(c,h),c.x=h.right+20,a.addChild(c),a.scaleXY=1.5,a.setSizeFromChildren(),p.layout.centerOnX(a,n.btnContinue),a.y=n.btnContinue.bottom+20,n.addChild(a);var l=p.Helper.tween(n.continueBall);return l.to({rotation:p.Helper.radians(10)},300,p.Easing.easeOutSine),l.to({rotation:p.Helper.radians(0)},300,p.Easing.easeInSine),l.to({rotation:p.Helper.radians(-10)},300,p.Easing.easeOutSine),l.to({rotation:p.Helper.radians(0)},300,p.Easing.easeInSine),l.repeat(-1),l.start(),n}return __extends(t,u),t.prototype.update=function(t){},t.prototype.render=function(t){},t.prototype.show=function(t){p.Handlers.langChangedHandlers.add(this.onLangChanged,this)},t.prototype.hide=function(t,e){p.Handlers.langChangedHandlers.remove(this.onLangChanged)},t.prototype.onLangChanged=function(t){},t}(h5ge.Container);p.ContinueOverlay=t}(GAME||(GAME={})),function(h){var t=function(a){function t(t,e){var i=a.call(this,h.Game.get().width,h.Game.get().height)||this;i.score=t,i.bestBeaten=e,i.restarting=!1;var n=h.factory.newRectangle(934,1400,0);if(i.addChild(n),n.alpha=.4,h.layout.centerOnXYInParent(n),i.scoreBg=h5ge.Sprite.fromFrame("gameover.png"),i.addChild(i.scoreBg),h.layout.centerOnXYInParent(i.scoreBg),e){var o=h.factory.newText(h.I18N.get(h.I18NK.NEW_BEST),60);i.addChild(o),h.layout.centerOnX(o,n),o.y=200,h.factory.blink(o);var r=h5ge.Sprite.fromFrame("bestscore_crown.png");r.scaleXY=2,h.layout.centerOnX(r,n),r.y=i.scoreBg.top-r.height+20,i.addChild(r),h.SoundManager.play(h.Sounds.SND_EV_CONFETTI_MELODY)}else{o=h.factory.newText(h.I18N.get(h.I18NK.GAME_OVER),60);i.addChild(o),h.layout.centerOnX(o,n),o.y=200}var s=h.factory.newTextNumber(i.score.toString(),100);return s.tint=h.Colors.GAMEOVER_SCORE,i.addChild(s),h.layout.centerOnX(s,i.scoreBg),h.layout.centerOnY(s,i.scoreBg),s.y-=50,i.btnRestart=h5ge.ImageButton.fromFrames("buttons/button_restart.png","buttons/button_restart_pressed.png","buttons/button_restart_hover.png"),i.addChild(i.btnRestart),h.layout.centerOnXYInParent(i.btnRestart),i.btnRestart.y=700,i.btnRestart.onClick(i.restart,i),i}return __extends(t,a),t.prototype.restart=function(){this.restarting||(this.restarting=!0,h.shipi.endGame(!0,function(){h.Background.get().change(),h.GameScene.launch(!0)}))},t.prototype.update=function(t){},t.prototype.render=function(t){},t.prototype.show=function(t){h.Handlers.langChangedHandlers.add(this.onLangChanged,this)},t.prototype.hide=function(t,e){h.Handlers.langChangedHandlers.remove(this.onLangChanged)},t.prototype.onLangChanged=function(t){},t}(h5ge.Container);h.GameOverOverlay=t}(GAME||(GAME={})),function(i){var n=function(){function t(){}return t.ballMaterial=new p2.Material(1),t.netMaterial=new p2.Material(2),t.wallMaterial=new p2.Material(3),t.basketMaterial=new p2.Material(4),t}();i.Materials=n;var t=function(e){function t(){var r=e.call(this,i.Game.get().width,i.Game.get().height)||this;r.layerBack=i.factory.newContainer(),r.layerMid=i.factory.newContainer(),r.layerFront=i.factory.newContainer(),r.entitiesByBody=new h5ge.HashMap,r.addChild(r.layerBack),r.addChild(r.layerMid),r.addChild(r.layerFront),r.p2World=new p2.World({gravity:[0,i.Params.WORLD_GRAVITY]}),r.p2World.defaultContactMaterial.restitution=.7,r.p2World.on("beginContact",function(t){var e=t.bodyA,i=t.bodyB,n=t.shapeA,o=t.shapeB;r.onCollide(e,i,n,o)},r);var t=new p2.ContactMaterial(n.ballMaterial,n.netMaterial,{restitution:.2,friction:.7});return r.p2World.addContactMaterial(t),r}return __extends(t,e),t.prototype.onCollide=function(t,e,i,n){var o=this.getEntity(t),r=this.getEntity(e);o&&o.onCollide(r,i,n),r&&r.onCollide(o,n,i)},t.prototype.addEntity=function(t){this.entitiesByBody.put(t.body.id.toString(),t),this.p2World.addBody(t.body)},t.prototype.removeEntity=function(t){this.entitiesByBody.remove(t.body.id.toString()),this.p2World.removeBody(t.body)},t.prototype.getEntity=function(t){return this.entitiesByBody.get(t.id.toString())},t.prototype.update=function(i){this.entitiesByBody.forEach(function(t,e){e.update(i)},this),this.p2World.step(1/60,i,10)},t.prototype.render=function(i){this.entitiesByBody.forEach(function(t,e){e.render(i)},this)},t.prototype.moveToY=function(t){this.y!=t&&(this.y=t)},t}(h5ge.Container);i.World=t}(GAME||(GAME={})),function(l){var o,t;(t=o||(o={}))[t.IDLE=0]="IDLE",t[t.STARTED=1]="STARTED",t[t.LOOSING=2]="LOOSING",t[t.GAME_OVER=3]="GAME_OVER";var e=function(i){function n(t){void 0===t&&(t=!0);var e=i.call(this)||this;e.showMenu=t,e.state=o.IDLE,e.ballPreviousPosition=[0,0],e.nextBaskets=[],e.right=!0,e.perfects=0,e.bounces=0,e.score=0,e.initialBestScore=0,e.bestScore=null,e.bestBeaten=!1,e.continueCount=0,e.continuePrice=3,e.stars=null,e._showTuto=!0,e.starting=!1,e.tutoCtn=null,e.goingHome=!1,e.basketsCount=0,e.nextBasketCount=0,e.suspectBlockedTime=0;return e.initialBestScore=l.Player.getBestScore(),e.build(),e.showMenu?(e.menuOverLay=new l.MenuOverlay(e.onMenuClicked),e.addChild(e.menuOverLay),e.menuOverLay.interactive=!0,e.menuOverLay.downHandler.add(function(){e.start()},e)):(e.btnHome.onClick(e.goToHome,e),e.doStart()),e}return __extends(n,i),n.launch=function(t){void 0===t&&(t=!0);var e=new n(t);l.Game.get().switchScene(e,!1,!1)},n.prototype.onMenuClicked=function(){},n.prototype.build=function(){this.world=new l.World,this.addChild(this.world);var t=new p2.ContactMaterial(l.Materials.ballMaterial,l.Materials.netMaterial,{restitution:.2,friction:.7});this.world.p2World.addContactMaterial(t);var e=new p2.ContactMaterial(l.Materials.ballMaterial,l.Materials.basketMaterial,{restitution:.3,friction:.5});this.world.p2World.addContactMaterial(e),this.plane=new l.Plane(this.world),this.world.addEntity(this.plane),this.plane.setBodyPosition(l.Game.get().width/2,l.Game.get().height),this.plane.collideHandlers.add(this.onBottomCollide,this),this.wallLeft=new l.Wall2(this.world),this.world.addEntity(this.wallLeft),this.wallLeft.setBodyPosition(0,0),this.wallRight=new l.Wall2(this.world,!1),this.world.addEntity(this.wallRight),this.wallRight.setBodyPosition(l.Game.get().width,0);this.basket1=new l.Basket(this.world,{x:170,y:-720}),this.world.addEntity(this.basket1);this.basket2=new l.Basket(this.world,{x:450,y:-600}),this.world.addEntity(this.basket2),this.ball=new l.Ball(this.world),this.ball.collideHandlers.add(this.onBallCollide,this),this.world.addEntity(this.ball),this.ball.setBodyPosition(this.basket1.body.position[0],700),this.dragManager=new h5ge.DragManager(this),this.dragManager.disable();var i=this;this.dragManager.setStartDragController(function(t){return null!=i.currentBasket&&i.currentBasket.isReadyToThrow()}),this.camera=new l.Camera2(this.world,this.ball,500,800),this.parabola=new l.Parabola(this.world,this.ball,this.wallLeft,this.wallRight),this.txtScore=l.factory.newTextNumber("0",100),this.addChild(this.txtScore),l.layout.centerOnXInParent(this.txtScore),this.txtScore.y=230,this.btnHome=l.factory.newHomeBtn(),this.btnHome.x=10,this.btnHome.y=10,this.addChild(this.btnHome),this.btnHome.visible=!1,l.Player.getBestScore()&&(this.bestScore=new l.BestScore,this.addChild(this.bestScore),l.layout.centerOnXInParent(this.bestScore),l.layout.centerOnY(this.bestScore,this.btnHome)),this.stars=new l.Stars,this.addChild(this.stars),this.stars.x=l.Game.get().width-this.stars.width-50,this.stars.y=10,l.layout.centerOnY(this.stars,this.btnHome),this.stars.visible=!1,this.btnHome.visible=!1,this.dragManager.disable(),this.stars.visible=!1},n.prototype.start=function(){var t=this;if(!this.starting){this.starting=!0;l.shipi.startGame(function(){t.menuOverLay&&t.menuOverLay.removeSelf(),t.doStart()})}},n.prototype.doStart=function(){this.txtScore.visible=!0,this.btnHome.visible=!0,this.state=o.STARTED,this.dragManager.enable(),this.bestScore&&(this.bestScore.visible=!0),this.stars.visible=!0;this.currentBasket.throwBall([62,150]),this.currentBasket=null},n.prototype.showTuto=function(){var t=this;this.txtScore.visible=!1,this.tutoCtn=new h5ge.Container(l.Game.get().width,l.Game.get().height),this.addChild(this.tutoCtn);var e=l.factory.newText(l.I18N.get(l.I18NK.KEY_TUTORIAL_TITLE),70);this.tutoCtn.addChild(e),e.y=10,l.layout.centerOnXInParent(e),(o=l.factory.newSprite("arrow.png")).setPivotToCenter(),o.rotation=.38,this.tutoCtn.addChild(o),o.x=this.basket1.bodyX-o.width/2-40,o.y=70-this.basket1.bodyY;var i=h5ge.Sprite.fromFrame("finger.png");l.layout.centerOnX(i,o),i.x-=30,i.y=o.bottom+10,this.tutoCtn.addChild(i);var n=l.factory.newText(l.I18N.get(l.I18NK.GOAL),60);n.x=this.basket2.bodyX-n.width/2,n.y=-this.basket2.bodyY-220,this.tutoCtn.addChild(n);var o=l.factory.newSprite("arrow.png");this.tutoCtn.addChild(o),l.layout.centerOnX(o,n),o.y=n.bottom+20;var r=this;this.world.p2World.disableBodyCollision(this.basket1.body,this.ball.body),this.world.p2World.applyGravity=!1,l.Helper.delay(100,function(){t.startDragPosition=null,r.basket1.setBodyAngle(-.38),t.basket1.attachBall(t.ball,!1,function(){var t=[62,150];r.basket1.updateVelocity(t),r.parabola.updateParabola(t),r.tutoCtn.interactive=!0,r.tutoCtn.downHandler.once(function(){r.dragManager.enable(),r.world.p2World.enableBodyCollision(r.basket1.body,r.ball.body),r.world.p2World.applyGravity=!0,r.tutoCtn.removeSelf(),r.doStart()},r)})},this)},n.prototype.goToHome=function(){this.goingHome||(this.goingHome=!0,this.isBest()&&(l.Player.setBestScore(this.score),l.Player.save()),l.shipi.endGame(!1,function(){l.Background.get().change(),n.launch(!0)}))},n.prototype.onBallCollide=function(t,e){if(t instanceof l.Basket){var i=t;if(e==i.scoreShape)i.attachBall(this.ball)&&(this.onBasket(i),this.currentBasket=i)}else if(t instanceof l.Wall2||t instanceof l.BasketWall){this.onBounce(t)}else if(t instanceof l.BasketStar){this.stars.value=this.stars.value+1}},n.prototype.onBounce=function(t){if(this.bounces++,t instanceof l.Wall2){var e=t,i=new h5ge.Point(this.ball.body.position[0],-this.ball.body.position[1]-this.ball.sprite.width/2);e.playEffect(i)}},n.prototype.onBasket=function(t){if(t==this.basket2){if(this.tutoCtn&&(this.tutoCtn=null,l.Player.setShowTuto(!1),l.Player.save()),this.addNextBasket(),t.touchedBorder)l.SoundManager.play(l.Sounds.SND_EV_SCORE_SIMPLE),this.perfects=0,this.ball.ballTail.noParticules();else{this.perfects++;var e=this.perfects<=10?this.perfects:10;l.SoundManager.play("ev_score_perfect_"+e),3==this.perfects?(l.SoundManager.play(l.Sounds.SND_BURN_ON_BASKET_TOUCH),this.ball.ballTail.tailParticles()):2==this.perfects&&this.ball.ballTail.smokeParticles()}this.updateScore(t);var i=0<this.perfects;t.onScore(i),0<this.bounces&&l.SoundManager.play(l.Sounds.SND_EV_SCORE_BOUNCE),2==this.score&&(this.dragIt=new l.DragIt,this.dragIt.x=this.basket1.bodyX,this.dragIt.y=100-this.basket1.bodyY,this.addChild(this.dragIt),this.dragIt.flipX=!0)}else this.basket2.touchedBorder=!1;this.bounces=0},n.prototype.updateScore=function(t){var e=this,i=this,n=100,o=0,r=0;0<this.perfects&&(o=2*this.perfects,this.displayPerfect(this.perfects,t,100),n+=400),0<this.bounces&&(n+=100,r=2*this.bounces,this.displayBounces(this.bounces,t,n),n+=400);var s=o+r;if(0==s&&(s=1),this.score+=s,this.displayScore(s,t,n),this.isNewBest()&&(l.Helper.delay(n,function(){e.bestScore.value=e.score}),0==this.bestBeaten)){this.bestBeaten=!0;var a=l.factory.newText(l.I18N.get(l.I18NK.NEW_BEST),64);a.width,a.height;a.setPivotToCenter(),this.addChild(a),l.layout.centerOnXInParent(a),a.y=130;var h=l.Helper.tween(a);h.from({scaleXY:0,alpha:0},300,l.Easing.EaseInOutBack),h.start(),l.SoundManager.play(l.Sounds.SND_EV_CONFETTI_MELODY),l.SoundManager.play(l.Sounds.SND_CONFETTI_BURST_1);var c=new h5ge.Container;c.x=-155,c.y=l.Game.get().height/4,this.addChild(c),new l.BestScoreEmitter(c,!0).start(),l.Helper.delay(50,function(){l.SoundManager.play(l.Sounds.SND_CONFETTI_BURST_2);var t=new h5ge.Container;t.x=l.Game.get().width+155,t.y=l.Game.get().height/4,i.addChild(t),new l.BestScoreEmitter(t,!1).start()}),l.Helper.delay(2e3,function(){a.removeSelf()})}},n.prototype.displayPerfect=function(n,o,t){var r=this;l.Helper.timer(t,function(){var t=null;t=1==n?l.I18N.get(l.I18NK.PERFECT):l.I18N.get(l.I18NK.PERFECT_N,{n:n});var e=l.factory.newText(t,40);e.tint=l.Colors.TXT_PERFECT,e.alpha=.5,l.layout.centerOnX(e,o.frontLayer),e.y=o.frontLayer.y-60,r.world.layerFront.addChild(e);var i=l.Helper.tween(e);i.to({alpha:1,y:e.y-2},16.6,l.Easing.EaseInOutBack),i.to({y:e.y-34},265.6,l.Easing.easeOutCubic),i.to({alpha:0,y:e.y-86},431.6,l.Easing.easeInCubic),i.onComplete=function(){e.removeSelf()},i.start()},this).start()},n.prototype.displayBounces=function(n,o,t){var r=this;l.Helper.timer(t,function(){var t=null;t=1==n?l.I18N.get(l.I18NK.BOUNCE):l.I18N.get(l.I18NK.BOUNCE_N,{n:n});var e=l.factory.newText(t,40);e.tint=l.Colors.TXT_BOUNCE,e.alpha=.5,l.layout.centerOnX(e,o.frontLayer),e.y=o.frontLayer.y-60,r.world.layerFront.addChild(e);var i=l.Helper.tween(e);i.to({alpha:1,y:e.y-2},16.6,l.Easing.EaseInOutBack),i.to({y:e.y-34},265.6,l.Easing.easeOutCubic),i.to({alpha:0,y:e.y-86},431.6,l.Easing.easeInCubic),i.onComplete=function(){e.removeSelf()},i.start()},this).start()},n.prototype.displayScore=function(i,n,t){var o=this;l.Helper.timer(t,function(){var t=l.factory.newText("+"+i,70);t.tint=l.Colors.TXT_SCORE,t.alpha=.5,l.layout.centerOnX(t,n.frontLayer),t.y=n.frontLayer.y-60,o.world.layerFront.addChild(t);var e=l.Helper.tween(t);e.to({alpha:1,y:t.y-2},16.6,l.Easing.EaseInOutBack),e.to({y:t.y-60},29*16.6,l.Easing.easeOutCubic),e.to({alpha:0,y:t.y-112},39*16.6,l.Easing.Linear),e.onComplete=function(){t.removeSelf()},e.start(),o.txtScore.text=o.score.toString(),l.layout.centerOnXInParent(o.txtScore)},this).start()},n.prototype.addNextBasket=function(){this.nextBasketCount++;var t=this.basket1,e=(this.basket2.bodyX,this.basket2.bodyY),i=l.BasketProvider.next(this.basket2,this.nextBasketCount,this.score),n=.8<Math.random(),o=new l.Basket(this.world,i,[0,e],n);this.world.addEntity(o),this.basket1=this.basket2,this.basket2=o,this.right=!this.right,this.plane.setBodyPosition(l.Game.get().width/2,-(e-100)),o.appear(),t.disappear()},n.prototype.onBottomCollide=function(){var t=this;this.state=o.LOOSING;var e=l.SoundManager.play(l.Sounds.SND_EV_GAMEOVER);l.SoundManager.setSoundVolume(10,e),l.Helper.timer(300,function(){t.onGameOver(),t.ball.disappear()},this).start()},n.prototype.show=function(t){this.mouseOutHandler=this.onMouseOut.bind(this),document.documentElement.addEventListener("mouseout",this.mouseOutHandler),i.prototype.show.call(this,t)},n.prototype.hide=function(t,e){document.documentElement.removeEventListener("mouseout",this.mouseOutHandler),i.prototype.hide.call(this,t,e)},n.prototype.onMouseOut=function(){null!=this.startDragPosition&&this.onDragEnd(this.endDragPosition)},n.prototype.update=function(t){if(i.prototype.update.call(this,t),this.state!=o.GAME_OVER){l.Game.get().inputManager.keyboard.isJustDown.bind(l.Game.get().inputManager.keyboard),l.Game.get().inputManager.keyboard.isDown.bind(l.Game.get().inputManager.keyboard);this.ball.update(t),this.world.update(t),this.state!=o.LOOSING&&this.state!=o.IDLE&&this.detectBallBlocked(t)&&(this.ball.disappear(),this.onGameOver())}},n.prototype.detectBallBlocked=function(t){if(null==this.currentBasket){var e=this.nearEquals(this.ball.bodyX,this.ballPreviousPosition[0],4),i=this.nearEquals(this.ball.bodyY,this.ballPreviousPosition[1],4);if(e&&i){if(this.suspectBlockedTime+=t,500<this.suspectBlockedTime)return!0}else this.suspectBlockedTime=0,this.ballPreviousPosition[0]=this.ball.bodyX,this.ballPreviousPosition[1]=this.ball.bodyY}return!1},n.prototype.nearEquals=function(t,e,i){return Math.abs(t-e)<=i},n.prototype.render=function(t){i.prototype.render.call(this,t),this.camera.render(t),this.world.render(t)},n.prototype.onDragBegin=function(t){this.startDragPosition=t,this.endDragPosition=t,this.menuOverLay&&(this.menuOverLay.removeSelf(),this.menuOverLay=null,this.stars.visible=!0,this.btnHome.visible=!0,this.btnHome.onClick(this.goToHome,this))},n.prototype.onDragMove=function(t,e,i){if(this.startDragPosition){var n=this.startDragPosition.x-i.x,o=this.startDragPosition.y-i.y,r=Math.atan2(n,-o);this.currentBasket.setBodyAngle(-r);var s=this.computeVelocity(this.startDragPosition,i);this.currentBasket.updateVelocity(s),s?this.parabola.updateParabola(s):this.parabola.clear(),this.endDragPosition=i}},n.prototype.onDragEnd=function(t){this.startDragPosition&&(this.endDragPosition=t,this.throwBall(),this.startDragPosition=null)},n.prototype.throwBall=function(){this.parabola.clear();var t=this.computeVelocity(this.startDragPosition,this.endDragPosition);t&&(3<=this.perfects&&l.SoundManager.play(l.Sounds.SND_EV_FIREBALL_RELEASE_1),this.currentBasket.throwBall(t),this.currentBasket=null,this.dragIt&&(this.dragIt.removeSelf(),this.dragIt=null))},n.prototype.computeVelocity=function(t,e){var i=t.x-e.x,n=t.y-e.y,o=Math.pow(i,2),r=Math.min(Math.pow(n,2),Math.pow(300,2)),s=Math.sqrt(o+r),a=this.currentBasket.body.angle;l.Helper.degree(this.currentBasket.body.angle);if(s<55)return null;s-=50;var h=0<n?-1:1;return[(s=Math.LOG2E*Math.log(s)*35)*Math.cos(a+Math.PI/2),h*s*Math.sin(a+Math.PI/2*h)]},n.prototype.onGameOver=function(){this.state=o.GAME_OVER,0==this.score?n.launch(!1):this.score<5||this.continueCount==l.Params.MAX_CONTINUE||this.continuePrice>l.Player.getStars()?this.showGameOver():this.showContinue()},n.prototype.showContinue=function(){this.continueOverLay=new l.ContinueOverlay(this.continuePrice,this.onContinue.bind(this),this.onContinueExpired.bind(this)),this.addChild(this.continueOverLay)},n.prototype.onContinue=function(){this.stars.refresh(),this.continueCount++,this.continueOverLay.removeSelf(),this.basket1.setBodyAngle(0),this.ball.bodyX=this.basket1.bodyX,this.ball.bodyY=this.basket1.bodyY+100,this.ball.setBodyAngle(0),this.ball.layer.alpha=1,this.basket1.attachBall(this.ball),this.state=o.STARTED},n.prototype.onContinueExpired=function(){this.continueOverLay.removeSelf(),this.showGameOver()},n.prototype.showGameOver=function(){this.txtScore.removeSelf(),this.isBest()&&l.Player.setBestScore(this.score),this.gameOverOverLay=new l.GameOverOverlay(this.score,this.bestBeaten),this.addChild(this.gameOverOverLay)},n.prototype.isNewBest=function(){return 0<this.initialBestScore&&this.score>this.initialBestScore},n.prototype.isBest=function(){return this.score>this.initialBestScore},n}(h5ge.Scene);l.GameScene=e}(GAME||(GAME={})),function(o){var t=function(r){function t(t,e,i,n){var o=r.call(this)||this;return o.world=t,o.ball=e,o.wallLeft=i,o.wallRight=n,o.build(),o}return __extends(t,r),t.prototype.build=function(){this.simuWorld=new p2.World({gravity:[0,o.Params.WORLD_GRAVITY]}),this.simuWorld.defaultContactMaterial.restitution=.7,this.ballBody=this.ball.cloneBody(),this.simuWorld.addBody(this.ballBody),this.simuWorld.addBody(this.wallLeft.body),this.simuWorld.addBody(this.wallRight.body),this.world.layerFront.addChild(this)},t.prototype.init=function(){},t.prototype.updateParabola=function(t){this.removeChildren(),this.ballBody.position=this.ball.body.position.slice(0),this.ballBody.velocity=t;for(var e=4e3,i=1;0<e;){if(e-=100,this.simuWorld.step(.1),i%5==0){var n=o.factory.newCircle(8,16777215);n.x=this.ballBody.position[0],n.y=-this.ballBody.position[1],this.addChild(n)}i++}},t.prototype.clear=function(){this.removeChildren()},t}(h5ge.Container);o.Parabola=t}(GAME||(GAME={})),function(i){var t=function(e){function t(){var t=e.call(this)||this;return t.build(),t.setSizeFromChildren(),t}return __extends(t,e),t.prototype.build=function(){this.crown=h5ge.Sprite.fromFrame("bestscore_crown.png"),this.addChild(this.crown);var t=i.Player.getBestScore().toString();this.txt=i.factory.newText(t),this.addChild(this.txt),i.layout.centerOnX(this.txt,this.crown),this.txt.y=this.crown.height+10},Object.defineProperty(t.prototype,"value",{set:function(t){var e=t.toString();this.txt.text=e,i.layout.centerOnX(this.txt,this.crown)},enumerable:!0,configurable:!0}),t}(h5ge.Container);i.BestScore=t}(GAME||(GAME={})),function(i){var t=function(e){function t(){var t=e.call(this)||this;return t.build(),t.setSizeFromChildren(),t}return __extends(t,e),t.prototype.build=function(){this.star=h5ge.Sprite.fromFrame("star.png"),this.addChild(this.star);var t=i.Player.getStars().toString();this.txt=i.factory.newText(t),this.addChild(this.txt),this.txt.x=this.star.width+10,i.layout.centerOnY(this.txt,this.star)},Object.defineProperty(t.prototype,"value",{get:function(){return i.Player.getStars()},set:function(t){i.Player.setStars(t),i.Player.save();var e=t.toString();this.txt.text=e},enumerable:!0,configurable:!0}),t.prototype.refresh=function(){var t=i.Player.getStars().toString();this.txt.text=t},t}(h5ge.Container);i.Stars=t}(GAME||(GAME={})),function(t){var e=function(){function t(){}return t.GAME_WIDTH=624,t.WORLD_GRAVITY=-35,t.BASKET_WIDTH=140,t.BASKET_HEIGHT=60,t.BASKET_HALF_WIDTH=t.BASKET_WIDTH/2,t.WALL_WIDTH=21,t.WALL_HEIGHT=156,t.GLOBAL_SPEED_RATIO=1,t.DEBUG_COLLIDERS=!1,t.GAMEPLAY_VELOCITY_X=-350,t.BIRD_VELOCITY_Y=700,t.BIRD_GRABITY_Y=-2400,t.PIPE_SPACING=220,t.ConfettiApparitionTime=500,t.ConfettiFallPixelMax=200,t.ConfettiRotationMax=3.14,t.ConfettiScaleXSpeedMax=1,t.ConfettiScaleYSpeedMax=1,t.MAX_CONTINUE=1,t}();t.Params=e}(GAME||(GAME={})),function(e){var i,t;(t=i=e.Orientation||(e.Orientation={}))[t.VERTICAL=0]="VERTICAL",t[t.HORIZONTAL=1]="HORIZONTAL";var n=function(){function t(){}return t.DEBUG_BASKETS=[{x:e.Params.BASKET_HALF_WIDTH+50,y:200,innerWallDesc:{x:30,y:300}},{x:e.Params.GAME_WIDTH-e.Params.BASKET_HALF_WIDTH-20,y:200,innerWallDesc:{angle:Math.PI/2,x:e.Params.GAME_WIDTH-e.Params.BASKET_HALF_WIDTH-20,y:400}},{x:e.Params.BASKET_HALF_WIDTH,y:200,moveDesc:{orientation:i.VERTICAL,moveDistance:300,moveSpeed:3e3}},{x:350,y:200,moveDesc:{orientation:i.HORIZONTAL,moveDistance:200,moveSpeed:2e3}}],t}();e.Data=n}(GAME||(GAME={})),function(t){var e=function(){function t(t){this.world=t}return t.prototype.update=function(t){},t.prototype.render=function(t){},t.prototype.onCollide=function(t,e,i){},t.prototype.setBodyPosition=function(t,e){this.body.position[0]=t,this.body.position[1]=-e},t.prototype.setBodyAngle=function(t){this.body.angle=t},Object.defineProperty(t.prototype,"bodyX",{get:function(){return this.body.position[0]},set:function(t){this.body.position[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bodyY",{get:function(){return this.body.position[1]},set:function(t){this.body.position[1]=t},enumerable:!0,configurable:!0}),t}();t.Entity=e}(GAME||(GAME={})),function(n){var t=function(i){function t(t){var e=i.call(this,t)||this;return e.collideHandlers=new h5ge.HandlerCollection,e.layer=new h5ge.Container,e.sprite=h5ge.Sprite.fromFrame("balls/ball.png"),e.sprite.x=-e.sprite.width/2,e.sprite.y=-e.sprite.height/2,e.layer.addChild(e.sprite),e.build(),e}return __extends(t,i),t.prototype.build=function(){var t=this;this.body=this.createBody(),this.debugPosition=n.factory.newText("Ball: x="),this.debugPosition.x=-500,this.layer.detachListener.once(function(){t.debugPosition.removeSelf()},this),this.world.layerMid.addChild(this.layer),this.ballTail=new n.BallTail(this),this.ballTail.start()},t.prototype.createBody=function(){var t=this.sprite.width/2,e=new p2.Circle({radius:t});e.material=n.Materials.ballMaterial,e.collisionGroup=n.Collisions.COLLISION_GROUP_BALL,e.collisionMask=n.Collisions.COLLISION_MASK_BALL;var i=new p2.Body({mass:1});return i.addShape(e),i},t.prototype.render=function(t){var e=-this.body.interpolatedAngle,i=this.body.interpolatedPosition[0],n=this.body.interpolatedPosition[1];this.layer.x=i,this.layer.y=-n,this.layer.rotation=e},t.prototype.updateDebug=function(){this.debugPosition.text="Ball x="+this.body.position[0].toFixed(0)+" y="+this.body.position[1].toFixed(0)},t.prototype.onCollide=function(t,e,i){this.collideHandlers.fire(t,i)},t.prototype.cloneBody=function(){return this.createBody()},t.prototype.update=function(t){},t.prototype.disappear=function(){var t=n.Helper.tween(this.layer);t.to({alpha:0},100),t.start(),this.ballTail.noParticules()},t}(n.Entity);n.Ball=t}(GAME||(GAME={})),function(e){var t=function(){function t(){this.terminated=!1,this.angle=0,this.startScale=0,this.endScale=1,this.startSpeed=0,this.endSpeed=0,this.lifetime=800,this.startAlpha=0,this.endAlpha=0,this._easing=e.Easing.easeInOutSine,this.build()}return t.prototype.build=function(){this.startAlpha=e.Helper.randomInt(3,10)/10,this.startScale=e.Helper.randomInt(1,5)/10,this.endScale=e.Helper.randomInt(8,12)/10,this.lifetime=e.Helper.randomInt(500,800),this.object=e.factory.newCircle(50,16777215)},t.prototype.start=function(){this.object.scaleXY=this.startScale,this._startTime=h5ge.Time.now(),0<this.lifetime&&(this._endTime=h5ge.Time.now()+this.lifetime);this.angle,h5ge.Maths.DEG_TO_RADIAN},t.prototype.update=function(t){if(!this.terminated){var e=h5ge.Time.now(),i=1;if(0<this.lifetime){if(e>this._endTime)return this.terminated=!0,void(this.object.visible=!1);var n=e-this._startTime,o=Math.min(n,this.lifetime)/this.lifetime;i=this._easing(o)}var r=this.startScale+(this.endScale-this.startScale)*i;this.object.scaleXY=r;var s=this.startAlpha+(this.endAlpha-this.startAlpha)*i;this.object.alpha=s}},t.prototype.reset=function(){this.terminated=!1,this.object.visible=!0},t.prototype.destroy=function(){this.object.visible=!1},t}();e.BallParticle=t}(GAME||(GAME={})),function(c){var l,t;(t=l||(l={}))[t.NOTHING=0]="NOTHING",t[t.SMOKE=1]="SMOKE",t[t.TAIL=2]="TAIL";var e=function(i){function t(t){var e=i.call(this,t.world.layerBack)||this;return e.ball=t,e.state=l.NOTHING,e.val=0,e.val2=0,e.build(),e}return __extends(t,i),t.prototype.build=function(){this.emit=this.emitParticule.bind(this)},t.prototype.emitParticule=function(){var t=[];if(this.state!=l.NOTHING){this.val++;var e=!1;if(2==this.val&&(e=!0,this.val=0),e)for(var i=c.Helper.randomInt(1,2),n=0;n<i;n++){var o=new c.BallParticle,r=c.Helper.randomInt(-15,15),s=c.Helper.randomInt(-15,15);o.object.x=this.ball.body.interpolatedPosition[0]+r,o.object.y=-this.ball.body.interpolatedPosition[1]+s,t.push(o)}this.val2++;var a=!1;if(2==this.val2&&(a=!0,this.val2=0),this.state==l.TAIL&&a){var h=new c.BallTailParticle(this.ball,"balls/effect/tail4.png");h.object.x=this.ball.body.interpolatedPosition[0]-h.object.width/2/h.scaleT1,h.object.y=-this.ball.body.interpolatedPosition[1]-h.object.height/2/h.scaleT1,t.push(h)}}return t},t.prototype.noParticules=function(){this.state=l.NOTHING},t.prototype.smokeParticles=function(){this.state=l.SMOKE},t.prototype.tailParticles=function(){this.state=l.TAIL},t}(h5ge.Emitter);c.BallTail=e}(GAME||(GAME={})),function(l){var t=function(){function t(t,e){this.ball=t,this.asset=e,this.terminated=!1,this.angle=0,this.scaleT1=.5,this.scaleT2=.75,this.scaleT3=0,this.endScale=0,this.startSpeed=0,this.endSpeed=0,this.lifetime=600,this.startAlpha=0,this.endAlpha=0,this.startColor=16771917,this.endColor=16745762,this._easing=l.Easing.easeInOutSine,this.build()}return t.prototype.build=function(){this.startAlpha=1,this.object=h5ge.Sprite.fromFrame(this.asset),this.object.setPivotToCenter(),this.object.scaleXY=this.scaleT1,this.object.rotation=this.ball.body.interpolatedAngle},t.prototype.start=function(){this._startTime=h5ge.Time.now(),0<this.lifetime&&(this._endTime=h5ge.Time.now()+this.lifetime);this.angle,h5ge.Maths.DEG_TO_RADIAN},t.prototype.update=function(t){if(!this.terminated){var e=h5ge.Time.now(),i=1;if(0<this.lifetime&&e>this._endTime)return this.terminated=!0,void(this.object.visible=!1);var n=e-this._startTime,o=this.lifetime/10;if(n<o){var r=Math.min(n,o)/o;i=this._easing(r);var s=this.scaleT1+(this.scaleT2-this.scaleT1)*i;this.object.scaleXY=s}else{n-=o;var a=this.lifetime-o;r=Math.min(n,a)/a;i=this._easing(r);s=this.scaleT2+(this.scaleT3-this.scaleT2)*i;this.object.scaleXY=s}n=e-this._startTime,r=Math.min(n,this.lifetime)/this.lifetime;i=l.Easing.easeInCirc(r);var h=this.startAlpha+(this.endAlpha-this.startAlpha)*i;this.object.alpha=h;n=e-this._startTime,r=Math.min(n,this.lifetime)/this.lifetime;i=l.Easing.easeInExpo(r);var c=this.startColor+(this.endColor-this.startColor)*i;this.object.tint=c}},t.prototype.reset=function(){this.terminated=!1,this.object.visible=!0},t.prototype.destroy=function(){this.object.visible=!1},t}();l.BallTailParticle=t}(GAME||(GAME={})),function(e){var t=function(i){function t(t){var e=i.call(this,t)||this;return e.collideHandlers=new h5ge.HandlerCollection,e.build(),e}return __extends(t,i),t.prototype.build=function(){var t=new p2.Line({length:e.Game.get().width});t.sensor=!0,t.collisionGroup=e.Collisions.COLLISION_GROUP_BALL,t.collisionMask=e.Collisions.COLLISION_MASK_GROUND,this.body=new p2.Body,this.body.addShape(t)},t.prototype.onCollide=function(t,e,i){this.collideHandlers.fire()},t}(e.Entity);e.Plane=t}(GAME||(GAME={})),function(o){var t=function(n){function t(t,e){void 0===e&&(e=!0);var i=n.call(this,t)||this;return i.left=e,i.build(),i}return __extends(t,n),t.prototype.build=function(){var t=Math.PI/2;this.left&&(t*=-1),this.body=new p2.Body({angle:t});var e=new p2.Plane;e.material=o.Materials.wallMaterial,this.body.addShape(e)},t.prototype.onCollide=function(t,e,i){o.SoundManager.playBorderSound()},t.prototype.update=function(t){},t.prototype.playEffect=function(t){new o.WallEffect(this,t).start()},t}(o.Entity);o.Wall2=t}(GAME||(GAME={})),function(n){var t=function(){function t(t,e){this.wall=t,this.point=e,this.build()}return t.prototype.build=function(){this.hit=h5ge.Sprite.fromFrame("wall/effect/hit_beams.png"),this.wall.left?this.hit.setPivot(0,this.hit.height/2):(this.hit.flipX=!0,this.hit.x=n.Game.get().width-this.hit.width,this.hit.setPivot(this.hit.width,this.hit.height/2)),this.hit.tint=n.Colors.BASKET_EFFECT,this.hit.y=this.point.y,this.wall.world.layerFront.addChild(this.hit)},t.prototype.update=function(t){},t.prototype.start=function(){var t=this;this.hit.scaleX=5,this.hit.scaleY=.3;var e=n.Helper.tween(this.hit);e.to({scaleX:4,scaleY:.2},20),e.to({scaleX:.6,scaleY:4},300,n.Easing.EaseOutBack),e.onComplete=function(){t.hit.removeSelf()},e.start();var i=n.Helper.tween(this.hit);i.delay(20),i.to({alpha:0},280),i.start()},t}();n.WallEffect=t}(GAME||(GAME={})),function(g){var s,t;(t=s||(s={}))[t.READY=0]="READY",t[t.THROWING=1]="THROWING";var e=function(r){function t(t,e,i,n){void 0===i&&(i=[0,0]),void 0===n&&(n=!1);var o=r.call(this,t)||this;return o.desc=e,o.refPoint=i,o.withStar=n,o.backLayer=new h5ge.Container,o.frontLayer=new h5ge.Container,o.state=s.READY,o.scored=!1,o.touchedBorder=!1,o.star=null,o.build(),o}return __extends(t,r),t.prototype.build=function(){var t=this;this.body=new p2.Body,this.net=h5ge.Sprite.fromFrame("basket/basket_net.png"),this.netHeight=this.net.height,this.netWidth=this.net.width,this.net.x=-this.net.width/2,this.net.y=0,this.frontLayer.addChild(this.net),this.backHoop=h5ge.Sprite.fromFrame("basket/basket_back.png"),this.backHoop.x=-this.backHoop.width/2,this.backHoop.y=-this.backHoop.height/2-10,this.backLayer.addChild(this.backHoop),this.frontHoop=h5ge.Sprite.fromFrame("basket/basket_front.png"),this.frontHoop.x=-this.frontHoop.width/2,this.frontHoop.y=-this.frontHoop.height/2-10,this.frontLayer.addChild(this.frontHoop);var e=this.net.width;this.leftBorderShape=new p2.Circle({radius:10}),this.leftBorderShape.material=g.Materials.basketMaterial,this.body.addShape(this.leftBorderShape,[-e/2,10]),this.rightBorderShape=new p2.Circle({radius:10}),this.rightBorderShape.material=g.Materials.basketMaterial,this.body.addShape(this.rightBorderShape,[e/2,10]),this.world.layerBack.addChild(this.backLayer),this.world.layerFront.addChild(this.frontLayer);var i=[];i.push({vertices:[[0,58],[2,45],[7,48],[5,58]]}),i.push({vertices:[[12,31],[19,22],[17,32],[7,48],[2,45]]}),i.push({vertices:[[123,58],[118,44],[115,29],[122,41],[128,58]]}),i.push({vertices:[[108,29],[105,18],[115,29],[118,44]]}),i.push({vertices:[[90,12],[90,7],[105,18],[108,29]]}),i.push({vertices:[[19,22],[34,9],[36,14],[17,32]]}),i.push({vertices:[[34,9],[53,0],[52,4],[36,14]]}),i.push({vertices:[[90,12],[68,4],[76,0],[90,7]]}),i.push({vertices:[[68,4],[52,4],[53,0],[76,0]]});for(var n=[-this.net.width/2,-this.net.height],o=0;o<i.length;o++){var r=i[o],s=new p2.Convex(r);s.material=g.Materials.netMaterial,this.body.addShape(s,n)}this.scoreShape=new p2.Circle({radius:4}),this.scoreShape.sensor=!0,this.body.addShape(this.scoreShape,[0,4-this.net.height+10]),this.body.shapes.forEach(function(t){t.collisionGroup=g.Collisions.COLLISION_GROUP_NET,t.collisionMask=g.Collisions.COLLISION_MASK_NET});var a=g.factory.newCircle(4,16711680);a.x=0,a.y=-this.scoreShape.position[1];var h=g.factory.newCircle(10,16776960);h.x=-e/2,h.y=-h.height/2;var c=g.factory.newCircle(10,16776960);if(c.x=e/2,c.y=-c.height/2,this.body.position[0]=this.refPoint[0]+this.desc.x,this.body.position[1]=this.refPoint[1]+this.desc.y,this.desc.angle&&(this.body.angle=this.desc.angle),this.desc.innerWallDesc&&(this.innerWall=new g.BasketWall(this.world,this.desc.innerWallDesc,this.body.position),this.world.addEntity(this.innerWall)),this.desc.moveDesc){var l=this.desc.moveDesc,u=l.moveDistance,p=u/Math.abs(u),d=l.moveSpeed;this.moveTween=g.Helper.tween(this);var f=this.body.position[0],y=this.body.position[1];l.orientation==g.Orientation.VERTICAL?(this.moveTween.to({bodyY:y-u},d,g.Easing.easeInOutSine),this.moveTween.delay(100),this.moveTween.to({bodyY:y},d,g.Easing.easeInOutSine),this.moveTween.delay(100)):l.orientation==g.Orientation.HORIZONTAL&&(this.moveTween.to({bodyX:f+u},d,g.Easing.easeInOutSine),this.moveTween.delay(100),this.moveTween.to({bodyX:f},d,g.Easing.easeInOutSine),this.moveTween.delay(100)),this.moveTween.repeat(-1),this.moveTween.start(),this.moveLine=new g.BasketMoveLine(l),this.moveLine.x=f,this.moveLine.y=-y,-1==p&&(this.moveLine.x-=this.moveLine.width,this.desc.moveDesc.orientation==g.Orientation.VERTICAL&&(this.moveLine.y-=this.moveLine.height)),this.world.layerBack.addChild(this.moveLine),this.moveLine.detachListener.once(function(){t.moveTween&&(t.moveTween.stop(),t.moveTween=null)},this)}this.withStar&&(this.star=new g.BasketStar(this.world,[this.bodyX,this.bodyY]),this.world.addEntity(this.star))},t.prototype.update=function(t){this.desc.moveDesc},t.prototype.render=function(t){var e=-this.body.angle,i=this.bodyX,n=-this.bodyY;e!=this.frontLayer.rotation&&(this.frontLayer.rotation=e,this.backLayer.rotation=e),i!=this.frontLayer.x&&(this.frontLayer.x=i,this.backLayer.x=i),n!=this.frontLayer.y&&(this.frontLayer.y=n,this.backLayer.y=n),this.ballInside&&(this.ballInside.bodyX=this.bodyX-25*Math.cos(Math.PI/2+this.body.angle),this.ballInside.bodyY=this.bodyY-25*Math.sin(Math.PI/2+this.body.angle),this.ballInside.setBodyAngle(0))},t.prototype.onCollide=function(t,e,i){var n=this;e==this.leftBorderShape||e==this.rightBorderShape?(this.touchedBorder=!0,g.SoundManager.play(g.Sounds.SND_EV_HOOP_BALL_0)):e==this.scoreShape||this.netTween||(g.SoundManager.play(g.Sounds.SND_EV_COLLISION_NET_0),this.netTween=g.Helper.tween(this.net),this.netTween.to({scaleY:.7},80),this.netTween.to({scaleY:1},80),this.netTween.start(),this.netTween.onComplete=function(){n.netTween=null},g.SoundManager.playNetSound())},t.prototype.attachBall=function(t,e,i){void 0===e&&(e=!0),g.SoundManager.playNetSound();var n=this;if(this.moveTween&&(this.moveTween.stop(),this.moveTween=null),this.state!=s.READY)return!1;if(this.state=s.READY,t.body.gravityScale=0,t.body.velocity=[0,0],t.body.setZeroForce(),t.body.angularVelocity=0,(this.ballInside=t).body.position[0]=this.body.position[0]-25*Math.cos(Math.PI/2+this.body.angle),t.body.position[1]=this.body.position[1]-25*Math.sin(Math.PI/2+this.body.angle),e){var o=h5ge.TweenManager.get().create(this.body);o.to({angle:0},60),o.start(),this.netTween&&(this.netTween.stop(),this.net.scaleY=1),this.netTween=g.Helper.tween(this.net),this.netTween.to({scaleY:1.2},100),this.netTween.to({scaleY:1},100),this.netTween.onComplete=function(){n.netTween=null},this.netTween.start();var r=g.Helper.tween(this.ballInside.sprite);r.to({y:this.ballInside.sprite.y+.2*this.netHeight},100),r.to({y:this.ballInside.sprite.y},100),r.start(),r.onComplete=i}else this.net.scaleY=1,i();return!0},t.prototype.throwBall=function(t){if(this.state==s.READY){this.ballInside.sprite.x=-this.ballInside.sprite.width/2,this.ballInside.sprite.y=-this.ballInside.sprite.height/2,this.ballInside.body.angle=0,this.state=s.THROWING;var e=this.ballInside;e.body.gravityScale=1,e.body.velocity=t,e.body.position[0]+=10*Math.cos(Math.PI/2+this.body.angle),e.body.position[1]+=10*Math.sin(Math.PI/2+this.body.angle),e.body.angularVelocity=.9,this.world.addEntity(e),this.ballInside=null,this.state=s.READY;var i=this.net.scaleY-1,n=Math.max(0,this.net.scaleY-4*i),o=g.Helper.tween(this.net);o.to({scaleY:n},100),o.to({scaleY:1},100),o.start(),g.SoundManager.play(g.Sounds.SND_EV_RELEASE_HIGH)}},t.prototype.isReadyToThrow=function(){return this.state==s.READY},Object.defineProperty(t.prototype,"scaleXY",{get:function(){return this.frontLayer.scaleXY},set:function(t){this.frontLayer.scaleXY=t,this.backLayer.scaleXY=t},enumerable:!0,configurable:!0}),t.prototype.onScore=function(t){this.playEffect(t),this.backHoop.setTexture(h5ge.Texture.fromFrame("basket/basket_back_gray.png")),this.frontHoop.setTexture(h5ge.Texture.fromFrame("basket/basket_front_gray.png"))},t.prototype.playEffect=function(t){new g.BasketEffect(this,t).start(),this.innerWall&&this.innerWall.disappear(),this.star&&this.star.disappear(),this.moveLine&&this.moveLine.removeSelf()},t.prototype.updateVelocity=function(t){if(t){var e=Math.pow(t[0],2),i=Math.pow(t[1],2),n=Math.sqrt(e+i);this.body.angle;this.net.scaleY=Math.max(1,n/150),this.ballInside.sprite.x=-this.ballInside.sprite.width/2+this.netHeight*(this.net.scaleY-1)*Math.cos(this.backLayer.rotation+Math.PI/2),this.ballInside.sprite.y=-this.ballInside.sprite.height/2+this.netHeight*(this.net.scaleY-1)*Math.sin(this.backLayer.rotation+Math.PI/2)}},t.prototype.appear=function(){this.scaleXY=0;var t=g.Helper.tween(this);t.delay(250),t.to({scaleXY:1},250,g.Easing.EaseOutBack),t.start(),this.innerWall&&this.innerWall.appear()},t.prototype.disappear=function(){var t=this;this.world.removeEntity(this);var e=g.Helper.tween(this);e.to({scaleXY:0},250,g.Easing.EaseInBack),e.onComplete=function(){t.frontLayer.removeSelf(),t.backLayer.removeSelf()},e.start(),this.star&&this.star.disappear(),this.innerWall&&this.innerWall.disappear()},t}(g.Entity);g.Basket=e}(GAME||(GAME={})),function(s){var t=function(){function t(t,e){this.basket=t,this.perfect=e,this.build()}return t.prototype.build=function(){this.ring=h5ge.Sprite.fromFrame("basket/effect/ring.png"),this.ring.setPivot(this.ring.width/2,this.ring.height/2),this.ring.tint=s.Colors.BASKET_EFFECT,this.ring.x=-this.ring.width/2,this.ring.y=-this.ring.height/2-15,this.basket.frontLayer.addChild(this.ring)},t.prototype.update=function(t){},t.prototype.start=function(){var t=.8,e=1.2;if(this.perfect){t=1,e=1.8;var i=new a;this.basket.frontLayer.addChild(i),i.start()}var n=this;this.ring.scaleXY=t;var o=s.Helper.tween(this.ring);o.to({scaleXY:e},450,s.Easing.easeOutCirc),o.onComplete=function(){n.ring.removeSelf()},o.start();var r=s.Helper.tween(this.ring);r.delay(100),r.to({alpha:0},350),r.start()},t}();s.BasketEffect=t;var o=function(r){function t(t,e,i,n){var o=r.call(this,h5ge.Texture.fromFrame("basket/effect/dot.png"))||this;return o.directionAngle=t,o.distance=e,o.initialScaleX=i,o.initialScaleY=n,o.vX=-1,o.vY=-10,o.gravity=-7e3,o.started=!1,o.build(),o}return __extends(t,r),t.prototype.build=function(){this.setPivotToCenter(),this.scaleX=this.initialScaleX,this.scaleY=this.initialScaleY,this.rotation=-this.directionAngle,this.vX=this.distance*Math.cos(Math.PI/2+this.directionAngle),this.vY=-this.distance*Math.sin(Math.PI/2+this.directionAngle),this.tint=s.Colors.BASKET_EFFECT},t.prototype.update=function(t){this.x+=this.vX*t/1e3,this.y+=this.vY*t/1e3,this.vY=this.vY-this.gravity*t/1e3,-100<this.vY&&(this.gravity=-4e3,this.rotation+=this.rotation/10),this.scaleY>this.scaleX?this.scaleY-=.15:(this.vX=9*this.vX/10,this.alpha-=.05),this.alpha<.01&&(this.started=!1,s.Game.get().removeUpdatable(this),this.removeSelf())},t.prototype.start=function(){this.started=!0,s.Game.get().addUpdatable(this);s.Helper.tween(this)},t}(h5ge.Sprite);s.PerfectParticule=o;var a=function(e){function t(){var t=e.call(this)||this;return t.started=!1,t.build(),t}return __extends(t,e),t.prototype.build=function(){var t=s.Colors.BASKET_EFFECT;this.beam1=s.factory.newSprite("basket/effect/trawel_beam_1.png"),this.beam1.tint=t,this.beam1.x=10-this.beam1.width,this.beam1.y=50-this.beam1.height,this.beam1.setPivot(this.beam1.width,this.beam1.height),this.beam1.scaleX=.1,this.beam1.scaleY=.25,this.beam1.rotation=s.Helper.radians(135),this.addChild(this.beam1),this.beam2=h5ge.Sprite.fromFrame("basket/effect/trawel_beam_2.png"),this.beam2.tint=t,this.beam2.x=-10,this.beam2.y=50-this.beam2.height,this.beam2.setPivot(0,this.beam2.height),this.beam2.scaleX=.1,this.beam2.scaleY=.25,this.beam2.rotation=s.Helper.radians(-135),this.addChild(this.beam2);var e=new o(s.Helper.radians(10),1300,.2,2);this.addChild(e),e.x-=54,e.y-=40;var i=new o(s.Helper.radians(-10),1400,.3,3);i.x-=34,i.y-=60,this.addChild(i);var n=new o(s.Helper.radians(1),1350,.3,3);n.x-=44,n.y-=20,this.addChild(n),s.Game.get().addUpdatable(this),this.start(),e.start(),i.start(),n.start()},t.prototype.start=function(){var t=s.Helper.tween(this.beam1),e=10,i=this.beam1.rotation+s.Helper.radians(-10),n=60;t.to({rotation:i,scaleX:.15,x:this.beam1.x-e*Math.cos(i),y:this.beam1.y-e*Math.sin(i)},16),t.to({scaleX:.6,scaleXY:.3,x:this.beam1.x-n*Math.cos(i),y:this.beam1.y-n*Math.sin(i)},128),t.to({alpha:0},80),t.start();t=s.Helper.tween(this.beam2),e=-10,i=this.beam2.rotation+s.Helper.radians(10),n=-60;t.to({rotation:i,scaleX:.15,x:this.beam2.x-e*Math.cos(i),y:this.beam2.y-e*Math.sin(i)},16),t.to({scaleX:.6,scaleXY:.3,x:this.beam2.x-n*Math.cos(i),y:this.beam2.y-n*Math.sin(i)},128),t.to({alpha:0},80),t.start()},t.prototype.update=function(t){this.started&&(this.beam1.x-=1*Math.cos(this.beam1.rotation),this.beam1.y-=1*Math.sin(this.beam1.rotation))},t}(h5ge.Container);s.PerfectEffect=a}(GAME||(GAME={})),function(s){var t=function(i){function t(t){var e=i.call(this)||this;return e.moveDesc=t,e.build(),e}return __extends(t,i),t.prototype.build=function(){for(var t=0,e=0,i=Math.round(Math.abs(this.moveDesc.moveDistance)/40),n=Math.abs(this.moveDesc.moveDistance)/i,o=0;o<=i;o++){var r=s.factory.newCircle(6,6710886);r.alpha=.5,r.x=t,r.y=e,this.addChild(r),this.moveDesc.orientation==s.Orientation.HORIZONTAL?t+=n:this.moveDesc.orientation==s.Orientation.VERTICAL&&(e+=n)}this.setSizeFromChildren()},t.prototype.update=function(t){},t}(h5ge.Container);s.BasketMoveLine=t}(GAME||(GAME={})),function(o){var t,e;(e=t||(t={}))[e.READY=0]="READY",e[e.THROWING=1]="THROWING";var i=function(n){function e(t,e){var i=n.call(this,t)||this;return i.refPoint=e,i.build(),i}return __extends(e,n),e.prototype.build=function(){this.body=new p2.Body,this.layer=new h5ge.Container,this.sprite=h5ge.Sprite.fromFrame("star.png"),this.sprite.x=-this.sprite.width/2,this.sprite.y=-this.sprite.height/2,this.layer.addChild(this.sprite),this.layer.setSizeFromChildren();var t=this.sprite.width/2;this.shape=new p2.Circle({radius:t}),this.shape.sensor=!0,this.body.addShape(this.shape),this.bodyX=this.refPoint[0],this.bodyY=this.refPoint[1]+e.STAR_Y,this.layer.x=this.bodyX,this.layer.y=this.bodyY,this.world.layerMid.addChild(this.layer),this.shape.collisionGroup=o.Collisions.COLLISION_GROUP_WALL,this.shape.collisionMask=o.Collisions.COLLISION_MASK_WALL,this.tween=o.Helper.tween(this),this.tween.to({bodyY:this.bodyY-20},500,o.Easing.easeOutSine),this.tween.delay(100),this.tween.to({bodyY:this.bodyY},500,o.Easing.easeOutSine),this.tween.delay(100),this.tween.repeat(-1),this.tween.start()},e.prototype.update=function(t){},e.prototype.render=function(t){this.layer.x=this.bodyX,this.layer.y=-this.bodyY},e.prototype.onCollide=function(t,e,i){this.disappear(),o.SoundManager.play(o.Sounds.SND_EV_COIN)},e.prototype.disappear=function(){this.world.removeEntity(this),this.layer.removeSelf()},e.STAR_Y=80,e}(o.Entity);o.BasketStar=i}(GAME||(GAME={})),function(n){var t,e;(e=t||(t={}))[e.READY=0]="READY",e[e.THROWING=1]="THROWING";var i=function(o){function t(t,e,i){var n=o.call(this,t)||this;return n.desc=e,n.refPoint=i,n.build(),n}return __extends(t,o),t.prototype.build=function(){this.body=new p2.Body,this.layer=new h5ge.Container,this.sprite=n.factory.newBasketWall(this.desc),this.layer.addChild(this.sprite),this.layer.setSizeFromChildren();var t={width:this.sprite.width,height:this.sprite.height};this.shape=new p2.Box(t),this.body.addShape(this.shape),this.bodyX=this.desc.x+this.refPoint[0],this.bodyY=this.desc.y+this.refPoint[1],this.layer.x=this.bodyX,this.layer.y=this.bodyY,this.desc.angle&&(this.layer.rotation=this.desc.angle),this.world.layerBack.addChild(this.layer),this.shape.collisionGroup=n.Collisions.COLLISION_GROUP_WALL,this.shape.collisionMask=n.Collisions.COLLISION_MASK_WALL},t.prototype.update=function(t){},t.prototype.render=function(t){this.bodyX!=this.layer.x&&(this.layer.x=this.bodyX),this.bodyY!=-this.layer.y&&(this.layer.y=-this.bodyY),this.body.angle!=-this.layer.rotation&&(this.body.angle=-this.layer.rotation)},t.prototype.onCollide=function(t,e,i){n.SoundManager.playBorderSound()},t.prototype.appear=function(){this.layer.scaleXY=0;var t=n.Helper.tween(this.layer);t.to({scaleXY:1},250,n.Easing.EaseOutBack),t.start()},t.prototype.disappear=function(){this.world.removeEntity(this);var t=this,e=n.Helper.tween(this.layer);e.to({scaleXY:0},250,n.Easing.easeOutSine),e.onComplete=function(){t.layer.removeSelf()},e.start()},t}(n.Entity);n.BasketWall=i}(GAME||(GAME={})),function(o){var t=function(n){function t(){var t=n.call(this)||this;t.arrow=h5ge.Sprite.fromFrame("arrow.png"),t.arrow.setPivot(t.arrow.width/2,0),t.arrow.x=-t.arrow.width/2,t.addChild(t.arrow),t.finger=h5ge.Sprite.fromFrame("finger.png"),t.finger.x=-40,t.finger.y=t.arrow.height+20,t.addChild(t.finger);var e=o.Helper.tween(t.arrow);e.delay(500),e.to({scaleY:2,rotation:Math.PI/10},500),e.to({scaleY:1,rotation:0},150),e.repeat(-1),e.start();var i=o.Helper.tween(t.finger);return i.delay(500),i.to({x:t.finger.x-40,y:t.finger.y+30},500),i.to({x:t.finger.x,y:t.finger.y},150),i.repeat(-1),i.start(),t}return __extends(t,n),t.prototype.update=function(t){},t.prototype.render=function(t){},t}(h5ge.Container);o.DragIt=t}(GAME||(GAME={})),function(t){var e=function(e){function t(){var t=e.call(this)||this;return t.build(),t}return __extends(t,e),t.prototype.build=function(){var t=this,e=function(){console.log("Am I fullscreen?",screenfull.isFullscreen?"Yes":"No"),t.onFullscreenChange()};screenfull.on("change",e),this.detachListener.once(function(){screenfull.off("change",e)},this);var i=null;i=screenfull.isFullscreen?"buttons/icons/icon_fullscreenoff.png":"buttons/icons/icon_fullscreen.png",this.button=h5ge.ImageButton.fromFramesArray(["buttons/large_circle_buttonv3.png","buttons/large_circle_buttonv3_pressed.png","buttons/large_circle_buttonv3_hover.png"]),this.button.setIcon(i),this.addChild(this.button),this.setSizeFromChildren(),this.button.onClick(this.toggleFullScreen,this),this.initSound()},t.prototype.onFullscreenChange=function(){var t=null;t=screenfull.isFullscreen?"buttons/icons/icon_fullscreenoff.png":"buttons/icons/icon_fullscreen.png",this.button.setIcon(t)},t.prototype.initSound=function(){},t.prototype.toggleFullScreen=function(){screenfull.toggle()},t}(h5ge.Container);t.FullscreenButton=e}(GAME||(GAME={})),function(o){var t=function(i){function n(){var t=i.call(this,h5ge.ImageButtonStyle.fromTextures(n.getUpTexture(),n.getDownTexture(),n.getHoverTexture()))||this,e=t;return t.onClick(function(){o.SelectLangPopup.launch(function(t){o.Handlers.langChangedHandlers.fire(),e.onLangChanged(t)})},t),t}return __extends(n,i),n.prototype.onLangChanged=function(t){this.setFrames(n.getFrame(t,""),n.getFrame(t,"_hover"),n.getFrame(t,"_pressed"))},n.getUpTexture=function(t){var e=this.getFrame(t,"");return h5ge.Texture.fromFrame(e)},n.getDownTexture=function(t){var e=this.getFrame(t,"_hover");return h5ge.Texture.fromFrame(e)},n.getHoverTexture=function(t){var e=this.getFrame(t,"_pressed");return h5ge.Texture.fromFrame(e)},n.getFrame=function(t,e){return null==t&&(t=o.Player.get().getLang()||h5ge.I18N.locale),-1==h5ge.I18N.availableLocales.indexOf(t)&&(t=h5ge.I18N.locale),"buttons/lang/"+t+e+".png"},n}(h5ge.ImageButton);o.LangButton=t}(GAME||(GAME={})),function(f){var t=function(d){function t(t){var e=d.call(this,f.Game.get().width,f.Game.get().height)||this;e.onClicked=t;for(var i=new h5ge.Container,n=[[191,676],[219,620],[246,576],[272,543],[296,520],[319,507],[341,503],[362,508]],o=0;o<n.length;o++){var r=n[o],s=f.factory.newCircle(8,16777215);s.x=r[0],s.y=r[1],i.addChild(s)}e.addChild(i),e.goalTxt=f.factory.newText(f.I18N.get(f.I18NK.GOAL),60),e.goalTxt.x=450-e.goalTxt.width/2,e.goalTxt.y=420,e.addChild(e.goalTxt);var a=f.factory.newSprite("arrow.png");e.addChild(a),f.layout.centerOnX(a,e.goalTxt),a.y=e.goalTxt.bottom+20,e.logo=h5ge.Sprite.fromFrame("logo.png"),e.logo.y=140,e.addChild(e.logo),h5ge.layout.centerOnXInParent(e.logo),e.dragIt=new f.DragIt,e.dragIt.x=170,e.dragIt.y=800,e.addChild(e.dragIt),e.txtDragToStart=f.factory.newText(f.I18N.get(f.I18NK.DRAG_TO_START),50),e.txtDragToStart.y=f.Game.get().height-e.txtDragToStart.height-10,f.factory.blink(e.txtDragToStart),e.addChild(e.txtDragToStart),h5ge.layout.centerOnXInParent(e.txtDragToStart);f.shipi.gs.playerManager.getPlayer(function(t){f.logger.info("Player data loaded => "+t)});var h=e;f.Player.onLoaded(function(){var t=new f.LangButton;t.x=f.Game.get().width-t.width-5,t.y=5,h.addChild(t)});var c=f.factory.newText(f.GAMECONFIG.gameVersion,22);c.x=f.Game.get().width-c.width-5,c.y=f.Game.get().height-c.height-5,e.addChild(c);var l=new f.SoundButton;if(l.x=5,l.y=5,e.addChild(l),screenfull.enabled){var u=new f.FullscreenButton;u.x=l.right+10,u.y=5,e.addChild(u)}var p=f.Handlers.langChangedHandlers.add(e.onLangChanged,e);return e.detachListener.once(function(){f.Handlers.langChangedHandlers.removeCtx(p)},e),e}return __extends(t,d),t.prototype.play=function(){},t.prototype.onLangChanged=function(t){this.txtDragToStart.text=f.I18N.get(f.I18NK.TAP_TO_PLAY),this.txtDragToStart.x=f.Game.get().width/2-this.txtDragToStart.width/2,this.goalTxt.text=f.I18N.get(f.I18NK.GOAL),this.goalTxt.x=450-this.goalTxt.width/2},t}(h5ge.Container);f.MenuOverlay=t}(GAME||(GAME={})),function(e){var t=function(){function t(t){void 0===t&&(t=.5),this.logger=h5ge.logger,this.closeHandler=new h5ge.HandlerCollection,this._alpha=t,this.game=h5ge.Game.get(),this.container=new h5ge.Container,this.bgContainer=new h5ge.Container(934,1400),this.bgContainer.interactive=!0,this.bgContainer.showCursor=!1;this.game.scaleManager;this.emptyRect=new h5ge.Graphics,this.emptyRect.beginFill(0,this.alpha),this.emptyRect.drawRect(0,0,934,1400),this.emptyRect.endFill(),this.emptyRect.setSize(934,1400),this.bgContainer.addChild(this.emptyRect),this.bgContainer.x=e.Game.get().width/2-this.bgContainer.width/2,this.bgContainer.y=e.Game.get().height/2-this.bgContainer.height/2,this.container.addChild(this.bgContainer),this.contentContainer=new h5ge.Container(e.Game.get().width,e.Game.get().height/2),this.container.addChild(this.contentContainer)}return t.prototype.setPosition=function(t,e){this.contentContainer.x=t,this.contentContainer.y=e},t.prototype.center=function(){this.contentContainer.x=(this.game.width-this.contentContainer.width)/2,this.contentContainer.y=(this.game.height-this.contentContainer.height)/2},t.prototype.show=function(t){void 0===t&&(t=this.game.layers.popup),t.addChild(this.container)},t.prototype.close=function(){this.container.removeSelf(),this.closeHandler.fire()},t.prototype.addChild=function(t){this.contentContainer.addChild(t)},t.prototype.removeChild=function(t){this.contentContainer.removeChild(t)},Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(t){this._alpha=t},enumerable:!0,configurable:!0}),t}();e.Popup=t}(GAME||(GAME={})),function(n){var t=function(i){function e(t){var e=i.call(this,.5)||this;return e.callback=t,e.saveToProfile=!0,e.langs=h5ge.I18N.availableLocales,e.build(),e}return __extends(e,i),e.launch=function(t){new e(t).show()},e.prototype.build=function(){var t=h5ge.Sprite.fromFrame("popup_small.png");this.contentContainer.addChild(t);n.Game.get().bounds;var e=this.getContent();e.setPivotToCenter(),e.x=t.width/2-e.width/2,e.y=t.height/2-e.height/2,this.contentContainer.addChild(e),this.contentContainer.setSizeFromChildren(),this.center(),this.contentContainer.onClick(function(){}),this.bgContainer.onClick(this.close,this)},e.prototype.getContent=function(){for(var t=new h5ge.Container,e=0;e<this.langs.length;e++){var i=this.langs[e],n=h5ge.ImageButton.fromFrames("buttons/lang/"+i+".png","buttons/lang/"+i+"_hover.png","buttons/lang/"+i+"_pressed.png");n.x=e*(50+n.width),t.addChild(n),this.addSelectionHandler(n,i)}return t.setSizeFromChildren(),t},e.prototype.addSelectionHandler=function(t,e){var i=this;t.onClick(function(){i.langSelected=e,i.onLangSelected(e),i.callback(e),i.close()})},e.prototype.onLangSelected=function(i){if(this.saveToProfile){h5ge.I18N.setLocale(i);var n=ship.ShipGs.get().playerManager;n.getPlayer(function(t){t.setLang(i);var e=new gs.SPlayer;e.setLang(i),n.savePlayerDiff(e)})}},e.prototype._generatBg=function(){var t=new h5ge.Graphics;return t.beginFill(6710886,.9),t.drawRoundedRect(0,0,500,250,20),t.endFill(),t.setSize(500,250),t},e}(n.Popup);n.SelectLangPopup=t}(GAME||(GAME={})),function(i){var t=function(e){function t(){var t=e.call(this)||this;return t.build(),t}return __extends(t,e),t.prototype.build=function(){var t=null;t=i.Player.getSoundsEnable()?"buttons/icons/icon_sound.png":"buttons/icons/icon_soundoff.png",this.button=h5ge.ImageButton.fromFramesArray(["buttons/large_circle_buttonv3.png","buttons/large_circle_buttonv3_pressed.png","buttons/large_circle_buttonv3_hover.png"]),this.button.setIcon(t),this.addChild(this.button),this.setSizeFromChildren(),this.button.onClick(this.toggleSound,this),this.initSound()},t.prototype.initSound=function(){},t.prototype.toggleSound=function(){i.SoundManager.loadSounds(function(){});var t=null;!i.Player.getSoundsEnable()?(t="buttons/icons/icon_sound.png",i.SoundManager.get(),i.SoundManager.unmuteSounds(),i.Player.setSoundsEnable(!0)):(t="buttons/icons/icon_soundoff.png",i.SoundManager.muteSounds(),i.Player.setSoundsEnable(!1)),i.Player.save(),this.button.setIcon(t)},t}(h5ge.Container);i.SoundButton=t}(GAME||(GAME={})),function(r){var t=function(n){function t(t,e){void 0===e&&(e=!0);var i=n.call(this,t)||this;return i.ctn=t,i.left=e,i.val=0,i.val2=0,i.done=!1,i.build(),i}return __extends(t,n),t.prototype.build=function(){this.emit=this.emitParticule.bind(this)},t.prototype.emitParticule=function(){if(this.done)return null;this.left;for(var t=[],e=0;e<50;e++){var i=h5ge.Sprite.fromFrame("confetti_"+r.Helper.randomInt(1,3)+".png"),n=16777215;switch(r.Helper.randomInt(1,4)){case 1:n=15322702;break;case 2:n=15753029;break;case 3:n=15569712;break;case 3:n=1565183}i.tint=n;var o=new r.BestScoreParticle(this.left,i,r.Easing.easeOutCirc);t.push(o)}return this.done=!0,t},t}(h5ge.Emitter);r.BestScoreEmitter=t}(GAME||(GAME={})),function(h){var t=function(){function t(t,e,i){this.left=t,this.object=e,this._easing=i,this.terminated=!1,this.angle=0,this.startScale=1,this.endScale=1,this.startSpeed=h.Helper.randomInt(.2,1),this.endSpeed=0,this.lifetime=2e3,this.gravity=-.5,this.gravityX=0}return t.prototype.start=function(){this.angle=h.Helper.randomInt(-45,-45),this.angle=h.Helper.randomInt(0,90),this.startSpeed=h.Helper.randomInt(.5,3),this.endSpeed=.1,this.object.scaleXY=this.startScale,this._startTime=h5ge.Time.now(),0<this.lifetime&&(this._endTime=h5ge.Time.now()+this.lifetime);var t=this.angle*h5ge.Maths.DEG_TO_RADIAN;this._angleCos=Math.cos(t),this._angleSin=Math.sin(t),this.vX=this.startSpeed*this._angleCos,this.vY=this.startSpeed*this._angleSin,this.rotationSpeed=h.Helper.randomInt(1,3),this.rotationSpeed*=.5<Math.random()?1:-1;var e=h.Helper.tween(this.object);e.delay(h.Helper.randomInt(500,1e3)),e.to({scaleY:.1},500),e.delay(h.Helper.randomInt(50,200)),e.to({scaleY:1},500),e.delay(h.Helper.randomInt(50,200)),e.repeat(-1),e.start()},t.prototype.update=function(t){if(!this.terminated){var e=h5ge.Time.now(),i=1;if(0<this.lifetime){var n=e-this._startTime,o=Math.min(n,this.lifetime)/this.lifetime;i=this._easing(o)}var r=this.startSpeed+(this.endSpeed-this.startSpeed)*i,s=t*(r*this._angleCos*(this.left?-1:1)),a=t*(r*this._angleSin);return this.vY=this.vY,this.vX=this.vX+this.gravityX*t/1e3*(this.left?-1:1),this.object.x-=s+this.gravityX*t,this.object.y-=a+this.gravity*t,this.object.rotation+=this.rotationSpeed*t/1e3,this.object.y>h.Game.get().height?(this.terminated=!0,void(this.object.visible=!1)):void 0}},t.prototype.reset=function(){this.terminated=!1,this.object.visible=!0},t.prototype.destroy=function(){this.object.visible=!1},t}();h.BestScoreParticle=t}(GAME||(GAME={})),function(t){var c=4,l=.001,u=1e-7,p=10,d=11,f=1/(d-1),o="function"==typeof Float32Array;function n(t,e){return 1-3*e+3*t}function r(t,e){return 3*e-6*t}function s(t){return 3*t}function y(t,e,i){return((n(e,i)*t+r(e,i))*t+s(e))*t}function g(t,e,i){return 3*n(e,i)*t*t+2*r(e,i)*t+s(e)}function e(t){return i(t[0],t[1],t[2],t[3])}function i(s,e,a,i){if(!(0<=s&&s<=1&&0<=a&&a<=1))throw new Error("bezier x values must be in [0, 1] range");var h=o?new Float32Array(d):new Array(d);if(s!==e||a!==i)for(var t=0;t<d;++t)h[t]=y(t*f,s,a);function n(t){for(var e=0,i=1,n=d-1;i!==n&&h[i]<=t;++i)e+=f;var o=e+(t-h[--i])/(h[i+1]-h[i])*f,r=g(o,s,a);return l<=r?function(t,e,i,n){for(var o=0;o<c;++o){var r=g(e,i,n);if(0===r)return e;e-=(y(e,i,n)-t)/r}return e}(t,o,s,a):0===r?o:function(t,e,i,n,o){for(var r,s,a=0;0<(r=y(s=e+(i-e)/2,n,o)-t)?i=s:e=s,Math.abs(r)>u&&++a<p;);return s}(t,e,e+f,s,a)}return function(t){return s===e&&a===i?t:0===t?0:1===t?1:y(n(t),e,i)}}t.BezierCurve=e,t.bezier=i,t.Easing={Linear:e([0,0,1,1]),Ease:e([.25,.1,.25,1]),EaseIn:e([.42,0,1,1]),EaseOut:e([0,0,.58,1]),EaseInOut:e([.42,0,.58,1]),EaseInBack:e([.6,-.28,.735,.045]),EaseOutBack:e([.175,.885,.32,1.275]),EaseInOutBack:e([.68,-.55,.265,1.55]),easeInSine:e([.47,0,.745,.715]),easeOutSine:e([.39,.575,.565,1]),easeInOutSine:e([.445,.05,.55,.95]),easeInQuad:e([.55,.085,.68,.53]),easeOutQuad:e([.25,.46,.45,.94]),easeInOutQuad:e([.455,.03,.515,.955]),easeInCubic:e([.55,.055,.675,.19]),easeOutCubic:e([.215,.61,.355,1]),easeInOutCubic:e([.645,.045,.355,1]),easeInQuart:e([.895,.03,.685,.22]),easeOutQuart:e([.165,.84,.44,1]),easeInOutQuart:e([.77,0,.175,1]),easeInQuint:e([.755,.05,.855,.06]),easeOutQuint:e([.23,1,.32,1]),easeInOutQuint:e([.86,0,.07,1]),easeInExpo:e([.95,.05,.795,.035]),easeOutExpo:e([.19,1,.22,1]),easeInOutExpo:e([1,0,0,1]),easeInCirc:e([.6,.04,.98,.335]),easeOutCirc:e([.075,.82,.165,1]),easeInOutCirc:e([.785,.135,.15,.86]),easeInBack:e([.6,-.28,.735,.045]),easeOutBack:e([.175,.885,.32,1.275]),easeInOutBack:e([.68,-.55,.265,1.55])}}(GAME||(GAME={})),function(t){var e=function(){function t(){}return t.langChangedHandlers=new h5ge.HandlerCollection,t}();t.Handlers=e}(GAME||(GAME={})),function(n){var t=function(e){function i(){return e.call(this,.5)||this}return __extends(i,e),i.show=function(){var t=new i;return t.show(),t},i.prototype.show=function(t){this.build(),e.prototype.show.call(this,t)},i.prototype.close=function(){e.prototype.close.call(this),this.timer.cancel()},i.prototype.build=function(){var t=h5ge.Sprite.fromFrame("processing.png");t.scaleXY=.5,t.setPivotToCenter(),t.x=-t.width/2,this.contentContainer.addChild(t),this.contentContainer.setSizeFromChildren(),this.center();var e=this;this.timer=h5ge.TimeManager.createAndStartTimer(250,function(){t.visible=!0,e.alpha=.8}),t.visible=!1,n.Helper.tweenInfiniteRotation(t,1e3)},i}(n.Popup);n.LoadingPopup=t}(GAME||(GAME={})),function(r){var t=function(i){function t(t,e){return i.call(this,t,e)||this}return __extends(t,i),t.prototype.onLoadComplete=function(){var t=window.performance.timing,e=performance.now()+performance.timeOrigin-t.domLoading;r.logger.debug("domLoadingToNow : "+e.toFixed()+" ms");var i=e,n=window.MIN_SPLASH_TIME_MS||0;if(0<i&&i<n){var o=n-i;o=Math.max(o,100),r.logger.debug("Waiting "+o+" ms before starting"),r.Helper.timer(o,this.letsGo,this).start()}else r.logger.debug("No waiting  before starting"),this.letsGo()},t.prototype.letsGo=function(){i.prototype.onLoadComplete.call(this),document.getElementsByTagName("body")[0].classList.remove("bg"),document.getElementsByTagName("canvas")[0].style.visibility="visible"},t}(h5ge.H5PreLoadingScene);r.PreLoadingScene=t}(GAME||(GAME={})),function(h){var t=function(a){function t(t,e){var i=a.call(this,t,e)||this;i.finishing=!1,i.lastProgress=-1,i.optFillColor=8400785;var n=i;i.optProgressAlgo=3,i.optDelayBeforeCompleteFire=300,i.optEstimateLoadingTime=2e4,i.optOnProgress=function(t){n._onProgress(t)};var o=new h5ge.Text(h.I18N.get(h.I18NK.LOADING),"Arial",40);i.addChild(o),h.layout.centerOnXYInParent(o),h.factory.blink(o);var r=h.factory.newRoundRect(302,18,8,0),s=h.factory.newRoundRect(300,16,8,65280);return h.layout.centerOnX(r,o),h.layout.centerOnY(r,o),r.y+=60,i.addChild(r),h.layout.centerOnX(s,o),h.layout.centerOnY(s,o),s.y+=60,i.addChild(s),i.progressbar=new h5ge.ProgressBar(s,0,0),i.progressbar.setProgress(0),i}return __extends(t,a),t.prototype._onProgress=function(t){t!=this.lastProgress&&(this.finishing||(this.lastProgress=t,null!=this.progressbar&&this.progressbar.setProgress(t)))},t.prototype.onLoadComplete=function(){if(a.prototype.onLoadComplete.call(this),!(1<=this.lastProgress)){this.finishing=!0;var t=this.optDelayBeforeCompleteFire-50,e=1-this.lastProgress,i=this.lastProgress*t/e;this.progressbar.startTimeLimited(i+t,i)}},t}(h5ge.H5PreLoadingScene);h.PADPreLoadingScene=t}(GAME||(GAME={}));
/*! howler.js v2.0.8 | (c) 2013-2018, James Simpson of GoldFire Studios | MIT License | howlerjs.com */
!function(){"use strict";var e=function(){this.init()};e.prototype={init:function(){var e=this||n;return e._counter=1e3,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.mobileAutoEnable=!0,e._setup(),e},volume:function(e){var t=this||n;if(e=parseFloat(e),t.ctx||_(),void 0!==e&&e>=0&&e<=1){if(t._volume=e,t._muted)return t;t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e,n.ctx.currentTime);for(var o=0;o<t._howls.length;o++)if(!t._howls[o]._webAudio)for(var r=t._howls[o]._getSoundIds(),a=0;a<r.length;a++){var u=t._howls[o]._soundById(r[a]);u&&u._node&&(u._node.volume=u._volume*e)}return t}return t._volume},mute:function(e){var t=this||n;t.ctx||_(),t._muted=e,t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e?0:t._volume,n.ctx.currentTime);for(var o=0;o<t._howls.length;o++)if(!t._howls[o]._webAudio)for(var r=t._howls[o]._getSoundIds(),a=0;a<r.length;a++){var u=t._howls[o]._soundById(r[a]);u&&u._node&&(u._node.muted=!!e||u._muted)}return t},unload:function(){for(var e=this||n,t=e._howls.length-1;t>=0;t--)e._howls[t].unload();return e.usingWebAudio&&e.ctx&&void 0!==e.ctx.close&&(e.ctx.close(),e.ctx=null,_()),e},codecs:function(e){return(this||n)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||n;if(e.state=e.ctx?e.ctx.state||"running":"running",e._autoSuspend(),!e.usingWebAudio)if("undefined"!=typeof Audio)try{var t=new Audio;void 0===t.oncanplaythrough&&(e._canPlayEvent="canplay")}catch(n){e.noAudio=!0}else e.noAudio=!0;try{var t=new Audio;t.muted&&(e.noAudio=!0)}catch(e){}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||n,t=null;try{t="undefined"!=typeof Audio?new Audio:null}catch(n){return e}if(!t||"function"!=typeof t.canPlayType)return e;var o=t.canPlayType("audio/mpeg;").replace(/^no$/,""),r=e._navigator&&e._navigator.userAgent.match(/OPR\/([0-6].)/g),a=r&&parseInt(r[0].split("/")[1],10)<33;return e._codecs={mp3:!(a||!o&&!t.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!o,opus:!!t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!t.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!t.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!t.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(t.canPlayType("audio/x-mp4;")||t.canPlayType("audio/mp4;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!t.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(t.canPlayType("audio/x-flac;")||t.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_enableMobileAudio:function(){var e=this||n,t=/iPhone|iPad|iPod|Android|BlackBerry|BB10|Silk|Mobi/i.test(e._navigator&&e._navigator.userAgent),o=!!("ontouchend"in window||e._navigator&&e._navigator.maxTouchPoints>0||e._navigator&&e._navigator.msMaxTouchPoints>0);if(!e._mobileEnabled&&e.ctx&&(t||o)){e._mobileEnabled=!1,e._mobileUnloaded||44100===e.ctx.sampleRate||(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var r=function(){n._autoResume();var t=e.ctx.createBufferSource();t.buffer=e._scratchBuffer,t.connect(e.ctx.destination),void 0===t.start?t.noteOn(0):t.start(0),"function"==typeof e.ctx.resume&&e.ctx.resume(),t.onended=function(){t.disconnect(0),e._mobileEnabled=!0,e.mobileAutoEnable=!1,document.removeEventListener("touchstart",r,!0),document.removeEventListener("touchend",r,!0)}};return document.addEventListener("touchstart",r,!0),document.addEventListener("touchend",r,!0),e}},_autoSuspend:function(){var e=this;if(e.autoSuspend&&e.ctx&&void 0!==e.ctx.suspend&&n.usingWebAudio){for(var t=0;t<e._howls.length;t++)if(e._howls[t]._webAudio)for(var o=0;o<e._howls[t]._sounds.length;o++)if(!e._howls[t]._sounds[o]._paused)return e;return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout(function(){e.autoSuspend&&(e._suspendTimer=null,e.state="suspending",e.ctx.suspend().then(function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())}))},3e4),e}},_autoResume:function(){var e=this;if(e.ctx&&void 0!==e.ctx.resume&&n.usingWebAudio)return"running"===e.state&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):"suspended"===e.state?(e.ctx.resume().then(function(){e.state="running";for(var n=0;n<e._howls.length;n++)e._howls[n]._emit("resume")}),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):"suspending"===e.state&&(e._resumeAfterSuspend=!0),e}};var n=new e,t=function(e){var n=this;if(!e.src||0===e.src.length)return void console.error("An array of source files must be passed with any new Howl.");n.init(e)};t.prototype={init:function(e){var t=this;return n.ctx||_(),t._autoplay=e.autoplay||!1,t._format="string"!=typeof e.format?e.format:[e.format],t._html5=e.html5||!1,t._muted=e.mute||!1,t._loop=e.loop||!1,t._pool=e.pool||5,t._preload="boolean"!=typeof e.preload||e.preload,t._rate=e.rate||1,t._sprite=e.sprite||{},t._src="string"!=typeof e.src?e.src:[e.src],t._volume=void 0!==e.volume?e.volume:1,t._xhrWithCredentials=e.xhrWithCredentials||!1,t._duration=0,t._state="unloaded",t._sounds=[],t._endTimers={},t._queue=[],t._playLock=!1,t._onend=e.onend?[{fn:e.onend}]:[],t._onfade=e.onfade?[{fn:e.onfade}]:[],t._onload=e.onload?[{fn:e.onload}]:[],t._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],t._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],t._onpause=e.onpause?[{fn:e.onpause}]:[],t._onplay=e.onplay?[{fn:e.onplay}]:[],t._onstop=e.onstop?[{fn:e.onstop}]:[],t._onmute=e.onmute?[{fn:e.onmute}]:[],t._onvolume=e.onvolume?[{fn:e.onvolume}]:[],t._onrate=e.onrate?[{fn:e.onrate}]:[],t._onseek=e.onseek?[{fn:e.onseek}]:[],t._onresume=[],t._webAudio=n.usingWebAudio&&!t._html5,void 0!==n.ctx&&n.ctx&&n.mobileAutoEnable&&n._enableMobileAudio(),n._howls.push(t),t._autoplay&&t._queue.push({event:"play",action:function(){t.play()}}),t._preload&&t.load(),t},load:function(){var e=this,t=null;if(n.noAudio)return void e._emit("loaderror",null,"No audio support.");"string"==typeof e._src&&(e._src=[e._src]);for(var r=0;r<e._src.length;r++){var u,i;if(e._format&&e._format[r])u=e._format[r];else{if("string"!=typeof(i=e._src[r])){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}u=/^data:audio\/([^;,]+);/i.exec(i),u||(u=/\.([^.]+)$/.exec(i.split("?",1)[0])),u&&(u=u[1].toLowerCase())}if(u||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),u&&n.codecs(u)){t=e._src[r];break}}return t?(e._src=t,e._state="loading","https:"===window.location.protocol&&"http:"===t.slice(0,5)&&(e._html5=!0,e._webAudio=!1),new o(e),e._webAudio&&a(e),e):void e._emit("loaderror",null,"No codec support for selected audio sources.")},play:function(e,t){var o=this,r=null;if("number"==typeof e)r=e,e=null;else{if("string"==typeof e&&"loaded"===o._state&&!o._sprite[e])return null;if(void 0===e){e="__default";for(var a=0,u=0;u<o._sounds.length;u++)o._sounds[u]._paused&&!o._sounds[u]._ended&&(a++,r=o._sounds[u]._id);1===a?e=null:r=null}}var i=r?o._soundById(r):o._inactiveSound();if(!i)return null;if(r&&!e&&(e=i._sprite||"__default"),"loaded"!==o._state){i._sprite=e,i._ended=!1;var d=i._id;return o._queue.push({event:"play",action:function(){o.play(d)}}),d}if(r&&!i._paused)return t||setTimeout(function(){o._emit("play",i._id)},0),i._id;o._webAudio&&n._autoResume();var _=Math.max(0,i._seek>0?i._seek:o._sprite[e][0]/1e3),s=Math.max(0,(o._sprite[e][0]+o._sprite[e][1])/1e3-_),l=1e3*s/Math.abs(i._rate);i._paused=!1,i._ended=!1,i._sprite=e,i._seek=_,i._start=o._sprite[e][0]/1e3,i._stop=(o._sprite[e][0]+o._sprite[e][1])/1e3,i._loop=!(!i._loop&&!o._sprite[e][2]);var c=i._node;if(o._webAudio){var f=function(){o._refreshBuffer(i);var e=i._muted||o._muted?0:i._volume;c.gain.setValueAtTime(e,n.ctx.currentTime),i._playStart=n.ctx.currentTime,void 0===c.bufferSource.start?i._loop?c.bufferSource.noteGrainOn(0,_,86400):c.bufferSource.noteGrainOn(0,_,s):i._loop?c.bufferSource.start(0,_,86400):c.bufferSource.start(0,_,s),l!==1/0&&(o._endTimers[i._id]=setTimeout(o._ended.bind(o,i),l)),t||setTimeout(function(){o._emit("play",i._id)},0)};"running"===n.state?f():(o.once("resume",f),o._clearTimer(i._id))}else{var p=function(){c.currentTime=_,c.muted=i._muted||o._muted||n._muted||c.muted,c.volume=i._volume*n.volume(),c.playbackRate=i._rate;try{var e=c.play();if("undefined"!=typeof Promise&&e instanceof Promise&&(o._playLock=!0,e.then(function(){o._playLock=!1,o._loadQueue()})),c.paused)return void o._emit("playerror",i._id,"Playback was unable to start. This is most commonly an issue on mobile devices where playback was not within a user interaction.");l!==1/0&&(o._endTimers[i._id]=setTimeout(o._ended.bind(o,i),l)),t||o._emit("play",i._id)}catch(e){o._emit("playerror",i._id,e)}},m=window&&window.ejecta||!c.readyState&&n._navigator.isCocoonJS;if(4===c.readyState||m)p();else{var v=function(){p(),c.removeEventListener(n._canPlayEvent,v,!1)};c.addEventListener(n._canPlayEvent,v,!1),o._clearTimer(i._id)}}return i._id},pause:function(e){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"pause",action:function(){n.pause(e)}}),n;for(var t=n._getSoundIds(e),o=0;o<t.length;o++){n._clearTimer(t[o]);var r=n._soundById(t[o]);if(r&&!r._paused&&(r._seek=n.seek(t[o]),r._rateSeek=0,r._paused=!0,n._stopFade(t[o]),r._node))if(n._webAudio){if(!r._node.bufferSource)continue;void 0===r._node.bufferSource.stop?r._node.bufferSource.noteOff(0):r._node.bufferSource.stop(0),n._cleanBuffer(r._node)}else isNaN(r._node.duration)&&r._node.duration!==1/0||r._node.pause();arguments[1]||n._emit("pause",r?r._id:null)}return n},stop:function(e,n){var t=this;if("loaded"!==t._state)return t._queue.push({event:"stop",action:function(){t.stop(e)}}),t;for(var o=t._getSoundIds(e),r=0;r<o.length;r++){t._clearTimer(o[r]);var a=t._soundById(o[r]);a&&(a._seek=a._start||0,a._rateSeek=0,a._paused=!0,a._ended=!0,t._stopFade(o[r]),a._node&&(t._webAudio?a._node.bufferSource&&(void 0===a._node.bufferSource.stop?a._node.bufferSource.noteOff(0):a._node.bufferSource.stop(0),t._cleanBuffer(a._node)):isNaN(a._node.duration)&&a._node.duration!==1/0||(a._node.currentTime=a._start||0,a._node.pause())),n||t._emit("stop",a._id))}return t},mute:function(e,t){var o=this;if("loaded"!==o._state)return o._queue.push({event:"mute",action:function(){o.mute(e,t)}}),o;if(void 0===t){if("boolean"!=typeof e)return o._muted;o._muted=e}for(var r=o._getSoundIds(t),a=0;a<r.length;a++){var u=o._soundById(r[a]);u&&(u._muted=e,u._interval&&o._stopFade(u._id),o._webAudio&&u._node?u._node.gain.setValueAtTime(e?0:u._volume,n.ctx.currentTime):u._node&&(u._node.muted=!!n._muted||e),o._emit("mute",u._id))}return o},volume:function(){var e,t,o=this,r=arguments;if(0===r.length)return o._volume;if(1===r.length||2===r.length&&void 0===r[1]){o._getSoundIds().indexOf(r[0])>=0?t=parseInt(r[0],10):e=parseFloat(r[0])}else r.length>=2&&(e=parseFloat(r[0]),t=parseInt(r[1],10));var a;if(!(void 0!==e&&e>=0&&e<=1))return a=t?o._soundById(t):o._sounds[0],a?a._volume:0;if("loaded"!==o._state)return o._queue.push({event:"volume",action:function(){o.volume.apply(o,r)}}),o;void 0===t&&(o._volume=e),t=o._getSoundIds(t);for(var u=0;u<t.length;u++)(a=o._soundById(t[u]))&&(a._volume=e,r[2]||o._stopFade(t[u]),o._webAudio&&a._node&&!a._muted?a._node.gain.setValueAtTime(e,n.ctx.currentTime):a._node&&!a._muted&&(a._node.volume=e*n.volume()),o._emit("volume",a._id));return o},fade:function(e,t,o,r){var a=this;if("loaded"!==a._state)return a._queue.push({event:"fade",action:function(){a.fade(e,t,o,r)}}),a;a.volume(e,r);for(var u=a._getSoundIds(r),i=0;i<u.length;i++){var d=a._soundById(u[i]);if(d){if(r||a._stopFade(u[i]),a._webAudio&&!d._muted){var _=n.ctx.currentTime,s=_+o/1e3;d._volume=e,d._node.gain.setValueAtTime(e,_),d._node.gain.linearRampToValueAtTime(t,s)}a._startFadeInterval(d,e,t,o,u[i],void 0===r)}}return a},_startFadeInterval:function(e,n,t,o,r,a){var u=this,i=n,d=t-n,_=Math.abs(d/.01),s=Math.max(4,_>0?o/_:o),l=Date.now();e._fadeTo=t,e._interval=setInterval(function(){var r=(Date.now()-l)/o;l=Date.now(),i+=d*r,i=Math.max(0,i),i=Math.min(1,i),i=Math.round(100*i)/100,u._webAudio?e._volume=i:u.volume(i,e._id,!0),a&&(u._volume=i),(t<n&&i<=t||t>n&&i>=t)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,u.volume(t,e._id),u._emit("fade",e._id))},s)},_stopFade:function(e){var t=this,o=t._soundById(e);return o&&o._interval&&(t._webAudio&&o._node.gain.cancelScheduledValues(n.ctx.currentTime),clearInterval(o._interval),o._interval=null,t.volume(o._fadeTo,e),o._fadeTo=null,t._emit("fade",e)),t},loop:function(){var e,n,t,o=this,r=arguments;if(0===r.length)return o._loop;if(1===r.length){if("boolean"!=typeof r[0])return!!(t=o._soundById(parseInt(r[0],10)))&&t._loop;e=r[0],o._loop=e}else 2===r.length&&(e=r[0],n=parseInt(r[1],10));for(var a=o._getSoundIds(n),u=0;u<a.length;u++)(t=o._soundById(a[u]))&&(t._loop=e,o._webAudio&&t._node&&t._node.bufferSource&&(t._node.bufferSource.loop=e,e&&(t._node.bufferSource.loopStart=t._start||0,t._node.bufferSource.loopEnd=t._stop)));return o},rate:function(){var e,t,o=this,r=arguments;if(0===r.length)t=o._sounds[0]._id;else if(1===r.length){var a=o._getSoundIds(),u=a.indexOf(r[0]);u>=0?t=parseInt(r[0],10):e=parseFloat(r[0])}else 2===r.length&&(e=parseFloat(r[0]),t=parseInt(r[1],10));var i;if("number"!=typeof e)return i=o._soundById(t),i?i._rate:o._rate;if("loaded"!==o._state)return o._queue.push({event:"rate",action:function(){o.rate.apply(o,r)}}),o;void 0===t&&(o._rate=e),t=o._getSoundIds(t);for(var d=0;d<t.length;d++)if(i=o._soundById(t[d])){i._rateSeek=o.seek(t[d]),i._playStart=o._webAudio?n.ctx.currentTime:i._playStart,i._rate=e,o._webAudio&&i._node&&i._node.bufferSource?i._node.bufferSource.playbackRate.setValueAtTime(e,n.ctx.currentTime):i._node&&(i._node.playbackRate=e);var _=o.seek(t[d]),s=(o._sprite[i._sprite][0]+o._sprite[i._sprite][1])/1e3-_,l=1e3*s/Math.abs(i._rate);!o._endTimers[t[d]]&&i._paused||(o._clearTimer(t[d]),o._endTimers[t[d]]=setTimeout(o._ended.bind(o,i),l)),o._emit("rate",i._id)}return o},seek:function(){var e,t,o=this,r=arguments;if(0===r.length)t=o._sounds[0]._id;else if(1===r.length){var a=o._getSoundIds(),u=a.indexOf(r[0]);u>=0?t=parseInt(r[0],10):o._sounds.length&&(t=o._sounds[0]._id,e=parseFloat(r[0]))}else 2===r.length&&(e=parseFloat(r[0]),t=parseInt(r[1],10));if(void 0===t)return o;if("loaded"!==o._state)return o._queue.push({event:"seek",action:function(){o.seek.apply(o,r)}}),o;var i=o._soundById(t);if(i){if(!("number"==typeof e&&e>=0)){if(o._webAudio){var d=o.playing(t)?n.ctx.currentTime-i._playStart:0,_=i._rateSeek?i._rateSeek-i._seek:0;return i._seek+(_+d*Math.abs(i._rate))}return i._node.currentTime}var s=o.playing(t);s&&o.pause(t,!0),i._seek=e,i._ended=!1,o._clearTimer(t),s&&o.play(t,!0),!o._webAudio&&i._node&&(i._node.currentTime=e),o._emit("seek",t)}return o},playing:function(e){var n=this;if("number"==typeof e){var t=n._soundById(e);return!!t&&!t._paused}for(var o=0;o<n._sounds.length;o++)if(!n._sounds[o]._paused)return!0;return!1},duration:function(e){var n=this,t=n._duration,o=n._soundById(e);return o&&(t=n._sprite[o._sprite][1]/1e3),t},state:function(){return this._state},unload:function(){for(var e=this,t=e._sounds,o=0;o<t.length;o++){if(t[o]._paused||e.stop(t[o]._id),!e._webAudio){/MSIE |Trident\//.test(n._navigator&&n._navigator.userAgent)||(t[o]._node.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"),t[o]._node.removeEventListener("error",t[o]._errorFn,!1),t[o]._node.removeEventListener(n._canPlayEvent,t[o]._loadFn,!1)}delete t[o]._node,e._clearTimer(t[o]._id);var a=n._howls.indexOf(e);a>=0&&n._howls.splice(a,1)}var u=!0;for(o=0;o<n._howls.length;o++)if(n._howls[o]._src===e._src){u=!1;break}return r&&u&&delete r[e._src],n.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,n,t,o){var r=this,a=r["_on"+e];return"function"==typeof n&&a.push(o?{id:t,fn:n,once:o}:{id:t,fn:n}),r},off:function(e,n,t){var o=this,r=o["_on"+e],a=0;if("number"==typeof n&&(t=n,n=null),n||t)for(a=0;a<r.length;a++){var u=t===r[a].id;if(n===r[a].fn&&u||!n&&u){r.splice(a,1);break}}else if(e)o["_on"+e]=[];else{var i=Object.keys(o);for(a=0;a<i.length;a++)0===i[a].indexOf("_on")&&Array.isArray(o[i[a]])&&(o[i[a]]=[])}return o},once:function(e,n,t){var o=this;return o.on(e,n,t,1),o},_emit:function(e,n,t){for(var o=this,r=o["_on"+e],a=r.length-1;a>=0;a--)r[a].id&&r[a].id!==n&&"load"!==e||(setTimeout(function(e){e.call(this,n,t)}.bind(o,r[a].fn),0),r[a].once&&o.off(e,r[a].fn,r[a].id));return o},_loadQueue:function(){var e=this;if(e._queue.length>0){var n=e._queue[0];e.once(n.event,function(){e._queue.shift(),e._loadQueue()}),n.action()}return e},_ended:function(e){var t=this,o=e._sprite;if(!t._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(t._ended.bind(t,e),100),t;var r=!(!e._loop&&!t._sprite[o][2]);if(t._emit("end",e._id),!t._webAudio&&r&&t.stop(e._id,!0).play(e._id),t._webAudio&&r){t._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=n.ctx.currentTime;var a=1e3*(e._stop-e._start)/Math.abs(e._rate);t._endTimers[e._id]=setTimeout(t._ended.bind(t,e),a)}return t._webAudio&&!r&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,t._clearTimer(e._id),t._cleanBuffer(e._node),n._autoSuspend()),t._webAudio||r||t.stop(e._id),t},_clearTimer:function(e){var n=this;return n._endTimers[e]&&(clearTimeout(n._endTimers[e]),delete n._endTimers[e]),n},_soundById:function(e){for(var n=this,t=0;t<n._sounds.length;t++)if(e===n._sounds[t]._id)return n._sounds[t];return null},_inactiveSound:function(){var e=this;e._drain();for(var n=0;n<e._sounds.length;n++)if(e._sounds[n]._ended)return e._sounds[n].reset();return new o(e)},_drain:function(){var e=this,n=e._pool,t=0,o=0;if(!(e._sounds.length<n)){for(o=0;o<e._sounds.length;o++)e._sounds[o]._ended&&t++;for(o=e._sounds.length-1;o>=0;o--){if(t<=n)return;e._sounds[o]._ended&&(e._webAudio&&e._sounds[o]._node&&e._sounds[o]._node.disconnect(0),e._sounds.splice(o,1),t--)}}},_getSoundIds:function(e){var n=this;if(void 0===e){for(var t=[],o=0;o<n._sounds.length;o++)t.push(n._sounds[o]._id);return t}return[e]},_refreshBuffer:function(e){var t=this;return e._node.bufferSource=n.ctx.createBufferSource(),e._node.bufferSource.buffer=r[t._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,n.ctx.currentTime),t},_cleanBuffer:function(e){var t=this;if(n._scratchBuffer){e.bufferSource.onended=null,e.bufferSource.disconnect(0);try{e.bufferSource.buffer=n._scratchBuffer}catch(e){}}return e.bufferSource=null,t}};var o=function(e){this._parent=e,this.init()};o.prototype={init:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++n._counter,t._sounds.push(e),e.create(),e},create:function(){var e=this,t=e._parent,o=n._muted||e._muted||e._parent._muted?0:e._volume;return t._webAudio?(e._node=void 0===n.ctx.createGain?n.ctx.createGainNode():n.ctx.createGain(),e._node.gain.setValueAtTime(o,n.ctx.currentTime),e._node.paused=!0,e._node.connect(n.masterGain)):(e._node=new Audio,e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(n._canPlayEvent,e._loadFn,!1),e._node.src=t._src,e._node.preload="auto",e._node.volume=o*n.volume(),e._node.load()),e},reset:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++n._counter,e},_errorListener:function(){var e=this;e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorFn,!1)},_loadListener:function(){var e=this,t=e._parent;t._duration=Math.ceil(10*e._node.duration)/10,0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue()),e._node.removeEventListener(n._canPlayEvent,e._loadFn,!1)}};var r={},a=function(e){var n=e._src;if(r[n])return e._duration=r[n].duration,void d(e);if(/^data:[^;]+;base64,/.test(n)){for(var t=atob(n.split(",")[1]),o=new Uint8Array(t.length),a=0;a<t.length;++a)o[a]=t.charCodeAt(a);i(o.buffer,e)}else{var _=new XMLHttpRequest;_.open("GET",n,!0),_.withCredentials=e._xhrWithCredentials,_.responseType="arraybuffer",_.onload=function(){var n=(_.status+"")[0];if("0"!==n&&"2"!==n&&"3"!==n)return void e._emit("loaderror",null,"Failed loading audio file with status: "+_.status+".");i(_.response,e)},_.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete r[n],e.load())},u(_)}},u=function(e){try{e.send()}catch(n){e.onerror()}},i=function(e,t){n.ctx.decodeAudioData(e,function(e){e&&t._sounds.length>0&&(r[t._src]=e,d(t,e))},function(){t._emit("loaderror",null,"Decoding audio data failed.")})},d=function(e,n){n&&!e._duration&&(e._duration=n.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue())},_=function(){try{"undefined"!=typeof AudioContext?n.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?n.ctx=new webkitAudioContext:n.usingWebAudio=!1}catch(e){n.usingWebAudio=!1}var e=/iP(hone|od|ad)/.test(n._navigator&&n._navigator.platform),t=n._navigator&&n._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),o=t?parseInt(t[1],10):null;if(e&&o&&o<9){var r=/safari/.test(n._navigator&&n._navigator.userAgent.toLowerCase());(n._navigator&&n._navigator.standalone&&!r||n._navigator&&!n._navigator.standalone&&!r)&&(n.usingWebAudio=!1)}n.usingWebAudio&&(n.masterGain=void 0===n.ctx.createGain?n.ctx.createGainNode():n.ctx.createGain(),n.masterGain.gain.setValueAtTime(n._muted?0:1,n.ctx.currentTime),n.masterGain.connect(n.ctx.destination)),n._setup()};"function"==typeof define&&define.amd&&define([],function(){return{Howler:n,Howl:t}}),"undefined"!=typeof exports&&(exports.Howler=n,exports.Howl=t),"undefined"!=typeof window?(window.HowlerGlobal=e,window.Howler=n,window.Howl=t,window.Sound=o):"undefined"!=typeof global&&(global.HowlerGlobal=e,global.Howler=n,global.Howl=t,global.Sound=o)}();